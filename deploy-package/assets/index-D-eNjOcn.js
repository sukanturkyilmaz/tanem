(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var yn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function s2(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var rg={exports:{}},F0={},ng={exports:{}},We={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Io=Symbol.for("react.element"),i2=Symbol.for("react.portal"),l2=Symbol.for("react.fragment"),o2=Symbol.for("react.strict_mode"),c2=Symbol.for("react.profiler"),u2=Symbol.for("react.provider"),d2=Symbol.for("react.context"),f2=Symbol.for("react.forward_ref"),h2=Symbol.for("react.suspense"),m2=Symbol.for("react.memo"),x2=Symbol.for("react.lazy"),ym=Symbol.iterator;function p2(e){return e===null||typeof e!="object"?null:(e=ym&&e[ym]||e["@@iterator"],typeof e=="function"?e:null)}var ag={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sg=Object.assign,ig={};function rl(e,t,r){this.props=e,this.context=t,this.refs=ig,this.updater=r||ag}rl.prototype.isReactComponent={};rl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};rl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function lg(){}lg.prototype=rl.prototype;function Sf(e,t,r){this.props=e,this.context=t,this.refs=ig,this.updater=r||ag}var Nf=Sf.prototype=new lg;Nf.constructor=Sf;sg(Nf,rl.prototype);Nf.isPureReactComponent=!0;var _m=Array.isArray,og=Object.prototype.hasOwnProperty,Ef={current:null},cg={key:!0,ref:!0,__self:!0,__source:!0};function ug(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)og.call(t,n)&&!cg.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:Io,type:e,key:s,ref:i,props:a,_owner:Ef.current}}function g2(e,t){return{$$typeof:Io,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Tf(e){return typeof e=="object"&&e!==null&&e.$$typeof===Io}function v2(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var wm=/\/+/g;function du(e,t){return typeof e=="object"&&e!==null&&e.key!=null?v2(""+e.key):t.toString(36)}function Fc(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Io:case i2:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+du(i,0):n,_m(a)?(r="",e!=null&&(r=e.replace(wm,"$&/")+"/"),Fc(a,t,r,"",function(u){return u})):a!=null&&(Tf(a)&&(a=g2(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(wm,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",_m(e))for(var o=0;o<e.length;o++){s=e[o];var c=n+du(s,o);i+=Fc(s,t,r,c,a)}else if(c=p2(e),typeof c=="function")for(e=c.call(e),o=0;!(s=e.next()).done;)s=s.value,c=n+du(s,o++),i+=Fc(s,t,r,c,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Qo(e,t,r){if(e==null)return e;var n=[],a=0;return Fc(e,n,"","",function(s){return t.call(r,s,a++)}),n}function y2(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ar={current:null},Pc={transition:null},_2={ReactCurrentDispatcher:Ar,ReactCurrentBatchConfig:Pc,ReactCurrentOwner:Ef};function dg(){throw Error("act(...) is not supported in production builds of React.")}We.Children={map:Qo,forEach:function(e,t,r){Qo(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Qo(e,function(){t++}),t},toArray:function(e){return Qo(e,function(t){return t})||[]},only:function(e){if(!Tf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};We.Component=rl;We.Fragment=l2;We.Profiler=c2;We.PureComponent=Sf;We.StrictMode=o2;We.Suspense=h2;We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_2;We.act=dg;We.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=sg({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=Ef.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)og.call(t,c)&&!cg.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Io,type:e.type,key:a,ref:s,props:n,_owner:i}};We.createContext=function(e){return e={$$typeof:d2,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:u2,_context:e},e.Consumer=e};We.createElement=ug;We.createFactory=function(e){var t=ug.bind(null,e);return t.type=e,t};We.createRef=function(){return{current:null}};We.forwardRef=function(e){return{$$typeof:f2,render:e}};We.isValidElement=Tf;We.lazy=function(e){return{$$typeof:x2,_payload:{_status:-1,_result:e},_init:y2}};We.memo=function(e,t){return{$$typeof:m2,type:e,compare:t===void 0?null:t}};We.startTransition=function(e){var t=Pc.transition;Pc.transition={};try{e()}finally{Pc.transition=t}};We.unstable_act=dg;We.useCallback=function(e,t){return Ar.current.useCallback(e,t)};We.useContext=function(e){return Ar.current.useContext(e)};We.useDebugValue=function(){};We.useDeferredValue=function(e){return Ar.current.useDeferredValue(e)};We.useEffect=function(e,t){return Ar.current.useEffect(e,t)};We.useId=function(){return Ar.current.useId()};We.useImperativeHandle=function(e,t,r){return Ar.current.useImperativeHandle(e,t,r)};We.useInsertionEffect=function(e,t){return Ar.current.useInsertionEffect(e,t)};We.useLayoutEffect=function(e,t){return Ar.current.useLayoutEffect(e,t)};We.useMemo=function(e,t){return Ar.current.useMemo(e,t)};We.useReducer=function(e,t,r){return Ar.current.useReducer(e,t,r)};We.useRef=function(e){return Ar.current.useRef(e)};We.useState=function(e){return Ar.current.useState(e)};We.useSyncExternalStore=function(e,t,r){return Ar.current.useSyncExternalStore(e,t,r)};We.useTransition=function(){return Ar.current.useTransition()};We.version="18.3.1";ng.exports=We;var z=ng.exports;/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w2=z,b2=Symbol.for("react.element"),k2=Symbol.for("react.fragment"),S2=Object.prototype.hasOwnProperty,N2=w2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,E2={key:!0,ref:!0,__self:!0,__source:!0};function fg(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)S2.call(t,n)&&!E2.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:b2,type:e,key:s,ref:i,props:a,_owner:N2.current}}F0.Fragment=k2;F0.jsx=fg;F0.jsxs=fg;rg.exports=F0;var l=rg.exports,hg={exports:{}},tn={},mg={exports:{}},xg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(Z,H){var ae=Z.length;Z.push(H);e:for(;0<ae;){var K=ae-1>>>1,P=Z[K];if(0<a(P,H))Z[K]=H,Z[ae]=P,ae=K;else break e}}function r(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var H=Z[0],ae=Z.pop();if(ae!==H){Z[0]=ae;e:for(var K=0,P=Z.length,V=P>>>1;K<V;){var D=2*(K+1)-1,R=Z[D],te=D+1,F=Z[te];if(0>a(R,ae))te<P&&0>a(F,R)?(Z[K]=F,Z[te]=ae,K=te):(Z[K]=R,Z[D]=ae,K=D);else if(te<P&&0>a(F,ae))Z[K]=F,Z[te]=ae,K=te;else break e}}return H}function a(Z,H){var ae=Z.sortIndex-H.sortIndex;return ae!==0?ae:Z.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],u=[],d=1,f=null,h=3,g=!1,p=!1,x=!1,m=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(Z){for(var H=r(u);H!==null;){if(H.callback===null)n(u);else if(H.startTime<=Z)n(u),H.sortIndex=H.expirationTime,t(c,H);else break;H=r(u)}}function b(Z){if(x=!1,y(Z),!p)if(r(c)!==null)p=!0,Y(E);else{var H=r(u);H!==null&&se(b,H.startTime-Z)}}function E(Z,H){p=!1,x&&(x=!1,v(A),A=-1),g=!0;var ae=h;try{for(y(H),f=r(c);f!==null&&(!(f.expirationTime>H)||Z&&!G());){var K=f.callback;if(typeof K=="function"){f.callback=null,h=f.priorityLevel;var P=K(f.expirationTime<=H);H=e.unstable_now(),typeof P=="function"?f.callback=P:f===r(c)&&n(c),y(H)}else n(c);f=r(c)}if(f!==null)var V=!0;else{var D=r(u);D!==null&&se(b,D.startTime-H),V=!1}return V}finally{f=null,h=ae,g=!1}}var T=!1,k=null,A=-1,M=5,B=-1;function G(){return!(e.unstable_now()-B<M)}function U(){if(k!==null){var Z=e.unstable_now();B=Z;var H=!0;try{H=k(!0,Z)}finally{H?ne():(T=!1,k=null)}}else T=!1}var ne;if(typeof _=="function")ne=function(){_(U)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,oe=de.port2;de.port1.onmessage=U,ne=function(){oe.postMessage(null)}}else ne=function(){m(U,0)};function Y(Z){k=Z,T||(T=!0,ne())}function se(Z,H){A=m(function(){Z(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_continueExecution=function(){p||g||(p=!0,Y(E))},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(Z){switch(h){case 1:case 2:case 3:var H=3;break;default:H=h}var ae=h;h=H;try{return Z()}finally{h=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Z,H){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ae=h;h=Z;try{return H()}finally{h=ae}},e.unstable_scheduleCallback=function(Z,H,ae){var K=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?K+ae:K):ae=K,Z){case 1:var P=-1;break;case 2:P=250;break;case 5:P=1073741823;break;case 4:P=1e4;break;default:P=5e3}return P=ae+P,Z={id:d++,callback:H,priorityLevel:Z,startTime:ae,expirationTime:P,sortIndex:-1},ae>K?(Z.sortIndex=ae,t(u,Z),r(c)===null&&Z===r(u)&&(x?(v(A),A=-1):x=!0,se(b,ae-K))):(Z.sortIndex=P,t(c,Z),p||g||(p=!0,Y(E))),Z},e.unstable_shouldYield=G,e.unstable_wrapCallback=function(Z){var H=h;return function(){var ae=h;h=H;try{return Z.apply(this,arguments)}finally{h=ae}}}})(xg);mg.exports=xg;var T2=mg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j2=z,Jr=T2;function ge(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var pg=new Set,ro={};function Ws(e,t){$i(e,t),$i(e+"Capture",t)}function $i(e,t){for(ro[e]=t,e=0;e<t.length;e++)pg.add(t[e])}var ha=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),sd=Object.prototype.hasOwnProperty,C2=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bm={},km={};function A2(e){return sd.call(km,e)?!0:sd.call(bm,e)?!1:C2.test(e)?km[e]=!0:(bm[e]=!0,!1)}function F2(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function P2(e,t,r,n){if(t===null||typeof t>"u"||F2(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Fr(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var sr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){sr[e]=new Fr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];sr[t]=new Fr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){sr[e]=new Fr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){sr[e]=new Fr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){sr[e]=new Fr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){sr[e]=new Fr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){sr[e]=new Fr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){sr[e]=new Fr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){sr[e]=new Fr(e,5,!1,e.toLowerCase(),null,!1,!1)});var jf=/[\-:]([a-z])/g;function Cf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(jf,Cf);sr[t]=new Fr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(jf,Cf);sr[t]=new Fr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(jf,Cf);sr[t]=new Fr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){sr[e]=new Fr(e,1,!1,e.toLowerCase(),null,!1,!1)});sr.xlinkHref=new Fr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){sr[e]=new Fr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Af(e,t,r,n){var a=sr.hasOwnProperty(t)?sr[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(P2(t,r,a,n)&&(r=null),n||a===null?A2(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ga=j2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Zo=Symbol.for("react.element"),gi=Symbol.for("react.portal"),vi=Symbol.for("react.fragment"),Ff=Symbol.for("react.strict_mode"),id=Symbol.for("react.profiler"),gg=Symbol.for("react.provider"),vg=Symbol.for("react.context"),Pf=Symbol.for("react.forward_ref"),ld=Symbol.for("react.suspense"),od=Symbol.for("react.suspense_list"),Df=Symbol.for("react.memo"),Ea=Symbol.for("react.lazy"),yg=Symbol.for("react.offscreen"),Sm=Symbol.iterator;function pl(e){return e===null||typeof e!="object"?null:(e=Sm&&e[Sm]||e["@@iterator"],typeof e=="function"?e:null)}var Nt=Object.assign,fu;function Tl(e){if(fu===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);fu=t&&t[1]||""}return`
`+fu+e}var hu=!1;function mu(e,t){if(!e||hu)return"";hu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var c=`
`+a[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=o);break}}}finally{hu=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Tl(e):""}function D2(e){switch(e.tag){case 5:return Tl(e.type);case 16:return Tl("Lazy");case 13:return Tl("Suspense");case 19:return Tl("SuspenseList");case 0:case 2:case 15:return e=mu(e.type,!1),e;case 11:return e=mu(e.type.render,!1),e;case 1:return e=mu(e.type,!0),e;default:return""}}function cd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case vi:return"Fragment";case gi:return"Portal";case id:return"Profiler";case Ff:return"StrictMode";case ld:return"Suspense";case od:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case vg:return(e.displayName||"Context")+".Consumer";case gg:return(e._context.displayName||"Context")+".Provider";case Pf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Df:return t=e.displayName||null,t!==null?t:cd(e.type)||"Memo";case Ea:t=e._payload,e=e._init;try{return cd(e(t))}catch{}}return null}function O2(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return cd(t);case 8:return t===Ff?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function qa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function _g(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function R2(e){var t=_g(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ec(e){e._valueTracker||(e._valueTracker=R2(e))}function wg(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=_g(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Hc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ud(e,t){var r=t.checked;return Nt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Nm(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=qa(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function bg(e,t){t=t.checked,t!=null&&Af(e,"checked",t,!1)}function dd(e,t){bg(e,t);var r=qa(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?fd(e,t.type,r):t.hasOwnProperty("defaultValue")&&fd(e,t.type,qa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Em(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function fd(e,t,r){(t!=="number"||Hc(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var jl=Array.isArray;function Pi(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+qa(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function hd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ge(91));return Nt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Tm(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ge(92));if(jl(r)){if(1<r.length)throw Error(ge(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:qa(r)}}function kg(e,t){var r=qa(t.value),n=qa(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function jm(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Sg(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function md(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Sg(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var tc,Ng=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(tc=tc||document.createElement("div"),tc.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=tc.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function no(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Rl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},I2=["Webkit","ms","Moz","O"];Object.keys(Rl).forEach(function(e){I2.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Rl[t]=Rl[e]})});function Eg(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Rl.hasOwnProperty(e)&&Rl[e]?(""+t).trim():t+"px"}function Tg(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=Eg(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var L2=Nt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xd(e,t){if(t){if(L2[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ge(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ge(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ge(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ge(62))}}function pd(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var gd=null;function Of(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var vd=null,Di=null,Oi=null;function Cm(e){if(e=Bo(e)){if(typeof vd!="function")throw Error(ge(280));var t=e.stateNode;t&&(t=I0(t),vd(e.stateNode,e.type,t))}}function jg(e){Di?Oi?Oi.push(e):Oi=[e]:Di=e}function Cg(){if(Di){var e=Di,t=Oi;if(Oi=Di=null,Cm(e),t)for(e=0;e<t.length;e++)Cm(t[e])}}function Ag(e,t){return e(t)}function Fg(){}var xu=!1;function Pg(e,t,r){if(xu)return e(t,r);xu=!0;try{return Ag(e,t,r)}finally{xu=!1,(Di!==null||Oi!==null)&&(Fg(),Cg())}}function ao(e,t){var r=e.stateNode;if(r===null)return null;var n=I0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ge(231,t,typeof r));return r}var yd=!1;if(ha)try{var gl={};Object.defineProperty(gl,"passive",{get:function(){yd=!0}}),window.addEventListener("test",gl,gl),window.removeEventListener("test",gl,gl)}catch{yd=!1}function M2(e,t,r,n,a,s,i,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Il=!1,Wc=null,Vc=!1,_d=null,B2={onError:function(e){Il=!0,Wc=e}};function U2(e,t,r,n,a,s,i,o,c){Il=!1,Wc=null,M2.apply(B2,arguments)}function z2(e,t,r,n,a,s,i,o,c){if(U2.apply(this,arguments),Il){if(Il){var u=Wc;Il=!1,Wc=null}else throw Error(ge(198));Vc||(Vc=!0,_d=u)}}function Vs(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function Dg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Am(e){if(Vs(e)!==e)throw Error(ge(188))}function $2(e){var t=e.alternate;if(!t){if(t=Vs(e),t===null)throw Error(ge(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return Am(a),e;if(s===n)return Am(a),t;s=s.sibling}throw Error(ge(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(ge(189))}}if(r.alternate!==n)throw Error(ge(190))}if(r.tag!==3)throw Error(ge(188));return r.stateNode.current===r?e:t}function Og(e){return e=$2(e),e!==null?Rg(e):null}function Rg(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Rg(e);if(t!==null)return t;e=e.sibling}return null}var Ig=Jr.unstable_scheduleCallback,Fm=Jr.unstable_cancelCallback,H2=Jr.unstable_shouldYield,W2=Jr.unstable_requestPaint,Ot=Jr.unstable_now,V2=Jr.unstable_getCurrentPriorityLevel,Rf=Jr.unstable_ImmediatePriority,Lg=Jr.unstable_UserBlockingPriority,Gc=Jr.unstable_NormalPriority,G2=Jr.unstable_LowPriority,Mg=Jr.unstable_IdlePriority,P0=null,Kn=null;function K2(e){if(Kn&&typeof Kn.onCommitFiberRoot=="function")try{Kn.onCommitFiberRoot(P0,e,void 0,(e.current.flags&128)===128)}catch{}}var Pn=Math.clz32?Math.clz32:Y2,q2=Math.log,X2=Math.LN2;function Y2(e){return e>>>=0,e===0?32:31-(q2(e)/X2|0)|0}var rc=64,nc=4194304;function Cl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Kc(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=Cl(o):(s&=i,s!==0&&(n=Cl(s)))}else i=r&~a,i!==0?n=Cl(i):s!==0&&(n=Cl(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Pn(t),a=1<<r,n|=e[r],t&=~a;return n}function J2(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Q2(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Pn(s),o=1<<i,c=a[i];c===-1?(!(o&r)||o&n)&&(a[i]=J2(o,t)):c<=t&&(e.expiredLanes|=o),s&=~o}}function wd(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Bg(){var e=rc;return rc<<=1,!(rc&4194240)&&(rc=64),e}function pu(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Lo(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Pn(t),e[t]=r}function Z2(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Pn(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function If(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Pn(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var rt=0;function Ug(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var zg,Lf,$g,Hg,Wg,bd=!1,ac=[],Ba=null,Ua=null,za=null,so=new Map,io=new Map,Ca=[],ew="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pm(e,t){switch(e){case"focusin":case"focusout":Ba=null;break;case"dragenter":case"dragleave":Ua=null;break;case"mouseover":case"mouseout":za=null;break;case"pointerover":case"pointerout":so.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":io.delete(t.pointerId)}}function vl(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=Bo(t),t!==null&&Lf(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function tw(e,t,r,n,a){switch(t){case"focusin":return Ba=vl(Ba,e,t,r,n,a),!0;case"dragenter":return Ua=vl(Ua,e,t,r,n,a),!0;case"mouseover":return za=vl(za,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return so.set(s,vl(so.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,io.set(s,vl(io.get(s)||null,e,t,r,n,a)),!0}return!1}function Vg(e){var t=ys(e.target);if(t!==null){var r=Vs(t);if(r!==null){if(t=r.tag,t===13){if(t=Dg(r),t!==null){e.blockedOn=t,Wg(e.priority,function(){$g(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Dc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=kd(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);gd=n,r.target.dispatchEvent(n),gd=null}else return t=Bo(r),t!==null&&Lf(t),e.blockedOn=r,!1;t.shift()}return!0}function Dm(e,t,r){Dc(e)&&r.delete(t)}function rw(){bd=!1,Ba!==null&&Dc(Ba)&&(Ba=null),Ua!==null&&Dc(Ua)&&(Ua=null),za!==null&&Dc(za)&&(za=null),so.forEach(Dm),io.forEach(Dm)}function yl(e,t){e.blockedOn===t&&(e.blockedOn=null,bd||(bd=!0,Jr.unstable_scheduleCallback(Jr.unstable_NormalPriority,rw)))}function lo(e){function t(a){return yl(a,e)}if(0<ac.length){yl(ac[0],e);for(var r=1;r<ac.length;r++){var n=ac[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ba!==null&&yl(Ba,e),Ua!==null&&yl(Ua,e),za!==null&&yl(za,e),so.forEach(t),io.forEach(t),r=0;r<Ca.length;r++)n=Ca[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ca.length&&(r=Ca[0],r.blockedOn===null);)Vg(r),r.blockedOn===null&&Ca.shift()}var Ri=ga.ReactCurrentBatchConfig,qc=!0;function nw(e,t,r,n){var a=rt,s=Ri.transition;Ri.transition=null;try{rt=1,Mf(e,t,r,n)}finally{rt=a,Ri.transition=s}}function aw(e,t,r,n){var a=rt,s=Ri.transition;Ri.transition=null;try{rt=4,Mf(e,t,r,n)}finally{rt=a,Ri.transition=s}}function Mf(e,t,r,n){if(qc){var a=kd(e,t,r,n);if(a===null)Eu(e,t,n,Xc,r),Pm(e,n);else if(tw(a,e,t,r,n))n.stopPropagation();else if(Pm(e,n),t&4&&-1<ew.indexOf(e)){for(;a!==null;){var s=Bo(a);if(s!==null&&zg(s),s=kd(e,t,r,n),s===null&&Eu(e,t,n,Xc,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else Eu(e,t,n,null,r)}}var Xc=null;function kd(e,t,r,n){if(Xc=null,e=Of(n),e=ys(e),e!==null)if(t=Vs(e),t===null)e=null;else if(r=t.tag,r===13){if(e=Dg(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xc=e,null}function Gg(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(V2()){case Rf:return 1;case Lg:return 4;case Gc:case G2:return 16;case Mg:return 536870912;default:return 16}default:return 16}}var Da=null,Bf=null,Oc=null;function Kg(){if(Oc)return Oc;var e,t=Bf,r=t.length,n,a="value"in Da?Da.value:Da.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return Oc=a.slice(e,1<n?1-n:void 0)}function Rc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function sc(){return!0}function Om(){return!1}function rn(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?sc:Om,this.isPropagationStopped=Om,this}return Nt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=sc)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=sc)},persist:function(){},isPersistent:sc}),t}var nl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uf=rn(nl),Mo=Nt({},nl,{view:0,detail:0}),sw=rn(Mo),gu,vu,_l,D0=Nt({},Mo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zf,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==_l&&(_l&&e.type==="mousemove"?(gu=e.screenX-_l.screenX,vu=e.screenY-_l.screenY):vu=gu=0,_l=e),gu)},movementY:function(e){return"movementY"in e?e.movementY:vu}}),Rm=rn(D0),iw=Nt({},D0,{dataTransfer:0}),lw=rn(iw),ow=Nt({},Mo,{relatedTarget:0}),yu=rn(ow),cw=Nt({},nl,{animationName:0,elapsedTime:0,pseudoElement:0}),uw=rn(cw),dw=Nt({},nl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),fw=rn(dw),hw=Nt({},nl,{data:0}),Im=rn(hw),mw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gw(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=pw[e])?!!t[e]:!1}function zf(){return gw}var vw=Nt({},Mo,{key:function(e){if(e.key){var t=mw[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Rc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?xw[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zf,charCode:function(e){return e.type==="keypress"?Rc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Rc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),yw=rn(vw),_w=Nt({},D0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Lm=rn(_w),ww=Nt({},Mo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zf}),bw=rn(ww),kw=Nt({},nl,{propertyName:0,elapsedTime:0,pseudoElement:0}),Sw=rn(kw),Nw=Nt({},D0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ew=rn(Nw),Tw=[9,13,27,32],$f=ha&&"CompositionEvent"in window,Ll=null;ha&&"documentMode"in document&&(Ll=document.documentMode);var jw=ha&&"TextEvent"in window&&!Ll,qg=ha&&(!$f||Ll&&8<Ll&&11>=Ll),Mm=" ",Bm=!1;function Xg(e,t){switch(e){case"keyup":return Tw.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Yg(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var yi=!1;function Cw(e,t){switch(e){case"compositionend":return Yg(t);case"keypress":return t.which!==32?null:(Bm=!0,Mm);case"textInput":return e=t.data,e===Mm&&Bm?null:e;default:return null}}function Aw(e,t){if(yi)return e==="compositionend"||!$f&&Xg(e,t)?(e=Kg(),Oc=Bf=Da=null,yi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return qg&&t.locale!=="ko"?null:t.data;default:return null}}var Fw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Um(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Fw[e.type]:t==="textarea"}function Jg(e,t,r,n){jg(n),t=Yc(t,"onChange"),0<t.length&&(r=new Uf("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Ml=null,oo=null;function Pw(e){o1(e,0)}function O0(e){var t=bi(e);if(wg(t))return e}function Dw(e,t){if(e==="change")return t}var Qg=!1;if(ha){var _u;if(ha){var wu="oninput"in document;if(!wu){var zm=document.createElement("div");zm.setAttribute("oninput","return;"),wu=typeof zm.oninput=="function"}_u=wu}else _u=!1;Qg=_u&&(!document.documentMode||9<document.documentMode)}function $m(){Ml&&(Ml.detachEvent("onpropertychange",Zg),oo=Ml=null)}function Zg(e){if(e.propertyName==="value"&&O0(oo)){var t=[];Jg(t,oo,e,Of(e)),Pg(Pw,t)}}function Ow(e,t,r){e==="focusin"?($m(),Ml=t,oo=r,Ml.attachEvent("onpropertychange",Zg)):e==="focusout"&&$m()}function Rw(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return O0(oo)}function Iw(e,t){if(e==="click")return O0(t)}function Lw(e,t){if(e==="input"||e==="change")return O0(t)}function Mw(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var In=typeof Object.is=="function"?Object.is:Mw;function co(e,t){if(In(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!sd.call(t,a)||!In(e[a],t[a]))return!1}return!0}function Hm(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Wm(e,t){var r=Hm(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Hm(r)}}function e1(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?e1(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function t1(){for(var e=window,t=Hc();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Hc(e.document)}return t}function Hf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Bw(e){var t=t1(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&e1(r.ownerDocument.documentElement,r)){if(n!==null&&Hf(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=Wm(r,s);var i=Wm(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Uw=ha&&"documentMode"in document&&11>=document.documentMode,_i=null,Sd=null,Bl=null,Nd=!1;function Vm(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Nd||_i==null||_i!==Hc(n)||(n=_i,"selectionStart"in n&&Hf(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Bl&&co(Bl,n)||(Bl=n,n=Yc(Sd,"onSelect"),0<n.length&&(t=new Uf("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=_i)))}function ic(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var wi={animationend:ic("Animation","AnimationEnd"),animationiteration:ic("Animation","AnimationIteration"),animationstart:ic("Animation","AnimationStart"),transitionend:ic("Transition","TransitionEnd")},bu={},r1={};ha&&(r1=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);function R0(e){if(bu[e])return bu[e];if(!wi[e])return e;var t=wi[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in r1)return bu[e]=t[r];return e}var n1=R0("animationend"),a1=R0("animationiteration"),s1=R0("animationstart"),i1=R0("transitionend"),l1=new Map,Gm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function rs(e,t){l1.set(e,t),Ws(t,[e])}for(var ku=0;ku<Gm.length;ku++){var Su=Gm[ku],zw=Su.toLowerCase(),$w=Su[0].toUpperCase()+Su.slice(1);rs(zw,"on"+$w)}rs(n1,"onAnimationEnd");rs(a1,"onAnimationIteration");rs(s1,"onAnimationStart");rs("dblclick","onDoubleClick");rs("focusin","onFocus");rs("focusout","onBlur");rs(i1,"onTransitionEnd");$i("onMouseEnter",["mouseout","mouseover"]);$i("onMouseLeave",["mouseout","mouseover"]);$i("onPointerEnter",["pointerout","pointerover"]);$i("onPointerLeave",["pointerout","pointerover"]);Ws("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ws("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ws("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ws("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ws("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ws("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Al="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Hw=new Set("cancel close invalid load scroll toggle".split(" ").concat(Al));function Km(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,z2(n,t,void 0,e),e.currentTarget=null}function o1(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==s&&a.isPropagationStopped())break e;Km(a,o,u),s=c}else for(i=0;i<n.length;i++){if(o=n[i],c=o.instance,u=o.currentTarget,o=o.listener,c!==s&&a.isPropagationStopped())break e;Km(a,o,u),s=c}}}if(Vc)throw e=_d,Vc=!1,_d=null,e}function dt(e,t){var r=t[Ad];r===void 0&&(r=t[Ad]=new Set);var n=e+"__bubble";r.has(n)||(c1(t,e,2,!1),r.add(n))}function Nu(e,t,r){var n=0;t&&(n|=4),c1(r,e,n,t)}var lc="_reactListening"+Math.random().toString(36).slice(2);function uo(e){if(!e[lc]){e[lc]=!0,pg.forEach(function(r){r!=="selectionchange"&&(Hw.has(r)||Nu(r,!1,e),Nu(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[lc]||(t[lc]=!0,Nu("selectionchange",!1,t))}}function c1(e,t,r,n){switch(Gg(t)){case 1:var a=nw;break;case 4:a=aw;break;default:a=Mf}r=a.bind(null,t,r,e),a=void 0,!yd||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Eu(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;i=i.return}for(;o!==null;){if(i=ys(o),i===null)return;if(c=i.tag,c===5||c===6){n=s=i;continue e}o=o.parentNode}}n=n.return}Pg(function(){var u=s,d=Of(r),f=[];e:{var h=l1.get(e);if(h!==void 0){var g=Uf,p=e;switch(e){case"keypress":if(Rc(r)===0)break e;case"keydown":case"keyup":g=yw;break;case"focusin":p="focus",g=yu;break;case"focusout":p="blur",g=yu;break;case"beforeblur":case"afterblur":g=yu;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=Rm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=lw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=bw;break;case n1:case a1:case s1:g=uw;break;case i1:g=Sw;break;case"scroll":g=sw;break;case"wheel":g=Ew;break;case"copy":case"cut":case"paste":g=fw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=Lm}var x=(t&4)!==0,m=!x&&e==="scroll",v=x?h!==null?h+"Capture":null:h;x=[];for(var _=u,y;_!==null;){y=_;var b=y.stateNode;if(y.tag===5&&b!==null&&(y=b,v!==null&&(b=ao(_,v),b!=null&&x.push(fo(_,b,y)))),m)break;_=_.return}0<x.length&&(h=new g(h,p,null,r,d),f.push({event:h,listeners:x}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",g=e==="mouseout"||e==="pointerout",h&&r!==gd&&(p=r.relatedTarget||r.fromElement)&&(ys(p)||p[ma]))break e;if((g||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,g?(p=r.relatedTarget||r.toElement,g=u,p=p?ys(p):null,p!==null&&(m=Vs(p),p!==m||p.tag!==5&&p.tag!==6)&&(p=null)):(g=null,p=u),g!==p)){if(x=Rm,b="onMouseLeave",v="onMouseEnter",_="mouse",(e==="pointerout"||e==="pointerover")&&(x=Lm,b="onPointerLeave",v="onPointerEnter",_="pointer"),m=g==null?h:bi(g),y=p==null?h:bi(p),h=new x(b,_+"leave",g,r,d),h.target=m,h.relatedTarget=y,b=null,ys(d)===u&&(x=new x(v,_+"enter",p,r,d),x.target=y,x.relatedTarget=m,b=x),m=b,g&&p)t:{for(x=g,v=p,_=0,y=x;y;y=si(y))_++;for(y=0,b=v;b;b=si(b))y++;for(;0<_-y;)x=si(x),_--;for(;0<y-_;)v=si(v),y--;for(;_--;){if(x===v||v!==null&&x===v.alternate)break t;x=si(x),v=si(v)}x=null}else x=null;g!==null&&qm(f,h,g,x,!1),p!==null&&m!==null&&qm(f,m,p,x,!0)}}e:{if(h=u?bi(u):window,g=h.nodeName&&h.nodeName.toLowerCase(),g==="select"||g==="input"&&h.type==="file")var E=Dw;else if(Um(h))if(Qg)E=Lw;else{E=Rw;var T=Ow}else(g=h.nodeName)&&g.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(E=Iw);if(E&&(E=E(e,u))){Jg(f,E,r,d);break e}T&&T(e,h,u),e==="focusout"&&(T=h._wrapperState)&&T.controlled&&h.type==="number"&&fd(h,"number",h.value)}switch(T=u?bi(u):window,e){case"focusin":(Um(T)||T.contentEditable==="true")&&(_i=T,Sd=u,Bl=null);break;case"focusout":Bl=Sd=_i=null;break;case"mousedown":Nd=!0;break;case"contextmenu":case"mouseup":case"dragend":Nd=!1,Vm(f,r,d);break;case"selectionchange":if(Uw)break;case"keydown":case"keyup":Vm(f,r,d)}var k;if($f)e:{switch(e){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else yi?Xg(e,r)&&(A="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(A="onCompositionStart");A&&(qg&&r.locale!=="ko"&&(yi||A!=="onCompositionStart"?A==="onCompositionEnd"&&yi&&(k=Kg()):(Da=d,Bf="value"in Da?Da.value:Da.textContent,yi=!0)),T=Yc(u,A),0<T.length&&(A=new Im(A,e,null,r,d),f.push({event:A,listeners:T}),k?A.data=k:(k=Yg(r),k!==null&&(A.data=k)))),(k=jw?Cw(e,r):Aw(e,r))&&(u=Yc(u,"onBeforeInput"),0<u.length&&(d=new Im("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=k))}o1(f,t)})}function fo(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Yc(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=ao(e,r),s!=null&&n.unshift(fo(e,s,a)),s=ao(e,t),s!=null&&n.push(fo(e,s,a))),e=e.return}return n}function si(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function qm(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&u!==null&&(o=u,a?(c=ao(r,s),c!=null&&i.unshift(fo(r,c,o))):a||(c=ao(r,s),c!=null&&i.push(fo(r,c,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var Ww=/\r\n?/g,Vw=/\u0000|\uFFFD/g;function Xm(e){return(typeof e=="string"?e:""+e).replace(Ww,`
`).replace(Vw,"")}function oc(e,t,r){if(t=Xm(t),Xm(e)!==t&&r)throw Error(ge(425))}function Jc(){}var Ed=null,Td=null;function jd(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Cd=typeof setTimeout=="function"?setTimeout:void 0,Gw=typeof clearTimeout=="function"?clearTimeout:void 0,Ym=typeof Promise=="function"?Promise:void 0,Kw=typeof queueMicrotask=="function"?queueMicrotask:typeof Ym<"u"?function(e){return Ym.resolve(null).then(e).catch(qw)}:Cd;function qw(e){setTimeout(function(){throw e})}function Tu(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),lo(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);lo(t)}function $a(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Jm(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var al=Math.random().toString(36).slice(2),Vn="__reactFiber$"+al,ho="__reactProps$"+al,ma="__reactContainer$"+al,Ad="__reactEvents$"+al,Xw="__reactListeners$"+al,Yw="__reactHandles$"+al;function ys(e){var t=e[Vn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ma]||r[Vn]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Jm(e);e!==null;){if(r=e[Vn])return r;e=Jm(e)}return t}e=r,r=e.parentNode}return null}function Bo(e){return e=e[Vn]||e[ma],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function bi(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ge(33))}function I0(e){return e[ho]||null}var Fd=[],ki=-1;function ns(e){return{current:e}}function ht(e){0>ki||(e.current=Fd[ki],Fd[ki]=null,ki--)}function ut(e,t){ki++,Fd[ki]=e.current,e.current=t}var Xa={},yr=ns(Xa),Lr=ns(!1),js=Xa;function Hi(e,t){var r=e.type.contextTypes;if(!r)return Xa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Mr(e){return e=e.childContextTypes,e!=null}function Qc(){ht(Lr),ht(yr)}function Qm(e,t,r){if(yr.current!==Xa)throw Error(ge(168));ut(yr,t),ut(Lr,r)}function u1(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(ge(108,O2(e)||"Unknown",a));return Nt({},r,n)}function Zc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Xa,js=yr.current,ut(yr,e),ut(Lr,Lr.current),!0}function Zm(e,t,r){var n=e.stateNode;if(!n)throw Error(ge(169));r?(e=u1(e,t,js),n.__reactInternalMemoizedMergedChildContext=e,ht(Lr),ht(yr),ut(yr,e)):ht(Lr),ut(Lr,r)}var sa=null,L0=!1,ju=!1;function d1(e){sa===null?sa=[e]:sa.push(e)}function Jw(e){L0=!0,d1(e)}function as(){if(!ju&&sa!==null){ju=!0;var e=0,t=rt;try{var r=sa;for(rt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}sa=null,L0=!1}catch(a){throw sa!==null&&(sa=sa.slice(e+1)),Ig(Rf,as),a}finally{rt=t,ju=!1}}return null}var Si=[],Ni=0,e0=null,t0=0,fn=[],hn=0,Cs=null,ia=1,la="";function ms(e,t){Si[Ni++]=t0,Si[Ni++]=e0,e0=e,t0=t}function f1(e,t,r){fn[hn++]=ia,fn[hn++]=la,fn[hn++]=Cs,Cs=e;var n=ia;e=la;var a=32-Pn(n)-1;n&=~(1<<a),r+=1;var s=32-Pn(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,ia=1<<32-Pn(t)+a|r<<a|n,la=s+e}else ia=1<<s|r<<a|n,la=e}function Wf(e){e.return!==null&&(ms(e,1),f1(e,1,0))}function Vf(e){for(;e===e0;)e0=Si[--Ni],Si[Ni]=null,t0=Si[--Ni],Si[Ni]=null;for(;e===Cs;)Cs=fn[--hn],fn[hn]=null,la=fn[--hn],fn[hn]=null,ia=fn[--hn],fn[hn]=null}var Xr=null,Gr=null,yt=!1,An=null;function h1(e,t){var r=mn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ex(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Xr=e,Gr=$a(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Xr=e,Gr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Cs!==null?{id:ia,overflow:la}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=mn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Xr=e,Gr=null,!0):!1;default:return!1}}function Pd(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Dd(e){if(yt){var t=Gr;if(t){var r=t;if(!ex(e,t)){if(Pd(e))throw Error(ge(418));t=$a(r.nextSibling);var n=Xr;t&&ex(e,t)?h1(n,r):(e.flags=e.flags&-4097|2,yt=!1,Xr=e)}}else{if(Pd(e))throw Error(ge(418));e.flags=e.flags&-4097|2,yt=!1,Xr=e}}}function tx(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Xr=e}function cc(e){if(e!==Xr)return!1;if(!yt)return tx(e),yt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!jd(e.type,e.memoizedProps)),t&&(t=Gr)){if(Pd(e))throw m1(),Error(ge(418));for(;t;)h1(e,t),t=$a(t.nextSibling)}if(tx(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ge(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Gr=$a(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Gr=null}}else Gr=Xr?$a(e.stateNode.nextSibling):null;return!0}function m1(){for(var e=Gr;e;)e=$a(e.nextSibling)}function Wi(){Gr=Xr=null,yt=!1}function Gf(e){An===null?An=[e]:An.push(e)}var Qw=ga.ReactCurrentBatchConfig;function wl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ge(309));var n=r.stateNode}if(!n)throw Error(ge(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(ge(284));if(!r._owner)throw Error(ge(290,e))}return e}function uc(e,t){throw e=Object.prototype.toString.call(t),Error(ge(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function rx(e){var t=e._init;return t(e._payload)}function x1(e){function t(v,_){if(e){var y=v.deletions;y===null?(v.deletions=[_],v.flags|=16):y.push(_)}}function r(v,_){if(!e)return null;for(;_!==null;)t(v,_),_=_.sibling;return null}function n(v,_){for(v=new Map;_!==null;)_.key!==null?v.set(_.key,_):v.set(_.index,_),_=_.sibling;return v}function a(v,_){return v=Ga(v,_),v.index=0,v.sibling=null,v}function s(v,_,y){return v.index=y,e?(y=v.alternate,y!==null?(y=y.index,y<_?(v.flags|=2,_):y):(v.flags|=2,_)):(v.flags|=1048576,_)}function i(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,_,y,b){return _===null||_.tag!==6?(_=Ru(y,v.mode,b),_.return=v,_):(_=a(_,y),_.return=v,_)}function c(v,_,y,b){var E=y.type;return E===vi?d(v,_,y.props.children,b,y.key):_!==null&&(_.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ea&&rx(E)===_.type)?(b=a(_,y.props),b.ref=wl(v,_,y),b.return=v,b):(b=$c(y.type,y.key,y.props,null,v.mode,b),b.ref=wl(v,_,y),b.return=v,b)}function u(v,_,y,b){return _===null||_.tag!==4||_.stateNode.containerInfo!==y.containerInfo||_.stateNode.implementation!==y.implementation?(_=Iu(y,v.mode,b),_.return=v,_):(_=a(_,y.children||[]),_.return=v,_)}function d(v,_,y,b,E){return _===null||_.tag!==7?(_=ks(y,v.mode,b,E),_.return=v,_):(_=a(_,y),_.return=v,_)}function f(v,_,y){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Ru(""+_,v.mode,y),_.return=v,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Zo:return y=$c(_.type,_.key,_.props,null,v.mode,y),y.ref=wl(v,null,_),y.return=v,y;case gi:return _=Iu(_,v.mode,y),_.return=v,_;case Ea:var b=_._init;return f(v,b(_._payload),y)}if(jl(_)||pl(_))return _=ks(_,v.mode,y,null),_.return=v,_;uc(v,_)}return null}function h(v,_,y,b){var E=_!==null?_.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return E!==null?null:o(v,_,""+y,b);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Zo:return y.key===E?c(v,_,y,b):null;case gi:return y.key===E?u(v,_,y,b):null;case Ea:return E=y._init,h(v,_,E(y._payload),b)}if(jl(y)||pl(y))return E!==null?null:d(v,_,y,b,null);uc(v,y)}return null}function g(v,_,y,b,E){if(typeof b=="string"&&b!==""||typeof b=="number")return v=v.get(y)||null,o(_,v,""+b,E);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Zo:return v=v.get(b.key===null?y:b.key)||null,c(_,v,b,E);case gi:return v=v.get(b.key===null?y:b.key)||null,u(_,v,b,E);case Ea:var T=b._init;return g(v,_,y,T(b._payload),E)}if(jl(b)||pl(b))return v=v.get(y)||null,d(_,v,b,E,null);uc(_,b)}return null}function p(v,_,y,b){for(var E=null,T=null,k=_,A=_=0,M=null;k!==null&&A<y.length;A++){k.index>A?(M=k,k=null):M=k.sibling;var B=h(v,k,y[A],b);if(B===null){k===null&&(k=M);break}e&&k&&B.alternate===null&&t(v,k),_=s(B,_,A),T===null?E=B:T.sibling=B,T=B,k=M}if(A===y.length)return r(v,k),yt&&ms(v,A),E;if(k===null){for(;A<y.length;A++)k=f(v,y[A],b),k!==null&&(_=s(k,_,A),T===null?E=k:T.sibling=k,T=k);return yt&&ms(v,A),E}for(k=n(v,k);A<y.length;A++)M=g(k,v,A,y[A],b),M!==null&&(e&&M.alternate!==null&&k.delete(M.key===null?A:M.key),_=s(M,_,A),T===null?E=M:T.sibling=M,T=M);return e&&k.forEach(function(G){return t(v,G)}),yt&&ms(v,A),E}function x(v,_,y,b){var E=pl(y);if(typeof E!="function")throw Error(ge(150));if(y=E.call(y),y==null)throw Error(ge(151));for(var T=E=null,k=_,A=_=0,M=null,B=y.next();k!==null&&!B.done;A++,B=y.next()){k.index>A?(M=k,k=null):M=k.sibling;var G=h(v,k,B.value,b);if(G===null){k===null&&(k=M);break}e&&k&&G.alternate===null&&t(v,k),_=s(G,_,A),T===null?E=G:T.sibling=G,T=G,k=M}if(B.done)return r(v,k),yt&&ms(v,A),E;if(k===null){for(;!B.done;A++,B=y.next())B=f(v,B.value,b),B!==null&&(_=s(B,_,A),T===null?E=B:T.sibling=B,T=B);return yt&&ms(v,A),E}for(k=n(v,k);!B.done;A++,B=y.next())B=g(k,v,A,B.value,b),B!==null&&(e&&B.alternate!==null&&k.delete(B.key===null?A:B.key),_=s(B,_,A),T===null?E=B:T.sibling=B,T=B);return e&&k.forEach(function(U){return t(v,U)}),yt&&ms(v,A),E}function m(v,_,y,b){if(typeof y=="object"&&y!==null&&y.type===vi&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Zo:e:{for(var E=y.key,T=_;T!==null;){if(T.key===E){if(E=y.type,E===vi){if(T.tag===7){r(v,T.sibling),_=a(T,y.props.children),_.return=v,v=_;break e}}else if(T.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ea&&rx(E)===T.type){r(v,T.sibling),_=a(T,y.props),_.ref=wl(v,T,y),_.return=v,v=_;break e}r(v,T);break}else t(v,T);T=T.sibling}y.type===vi?(_=ks(y.props.children,v.mode,b,y.key),_.return=v,v=_):(b=$c(y.type,y.key,y.props,null,v.mode,b),b.ref=wl(v,_,y),b.return=v,v=b)}return i(v);case gi:e:{for(T=y.key;_!==null;){if(_.key===T)if(_.tag===4&&_.stateNode.containerInfo===y.containerInfo&&_.stateNode.implementation===y.implementation){r(v,_.sibling),_=a(_,y.children||[]),_.return=v,v=_;break e}else{r(v,_);break}else t(v,_);_=_.sibling}_=Iu(y,v.mode,b),_.return=v,v=_}return i(v);case Ea:return T=y._init,m(v,_,T(y._payload),b)}if(jl(y))return p(v,_,y,b);if(pl(y))return x(v,_,y,b);uc(v,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,_!==null&&_.tag===6?(r(v,_.sibling),_=a(_,y),_.return=v,v=_):(r(v,_),_=Ru(y,v.mode,b),_.return=v,v=_),i(v)):r(v,_)}return m}var Vi=x1(!0),p1=x1(!1),r0=ns(null),n0=null,Ei=null,Kf=null;function qf(){Kf=Ei=n0=null}function Xf(e){var t=r0.current;ht(r0),e._currentValue=t}function Od(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ii(e,t){n0=e,Kf=Ei=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ir=!0),e.firstContext=null)}function _n(e){var t=e._currentValue;if(Kf!==e)if(e={context:e,memoizedValue:t,next:null},Ei===null){if(n0===null)throw Error(ge(308));Ei=e,n0.dependencies={lanes:0,firstContext:e}}else Ei=Ei.next=e;return t}var _s=null;function Yf(e){_s===null?_s=[e]:_s.push(e)}function g1(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,Yf(t)):(r.next=a.next,a.next=r),t.interleaved=r,xa(e,n)}function xa(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ta=!1;function Jf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function v1(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ca(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ha(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Xe&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,xa(e,r)}return a=n.interleaved,a===null?(t.next=t,Yf(n)):(t.next=a.next,a.next=t),n.interleaved=t,xa(e,r)}function Ic(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,If(e,r)}}function nx(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function a0(e,t,r,n){var a=e.updateQueue;Ta=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var c=o,u=c.next;c.next=null,i===null?s=u:i.next=u,i=c;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==i&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=a.baseState;i=0,d=u=c=null,o=s;do{var h=o.lane,g=o.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:g,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,x=o;switch(h=t,g=r,x.tag){case 1:if(p=x.payload,typeof p=="function"){f=p.call(g,f,h);break e}f=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=x.payload,h=typeof p=="function"?p.call(g,f,h):p,h==null)break e;f=Nt({},f,h);break e;case 2:Ta=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else g={eventTime:g,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=g,c=f):d=d.next=g,i|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(d===null&&(c=f),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);Fs|=i,e.lanes=i,e.memoizedState=f}}function ax(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(ge(191,a));a.call(n)}}}var Uo={},qn=ns(Uo),mo=ns(Uo),xo=ns(Uo);function ws(e){if(e===Uo)throw Error(ge(174));return e}function Qf(e,t){switch(ut(xo,t),ut(mo,e),ut(qn,Uo),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:md(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=md(t,e)}ht(qn),ut(qn,t)}function Gi(){ht(qn),ht(mo),ht(xo)}function y1(e){ws(xo.current);var t=ws(qn.current),r=md(t,e.type);t!==r&&(ut(mo,e),ut(qn,r))}function Zf(e){mo.current===e&&(ht(qn),ht(mo))}var bt=ns(0);function s0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Cu=[];function eh(){for(var e=0;e<Cu.length;e++)Cu[e]._workInProgressVersionPrimary=null;Cu.length=0}var Lc=ga.ReactCurrentDispatcher,Au=ga.ReactCurrentBatchConfig,As=0,St=null,Ht=null,Xt=null,i0=!1,Ul=!1,po=0,Zw=0;function cr(){throw Error(ge(321))}function th(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!In(e[r],t[r]))return!1;return!0}function rh(e,t,r,n,a,s){if(As=s,St=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Lc.current=e===null||e.memoizedState===null?nb:ab,e=r(n,a),Ul){s=0;do{if(Ul=!1,po=0,25<=s)throw Error(ge(301));s+=1,Xt=Ht=null,t.updateQueue=null,Lc.current=sb,e=r(n,a)}while(Ul)}if(Lc.current=l0,t=Ht!==null&&Ht.next!==null,As=0,Xt=Ht=St=null,i0=!1,t)throw Error(ge(300));return e}function nh(){var e=po!==0;return po=0,e}function Hn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xt===null?St.memoizedState=Xt=e:Xt=Xt.next=e,Xt}function wn(){if(Ht===null){var e=St.alternate;e=e!==null?e.memoizedState:null}else e=Ht.next;var t=Xt===null?St.memoizedState:Xt.next;if(t!==null)Xt=t,Ht=e;else{if(e===null)throw Error(ge(310));Ht=e,e={memoizedState:Ht.memoizedState,baseState:Ht.baseState,baseQueue:Ht.baseQueue,queue:Ht.queue,next:null},Xt===null?St.memoizedState=Xt=e:Xt=Xt.next=e}return Xt}function go(e,t){return typeof t=="function"?t(e):t}function Fu(e){var t=wn(),r=t.queue;if(r===null)throw Error(ge(311));r.lastRenderedReducer=e;var n=Ht,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,c=null,u=s;do{var d=u.lane;if((As&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=f,i=n):c=c.next=f,St.lanes|=d,Fs|=d}u=u.next}while(u!==null&&u!==s);c===null?i=n:c.next=o,In(n,t.memoizedState)||(Ir=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,St.lanes|=s,Fs|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Pu(e){var t=wn(),r=t.queue;if(r===null)throw Error(ge(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);In(s,t.memoizedState)||(Ir=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function _1(){}function w1(e,t){var r=St,n=wn(),a=t(),s=!In(n.memoizedState,a);if(s&&(n.memoizedState=a,Ir=!0),n=n.queue,ah(S1.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Xt!==null&&Xt.memoizedState.tag&1){if(r.flags|=2048,vo(9,k1.bind(null,r,n,a,t),void 0,null),Zt===null)throw Error(ge(349));As&30||b1(r,t,a)}return a}function b1(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=St.updateQueue,t===null?(t={lastEffect:null,stores:null},St.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function k1(e,t,r,n){t.value=r,t.getSnapshot=n,N1(t)&&E1(e)}function S1(e,t,r){return r(function(){N1(t)&&E1(e)})}function N1(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!In(e,r)}catch{return!0}}function E1(e){var t=xa(e,1);t!==null&&Dn(t,e,1,-1)}function sx(e){var t=Hn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:go,lastRenderedState:e},t.queue=e,e=e.dispatch=rb.bind(null,St,e),[t.memoizedState,e]}function vo(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=St.updateQueue,t===null?(t={lastEffect:null,stores:null},St.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function T1(){return wn().memoizedState}function Mc(e,t,r,n){var a=Hn();St.flags|=e,a.memoizedState=vo(1|t,r,void 0,n===void 0?null:n)}function M0(e,t,r,n){var a=wn();n=n===void 0?null:n;var s=void 0;if(Ht!==null){var i=Ht.memoizedState;if(s=i.destroy,n!==null&&th(n,i.deps)){a.memoizedState=vo(t,r,s,n);return}}St.flags|=e,a.memoizedState=vo(1|t,r,s,n)}function ix(e,t){return Mc(8390656,8,e,t)}function ah(e,t){return M0(2048,8,e,t)}function j1(e,t){return M0(4,2,e,t)}function C1(e,t){return M0(4,4,e,t)}function A1(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function F1(e,t,r){return r=r!=null?r.concat([e]):null,M0(4,4,A1.bind(null,t,e),r)}function sh(){}function P1(e,t){var r=wn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&th(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function D1(e,t){var r=wn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&th(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function O1(e,t,r){return As&21?(In(r,t)||(r=Bg(),St.lanes|=r,Fs|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ir=!0),e.memoizedState=r)}function eb(e,t){var r=rt;rt=r!==0&&4>r?r:4,e(!0);var n=Au.transition;Au.transition={};try{e(!1),t()}finally{rt=r,Au.transition=n}}function R1(){return wn().memoizedState}function tb(e,t,r){var n=Va(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},I1(e))L1(t,r);else if(r=g1(e,t,r,n),r!==null){var a=jr();Dn(r,e,n,a),M1(r,t,n)}}function rb(e,t,r){var n=Va(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(I1(e))L1(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,In(o,i)){var c=t.interleaved;c===null?(a.next=a,Yf(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=g1(e,t,a,n),r!==null&&(a=jr(),Dn(r,e,n,a),M1(r,t,n))}}function I1(e){var t=e.alternate;return e===St||t!==null&&t===St}function L1(e,t){Ul=i0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function M1(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,If(e,r)}}var l0={readContext:_n,useCallback:cr,useContext:cr,useEffect:cr,useImperativeHandle:cr,useInsertionEffect:cr,useLayoutEffect:cr,useMemo:cr,useReducer:cr,useRef:cr,useState:cr,useDebugValue:cr,useDeferredValue:cr,useTransition:cr,useMutableSource:cr,useSyncExternalStore:cr,useId:cr,unstable_isNewReconciler:!1},nb={readContext:_n,useCallback:function(e,t){return Hn().memoizedState=[e,t===void 0?null:t],e},useContext:_n,useEffect:ix,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Mc(4194308,4,A1.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Mc(4194308,4,e,t)},useInsertionEffect:function(e,t){return Mc(4,2,e,t)},useMemo:function(e,t){var r=Hn();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Hn();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=tb.bind(null,St,e),[n.memoizedState,e]},useRef:function(e){var t=Hn();return e={current:e},t.memoizedState=e},useState:sx,useDebugValue:sh,useDeferredValue:function(e){return Hn().memoizedState=e},useTransition:function(){var e=sx(!1),t=e[0];return e=eb.bind(null,e[1]),Hn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=St,a=Hn();if(yt){if(r===void 0)throw Error(ge(407));r=r()}else{if(r=t(),Zt===null)throw Error(ge(349));As&30||b1(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,ix(S1.bind(null,n,s,e),[e]),n.flags|=2048,vo(9,k1.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Hn(),t=Zt.identifierPrefix;if(yt){var r=la,n=ia;r=(n&~(1<<32-Pn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=po++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Zw++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ab={readContext:_n,useCallback:P1,useContext:_n,useEffect:ah,useImperativeHandle:F1,useInsertionEffect:j1,useLayoutEffect:C1,useMemo:D1,useReducer:Fu,useRef:T1,useState:function(){return Fu(go)},useDebugValue:sh,useDeferredValue:function(e){var t=wn();return O1(t,Ht.memoizedState,e)},useTransition:function(){var e=Fu(go)[0],t=wn().memoizedState;return[e,t]},useMutableSource:_1,useSyncExternalStore:w1,useId:R1,unstable_isNewReconciler:!1},sb={readContext:_n,useCallback:P1,useContext:_n,useEffect:ah,useImperativeHandle:F1,useInsertionEffect:j1,useLayoutEffect:C1,useMemo:D1,useReducer:Pu,useRef:T1,useState:function(){return Pu(go)},useDebugValue:sh,useDeferredValue:function(e){var t=wn();return Ht===null?t.memoizedState=e:O1(t,Ht.memoizedState,e)},useTransition:function(){var e=Pu(go)[0],t=wn().memoizedState;return[e,t]},useMutableSource:_1,useSyncExternalStore:w1,useId:R1,unstable_isNewReconciler:!1};function Tn(e,t){if(e&&e.defaultProps){t=Nt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Rd(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Nt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var B0={isMounted:function(e){return(e=e._reactInternals)?Vs(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=jr(),a=Va(e),s=ca(n,a);s.payload=t,r!=null&&(s.callback=r),t=Ha(e,s,a),t!==null&&(Dn(t,e,a,n),Ic(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=jr(),a=Va(e),s=ca(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Ha(e,s,a),t!==null&&(Dn(t,e,a,n),Ic(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=jr(),n=Va(e),a=ca(r,n);a.tag=2,t!=null&&(a.callback=t),t=Ha(e,a,n),t!==null&&(Dn(t,e,n,r),Ic(t,e,n))}};function lx(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!co(r,n)||!co(a,s):!0}function B1(e,t,r){var n=!1,a=Xa,s=t.contextType;return typeof s=="object"&&s!==null?s=_n(s):(a=Mr(t)?js:yr.current,n=t.contextTypes,s=(n=n!=null)?Hi(e,a):Xa),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=B0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function ox(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&B0.enqueueReplaceState(t,t.state,null)}function Id(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Jf(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=_n(s):(s=Mr(t)?js:yr.current,a.context=Hi(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(Rd(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&B0.enqueueReplaceState(a,a.state,null),a0(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function Ki(e,t){try{var r="",n=t;do r+=D2(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function Du(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Ld(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ib=typeof WeakMap=="function"?WeakMap:Map;function U1(e,t,r){r=ca(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){c0||(c0=!0,Kd=n),Ld(e,t)},r}function z1(e,t,r){r=ca(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){Ld(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){Ld(e,t),typeof n!="function"&&(Wa===null?Wa=new Set([this]):Wa.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function cx(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new ib;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=_b.bind(null,e,t,r),t.then(e,e))}function ux(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function dx(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ca(-1,1),t.tag=2,Ha(r,t,1))),r.lanes|=1),e)}var lb=ga.ReactCurrentOwner,Ir=!1;function Nr(e,t,r,n){t.child=e===null?p1(t,null,r,n):Vi(t,e.child,r,n)}function fx(e,t,r,n,a){r=r.render;var s=t.ref;return Ii(t,a),n=rh(e,t,r,n,s,a),r=nh(),e!==null&&!Ir?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,pa(e,t,a)):(yt&&r&&Wf(t),t.flags|=1,Nr(e,t,n,a),t.child)}function hx(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!hh(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,$1(e,t,s,n,a)):(e=$c(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:co,r(i,n)&&e.ref===t.ref)return pa(e,t,a)}return t.flags|=1,e=Ga(s,n),e.ref=t.ref,e.return=t,t.child=e}function $1(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(co(s,n)&&e.ref===t.ref)if(Ir=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Ir=!0);else return t.lanes=e.lanes,pa(e,t,a)}return Md(e,t,r,n,a)}function H1(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ut(ji,$r),$r|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ut(ji,$r),$r|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,ut(ji,$r),$r|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,ut(ji,$r),$r|=n;return Nr(e,t,a,r),t.child}function W1(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Md(e,t,r,n,a){var s=Mr(r)?js:yr.current;return s=Hi(t,s),Ii(t,a),r=rh(e,t,r,n,s,a),n=nh(),e!==null&&!Ir?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,pa(e,t,a)):(yt&&n&&Wf(t),t.flags|=1,Nr(e,t,r,a),t.child)}function mx(e,t,r,n,a){if(Mr(r)){var s=!0;Zc(t)}else s=!1;if(Ii(t,a),t.stateNode===null)Bc(e,t),B1(t,r,n),Id(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var c=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=_n(u):(u=Mr(r)?js:yr.current,u=Hi(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||c!==u)&&ox(t,i,n,u),Ta=!1;var h=t.memoizedState;i.state=h,a0(t,n,i,a),c=t.memoizedState,o!==n||h!==c||Lr.current||Ta?(typeof d=="function"&&(Rd(t,r,d,n),c=t.memoizedState),(o=Ta||lx(t,r,o,n,h,c,u))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),i.props=n,i.state=c,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,v1(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:Tn(t.type,o),i.props=u,f=t.pendingProps,h=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=_n(c):(c=Mr(r)?js:yr.current,c=Hi(t,c));var g=r.getDerivedStateFromProps;(d=typeof g=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==f||h!==c)&&ox(t,i,n,c),Ta=!1,h=t.memoizedState,i.state=h,a0(t,n,i,a);var p=t.memoizedState;o!==f||h!==p||Lr.current||Ta?(typeof g=="function"&&(Rd(t,r,g,n),p=t.memoizedState),(u=Ta||lx(t,r,u,n,h,p,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,p,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,p,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),i.props=n,i.state=p,i.context=c,n=u):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Bd(e,t,r,n,s,a)}function Bd(e,t,r,n,a,s){W1(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&Zm(t,r,!1),pa(e,t,s);n=t.stateNode,lb.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Vi(t,e.child,null,s),t.child=Vi(t,null,o,s)):Nr(e,t,o,s),t.memoizedState=n.state,a&&Zm(t,r,!0),t.child}function V1(e){var t=e.stateNode;t.pendingContext?Qm(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Qm(e,t.context,!1),Qf(e,t.containerInfo)}function xx(e,t,r,n,a){return Wi(),Gf(a),t.flags|=256,Nr(e,t,r,n),t.child}var Ud={dehydrated:null,treeContext:null,retryLane:0};function zd(e){return{baseLanes:e,cachePool:null,transitions:null}}function G1(e,t,r){var n=t.pendingProps,a=bt.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),ut(bt,a&1),e===null)return Dd(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=$0(i,n,0,null),e=ks(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=zd(r),t.memoizedState=Ud,e):ih(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return ob(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Ga(a,c),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=Ga(o,s):(s=ks(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?zd(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=Ud,n}return s=e.child,e=s.sibling,n=Ga(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function ih(e,t){return t=$0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function dc(e,t,r,n){return n!==null&&Gf(n),Vi(t,e.child,null,r),e=ih(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function ob(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=Du(Error(ge(422))),dc(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=$0({mode:"visible",children:n.children},a,0,null),s=ks(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Vi(t,e.child,null,i),t.child.memoizedState=zd(i),t.memoizedState=Ud,s);if(!(t.mode&1))return dc(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(ge(419)),n=Du(s,n,void 0),dc(e,t,i,n)}if(o=(i&e.childLanes)!==0,Ir||o){if(n=Zt,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,xa(e,a),Dn(n,e,a,-1))}return fh(),n=Du(Error(ge(421))),dc(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=wb.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,Gr=$a(a.nextSibling),Xr=t,yt=!0,An=null,e!==null&&(fn[hn++]=ia,fn[hn++]=la,fn[hn++]=Cs,ia=e.id,la=e.overflow,Cs=t),t=ih(t,n.children),t.flags|=4096,t)}function px(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Od(e.return,t,r)}function Ou(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function K1(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(Nr(e,t,n.children,r),n=bt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&px(e,r,t);else if(e.tag===19)px(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ut(bt,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&s0(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Ou(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&s0(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Ou(t,!0,r,null,s);break;case"together":Ou(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Bc(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function pa(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Fs|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ge(153));if(t.child!==null){for(e=t.child,r=Ga(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ga(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function cb(e,t,r){switch(t.tag){case 3:V1(t),Wi();break;case 5:y1(t);break;case 1:Mr(t.type)&&Zc(t);break;case 4:Qf(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;ut(r0,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ut(bt,bt.current&1),t.flags|=128,null):r&t.child.childLanes?G1(e,t,r):(ut(bt,bt.current&1),e=pa(e,t,r),e!==null?e.sibling:null);ut(bt,bt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return K1(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),ut(bt,bt.current),n)break;return null;case 22:case 23:return t.lanes=0,H1(e,t,r)}return pa(e,t,r)}var q1,$d,X1,Y1;q1=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};$d=function(){};X1=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,ws(qn.current);var s=null;switch(r){case"input":a=ud(e,a),n=ud(e,n),s=[];break;case"select":a=Nt({},a,{value:void 0}),n=Nt({},n,{value:void 0}),s=[];break;case"textarea":a=hd(e,a),n=hd(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Jc)}xd(r,n);var i;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var o=a[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(ro.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(o=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(ro.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&dt("scroll",e),s||o===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};Y1=function(e,t,r,n){r!==n&&(t.flags|=4)};function bl(e,t){if(!yt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ur(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function ub(e,t,r){var n=t.pendingProps;switch(Vf(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ur(t),null;case 1:return Mr(t.type)&&Qc(),ur(t),null;case 3:return n=t.stateNode,Gi(),ht(Lr),ht(yr),eh(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(cc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,An!==null&&(Yd(An),An=null))),$d(e,t),ur(t),null;case 5:Zf(t);var a=ws(xo.current);if(r=t.type,e!==null&&t.stateNode!=null)X1(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ge(166));return ur(t),null}if(e=ws(qn.current),cc(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Vn]=t,n[ho]=s,e=(t.mode&1)!==0,r){case"dialog":dt("cancel",n),dt("close",n);break;case"iframe":case"object":case"embed":dt("load",n);break;case"video":case"audio":for(a=0;a<Al.length;a++)dt(Al[a],n);break;case"source":dt("error",n);break;case"img":case"image":case"link":dt("error",n),dt("load",n);break;case"details":dt("toggle",n);break;case"input":Nm(n,s),dt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},dt("invalid",n);break;case"textarea":Tm(n,s),dt("invalid",n)}xd(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&oc(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&oc(n.textContent,o,e),a=["children",""+o]):ro.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&dt("scroll",n)}switch(r){case"input":ec(n),Em(n,s,!0);break;case"textarea":ec(n),jm(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=Jc)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Sg(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[Vn]=t,e[ho]=n,q1(e,t,!1,!1),t.stateNode=e;e:{switch(i=pd(r,n),r){case"dialog":dt("cancel",e),dt("close",e),a=n;break;case"iframe":case"object":case"embed":dt("load",e),a=n;break;case"video":case"audio":for(a=0;a<Al.length;a++)dt(Al[a],e);a=n;break;case"source":dt("error",e),a=n;break;case"img":case"image":case"link":dt("error",e),dt("load",e),a=n;break;case"details":dt("toggle",e),a=n;break;case"input":Nm(e,n),a=ud(e,n),dt("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Nt({},n,{value:void 0}),dt("invalid",e);break;case"textarea":Tm(e,n),a=hd(e,n),dt("invalid",e);break;default:a=n}xd(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var c=o[s];s==="style"?Tg(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Ng(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&no(e,c):typeof c=="number"&&no(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ro.hasOwnProperty(s)?c!=null&&s==="onScroll"&&dt("scroll",e):c!=null&&Af(e,s,c,i))}switch(r){case"input":ec(e),Em(e,n,!1);break;case"textarea":ec(e),jm(e);break;case"option":n.value!=null&&e.setAttribute("value",""+qa(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Pi(e,!!n.multiple,s,!1):n.defaultValue!=null&&Pi(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Jc)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ur(t),null;case 6:if(e&&t.stateNode!=null)Y1(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ge(166));if(r=ws(xo.current),ws(qn.current),cc(t)){if(n=t.stateNode,r=t.memoizedProps,n[Vn]=t,(s=n.nodeValue!==r)&&(e=Xr,e!==null))switch(e.tag){case 3:oc(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&oc(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Vn]=t,t.stateNode=n}return ur(t),null;case 13:if(ht(bt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(yt&&Gr!==null&&t.mode&1&&!(t.flags&128))m1(),Wi(),t.flags|=98560,s=!1;else if(s=cc(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(ge(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ge(317));s[Vn]=t}else Wi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ur(t),s=!1}else An!==null&&(Yd(An),An=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||bt.current&1?Vt===0&&(Vt=3):fh())),t.updateQueue!==null&&(t.flags|=4),ur(t),null);case 4:return Gi(),$d(e,t),e===null&&uo(t.stateNode.containerInfo),ur(t),null;case 10:return Xf(t.type._context),ur(t),null;case 17:return Mr(t.type)&&Qc(),ur(t),null;case 19:if(ht(bt),s=t.memoizedState,s===null)return ur(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)bl(s,!1);else{if(Vt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=s0(e),i!==null){for(t.flags|=128,bl(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ut(bt,bt.current&1|2),t.child}e=e.sibling}s.tail!==null&&Ot()>qi&&(t.flags|=128,n=!0,bl(s,!1),t.lanes=4194304)}else{if(!n)if(e=s0(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),bl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!yt)return ur(t),null}else 2*Ot()-s.renderingStartTime>qi&&r!==1073741824&&(t.flags|=128,n=!0,bl(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ot(),t.sibling=null,r=bt.current,ut(bt,n?r&1|2:r&1),t):(ur(t),null);case 22:case 23:return dh(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?$r&1073741824&&(ur(t),t.subtreeFlags&6&&(t.flags|=8192)):ur(t),null;case 24:return null;case 25:return null}throw Error(ge(156,t.tag))}function db(e,t){switch(Vf(t),t.tag){case 1:return Mr(t.type)&&Qc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Gi(),ht(Lr),ht(yr),eh(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Zf(t),null;case 13:if(ht(bt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ge(340));Wi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ht(bt),null;case 4:return Gi(),null;case 10:return Xf(t.type._context),null;case 22:case 23:return dh(),null;case 24:return null;default:return null}}var fc=!1,mr=!1,fb=typeof WeakSet=="function"?WeakSet:Set,Ee=null;function Ti(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Et(e,t,n)}else r.current=null}function Hd(e,t,r){try{r()}catch(n){Et(e,t,n)}}var gx=!1;function hb(e,t){if(Ed=qc,e=t1(),Hf(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var g;f!==r||a!==0&&f.nodeType!==3||(o=i+a),f!==s||n!==0&&f.nodeType!==3||(c=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(g=f.firstChild)!==null;)h=f,f=g;for(;;){if(f===e)break t;if(h===r&&++u===a&&(o=i),h===s&&++d===n&&(c=i),(g=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=g}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Td={focusedElem:e,selectionRange:r},qc=!1,Ee=t;Ee!==null;)if(t=Ee,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ee=e;else for(;Ee!==null;){t=Ee;try{var p=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var x=p.memoizedProps,m=p.memoizedState,v=t.stateNode,_=v.getSnapshotBeforeUpdate(t.elementType===t.type?x:Tn(t.type,x),m);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ge(163))}}catch(b){Et(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,Ee=e;break}Ee=t.return}return p=gx,gx=!1,p}function zl(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&Hd(t,r,s)}a=a.next}while(a!==n)}}function U0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Wd(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function J1(e){var t=e.alternate;t!==null&&(e.alternate=null,J1(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Vn],delete t[ho],delete t[Ad],delete t[Xw],delete t[Yw])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Q1(e){return e.tag===5||e.tag===3||e.tag===4}function vx(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Q1(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Vd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Jc));else if(n!==4&&(e=e.child,e!==null))for(Vd(e,t,r),e=e.sibling;e!==null;)Vd(e,t,r),e=e.sibling}function Gd(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Gd(e,t,r),e=e.sibling;e!==null;)Gd(e,t,r),e=e.sibling}var tr=null,jn=!1;function ba(e,t,r){for(r=r.child;r!==null;)Z1(e,t,r),r=r.sibling}function Z1(e,t,r){if(Kn&&typeof Kn.onCommitFiberUnmount=="function")try{Kn.onCommitFiberUnmount(P0,r)}catch{}switch(r.tag){case 5:mr||Ti(r,t);case 6:var n=tr,a=jn;tr=null,ba(e,t,r),tr=n,jn=a,tr!==null&&(jn?(e=tr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):tr.removeChild(r.stateNode));break;case 18:tr!==null&&(jn?(e=tr,r=r.stateNode,e.nodeType===8?Tu(e.parentNode,r):e.nodeType===1&&Tu(e,r),lo(e)):Tu(tr,r.stateNode));break;case 4:n=tr,a=jn,tr=r.stateNode.containerInfo,jn=!0,ba(e,t,r),tr=n,jn=a;break;case 0:case 11:case 14:case 15:if(!mr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&Hd(r,t,i),a=a.next}while(a!==n)}ba(e,t,r);break;case 1:if(!mr&&(Ti(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Et(r,t,o)}ba(e,t,r);break;case 21:ba(e,t,r);break;case 22:r.mode&1?(mr=(n=mr)||r.memoizedState!==null,ba(e,t,r),mr=n):ba(e,t,r);break;default:ba(e,t,r)}}function yx(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new fb),t.forEach(function(n){var a=bb.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Sn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:tr=o.stateNode,jn=!1;break e;case 3:tr=o.stateNode.containerInfo,jn=!0;break e;case 4:tr=o.stateNode.containerInfo,jn=!0;break e}o=o.return}if(tr===null)throw Error(ge(160));Z1(s,i,a),tr=null,jn=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){Et(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ev(t,e),t=t.sibling}function ev(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Sn(t,e),Bn(e),n&4){try{zl(3,e,e.return),U0(3,e)}catch(x){Et(e,e.return,x)}try{zl(5,e,e.return)}catch(x){Et(e,e.return,x)}}break;case 1:Sn(t,e),Bn(e),n&512&&r!==null&&Ti(r,r.return);break;case 5:if(Sn(t,e),Bn(e),n&512&&r!==null&&Ti(r,r.return),e.flags&32){var a=e.stateNode;try{no(a,"")}catch(x){Et(e,e.return,x)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&bg(a,s),pd(o,i);var u=pd(o,s);for(i=0;i<c.length;i+=2){var d=c[i],f=c[i+1];d==="style"?Tg(a,f):d==="dangerouslySetInnerHTML"?Ng(a,f):d==="children"?no(a,f):Af(a,d,f,u)}switch(o){case"input":dd(a,s);break;case"textarea":kg(a,s);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var g=s.value;g!=null?Pi(a,!!s.multiple,g,!1):h!==!!s.multiple&&(s.defaultValue!=null?Pi(a,!!s.multiple,s.defaultValue,!0):Pi(a,!!s.multiple,s.multiple?[]:"",!1))}a[ho]=s}catch(x){Et(e,e.return,x)}}break;case 6:if(Sn(t,e),Bn(e),n&4){if(e.stateNode===null)throw Error(ge(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(x){Et(e,e.return,x)}}break;case 3:if(Sn(t,e),Bn(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{lo(t.containerInfo)}catch(x){Et(e,e.return,x)}break;case 4:Sn(t,e),Bn(e);break;case 13:Sn(t,e),Bn(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(ch=Ot())),n&4&&yx(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(mr=(u=mr)||d,Sn(t,e),mr=u):Sn(t,e),Bn(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Ee=e,d=e.child;d!==null;){for(f=Ee=d;Ee!==null;){switch(h=Ee,g=h.child,h.tag){case 0:case 11:case 14:case 15:zl(4,h,h.return);break;case 1:Ti(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(x){Et(n,r,x)}}break;case 5:Ti(h,h.return);break;case 22:if(h.memoizedState!==null){wx(f);continue}}g!==null?(g.return=h,Ee=g):wx(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=Eg("display",i))}catch(x){Et(e,e.return,x)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(x){Et(e,e.return,x)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Sn(t,e),Bn(e),n&4&&yx(e);break;case 21:break;default:Sn(t,e),Bn(e)}}function Bn(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Q1(r)){var n=r;break e}r=r.return}throw Error(ge(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(no(a,""),n.flags&=-33);var s=vx(e);Gd(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=vx(e);Vd(e,o,i);break;default:throw Error(ge(161))}}catch(c){Et(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function mb(e,t,r){Ee=e,tv(e)}function tv(e,t,r){for(var n=(e.mode&1)!==0;Ee!==null;){var a=Ee,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||fc;if(!i){var o=a.alternate,c=o!==null&&o.memoizedState!==null||mr;o=fc;var u=mr;if(fc=i,(mr=c)&&!u)for(Ee=a;Ee!==null;)i=Ee,c=i.child,i.tag===22&&i.memoizedState!==null?bx(a):c!==null?(c.return=i,Ee=c):bx(a);for(;s!==null;)Ee=s,tv(s),s=s.sibling;Ee=a,fc=o,mr=u}_x(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,Ee=s):_x(e)}}function _x(e){for(;Ee!==null;){var t=Ee;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:mr||U0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!mr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Tn(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&ax(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}ax(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&lo(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ge(163))}mr||t.flags&512&&Wd(t)}catch(h){Et(t,t.return,h)}}if(t===e){Ee=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ee=r;break}Ee=t.return}}function wx(e){for(;Ee!==null;){var t=Ee;if(t===e){Ee=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ee=r;break}Ee=t.return}}function bx(e){for(;Ee!==null;){var t=Ee;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{U0(4,t)}catch(c){Et(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){Et(t,a,c)}}var s=t.return;try{Wd(t)}catch(c){Et(t,s,c)}break;case 5:var i=t.return;try{Wd(t)}catch(c){Et(t,i,c)}}}catch(c){Et(t,t.return,c)}if(t===e){Ee=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ee=o;break}Ee=t.return}}var xb=Math.ceil,o0=ga.ReactCurrentDispatcher,lh=ga.ReactCurrentOwner,pn=ga.ReactCurrentBatchConfig,Xe=0,Zt=null,Ut=null,ar=0,$r=0,ji=ns(0),Vt=0,yo=null,Fs=0,z0=0,oh=0,$l=null,Or=null,ch=0,qi=1/0,na=null,c0=!1,Kd=null,Wa=null,hc=!1,Oa=null,u0=0,Hl=0,qd=null,Uc=-1,zc=0;function jr(){return Xe&6?Ot():Uc!==-1?Uc:Uc=Ot()}function Va(e){return e.mode&1?Xe&2&&ar!==0?ar&-ar:Qw.transition!==null?(zc===0&&(zc=Bg()),zc):(e=rt,e!==0||(e=window.event,e=e===void 0?16:Gg(e.type)),e):1}function Dn(e,t,r,n){if(50<Hl)throw Hl=0,qd=null,Error(ge(185));Lo(e,r,n),(!(Xe&2)||e!==Zt)&&(e===Zt&&(!(Xe&2)&&(z0|=r),Vt===4&&Aa(e,ar)),Br(e,n),r===1&&Xe===0&&!(t.mode&1)&&(qi=Ot()+500,L0&&as()))}function Br(e,t){var r=e.callbackNode;Q2(e,t);var n=Kc(e,e===Zt?ar:0);if(n===0)r!==null&&Fm(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Fm(r),t===1)e.tag===0?Jw(kx.bind(null,e)):d1(kx.bind(null,e)),Kw(function(){!(Xe&6)&&as()}),r=null;else{switch(Ug(n)){case 1:r=Rf;break;case 4:r=Lg;break;case 16:r=Gc;break;case 536870912:r=Mg;break;default:r=Gc}r=cv(r,rv.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function rv(e,t){if(Uc=-1,zc=0,Xe&6)throw Error(ge(327));var r=e.callbackNode;if(Li()&&e.callbackNode!==r)return null;var n=Kc(e,e===Zt?ar:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=d0(e,n);else{t=n;var a=Xe;Xe|=2;var s=av();(Zt!==e||ar!==t)&&(na=null,qi=Ot()+500,bs(e,t));do try{vb();break}catch(o){nv(e,o)}while(!0);qf(),o0.current=s,Xe=a,Ut!==null?t=0:(Zt=null,ar=0,t=Vt)}if(t!==0){if(t===2&&(a=wd(e),a!==0&&(n=a,t=Xd(e,a))),t===1)throw r=yo,bs(e,0),Aa(e,n),Br(e,Ot()),r;if(t===6)Aa(e,n);else{if(a=e.current.alternate,!(n&30)&&!pb(a)&&(t=d0(e,n),t===2&&(s=wd(e),s!==0&&(n=s,t=Xd(e,s))),t===1))throw r=yo,bs(e,0),Aa(e,n),Br(e,Ot()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(ge(345));case 2:xs(e,Or,na);break;case 3:if(Aa(e,n),(n&130023424)===n&&(t=ch+500-Ot(),10<t)){if(Kc(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){jr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Cd(xs.bind(null,e,Or,na),t);break}xs(e,Or,na);break;case 4:if(Aa(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-Pn(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=Ot()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*xb(n/1960))-n,10<n){e.timeoutHandle=Cd(xs.bind(null,e,Or,na),n);break}xs(e,Or,na);break;case 5:xs(e,Or,na);break;default:throw Error(ge(329))}}}return Br(e,Ot()),e.callbackNode===r?rv.bind(null,e):null}function Xd(e,t){var r=$l;return e.current.memoizedState.isDehydrated&&(bs(e,t).flags|=256),e=d0(e,t),e!==2&&(t=Or,Or=r,t!==null&&Yd(t)),e}function Yd(e){Or===null?Or=e:Or.push.apply(Or,e)}function pb(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!In(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Aa(e,t){for(t&=~oh,t&=~z0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Pn(t),n=1<<r;e[r]=-1,t&=~n}}function kx(e){if(Xe&6)throw Error(ge(327));Li();var t=Kc(e,0);if(!(t&1))return Br(e,Ot()),null;var r=d0(e,t);if(e.tag!==0&&r===2){var n=wd(e);n!==0&&(t=n,r=Xd(e,n))}if(r===1)throw r=yo,bs(e,0),Aa(e,t),Br(e,Ot()),r;if(r===6)throw Error(ge(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xs(e,Or,na),Br(e,Ot()),null}function uh(e,t){var r=Xe;Xe|=1;try{return e(t)}finally{Xe=r,Xe===0&&(qi=Ot()+500,L0&&as())}}function Ps(e){Oa!==null&&Oa.tag===0&&!(Xe&6)&&Li();var t=Xe;Xe|=1;var r=pn.transition,n=rt;try{if(pn.transition=null,rt=1,e)return e()}finally{rt=n,pn.transition=r,Xe=t,!(Xe&6)&&as()}}function dh(){$r=ji.current,ht(ji)}function bs(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Gw(r)),Ut!==null)for(r=Ut.return;r!==null;){var n=r;switch(Vf(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Qc();break;case 3:Gi(),ht(Lr),ht(yr),eh();break;case 5:Zf(n);break;case 4:Gi();break;case 13:ht(bt);break;case 19:ht(bt);break;case 10:Xf(n.type._context);break;case 22:case 23:dh()}r=r.return}if(Zt=e,Ut=e=Ga(e.current,null),ar=$r=t,Vt=0,yo=null,oh=z0=Fs=0,Or=$l=null,_s!==null){for(t=0;t<_s.length;t++)if(r=_s[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}_s=null}return e}function nv(e,t){do{var r=Ut;try{if(qf(),Lc.current=l0,i0){for(var n=St.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}i0=!1}if(As=0,Xt=Ht=St=null,Ul=!1,po=0,lh.current=null,r===null||r.return===null){Vt=1,yo=t,Ut=null;break}e:{var s=e,i=r.return,o=r,c=t;if(t=ar,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=ux(i);if(g!==null){g.flags&=-257,dx(g,i,o,s,t),g.mode&1&&cx(s,u,t),t=g,c=u;var p=t.updateQueue;if(p===null){var x=new Set;x.add(c),t.updateQueue=x}else p.add(c);break e}else{if(!(t&1)){cx(s,u,t),fh();break e}c=Error(ge(426))}}else if(yt&&o.mode&1){var m=ux(i);if(m!==null){!(m.flags&65536)&&(m.flags|=256),dx(m,i,o,s,t),Gf(Ki(c,o));break e}}s=c=Ki(c,o),Vt!==4&&(Vt=2),$l===null?$l=[s]:$l.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var v=U1(s,c,t);nx(s,v);break e;case 1:o=c;var _=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Wa===null||!Wa.has(y)))){s.flags|=65536,t&=-t,s.lanes|=t;var b=z1(s,o,t);nx(s,b);break e}}s=s.return}while(s!==null)}iv(r)}catch(E){t=E,Ut===r&&r!==null&&(Ut=r=r.return);continue}break}while(!0)}function av(){var e=o0.current;return o0.current=l0,e===null?l0:e}function fh(){(Vt===0||Vt===3||Vt===2)&&(Vt=4),Zt===null||!(Fs&268435455)&&!(z0&268435455)||Aa(Zt,ar)}function d0(e,t){var r=Xe;Xe|=2;var n=av();(Zt!==e||ar!==t)&&(na=null,bs(e,t));do try{gb();break}catch(a){nv(e,a)}while(!0);if(qf(),Xe=r,o0.current=n,Ut!==null)throw Error(ge(261));return Zt=null,ar=0,Vt}function gb(){for(;Ut!==null;)sv(Ut)}function vb(){for(;Ut!==null&&!H2();)sv(Ut)}function sv(e){var t=ov(e.alternate,e,$r);e.memoizedProps=e.pendingProps,t===null?iv(e):Ut=t,lh.current=null}function iv(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=db(r,t),r!==null){r.flags&=32767,Ut=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Vt=6,Ut=null;return}}else if(r=ub(r,t,$r),r!==null){Ut=r;return}if(t=t.sibling,t!==null){Ut=t;return}Ut=t=e}while(t!==null);Vt===0&&(Vt=5)}function xs(e,t,r){var n=rt,a=pn.transition;try{pn.transition=null,rt=1,yb(e,t,r,n)}finally{pn.transition=a,rt=n}return null}function yb(e,t,r,n){do Li();while(Oa!==null);if(Xe&6)throw Error(ge(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ge(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(Z2(e,s),e===Zt&&(Ut=Zt=null,ar=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||hc||(hc=!0,cv(Gc,function(){return Li(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=pn.transition,pn.transition=null;var i=rt;rt=1;var o=Xe;Xe|=4,lh.current=null,hb(e,r),ev(r,e),Bw(Td),qc=!!Ed,Td=Ed=null,e.current=r,mb(r),W2(),Xe=o,rt=i,pn.transition=s}else e.current=r;if(hc&&(hc=!1,Oa=e,u0=a),s=e.pendingLanes,s===0&&(Wa=null),K2(r.stateNode),Br(e,Ot()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(c0)throw c0=!1,e=Kd,Kd=null,e;return u0&1&&e.tag!==0&&Li(),s=e.pendingLanes,s&1?e===qd?Hl++:(Hl=0,qd=e):Hl=0,as(),null}function Li(){if(Oa!==null){var e=Ug(u0),t=pn.transition,r=rt;try{if(pn.transition=null,rt=16>e?16:e,Oa===null)var n=!1;else{if(e=Oa,Oa=null,u0=0,Xe&6)throw Error(ge(331));var a=Xe;for(Xe|=4,Ee=e.current;Ee!==null;){var s=Ee,i=s.child;if(Ee.flags&16){var o=s.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(Ee=u;Ee!==null;){var d=Ee;switch(d.tag){case 0:case 11:case 15:zl(8,d,s)}var f=d.child;if(f!==null)f.return=d,Ee=f;else for(;Ee!==null;){d=Ee;var h=d.sibling,g=d.return;if(J1(d),d===u){Ee=null;break}if(h!==null){h.return=g,Ee=h;break}Ee=g}}}var p=s.alternate;if(p!==null){var x=p.child;if(x!==null){p.child=null;do{var m=x.sibling;x.sibling=null,x=m}while(x!==null)}}Ee=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,Ee=i;else e:for(;Ee!==null;){if(s=Ee,s.flags&2048)switch(s.tag){case 0:case 11:case 15:zl(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Ee=v;break e}Ee=s.return}}var _=e.current;for(Ee=_;Ee!==null;){i=Ee;var y=i.child;if(i.subtreeFlags&2064&&y!==null)y.return=i,Ee=y;else e:for(i=_;Ee!==null;){if(o=Ee,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:U0(9,o)}}catch(E){Et(o,o.return,E)}if(o===i){Ee=null;break e}var b=o.sibling;if(b!==null){b.return=o.return,Ee=b;break e}Ee=o.return}}if(Xe=a,as(),Kn&&typeof Kn.onPostCommitFiberRoot=="function")try{Kn.onPostCommitFiberRoot(P0,e)}catch{}n=!0}return n}finally{rt=r,pn.transition=t}}return!1}function Sx(e,t,r){t=Ki(r,t),t=U1(e,t,1),e=Ha(e,t,1),t=jr(),e!==null&&(Lo(e,1,t),Br(e,t))}function Et(e,t,r){if(e.tag===3)Sx(e,e,r);else for(;t!==null;){if(t.tag===3){Sx(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Wa===null||!Wa.has(n))){e=Ki(r,e),e=z1(t,e,1),t=Ha(t,e,1),e=jr(),t!==null&&(Lo(t,1,e),Br(t,e));break}}t=t.return}}function _b(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=jr(),e.pingedLanes|=e.suspendedLanes&r,Zt===e&&(ar&r)===r&&(Vt===4||Vt===3&&(ar&130023424)===ar&&500>Ot()-ch?bs(e,0):oh|=r),Br(e,t)}function lv(e,t){t===0&&(e.mode&1?(t=nc,nc<<=1,!(nc&130023424)&&(nc=4194304)):t=1);var r=jr();e=xa(e,t),e!==null&&(Lo(e,t,r),Br(e,r))}function wb(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),lv(e,r)}function bb(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ge(314))}n!==null&&n.delete(t),lv(e,r)}var ov;ov=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Lr.current)Ir=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Ir=!1,cb(e,t,r);Ir=!!(e.flags&131072)}else Ir=!1,yt&&t.flags&1048576&&f1(t,t0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Bc(e,t),e=t.pendingProps;var a=Hi(t,yr.current);Ii(t,r),a=rh(null,t,n,e,a,r);var s=nh();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Mr(n)?(s=!0,Zc(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Jf(t),a.updater=B0,t.stateNode=a,a._reactInternals=t,Id(t,n,e,r),t=Bd(null,t,n,!0,s,r)):(t.tag=0,yt&&s&&Wf(t),Nr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Bc(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=Sb(n),e=Tn(n,e),a){case 0:t=Md(null,t,n,e,r);break e;case 1:t=mx(null,t,n,e,r);break e;case 11:t=fx(null,t,n,e,r);break e;case 14:t=hx(null,t,n,Tn(n.type,e),r);break e}throw Error(ge(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Tn(n,a),Md(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Tn(n,a),mx(e,t,n,a,r);case 3:e:{if(V1(t),e===null)throw Error(ge(387));n=t.pendingProps,s=t.memoizedState,a=s.element,v1(e,t),a0(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=Ki(Error(ge(423)),t),t=xx(e,t,n,r,a);break e}else if(n!==a){a=Ki(Error(ge(424)),t),t=xx(e,t,n,r,a);break e}else for(Gr=$a(t.stateNode.containerInfo.firstChild),Xr=t,yt=!0,An=null,r=p1(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Wi(),n===a){t=pa(e,t,r);break e}Nr(e,t,n,r)}t=t.child}return t;case 5:return y1(t),e===null&&Dd(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,jd(n,a)?i=null:s!==null&&jd(n,s)&&(t.flags|=32),W1(e,t),Nr(e,t,i,r),t.child;case 6:return e===null&&Dd(t),null;case 13:return G1(e,t,r);case 4:return Qf(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Vi(t,null,n,r):Nr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Tn(n,a),fx(e,t,n,a,r);case 7:return Nr(e,t,t.pendingProps,r),t.child;case 8:return Nr(e,t,t.pendingProps.children,r),t.child;case 12:return Nr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,ut(r0,n._currentValue),n._currentValue=i,s!==null)if(In(s.value,i)){if(s.children===a.children&&!Lr.current){t=pa(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=ca(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),Od(s.return,r,t),o.lanes|=r;break}c=c.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(ge(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Od(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Nr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Ii(t,r),a=_n(a),n=n(a),t.flags|=1,Nr(e,t,n,r),t.child;case 14:return n=t.type,a=Tn(n,t.pendingProps),a=Tn(n.type,a),hx(e,t,n,a,r);case 15:return $1(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Tn(n,a),Bc(e,t),t.tag=1,Mr(n)?(e=!0,Zc(t)):e=!1,Ii(t,r),B1(t,n,a),Id(t,n,a,r),Bd(null,t,n,!0,e,r);case 19:return K1(e,t,r);case 22:return H1(e,t,r)}throw Error(ge(156,t.tag))};function cv(e,t){return Ig(e,t)}function kb(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mn(e,t,r,n){return new kb(e,t,r,n)}function hh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Sb(e){if(typeof e=="function")return hh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Pf)return 11;if(e===Df)return 14}return 2}function Ga(e,t){var r=e.alternate;return r===null?(r=mn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function $c(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")hh(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case vi:return ks(r.children,a,s,t);case Ff:i=8,a|=8;break;case id:return e=mn(12,r,t,a|2),e.elementType=id,e.lanes=s,e;case ld:return e=mn(13,r,t,a),e.elementType=ld,e.lanes=s,e;case od:return e=mn(19,r,t,a),e.elementType=od,e.lanes=s,e;case yg:return $0(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case gg:i=10;break e;case vg:i=9;break e;case Pf:i=11;break e;case Df:i=14;break e;case Ea:i=16,n=null;break e}throw Error(ge(130,e==null?e:typeof e,""))}return t=mn(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function ks(e,t,r,n){return e=mn(7,e,n,t),e.lanes=r,e}function $0(e,t,r,n){return e=mn(22,e,n,t),e.elementType=yg,e.lanes=r,e.stateNode={isHidden:!1},e}function Ru(e,t,r){return e=mn(6,e,null,t),e.lanes=r,e}function Iu(e,t,r){return t=mn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Nb(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pu(0),this.expirationTimes=pu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pu(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function mh(e,t,r,n,a,s,i,o,c){return e=new Nb(e,t,r,o,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=mn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jf(s),e}function Eb(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gi,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function uv(e){if(!e)return Xa;e=e._reactInternals;e:{if(Vs(e)!==e||e.tag!==1)throw Error(ge(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Mr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ge(171))}if(e.tag===1){var r=e.type;if(Mr(r))return u1(e,r,t)}return t}function dv(e,t,r,n,a,s,i,o,c){return e=mh(r,n,!0,e,a,s,i,o,c),e.context=uv(null),r=e.current,n=jr(),a=Va(r),s=ca(n,a),s.callback=t??null,Ha(r,s,a),e.current.lanes=a,Lo(e,a,n),Br(e,n),e}function H0(e,t,r,n){var a=t.current,s=jr(),i=Va(a);return r=uv(r),t.context===null?t.context=r:t.pendingContext=r,t=ca(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ha(a,t,i),e!==null&&(Dn(e,a,i,s),Ic(e,a,i)),i}function f0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Nx(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function xh(e,t){Nx(e,t),(e=e.alternate)&&Nx(e,t)}function Tb(){return null}var fv=typeof reportError=="function"?reportError:function(e){console.error(e)};function ph(e){this._internalRoot=e}W0.prototype.render=ph.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ge(409));H0(e,t,null,null)};W0.prototype.unmount=ph.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ps(function(){H0(null,e,null,null)}),t[ma]=null}};function W0(e){this._internalRoot=e}W0.prototype.unstable_scheduleHydration=function(e){if(e){var t=Hg();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ca.length&&t!==0&&t<Ca[r].priority;r++);Ca.splice(r,0,e),r===0&&Vg(e)}};function gh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function V0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ex(){}function jb(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var u=f0(i);s.call(u)}}var i=dv(t,n,e,0,null,!1,!1,"",Ex);return e._reactRootContainer=i,e[ma]=i.current,uo(e.nodeType===8?e.parentNode:e),Ps(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var u=f0(c);o.call(u)}}var c=mh(e,0,!1,null,null,!1,!1,"",Ex);return e._reactRootContainer=c,e[ma]=c.current,uo(e.nodeType===8?e.parentNode:e),Ps(function(){H0(t,c,r,n)}),c}function G0(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var c=f0(i);o.call(c)}}H0(t,i,e,a)}else i=jb(r,t,e,a,n);return f0(i)}zg=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Cl(t.pendingLanes);r!==0&&(If(t,r|1),Br(t,Ot()),!(Xe&6)&&(qi=Ot()+500,as()))}break;case 13:Ps(function(){var n=xa(e,1);if(n!==null){var a=jr();Dn(n,e,1,a)}}),xh(e,1)}};Lf=function(e){if(e.tag===13){var t=xa(e,134217728);if(t!==null){var r=jr();Dn(t,e,134217728,r)}xh(e,134217728)}};$g=function(e){if(e.tag===13){var t=Va(e),r=xa(e,t);if(r!==null){var n=jr();Dn(r,e,t,n)}xh(e,t)}};Hg=function(){return rt};Wg=function(e,t){var r=rt;try{return rt=e,t()}finally{rt=r}};vd=function(e,t,r){switch(t){case"input":if(dd(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=I0(n);if(!a)throw Error(ge(90));wg(n),dd(n,a)}}}break;case"textarea":kg(e,r);break;case"select":t=r.value,t!=null&&Pi(e,!!r.multiple,t,!1)}};Ag=uh;Fg=Ps;var Cb={usingClientEntryPoint:!1,Events:[Bo,bi,I0,jg,Cg,uh]},kl={findFiberByHostInstance:ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ab={bundleType:kl.bundleType,version:kl.version,rendererPackageName:kl.rendererPackageName,rendererConfig:kl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ga.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Og(e),e===null?null:e.stateNode},findFiberByHostInstance:kl.findFiberByHostInstance||Tb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mc.isDisabled&&mc.supportsFiber)try{P0=mc.inject(Ab),Kn=mc}catch{}}tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cb;tn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gh(t))throw Error(ge(200));return Eb(e,t,null,r)};tn.createRoot=function(e,t){if(!gh(e))throw Error(ge(299));var r=!1,n="",a=fv;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=mh(e,1,!1,null,null,r,!1,n,a),e[ma]=t.current,uo(e.nodeType===8?e.parentNode:e),new ph(t)};tn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ge(188)):(e=Object.keys(e).join(","),Error(ge(268,e)));return e=Og(t),e=e===null?null:e.stateNode,e};tn.flushSync=function(e){return Ps(e)};tn.hydrate=function(e,t,r){if(!V0(t))throw Error(ge(200));return G0(null,e,t,!0,r)};tn.hydrateRoot=function(e,t,r){if(!gh(e))throw Error(ge(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=fv;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=dv(t,null,e,1,r??null,a,!1,s,i),e[ma]=t.current,uo(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new W0(t)};tn.render=function(e,t,r){if(!V0(t))throw Error(ge(200));return G0(null,e,t,!1,r)};tn.unmountComponentAtNode=function(e){if(!V0(e))throw Error(ge(40));return e._reactRootContainer?(Ps(function(){G0(null,null,e,!1,function(){e._reactRootContainer=null,e[ma]=null})}),!0):!1};tn.unstable_batchedUpdates=uh;tn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!V0(r))throw Error(ge(200));if(e==null||e._reactInternals===void 0)throw Error(ge(38));return G0(e,t,r,!1,n)};tn.version="18.3.1-next-f1338f8080-20240426";function hv(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hv)}catch(e){console.error(e)}}hv(),hg.exports=tn;var Fb=hg.exports,mv,Tx=Fb;mv=Tx.createRoot,Tx.hydrateRoot;const Pb="modulepreload",Db=function(e){return"/"+e},jx={},Ya=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=Db(c),c in jx)return;jx[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Pb,u||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((h,g)=>{f.addEventListener("load",h),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},Ob=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ya(async()=>{const{default:n}=await Promise.resolve().then(()=>sl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class vh extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Rb extends vh{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Cx extends vh{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Ax extends vh{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Jd;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Jd||(Jd={}));var Ib=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class Lb{constructor(t,{headers:r={},customFetch:n,region:a=Jd.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=Ob(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return Ib(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:i}=r;let o={},{region:c}=r;c||(c=this.region);const u=new URL(`${this.url}/${t}`);c&&c!=="any"&&(o["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let d;i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",d=i):typeof i=="string"?(o["Content-Type"]="text/plain",d=i):typeof FormData<"u"&&i instanceof FormData?d=i:(o["Content-Type"]="application/json",d=JSON.stringify(i)));const f=yield this.fetch(u.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:d}).catch(x=>{throw new Rb(x)}),h=f.headers.get("x-relay-error");if(h&&h==="true")throw new Cx(f);if(!f.ok)throw new Ax(f);let g=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),p;return g==="application/json"?p=yield f.json():g==="application/octet-stream"?p=yield f.blob():g==="text/event-stream"?p=f:g==="multipart/form-data"?p=yield f.formData():p=yield f.text(),{data:p,error:null,response:f}}catch(a){return{data:null,error:a,response:a instanceof Ax||a instanceof Cx?a.context:void 0}}})}}var Rr={},yh={},K0={},zo={},q0={},X0={},Mb=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Xi=Mb();const Bb=Xi.fetch,xv=Xi.fetch.bind(Xi),pv=Xi.Headers,Ub=Xi.Request,zb=Xi.Response,sl=Object.freeze(Object.defineProperty({__proto__:null,Headers:pv,Request:Ub,Response:zb,default:xv,fetch:Bb},Symbol.toStringTag,{value:"Module"})),$b=s2(sl);var Y0={};Object.defineProperty(Y0,"__esModule",{value:!0});let Hb=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Y0.default=Hb;var gv=yn&&yn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(X0,"__esModule",{value:!0});const Wb=gv($b),Vb=gv(Y0);let Gb=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=Wb.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,o,c,u;let d=null,f=null,h=null,g=s.status,p=s.statusText;if(s.ok){if(this.method!=="HEAD"){const _=await s.text();_===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?f=_:f=JSON.parse(_))}const m=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),v=(c=s.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");m&&v&&v.length>1&&(h=parseInt(v[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(d={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,h=null,g=406,p="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const m=await s.text();try{d=JSON.parse(m),Array.isArray(d)&&s.status===404&&(f=[],d=null,g=200,p="OK")}catch{s.status===404&&m===""?(g=204,p="No Content"):d={message:m}}if(d&&this.isMaybeSingle&&(!((u=d==null?void 0:d.details)===null||u===void 0)&&u.includes("0 rows"))&&(d=null,g=200,p="OK"),d&&this.shouldThrowOnError)throw new Vb.default(d)}return{error:d,data:f,count:h,status:g,statusText:p}});return this.shouldThrowOnError||(a=a.catch(s=>{var i,o,c;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(c=s==null?void 0:s.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};X0.default=Gb;var Kb=yn&&yn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(q0,"__esModule",{value:!0});const qb=Kb(X0);let Xb=class extends qb.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:s=a}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const s=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:s=!1,format:i="text"}={}){var o;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${u}"; options=${c};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};q0.default=Xb;var Yb=yn&&yn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(zo,"__esModule",{value:!0});const Jb=Yb(q0);let Qb=class extends Jb.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};zo.default=Qb;var Zb=yn&&yn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(K0,"__esModule",{value:!0});const Sl=Zb(zo);let ek=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let s=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),n&&this.headers.append("Prefer",`count=${n}`),new Sl.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var a;const s="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(i.length>0){const o=[...new Set(i)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new Sl.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:s=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),a&&this.headers.append("Prefer",`count=${a}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new Sl.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:r}={}){var n;const a="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Sl.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Sl.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};K0.default=ek;var vv=yn&&yn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yh,"__esModule",{value:!0});const tk=vv(K0),rk=vv(zo);let nk=class yv{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new tk.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new yv(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:s}={}){var i;let o;const c=new URL(`${this.url}/rpc/${t}`);let u;n||a?(o=n?"HEAD":"GET",Object.entries(r).filter(([f,h])=>h!==void 0).map(([f,h])=>[f,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([f,h])=>{c.searchParams.append(f,h)})):(o="POST",u=r);const d=new Headers(this.headers);return s&&d.set("Prefer",`count=${s}`),new rk.default({method:o,url:c,headers:d,schema:this.schemaName,body:u,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};yh.default=nk;var il=yn&&yn.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Rr,"__esModule",{value:!0});Rr.PostgrestError=Rr.PostgrestBuilder=Rr.PostgrestTransformBuilder=Rr.PostgrestFilterBuilder=Rr.PostgrestQueryBuilder=Rr.PostgrestClient=void 0;const _v=il(yh);Rr.PostgrestClient=_v.default;const wv=il(K0);Rr.PostgrestQueryBuilder=wv.default;const bv=il(zo);Rr.PostgrestFilterBuilder=bv.default;const kv=il(q0);Rr.PostgrestTransformBuilder=kv.default;const Sv=il(X0);Rr.PostgrestBuilder=Sv.default;const Nv=il(Y0);Rr.PostgrestError=Nv.default;var ak=Rr.default={PostgrestClient:_v.default,PostgrestQueryBuilder:wv.default,PostgrestFilterBuilder:bv.default,PostgrestTransformBuilder:kv.default,PostgrestBuilder:Sv.default,PostgrestError:Nv.default};const{PostgrestClient:sk,PostgrestQueryBuilder:JP,PostgrestFilterBuilder:QP,PostgrestTransformBuilder:ZP,PostgrestBuilder:eD,PostgrestError:tD}=ak;class ik{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,a=parseInt(n.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const lk="2.15.5",ok=`realtime-js/${lk}`,ck="1.0.0",Qd=1e4,uk=1e3,dk=100;var Wl;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Wl||(Wl={}));var zt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(zt||(zt={}));var Cn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Cn||(Cn={}));var Zd;(function(e){e.websocket="websocket"})(Zd||(Zd={}));var gs;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(gs||(gs={}));class fk{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(t.slice(i,i+a));i=i+a;const c=n.decode(t.slice(i,i+s));i=i+s;const u=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:c,payload:u}}}class Ev{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ct;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ct||(ct={}));const Fx=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,i)=>(s[i]=hk(i,e,t,a),s),{})},hk=(e,t,r,n)=>{const a=t.find(o=>o.name===e),s=a==null?void 0:a.type,i=r[e];return s&&!n.includes(s)?Tv(s,i):ef(i)},Tv=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return gk(t,r)}switch(e){case ct.bool:return mk(t);case ct.float4:case ct.float8:case ct.int2:case ct.int4:case ct.int8:case ct.numeric:case ct.oid:return xk(t);case ct.json:case ct.jsonb:return pk(t);case ct.timestamp:return vk(t);case ct.abstime:case ct.date:case ct.daterange:case ct.int4range:case ct.int8range:case ct.money:case ct.reltime:case ct.text:case ct.time:case ct.timestamptz:case ct.timetz:case ct.tsrange:case ct.tstzrange:return ef(t);default:return ef(t)}},ef=e=>e,mk=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},xk=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},pk=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},gk=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>Tv(t,o))}return e},vk=e=>typeof e=="string"?e.replace(" ","T"):e,jv=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Lu{constructor(t,r,n={},a=Qd){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Px;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Px||(Px={}));class Vl{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Vl.syncState(this.state,a,s,i),this.pendingDiffs.forEach(c=>{this.state=Vl.syncDiff(this.state,c,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Vl.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),i=this.transformState(r),o={},c={};return this.map(s,(u,d)=>{i[u]||(c[u]=d)}),this.map(i,(u,d)=>{const f=s[u];if(f){const h=d.map(m=>m.presence_ref),g=f.map(m=>m.presence_ref),p=d.filter(m=>g.indexOf(m.presence_ref)<0),x=f.filter(m=>h.indexOf(m.presence_ref)<0);p.length>0&&(o[u]=p),x.length>0&&(c[u]=x)}else o[u]=d}),this.syncDiff(s,{joins:o,leaves:c},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(o,c)=>{var u;const d=(u=t[o])!==null&&u!==void 0?u:[];if(t[o]=this.cloneDeep(c),d.length>0){const f=t[o].map(g=>g.presence_ref),h=d.filter(g=>f.indexOf(g.presence_ref)<0);t[o].unshift(...h)}n(o,d,c)}),this.map(i,(o,c)=>{let u=t[o];if(!u)return;const d=c.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),t[o]=u,a(o,u,c),u.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Dx;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Dx||(Dx={}));var Gl;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Gl||(Gl={}));var aa;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(aa||(aa={}));class _h{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=zt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Lu(this,Cn.join,this.params,this.timeout),this.rejoinTimer=new Ev(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=zt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=zt.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=zt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=zt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Cn.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new Vl(this),this.broadcastEndpointURL=jv(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a,s;if(this.socket.isConnected()||this.socket.connect(),this.state==zt.closed){const{config:{broadcast:i,presence:o,private:c}}=this.params,u=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(g=>g.filter))!==null&&a!==void 0?a:[],d=!!this.bindings[Gl.PRESENCE]&&this.bindings[Gl.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,f={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(g=>t==null?void 0:t(aa.CHANNEL_ERROR,g)),this._onClose(()=>t==null?void 0:t(aa.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:g})=>{var p;if(this.socket.setAuth(),g===void 0){t==null||t(aa.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,m=(p=x==null?void 0:x.length)!==null&&p!==void 0?p:0,v=[];for(let _=0;_<m;_++){const y=x[_],{filter:{event:b,schema:E,table:T,filter:k}}=y,A=g&&g[_];if(A&&A.event===b&&A.schema===E&&A.table===T&&A.filter===k)v.push(Object.assign(Object.assign({},y),{id:A.id}));else{this.unsubscribe(),this.state=zt.errored,t==null||t(aa.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(aa.SUBSCRIBED);return}}).receive("error",g=>{this.state=zt.errored,t==null||t(aa.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(aa.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===zt.joined&&t===Gl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:i}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=u.body)===null||a===void 0?void 0:a.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&s("ok"),u.receive("ok",()=>s("ok")),u.receive("error",()=>s("error")),u.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=zt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Cn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new Lu(this,Cn.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=zt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Lu(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>dk){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const i=t.toLocaleLowerCase(),{close:o,error:c,leave:u,join:d}=Cn;if(n&&[o,c,u,d].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(g=>{var p,x,m;return((p=g.filter)===null||p===void 0?void 0:p.event)==="*"||((m=(x=g.filter)===null||x===void 0?void 0:x.event)===null||m===void 0?void 0:m.toLocaleLowerCase())===i}).map(g=>g.callback(h,n)):(s=this.bindings[i])===null||s===void 0||s.filter(g=>{var p,x,m,v,_,y;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in g){const b=g.id,E=(p=g.filter)===null||p===void 0?void 0:p.event;return b&&((x=r.ids)===null||x===void 0?void 0:x.includes(b))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((m=r.data)===null||m===void 0?void 0:m.type.toLocaleLowerCase()))}else{const b=(_=(v=g==null?void 0:g.filter)===null||v===void 0?void 0:v.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return b==="*"||b===((y=r==null?void 0:r.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===i}).map(g=>{if(typeof h=="object"&&"ids"in h){const p=h.data,{schema:x,table:m,commit_timestamp:v,type:_,errors:y}=p;h=Object.assign(Object.assign({},{schema:x,table:m,commit_timestamp:v,eventType:_,new:{},old:{},errors:y}),this._getPayloadRecords(p))}g.callback(h,n)})}_isClosed(){return this.state===zt.closed}_isJoined(){return this.state===zt.joined}_isJoining(){return this.state===zt.joining}_isLeaving(){return this.state===zt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&_h.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Cn.close,{},t)}_onError(t){this._on(Cn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=zt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=Fx(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=Fx(t.columns,t.old_record)),r}}const Mu=()=>{},xc={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},yk=[1e3,2e3,5e3,1e4],_k=1e4,wk=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class bk{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Qd,this.transport=null,this.heartbeatIntervalMs=xc.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Mu,this.ref=0,this.reconnectTimer=null,this.logger=Mu,this.conn=null,this.sendBuffer=[],this.serializer=new fk,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=a=>{let s;return a?s=a:typeof fetch>"u"?s=(...i)=>Ya(async()=>{const{default:o}=await Promise.resolve().then(()=>sl);return{default:o}},void 0).then(({default:o})=>o(...i)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...i)=>s(...i)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Zd.websocket}`,this.httpEndpoint=jv(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=ik.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:ck}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Wl.connecting:return gs.Connecting;case Wl.open:return gs.Open;case Wl.closing:return gs.Closing;default:return gs.Closed}}isConnected(){return this.connectionState()===gs.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(s=>s.topic===n);if(a)return a;{const s=new _h(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:a,ref:s}=t,i=()=>{this.encode(t,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(uk,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},xc.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:a,payload:s,ref:i}=r,o=i?`(${i})`:"",c=s.status||"";this.log("receive",`${c} ${n} ${a} ${o}`.trim(),s),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(a,s,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Cn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([wk],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const a={access_token:r,version:ok};r&&n.updateJoinPayload(a),n.joinedOnce&&n._isJoined()&&n._push(Cn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Ev(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},xc.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,s,i,o,c,u,d;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Qd,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:xc.HEARTBEAT_INTERVAL,this.worker=(s=t==null?void 0:t.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Mu,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:f=>yk[f-1]||_k,this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(f,h)=>h(JSON.stringify(f)),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class wh extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function $t(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class kk extends wh{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class tf extends wh{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var Sk=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const Cv=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ya(async()=>{const{default:n}=await Promise.resolve().then(()=>sl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},Nk=()=>Sk(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ya(()=>Promise.resolve().then(()=>sl),void 0)).Response:Response}),rf=e=>{if(Array.isArray(e))return e.map(r=>rf(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=rf(n)}),t},Ek=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var Gs=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const Bu=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Tk=(e,t,r)=>Gs(void 0,void 0,void 0,function*(){const n=yield Nk();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{const s=e.status||500,i=(a==null?void 0:a.statusCode)||s+"";t(new kk(Bu(a),s,i))}).catch(a=>{t(new tf(Bu(a),a))}):t(new tf(Bu(e),e))}),jk=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(Ek(n)?(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Object.assign(Object.assign({},a),r))};function $o(e,t,r,n,a,s){return Gs(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,jk(t,n,a,s)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>Tk(c,o,n))})})}function h0(e,t,r,n){return Gs(this,void 0,void 0,function*(){return $o(e,"GET",t,r,n)})}function Wn(e,t,r,n,a){return Gs(this,void 0,void 0,function*(){return $o(e,"POST",t,n,a,r)})}function nf(e,t,r,n,a){return Gs(this,void 0,void 0,function*(){return $o(e,"PUT",t,n,a,r)})}function Ck(e,t,r,n){return Gs(this,void 0,void 0,function*(){return $o(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Av(e,t,r,n,a){return Gs(this,void 0,void 0,function*(){return $o(e,"DELETE",t,n,a,r)})}var Sr=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const Ak={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ox={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Fk{constructor(t,r={},n,a){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=Cv(a)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,a){return Sr(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},Ox),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),c&&s.append("metadata",this.encodeMetadata(c)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),c&&s.append("metadata",this.encodeMetadata(c))):(s=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const u=this._removeEmptyFolders(r),d=this._getFinalPath(u),f=yield(t=="PUT"?nf:Wn)(this.fetch,`${this.url}/object/${d}`,s,Object.assign({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if($t(s))return{data:null,error:s};throw s}})}upload(t,r,n){return Sr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Sr(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:Ox.upsert},a),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const f=yield nf(this.fetch,o.toString(),c,{headers:d});return{data:{path:s,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if($t(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Sr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const s=yield Wn(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new wh("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}})}update(t,r,n){return Sr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Sr(this,void 0,void 0,function*(){try{return{data:yield Wn(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if($t(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Sr(this,void 0,void 0,function*(){try{return{data:{path:(yield Wn(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if($t(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Sr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield Wn(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(this.shouldThrowOnError)throw a;if($t(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Sr(this,void 0,void 0,function*(){try{const a=yield Wn(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if($t(a))return{data:null,error:a};throw a}})}download(t,r){return Sr(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield h0(this.fetch,`${this.url}/${a}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if($t(o))return{data:null,error:o};throw o}})}info(t){return Sr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield h0(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:rf(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}})}exists(t){return Sr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield Ck(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($t(n)&&n instanceof tf){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&a.push(c);let u=a.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${u}`)}}}remove(t){return Sr(this,void 0,void 0,function*(){try{return{data:yield Av(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}})}list(t,r,n){return Sr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},Ak),r),{prefix:t||""});return{data:yield Wn(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(this.shouldThrowOnError)throw a;if($t(a))return{data:null,error:a};throw a}})}listV2(t,r){return Sr(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield Wn(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const Pk="2.12.1",Dk={"X-Client-Info":`storage-js/${Pk}`};var ii=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class Ok{constructor(t,r={},n,a){this.shouldThrowOnError=!1;const s=new URL(t);a!=null&&a.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},Dk),r),this.fetch=Cv(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return ii(this,void 0,void 0,function*(){try{return{data:yield h0(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if($t(t))return{data:null,error:t};throw t}})}getBucket(t){return ii(this,void 0,void 0,function*(){try{return{data:yield h0(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return ii(this,void 0,void 0,function*(){try{return{data:yield Wn(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return ii(this,void 0,void 0,function*(){try{return{data:yield nf(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}})}emptyBucket(t){return ii(this,void 0,void 0,function*(){try{return{data:yield Wn(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}})}deleteBucket(t){return ii(this,void 0,void 0,function*(){try{return{data:yield Av(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}})}}class Rk extends Ok{constructor(t,r={},n,a){super(t,r,n,a)}from(t){return new Fk(this.url,this.headers,t,this.fetch)}}const Ik="2.57.4";let Fl="";typeof Deno<"u"?Fl="deno":typeof document<"u"?Fl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Fl="react-native":Fl="node";const Lk={"X-Client-Info":`supabase-js-${Fl}/${Ik}`},Mk={headers:Lk},Bk={schema:"public"},Uk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},zk={};var $k=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const Hk=e=>{let t;return e?t=e:typeof fetch>"u"?t=xv:t=fetch,(...r)=>t(...r)},Wk=()=>typeof Headers>"u"?pv:Headers,Vk=(e,t,r)=>{const n=Hk(r),a=Wk();return(s,i)=>$k(void 0,void 0,void 0,function*(){var o;const c=(o=yield t())!==null&&o!==void 0?o:e;let u=new a(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(s,Object.assign(Object.assign({},i),{headers:u}))})};var Gk=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};function Kk(e){return e.endsWith("/")?e:e+"/"}function qk(e,t){var r,n;const{db:a,auth:s,realtime:i,global:o}=e,{db:c,auth:u,realtime:d,global:f}=t,h={db:Object.assign(Object.assign({},c),a),auth:Object.assign(Object.assign({},u),s),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},f),o),{headers:Object.assign(Object.assign({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>Gk(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function Xk(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Kk(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Fv="2.71.1",mi=30*1e3,af=3,Uu=af*mi,Yk="http://localhost:9999",Jk="supabase.auth.token",Qk={"X-Client-Info":`gotrue-js/${Fv}`},sf="X-Supabase-Api-Version",Pv={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Zk=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,eS=10*60*1e3;class bh extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Re(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class tS extends bh{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function rS(e){return Re(e)&&e.name==="AuthApiError"}class Dv extends bh{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class ss extends bh{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Na extends ss{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function nS(e){return Re(e)&&e.name==="AuthSessionMissingError"}class pc extends ss{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class gc extends ss{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class vc extends ss{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function aS(e){return Re(e)&&e.name==="AuthImplicitGrantRedirectError"}class Rx extends ss{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class lf extends ss{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function zu(e){return Re(e)&&e.name==="AuthRetryableFetchError"}class Ix extends ss{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class of extends ss{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const m0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Lx=` 	
\r=`.split(""),sS=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Lx.length;t+=1)e[Lx[t].charCodeAt(0)]=-2;for(let t=0;t<m0.length;t+=1)e[m0[t].charCodeAt(0)]=t;return e})();function Mx(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(m0[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(m0[n]),t.queuedBits-=6}}function Ov(e,t,r){const n=sS[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Bx(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{oS(i,n,r)};for(let i=0;i<e.length;i+=1)Ov(e.charCodeAt(i),a,s);return t.join("")}function iS(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function lS(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}iS(n,t)}}function oS(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function cS(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)Ov(e.charCodeAt(a),r,n);return new Uint8Array(t)}function uS(e){const t=[];return lS(e,r=>t.push(r)),new Uint8Array(t)}function dS(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>Mx(a,r,n)),Mx(null,r,n),t.join("")}function fS(e){return Math.round(Date.now()/1e3)+e}function hS(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const En=()=>typeof window<"u"&&typeof document<"u",fs={tested:!1,writable:!1},Rv=()=>{if(!En())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(fs.tested)return fs.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),fs.tested=!0,fs.writable=!0}catch{fs.tested=!0,fs.writable=!1}return fs.writable};function mS(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const Iv=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>Ya(async()=>{const{default:n}=await Promise.resolve().then(()=>sl);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},xS=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",xi=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},hs=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ka=async(e,t)=>{await e.removeItem(t)};class J0{constructor(){this.promise=new J0.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}J0.promiseConstructor=Promise;function $u(e){const t=e.split(".");if(t.length!==3)throw new of("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Zk.test(t[n]))throw new of("JWT not in base64url format");return{header:JSON.parse(Bx(t[0])),payload:JSON.parse(Bx(t[1])),signature:cS(t[2]),raw:{header:t[0],payload:t[1]}}}async function pS(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function gS(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function vS(e){return("0"+e.toString(16)).substr(-2)}function yS(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,vS).join("")}async function _S(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function wS(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await _S(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function li(e,t,r=!1){const n=yS();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await xi(e,`${t}-code-verifier`,a);const s=await wS(n);return[s,n===s?"plain":"s256"]}const bS=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function kS(e){const t=e.headers.get(sf);if(!t||!t.match(bS))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function SS(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function NS(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ES=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function oi(e){if(!ES.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Hu(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Ux(e){return JSON.parse(JSON.stringify(e))}var TS=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const ps=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),jS=[502,503,504];async function zx(e){var t;if(!xS(e))throw new lf(ps(e),0);if(jS.includes(e.status))throw new lf(ps(e),e.status);let r;try{r=await e.json()}catch(s){throw new Dv(ps(s),s)}let n;const a=kS(e);if(a&&a.getTime()>=Pv["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Ix(ps(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Na}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new Ix(ps(r),e.status,r.weak_password.reasons);throw new tS(ps(r),e.status||500,n)}const CS=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function He(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[sf]||(s[sf]=Pv["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await AS(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function AS(e,t,r,n,a,s){const i=CS(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(c){throw console.error(c),new lf(ps(c),0)}if(o.ok||await zx(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(c){await zx(c)}}function ra(e){var t;let r=null;OS(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=fS(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function $x(e){const t=ra(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Fa(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function FS(e){return{data:e,error:null}}function PS(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=TS(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},c=Object.assign({},i);return{data:{properties:o,user:c},error:null}}function DS(e){return e}function OS(e){return e.access_token&&e.refresh_token&&e.expires_in}const Wu=["global","local","others"];var RS=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class IS{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Iv(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r=Wu[0]){if(Wu.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Wu.join(", ")}`);try{return await He(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Re(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await He(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Fa})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=RS(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await He(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:PS,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Re(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await He(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Fa})}catch(r){if(Re(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,i,o,c;try{const u={nextPage:null,lastPage:0,total:0},d=await He(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:DS});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,g=(c=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(p=>{const x=parseInt(p.split(";")[0].split("=")[1].substring(0,1)),m=JSON.parse(p.split(";")[1].split("=")[1]);u[`${m}Page`]=x}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(Re(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){oi(t);try{return await He(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Fa})}catch(r){if(Re(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){oi(t);try{return await He(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Fa})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){oi(t);try{return await He(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Fa})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){oi(t.userId);try{const{data:r,error:n}=await He(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Re(r))return{data:null,error:r};throw r}}async _deleteFactor(t){oi(t.userId),oi(t.id);try{return{data:await He(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Re(r))return{data:null,error:r};throw r}}}function Hx(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function LS(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const ci={debug:!!(globalThis&&Rv()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Lv extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class MS extends Lv{}async function BS(e,t,r){ci.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),ci.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){ci.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{ci.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw ci.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new MS(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(ci.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}LS();const US={url:Yk,storageKey:Jk,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Qk,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Wx(e,t,r){return await r()}const ui={};class _o{constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=_o.nextInstanceID,_o.nextInstanceID+=1,this.instanceID>0&&En()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},US),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new IS({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Iv(a.fetch),this.lock=a.lock||Wx,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:En()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=BS:this.lock=Wx,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Rv()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Hx(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Hx(this.memoryStorage)),En()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var t,r;return(r=(t=ui[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){ui[this.storageKey]=Object.assign(Object.assign({},ui[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=ui[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){ui[this.storageKey]=Object.assign(Object.assign({},ui[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Fv}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=mS(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),En()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),aS(s)){const c=(t=s.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Re(r)?{error:r}:{error:new Dv("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await He(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:ra}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(Re(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:d,password:f,options:h}=t;let g=null,p=null;this.flowType==="pkce"&&([g,p]=await li(this.storage,this.storageKey)),s=await He(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:g,code_challenge_method:p},xform:ra})}else if("phone"in t){const{phone:d,password:f,options:h}=t;s=await He(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(a=h==null?void 0:h.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:ra})}else throw new gc("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(Re(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:o}=t;r=await He(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:$x})}else if("phone"in t){const{phone:s,password:i,options:o}=t;r=await He(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:$x})}else throw new gc("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new pc}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Re(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;if(r==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(t){var r,n,a,s,i,o,c,u,d,f,h,g;let p,x;if("message"in t)p=t.message,x=t.signature;else{const{chain:m,wallet:v,statement:_,options:y}=t;let b;if(En())if(typeof v=="object")b=v;else{const T=window;if("solana"in T&&typeof T.solana=="object"&&("signIn"in T.solana&&typeof T.solana.signIn=="function"||"signMessage"in T.solana&&typeof T.solana.signMessage=="function"))b=T.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof v!="object"||!(y!=null&&y.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");b=v}const E=new URL((r=y==null?void 0:y.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in b&&b.signIn){const T=await b.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y==null?void 0:y.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),_?{statement:_}:null));let k;if(Array.isArray(T)&&T[0]&&typeof T[0]=="object")k=T[0];else if(T&&typeof T=="object"&&"signedMessage"in T&&"signature"in T)k=T;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)p=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),x=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in b)||typeof b.signMessage!="function"||!("publicKey"in b)||typeof b!="object"||!b.publicKey||!("toBase58"in b.publicKey)||typeof b.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${E.host} wants you to sign in with your Solana account:`,b.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(a=(n=y==null?void 0:y.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((s=y==null?void 0:y.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((i=y==null?void 0:y.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((o=y==null?void 0:y.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((c=y==null?void 0:y.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((u=y==null?void 0:y.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((f=(d=y==null?void 0:y.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...y.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const T=await b.signMessage(new TextEncoder().encode(p),"utf8");if(!T||!(T instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=T}}try{const{data:m,error:v}=await He(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:dS(x)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(g=t.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:ra});if(v)throw v;return!m||!m.session||!m.user?{data:{user:null,session:null},error:new pc}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:Object.assign({},m),error:v})}catch(m){if(Re(m))return{data:{user:null,session:null},error:m};throw m}}async _exchangeCodeForSession(t){const r=await hs(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:i}=await He(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:ra});if(await ka(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new pc}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if(Re(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:i}=t,o=await He(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:ra}),{data:c,error:u}=o;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new pc}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(Re(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,s,i;try{if("email"in t){const{email:o,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await li(this.storage,this.storageKey));const{error:f}=await He(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in t){const{phone:o,options:c}=t,{data:u,error:d}=await He(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=c==null?void 0:c.data)!==null&&a!==void 0?a:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new gc("You must provide either an email or phone number.")}catch(o){if(Re(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await He(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:ra});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,u=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(Re(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await li(this.storage,this.storageKey)),await He(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:FS})}catch(s){if(Re(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Na;const{error:a}=await He(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Re(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:i}=await He(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:i,error:o}=await He(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new gc("You must provide either an email or phone number and a type")}catch(r){if(Re(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await hs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Uu:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await hs(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=Hu()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,u,d)=>(!i&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await He(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Fa}):await this._useSession(async r=>{var n,a,s;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Na}:await He(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:Fa})})}catch(r){if(Re(r))return nS(r)&&(await this._removeSession(),await ka(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new Na;const i=a.session;let o=null,c=null;this.flowType==="pkce"&&t.email!=null&&([o,c]=await li(this.storage,this.storageKey));const{data:u,error:d}=await He(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:c}),jwt:i.access_token,xform:Fa});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Na;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:i}=$u(t.access_token);if(i.exp&&(n=i.exp,a=n<=r),a){const{session:o,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:c}=await this._getUser(t.access_token);if(c)throw c;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(Re(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Na;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Re(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!En())throw new vc("No browser detected.");if(t.error||t.error_description||t.error_code)throw new vc(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Rx("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new vc("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Rx("No code detected.");const{data:_,error:y}=await this._exchangeCodeForSession(t.code);if(y)throw y;const b=new URL(window.location.href);return b.searchParams.delete("code"),window.history.replaceState(window.history.state,"",b.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:c,token_type:u}=t;if(!s||!o||!i||!u)throw new vc("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(o);let h=d+f;c&&(h=parseInt(c));const g=h-d;g*1e3<=mi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${f}s`);const p=h-f;d-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,h,d):d-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,h,d);const{data:x,error:m}=await this._getUser(s);if(m)throw m;const v={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:f,expires_at:h,refresh_token:i,token_type:u,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:v,redirectType:t.type},error:null}}catch(n){if(Re(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await hs(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{error:s};const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(rS(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await ka(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=hS(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await li(this.storage,this.storageKey,!0));try{return await He(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Re(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Re(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var i,o,c,u,d;const{data:f,error:h}=s;if(h)throw h;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await He(this.fetch,"GET",g,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(a)throw a;return En()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Re(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)throw i;return await He(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Re(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await gS(async a=>(a>0&&await pS(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await He(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ra})),(a,s)=>{const i=200*Math.pow(2,a);return s&&zu(s)&&Date.now()+i-n<mi})}catch(n){if(this._debug(r,"error",n),Re(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),En()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await hs(this.storage,this.storageKey);if(a&&this.userStorage){let i=await hs(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:a.user},await xi(this.userStorage,this.storageKey+"-user",i)),a.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:Hu()}else if(a&&!a.user&&!a.user){const i=await hs(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(a.user=i.user,await ka(this.storage,this.storageKey+"-user"),await xi(this.storage,this.storageKey,a)):a.user=Hu()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const s=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Uu;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Uu}s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:i}=await this._callRefreshToken(a.refresh_token);i&&(console.error(i),zu(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(a.access_token);!o&&(i!=null&&i.user)?(a.user=i.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Na;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new J0;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new Na;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),Re(s)){const i={session:null,error:s};return zu(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(c){s.push(c)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await xi(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const s=Ux(a);await xi(this.storage,this.storageKey,s)}else{const a=Ux(r);await xi(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),await ka(this.storage,this.storageKey),await ka(this.storage,this.storageKey+"-code-verifier"),await ka(this.storage,this.storageKey+"-user"),this.userStorage&&await ka(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&En()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),mi);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/mi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${mi}ms, refresh threshold is ${af} ticks`),a<=af&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Lv)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!En()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await li(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await He(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Re(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:u}=await He(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((a=c==null?void 0:c.totp)===null||a===void 0)&&a.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(Re(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const{data:i,error:o}=await He(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(r){if(Re(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await He(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Re(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=$u(a.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const d=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+eS>a)return n;const{data:s,error:i}=await He(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=a,n=s.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:g,error:p}=await this.getSession();if(p||!g.session)return{data:null,error:p};n=g.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:c}}=$u(n);r!=null&&r.allowExpired||SS(s.exp);const u=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:g}=await this.getUser(n);if(g)throw g;return{data:{claims:s,header:a,signature:i},error:null}}const d=NS(a.alg),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,i,uS(`${o}.${c}`)))throw new of("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if(Re(n))return{data:null,error:n};throw n}}}_o.nextInstanceID=0;const zS=_o;class $S extends zS{constructor(t){super(t)}}var HS=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?s(d.value):a(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class WS{constructor(t,r,n){var a,s,i;this.supabaseUrl=t,this.supabaseKey=r;const o=Xk(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const c=`sb-${o.hostname.split(".")[0]}-auth-token`,u={db:Bk,realtime:zk,auth:Object.assign(Object.assign({},Uk),{storageKey:c}),global:Mk},d=qk(n??{},u);this.storageKey=(a=d.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(f,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=Vk(r,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new sk(new URL("rest/v1",o).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new Rk(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new Lb(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return HS(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,storageKey:i,flowType:o,lock:c,debug:u},d,f){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new $S({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),d),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,userStorage:s,flowType:o,lock:c,debug:u,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new bk(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const VS=(e,t,r)=>new WS(e,t,r);function GS(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}GS()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const KS="https://ebmjfuvairqzxsisshep.supabase.co",qS="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVibWpmdXZhaXJxenhzaXNzaGVwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkzMDk5ODUsImV4cCI6MjA3NDg4NTk4NX0.Vm0cgAW0Oxt-DXKbs1TNIYbA-Zqp7b2rkI9arFEhZic",ee=VS(KS,qS),Mv=z.createContext(void 0);function XS({children:e}){const[t,r]=z.useState(null),[n,a]=z.useState(null),[s,i]=z.useState(null),[o,c]=z.useState(!0);z.useEffect(()=>{let p=!0,x=!1;const m=setTimeout(()=>{p&&c(!1)},2e3);ee.auth.getSession().then(({data:{session:_}})=>{p&&(x=!0,r((_==null?void 0:_.user)??null),_!=null&&_.user?u(_.user.id):c(!1))}).catch(_=>{p&&(console.error("Session fetch error:",_),c(!1))});const{data:{subscription:v}}=ee.auth.onAuthStateChange((_,y)=>{p&&(_==="INITIAL_SESSION"||_==="SIGNED_IN"&&!x||(r((y==null?void 0:y.user)??null),y!=null&&y.user?u(y.user.id):(a(null),i(null),c(!1))))});return()=>{p=!1,clearTimeout(m),v.unsubscribe()}},[]);const u=async p=>{try{const{data:x,error:m}=await ee.from("profiles").select("*").eq("id",p).maybeSingle();if(m){console.error("Profile fetch error:",m),c(!1);return}if(console.log("Profile loaded:",x),a(x),(x==null?void 0:x.role)==="client"){const{data:v,error:_}=await ee.from("clients").select("id").eq("user_id",p).maybeSingle();console.log("Client lookup result:",{clientData:v,clientError:_}),!_&&v?i(v.id):console.error("No client record found for user_id:",p)}}catch(x){console.error("Error fetching profile:",x)}finally{console.log("Setting loading to false"),c(!1)}},d=async(p,x)=>{const{error:m}=await ee.auth.signInWithPassword({email:p,password:x});if(m)throw m},f=async()=>{const{error:p}=await ee.auth.signOut();if(p)throw p},h=(n==null?void 0:n.role)==="admin",g=(n==null?void 0:n.role)==="client";return l.jsx(Mv.Provider,{value:{user:t,profile:n,loading:o,signIn:d,signOut:f,isAdmin:h,isClient:g,clientId:s},children:e})}function Pr(){const e=z.useContext(Mv);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var YS={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JS=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Ae=(e,t)=>{const r=z.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:o="",children:c,...u},d)=>z.createElement("svg",{ref:d,...YS,width:a,height:a,stroke:n,strokeWidth:i?Number(s)*24/Number(a):s,className:["lucide",`lucide-${JS(e)}`,o].join(" "),...u},[...t.map(([f,h])=>z.createElement(f,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=Ae("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QS=Ae("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZS=Ae("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kl=Ae("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=Ae("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kh=Ae("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yc=Ae("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=Ae("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ci=Ae("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=Ae("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x0=Ae("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eN=Ae("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cf=Ae("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=Ae("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nl=Ae("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=Ae("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tN=Ae("FileArchive",[["path",{d:"M16 22h2a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v18",key:"1oywqq"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rN=Ae("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p0=Ae("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=Ae("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=Ae("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sh=Ae("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bv=Ae("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nN=Ae("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vx=Ae("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aN=Ae("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gx=Ae("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uv=Ae("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nh=Ae("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sN=Ae("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zv=Ae("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iN=Ae("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lN=Ae("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oN=Ae("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ja=Ae("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _c=Ae("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $v=Ae("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hv=Ae("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cN=Ae("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yi=Ae("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ji=Ae("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uf=Ae("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=Ae("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uN=Ae("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dN=Ae("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wo=Ae("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=Ae("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wv=Ae("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ka=Ae("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=Ae("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eh=Ae("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fN=Ae("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=Ae("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g0=Ae("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=Ae("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function hN(){const[e,t]=z.useState(!1),[r,n]=z.useState(""),[a,s]=z.useState(""),[i,o]=z.useState(""),[c,u]=z.useState(""),[d,f]=z.useState(""),[h,g]=z.useState(!1),{signIn:p}=Pr(),x=async v=>{v.preventDefault(),u(""),f(""),g(!0);try{await p(r,a)}catch(_){u(_.message||"Giri baarsz oldu")}finally{g(!1)}},m=async v=>{v.preventDefault(),u(""),f(""),g(!0);try{const{data:_,error:y}=await ee.auth.signUp({email:r,password:a});if(y)throw y;if(_.user){const{data:b}=await ee.rpc("generate_verification_code"),E=b,{error:T}=await ee.from("profiles").insert([{id:_.user.id,email:r,full_name:i,role:"admin",verification_code:E,is_verified:!0}]);if(T)throw T;f(`Kayt baarl! Dorulama Kodunuz: ${E}

Bu kodu gvenli bir yerde saklayn. Mterilerinizin sisteme giri yapabilmesi iin bu kodu paylamanz gerekecek.`),t(!1),s(""),o("")}}catch(_){u(_.message||"Kayt baarsz oldu")}finally{g(!1)}};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-8",children:[l.jsxs("div",{className:"flex flex-col items-center mb-8",children:[l.jsx("div",{className:"bg-blue-600 rounded-full p-3 mb-4",children:l.jsx(wo,{className:"w-8 h-8 text-white"})}),l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"STN Trkylmaz Sigorta"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Polie Ynetim Sistemi"})]}),l.jsxs("div",{className:"flex gap-2 mb-6",children:[l.jsx("button",{onClick:()=>{t(!1),u(""),f("")},className:`flex-1 py-2 px-4 rounded-lg font-medium transition ${e?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-blue-600 text-white"}`,children:"Giri Yap"}),l.jsx("button",{onClick:()=>{t(!0),u(""),f("")},className:`flex-1 py-2 px-4 rounded-lg font-medium transition ${e?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Kayt Ol"})]}),l.jsxs("form",{onSubmit:e?m:x,className:"space-y-6",children:[e&&l.jsxs("div",{children:[l.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Ad Soyad"}),l.jsx("input",{id:"fullName",type:"text",value:i,onChange:v=>o(v.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:"Adnz Soyadnz"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"E-posta"}),l.jsx("input",{id:"email",type:"email",value:r,onChange:v=>n(v.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:"ornek@email.com"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"ifre"}),l.jsx("input",{id:"password",type:"password",value:a,onChange:v=>s(v.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition",placeholder:""})]}),c&&l.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:c}),d&&l.jsx("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg text-sm whitespace-pre-line",children:d}),l.jsx("button",{type:"submit",disabled:h,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition disabled:opacity-50 disabled:cursor-not-allowed",children:h?e?"Kayt yaplyor...":"Giri yaplyor...":e?"Kayt Ol":"Giri Yap"})]})]})})}function mN(){const{profile:e}=Pr(),[t,r]=z.useState([]),[n,a]=z.useState(0),[s,i]=z.useState(!1),[o,c]=z.useState(!0),u=z.useRef(null);z.useEffect(()=>{e&&(d(),f())},[e]),z.useEffect(()=>{const v=_=>{u.current&&!u.current.contains(_.target)&&i(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const d=async()=>{try{const{data:v,error:_}=await ee.from("notifications").select("*").eq("user_id",e==null?void 0:e.id).order("created_at",{ascending:!1}).limit(20);if(_)throw _;r(v||[]),a((v==null?void 0:v.filter(y=>!y.read).length)||0)}catch(v){console.error("Error fetching notifications:",v)}finally{c(!1)}},f=()=>{const v=ee.channel("notifications-channel").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${e==null?void 0:e.id}`},_=>{const y=_.new;r(b=>[y,...b]),a(b=>b+1),"Notification"in window&&Notification.permission==="granted"&&new Notification(y.title,{body:y.message,icon:"/favicon.ico"})}).subscribe();return()=>{ee.removeChannel(v)}},h=async v=>{try{await ee.from("notifications").update({read:!0}).eq("id",v),r(_=>_.map(y=>y.id===v?{...y,read:!0}:y)),a(_=>Math.max(0,_-1))}catch(_){console.error("Error marking notification as read:",_)}},g=async()=>{try{const v=t.filter(_=>!_.read).map(_=>_.id);if(v.length===0)return;await ee.from("notifications").update({read:!0}).in("id",v),r(_=>_.map(y=>({...y,read:!0}))),a(0)}catch(v){console.error("Error marking all as read:",v)}},p=v=>{h(v.id),v.link&&(window.dispatchEvent(new CustomEvent("navigate",{detail:v.link})),i(!1))},x=v=>{switch(v){case"new_message":return l.jsx(Ja,{className:"w-5 h-5 text-blue-600"});case"policy_renewal":return l.jsx(Kr,{className:"w-5 h-5 text-orange-600"});case"new_claim":return l.jsx(Rt,{className:"w-5 h-5 text-red-600"});case"announcement":return l.jsx(lN,{className:"w-5 h-5 text-purple-600"});case"message_reply":return l.jsx(Ja,{className:"w-5 h-5 text-green-600"});default:return l.jsx(ua,{className:"w-5 h-5 text-gray-600"})}},m=async()=>{"Notification"in window&&Notification.permission==="default"&&await Notification.requestPermission()};return z.useEffect(()=>{m()},[]),l.jsxs("div",{className:"relative",ref:u,children:[l.jsxs("button",{onClick:()=>i(!s),className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition",children:[l.jsx(ua,{className:"w-6 h-6"}),n>0&&l.jsx("span",{className:"absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-red-600 rounded-full",children:n>9?"9+":n})]}),s&&l.jsxs("div",{className:"absolute right-0 mt-2 w-96 bg-white rounded-lg shadow-lg border border-gray-200 z-50 max-h-[600px] overflow-hidden flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Bildirimler"}),l.jsxs("div",{className:"flex items-center gap-2",children:[n>0&&l.jsx("button",{onClick:g,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"Tmn Okundu aretle"}),l.jsx("button",{onClick:()=>i(!1),className:"text-gray-400 hover:text-gray-600",children:l.jsx(Kt,{className:"w-5 h-5"})})]})]}),l.jsx("div",{className:"overflow-y-auto flex-1",children:o?l.jsx("div",{className:"flex items-center justify-center p-8",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):t.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx(ua,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),l.jsx("p",{className:"text-gray-500",children:"Bildiriminiz yok"})]}):l.jsx("div",{className:"divide-y divide-gray-100",children:t.map(v=>l.jsx("div",{onClick:()=>p(v),className:`p-4 hover:bg-gray-50 transition cursor-pointer ${v.read?"":"bg-blue-50"}`,children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:"flex-shrink-0 mt-1",children:x(v.type)}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-start justify-between gap-2",children:[l.jsx("p",{className:`text-sm font-medium ${v.read?"text-gray-700":"text-gray-900"}`,children:v.title}),!v.read&&l.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full flex-shrink-0 mt-1"})]}),l.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:v.message}),l.jsx("p",{className:"text-xs text-gray-400 mt-2",children:new Date(v.created_at).toLocaleString("tr-TR")})]})]})},v.id))})})]})]})}function xN({children:e,currentPage:t,onNavigate:r}){const{profile:n,signOut:a,isAdmin:s,isClient:i}=Pr(),[o,c]=z.useState(!1),[u,d]=z.useState(0),[f,h]=z.useState(0),[g,p]=z.useState(0),[x,m]=z.useState(null),[v,_]=z.useState("STN Trkylmaz Sigorta");z.useEffect(()=>{y()},[]),z.useEffect(()=>{if(s&&!i){b(),E(),T();const A=ee.channel("messages_count_changes").on("postgres_changes",{event:"*",schema:"public",table:"customer_messages"},()=>{b()}).on("postgres_changes",{event:"*",schema:"public",table:"policy_renewal_requests"},()=>{E()}).on("postgres_changes",{event:"INSERT",schema:"public",table:"client_documents"},()=>{T()}).subscribe();return()=>{A.unsubscribe()}}},[s,i]);const y=async()=>{try{const{data:A}=await ee.from("settings").select("logo_url, company_name").maybeSingle();A&&(m(A.logo_url),_(A.company_name))}catch(A){console.error("Error fetching settings:",A)}},b=async()=>{var A;try{const{data:M}=await ee.auth.getUser(),{count:B,error:G}=await ee.from("customer_messages").select("*",{count:"exact",head:!0}).eq("agent_id",(A=M.user)==null?void 0:A.id).eq("status","new");G||d(B||0)}catch(M){console.error("Error fetching messages count:",M)}},E=async()=>{try{const{count:A}=await ee.from("policy_renewal_requests").select("*",{count:"exact",head:!0}).eq("status","pending");h(A||0)}catch(A){console.error("Error fetching renewals count:",A)}},T=async()=>{try{const A=new Date;A.setHours(0,0,0,0);const{count:M}=await ee.from("client_documents").select("*",{count:"exact",head:!0}).gte("created_at",A.toISOString());p(M||0)}catch(A){console.error("Error fetching documents count:",A)}},k=i?[{id:"dashboard",label:"Ana Sayfa",icon:Kl}]:[{id:"dashboard",label:"Ana Sayfa",icon:Kl},{id:"policies",label:"Polieler",icon:gn},{id:"claims",label:"Hasarlar",icon:Rt},{id:"clients",label:"Mteriler",icon:Os},{id:"analytics",label:"Analiz & Raporlar",icon:Kl}];return s&&!i&&k.push({id:"messages",label:"Mteri Mesajlar",icon:Ja,badge:u},{id:"renewals",label:"Yenileme Talepleri",icon:Ji,badge:f},{id:"documents",label:"Dosya Ynetimi",icon:Bv,badge:g},{id:"announcements",label:"Duyurular",icon:ua},{id:"agency-info",label:"Acente Bilgileri",icon:kh},{id:"backup",label:"Backup ndir",icon:Qr},{id:"settings",label:"Ayarlar",icon:dN}),l.jsxs("div",{className:"min-h-screen bg-slate-50",children:[l.jsx("header",{className:"bg-white border-b border-gray-200 sticky top-0 z-40",children:l.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between h-16",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("button",{onClick:()=>c(!o),className:"lg:hidden p-2 rounded-lg hover:bg-gray-100",children:o?l.jsx(Kt,{className:"w-6 h-6"}):l.jsx(oN,{className:"w-6 h-6"})}),x?l.jsx("img",{src:x,alt:v,className:"ml-4 lg:ml-0 h-10 object-contain"}):l.jsx("h1",{className:"ml-4 lg:ml-0 text-xl font-bold text-gray-900",children:v})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx(mN,{}),l.jsxs("div",{className:"text-right hidden sm:block",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:n==null?void 0:n.full_name}),l.jsx("p",{className:"text-xs text-gray-600",children:(n==null?void 0:n.role)==="admin"?"Ynetici":(n==null?void 0:n.role)==="client"?"Mteri":"Vekilhane"})]}),l.jsxs("button",{onClick:()=>a(),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition",children:[l.jsx(sN,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden sm:inline",children:"k"})]})]})]})})}),l.jsxs("div",{className:"flex",children:[l.jsx("aside",{className:`
            fixed lg:sticky top-16 left-0 z-30 h-[calc(100vh-4rem)] w-64 bg-white border-r border-gray-200
            transform transition-transform duration-200 ease-in-out
            ${o?"translate-x-0":"-translate-x-full lg:translate-x-0"}
          `,children:l.jsx("nav",{className:"p-4 space-y-1",children:k.map(A=>{const M=A.icon;return l.jsxs("button",{onClick:()=>{r(A.id),c(!1)},className:`
                    w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition
                    ${t===A.id?"bg-blue-50 text-blue-700 font-medium":"text-gray-700 hover:bg-gray-50"}
                  `,children:[l.jsx(M,{className:"w-5 h-5"}),l.jsx("span",{className:"flex-1",children:A.label}),A.badge&&A.badge>0&&l.jsx("span",{className:"bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full",children:A.badge})]},A.id)})})}),o&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20 lg:hidden",onClick:()=>c(!1)}),l.jsx("main",{className:"flex-1 p-4 sm:p-6 lg:p-8",children:e})]})]})}function pN({isOpen:e,onClose:t,metricType:r,metricTitle:n}){const{profile:a,isAdmin:s}=Pr(),[i,o]=z.useState("client"),[c,u]=z.useState(null),[d,f]=z.useState([]),[h,g]=z.useState([]),[p,x]=z.useState([]),[m,v]=z.useState(!1);z.useEffect(()=>{e&&_()},[e,i,c,r]);const _=async()=>{v(!0);try{i==="client"&&!c?await E():i==="client"&&c?await T():i==="insurer"&&!c?await y():i==="insurer"&&c?await b():i==="type"&&await k()}catch(B){console.error("Error fetching data:",B)}finally{v(!1)}},y=async()=>{const B=r==="policies"||r==="premium",G=B?"policies":"claims";let U=ee.from(G).select(B?"insurance_company_id, insurance_company:insurance_companies(name), premium_amount":"payment_amount, policy:policies!inner(agent_id, insurance_company_id, insurance_company:insurance_companies(name))");B?(U=U.is("archived_at",null).eq("is_deleted",!1),!s&&a&&(U=U.eq("agent_id",a.id))):(U=U.not("policy_id","is",null),!s&&a&&(U=U.eq("policy.agent_id",a.id)));const{data:ne,error:de}=await U;if(de)throw console.error("fetchCompanyStats error:",de),de;console.log("fetchCompanyStats data:",{metricType:r,isPolicyMetric:B,dataLength:ne==null?void 0:ne.length,sampleData:ne==null?void 0:ne[0]});const oe=new Map;ne==null||ne.forEach(se=>{var K,P,V,D;const Z=B?se.insurance_company_id:(K=se.policy)==null?void 0:K.insurance_company_id,H=B?(P=se.insurance_company)==null?void 0:P.name:((D=(V=se.policy)==null?void 0:V.insurance_company)==null?void 0:D.name)||"Bilinmeyen irket";if(!Z){console.log("Skipping item - no companyId:",se);return}oe.has(Z)||oe.set(Z,{company_id:Z,company_name:H,total:0,byType:{}});const ae=oe.get(Z);r==="policies"||r==="claims"?ae.total+=1:r==="premium"?ae.total+=Number(se.premium_amount||0):r==="claimAmount"&&(ae.total+=Number(se.payment_amount||0))});const Y=Array.from(oe.values()).sort((se,Z)=>Z.total-se.total);console.log("fetchCompanyStats result:",Y),f(Y)},b=async()=>{const B=r==="policies"||r==="premium",G=B?"policies":"claims";let U;B?(U=ee.from(G).select("policy_type, premium_amount").eq("insurance_company_id",c).is("archived_at",null).eq("is_deleted",!1),!s&&a&&(U=U.eq("agent_id",a.id))):(U=ee.from(G).select("payment_amount, policy:policies!inner(agent_id, insurance_company_id, policy_type)").eq("policy.insurance_company_id",c),!s&&a&&(U=U.eq("policy.agent_id",a.id)));const{data:ne,error:de}=await U;if(de)throw de;const oe=new Map;ne==null||ne.forEach(se=>{var ae;const Z=B?se.policy_type:((ae=se.policy)==null?void 0:ae.policy_type)||"Bilinmeyen",H=oe.get(Z)||0;r==="policies"||r==="claims"?oe.set(Z,H+1):r==="premium"?oe.set(Z,H+Number(se.premium_amount||0)):r==="claimAmount"&&oe.set(Z,H+Number(se.payment_amount||0))});const Y=Array.from(oe.entries()).map(([se,Z])=>({type:A(se),total:Z}));x(Y.sort((se,Z)=>Z.total-se.total))},E=async()=>{const B=r==="policies"||r==="premium",G=B?"policies":"claims";let U=ee.from(G).select(B?"client_id, client:clients(name, tax_number), premium_amount":"payment_amount, policy:policies!inner(agent_id, client_id, client:clients(name, tax_number))");B?(U=U.is("archived_at",null).eq("is_deleted",!1),!s&&a&&(U=U.eq("agent_id",a.id))):(U=U.not("policy_id","is",null),!s&&a&&(U=U.eq("policy.agent_id",a.id)));const{data:ne,error:de}=await U;if(de)throw de;const oe=new Map;ne==null||ne.forEach(Y=>{var K,P,V,D,R,te,F;const se=B?Y.client_id:(K=Y.policy)==null?void 0:K.client_id;if(!se)return;const Z=B?((P=Y.client)==null?void 0:P.name)||"Bilinmeyen Mteri":((D=(V=Y.policy)==null?void 0:V.client)==null?void 0:D.name)||"Bilinmeyen Mteri",H=B?((R=Y.client)==null?void 0:R.tax_number)||"":((F=(te=Y.policy)==null?void 0:te.client)==null?void 0:F.tax_number)||"";oe.has(se)||oe.set(se,{client_id:se,client_name:Z,client_tax_number:H,total:0});const ae=oe.get(se);r==="policies"||r==="claims"?ae.total+=1:r==="premium"?ae.total+=Number(Y.premium_amount||0):r==="claimAmount"&&(ae.total+=Number(Y.payment_amount||0))}),g(Array.from(oe.values()).sort((Y,se)=>se.total-Y.total))},T=async()=>{const B=r==="policies"||r==="premium",G=B?"policies":"claims";let U;B?(U=ee.from(G).select("policy_type, premium_amount").eq("client_id",c).is("archived_at",null).eq("is_deleted",!1),!s&&a&&(U=U.eq("agent_id",a.id))):(U=ee.from(G).select("payment_amount, policy:policies!inner(agent_id, client_id, policy_type)").eq("policy.client_id",c),!s&&a&&(U=U.eq("policy.agent_id",a.id)));const{data:ne,error:de}=await U;if(de)throw de;const oe=new Map;ne==null||ne.forEach(se=>{var ae;const Z=B?se.policy_type:((ae=se.policy)==null?void 0:ae.policy_type)||"Bilinmeyen",H=oe.get(Z)||0;r==="policies"||r==="claims"?oe.set(Z,H+1):r==="premium"?oe.set(Z,H+Number(se.premium_amount||0)):r==="claimAmount"&&oe.set(Z,H+Number(se.payment_amount||0))});const Y=Array.from(oe.entries()).map(([se,Z])=>({type:A(se),total:Z}));x(Y.sort((se,Z)=>Z.total-se.total))},k=async()=>{const B=r==="policies"||r==="premium",G=B?"policies":"claims";let U;B?(U=ee.from(G).select("policy_type, premium_amount").is("archived_at",null).eq("is_deleted",!1),!s&&a&&(U=U.eq("agent_id",a.id))):(U=ee.from(G).select("payment_amount, policy:policies!inner(agent_id, policy_type)"),!s&&a&&(U=U.eq("policy.agent_id",a.id)));const{data:ne,error:de}=await U;if(de)throw de;const oe=new Map;ne==null||ne.forEach(se=>{var ae;const Z=B?se.policy_type:((ae=se.policy)==null?void 0:ae.policy_type)||"Bilinmeyen",H=oe.get(Z)||0;r==="policies"||r==="claims"?oe.set(Z,H+1):r==="premium"?oe.set(Z,H+Number(se.premium_amount||0)):r==="claimAmount"&&oe.set(Z,H+Number(se.payment_amount||0))});const Y=Array.from(oe.entries()).map(([se,Z])=>({type:A(se),total:Z}));x(Y.sort((se,Z)=>Z.total-se.total))},A=B=>({kasko:"Kasko",trafik:"Trafik",workplace:"yeri",residence:"Konut",health:"Salk",dask:"DASK",group_health:"Grup Salk",group_accident:"Grup Kaza",traffic:"Trafik",comprehensive:"Kasko",property:"Mlk",liability:"Sorumluluk"})[B]||B,M=B=>r==="premium"||r==="claimAmount"?`${B.toLocaleString("tr-TR",{minimumFractionDigits:2})}`:B.toString();return e?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:[n," - Detayl Grnm"]}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition",children:l.jsx(Kt,{className:"w-6 h-6"})})]}),l.jsxs("div",{className:"p-6",children:[s&&l.jsxs("div",{className:"flex gap-2 mb-6",children:[l.jsxs("button",{onClick:()=>{o("client"),u(null)},className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition ${i==="client"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[l.jsx(Os,{className:"w-4 h-4"}),"Mteriye Gre"]}),l.jsxs("button",{onClick:()=>{o("insurer"),u(null)},className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition ${i==="insurer"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[l.jsx(wo,{className:"w-4 h-4"}),"Sigorta irketine Gre"]}),l.jsxs("button",{onClick:()=>{o("type"),u(null)},className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition ${i==="type"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[l.jsx(_c,{className:"w-4 h-4"}),"Brana Gre"]})]}),m?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsxs("div",{className:"overflow-y-auto max-h-[60vh]",children:[i==="client"&&!c&&l.jsxs("div",{className:"space-y-3",children:[h.map(B=>l.jsx("div",{onClick:()=>u(B.client_id),className:"bg-gray-50 rounded-lg p-4 hover:bg-gray-100 cursor-pointer transition border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Os,{className:"w-5 h-5 text-blue-600"}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-900 block",children:B.client_name}),B.client_tax_number&&l.jsxs("span",{className:"text-xs text-gray-500",children:["VKN: ",B.client_tax_number]})]})]}),l.jsx("span",{className:"text-lg font-bold text-blue-600",children:M(B.total)})]})},B.client_id)),h.length===0&&l.jsx("div",{className:"text-center py-8 text-gray-500",children:"Veri bulunamad"})]}),i==="client"&&c&&l.jsxs("div",{children:[l.jsx("button",{onClick:()=>u(null),className:"mb-4 text-blue-600 hover:text-blue-700 font-medium",children:" Mterilere Geri Dn"}),l.jsxs("div",{className:"space-y-3",children:[p.map(B=>l.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(_c,{className:"w-5 h-5 text-green-600"}),l.jsx("span",{className:"font-medium text-gray-900",children:B.type})]}),l.jsx("span",{className:"text-lg font-bold text-green-600",children:M(B.total)})]})},B.type)),p.length===0&&l.jsx("div",{className:"text-center py-8 text-gray-500",children:"Veri bulunamad"})]})]}),i==="insurer"&&!c&&l.jsxs("div",{className:"space-y-3",children:[d.map(B=>l.jsx("div",{onClick:()=>u(B.company_id),className:"bg-gray-50 rounded-lg p-4 hover:bg-gray-100 cursor-pointer transition border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(wo,{className:"w-5 h-5 text-purple-600"}),l.jsx("span",{className:"font-medium text-gray-900",children:B.company_name})]}),l.jsx("span",{className:"text-lg font-bold text-purple-600",children:M(B.total)})]})},B.company_id)),d.length===0&&l.jsx("div",{className:"text-center py-8 text-gray-500",children:"Veri bulunamad"})]}),i==="insurer"&&c&&l.jsxs("div",{children:[l.jsx("button",{onClick:()=>u(null),className:"mb-4 text-blue-600 hover:text-blue-700 font-medium",children:" Sigorta irketlerine Geri Dn"}),l.jsxs("div",{className:"space-y-3",children:[p.map(B=>l.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(_c,{className:"w-5 h-5 text-green-600"}),l.jsx("span",{className:"font-medium text-gray-900",children:B.type})]}),l.jsx("span",{className:"text-lg font-bold text-green-600",children:M(B.total)})]})},B.type)),p.length===0&&l.jsx("div",{className:"text-center py-8 text-gray-500",children:"Veri bulunamad"})]})]}),i==="type"&&l.jsxs("div",{className:"space-y-3",children:[p.map(B=>l.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(_c,{className:"w-5 h-5 text-green-600"}),l.jsx("span",{className:"font-medium text-gray-900",children:B.type})]}),l.jsx("span",{className:"text-lg font-bold text-green-600",children:M(B.total)})]})},B.type)),p.length===0&&l.jsx("div",{className:"text-center py-8 text-gray-500",children:"Veri bulunamad"})]})]})]})]})}):null}function Kx(){const{profile:e,isAdmin:t}=Pr(),[r,n]=z.useState({totalPolicies:0,totalClaims:0,totalPremium:0,earnedPremium:0,totalClaimAmount:0}),[a,s]=z.useState({newPolicies:0,newClaims:0,monthlyPremium:0,expiringPolicies:0}),[i,o]=z.useState([]),[c,u]=z.useState(0),[d,f]=z.useState(0),[h,g]=z.useState(0),[p,x]=z.useState(!0),[m,v]=z.useState(!1),[_,y]=z.useState(null);z.useEffect(()=>{b(),E(),T(),k(),A(),M()},[e]);const b=async()=>{try{x(!0);let Y=ee.from("policies").select("policy_number, premium_amount, start_date, end_date",{count:"exact"}).is("archived_at",null).eq("is_deleted",!1),se=ee.from("claims").select("payment_amount, policy:policies(policy_number)",{count:"exact"});!t&&e&&(Y=Y.eq("agent_id",e.id),se=se.eq("agent_id",e.id));const[{data:Z,count:H},{data:ae,count:K}]=await Promise.all([Y,se]),P=(Z==null?void 0:Z.reduce((J,j)=>J+Number(j.premium_amount),0))||0,V=(ae==null?void 0:ae.reduce((J,j)=>J+Number(j.payment_amount),0))||0,D=new Set((Z==null?void 0:Z.map(J=>J.policy_number))||[]),R=(ae==null?void 0:ae.filter(J=>{var j;return((j=J.policy)==null?void 0:j.policy_number)&&D.has(J.policy.policy_number)}))||[],te=R.reduce((J,j)=>J+Number(j.payment_amount),0),F=new Set(R.map(J=>{var j;return(j=J.policy)==null?void 0:j.policy_number}).filter(Boolean)),q=(Z==null?void 0:Z.filter(J=>F.has(J.policy_number)))||[],X=new Date,L=q.reduce((J,j)=>{const ke=new Date(j.start_date),ue=new Date(j.end_date),ve=Math.max(1,Math.ceil((ue.getTime()-ke.getTime())/(1e3*60*60*24))),he=Math.min(ve,Math.max(0,Math.ceil((X.getTime()-ke.getTime())/(1e3*60*60*24))))/ve;return J+Number(j.premium_amount)*he},0);n({totalPolicies:H||0,totalClaims:K||0,totalPremium:P,earnedPremium:L,totalClaimAmount:te})}catch(Y){console.error("Error fetching stats:",Y)}finally{x(!1)}},E=async()=>{try{const Y=new Date,se=new Date(Y.getFullYear(),Y.getMonth(),1),Z=new Date(Y.getFullYear(),Y.getMonth()+1,0);let H=ee.from("policies").select("premium_amount, start_date").gte("start_date",se.toISOString()).lte("start_date",Z.toISOString()).is("archived_at",null).eq("is_deleted",!1),ae=ee.from("claims").select("id",{count:"exact"}).gte("claim_date",se.toISOString()).lte("claim_date",Z.toISOString()),K=ee.from("policies").select("id",{count:"exact"}).gte("end_date",Y.toISOString()).lte("end_date",new Date(Y.getTime()+30*24*60*60*1e3).toISOString()).is("archived_at",null).eq("is_deleted",!1).eq("status","active");!t&&e&&(H=H.eq("agent_id",e.id),ae=ae.eq("agent_id",e.id),K=K.eq("agent_id",e.id));const[{data:P,count:V},{count:D},{count:R}]=await Promise.all([H,ae,K]),te=(P==null?void 0:P.reduce((F,q)=>F+Number(q.premium_amount),0))||0;s({newPolicies:V||0,newClaims:D||0,monthlyPremium:te,expiringPolicies:R||0})}catch(Y){console.error("Error fetching monthly stats:",Y)}},T=async()=>{try{const Y=new Date,se=new Date(Y.getTime()+30*24*60*60*1e3);let Z=ee.from("policies").select("id, policy_number, end_date, policy_type, insurance_companies(name)").gte("end_date",Y.toISOString()).lte("end_date",se.toISOString()).is("archived_at",null).eq("is_deleted",!1).eq("status","active").order("end_date",{ascending:!0}).limit(5);!t&&e&&(Z=Z.eq("agent_id",e.id));const{data:H}=await Z;o(H||[])}catch(Y){console.error("Error fetching upcoming renewals:",Y)}},k=async()=>{try{const{count:Y}=await ee.from("customer_messages").select("*",{count:"exact",head:!0}).in("status",["new","read"]);u(Y||0)}catch(Y){console.error("Error fetching unanswered messages:",Y)}},A=async()=>{try{const{count:Y}=await ee.from("policy_renewal_requests").select("*",{count:"exact",head:!0}).eq("status","pending");f(Y||0)}catch(Y){console.error("Error fetching pending renewals:",Y)}},M=async()=>{try{const Y=new Date;Y.setHours(0,0,0,0);const{count:se}=await ee.from("client_documents").select("*",{count:"exact",head:!0}).gte("created_at",Y.toISOString());g(se||0)}catch(Y){console.error("Error fetching today documents:",Y)}},B=(Y,se)=>{y({type:Y,title:se}),v(!0)},G=r.earnedPremium>0?r.totalClaimAmount/r.earnedPremium*100:0,U=G<50?"bg-teal-500":G<75?"bg-yellow-500":"bg-red-500",ne=G<50?"ok iyi":G<75?"yi":"Yksek",de=[{title:"Toplam Polie",value:r.totalPolicies,icon:gn,color:"bg-blue-500",metricType:"policies"},{title:"Toplam Hasar",value:r.totalClaims,icon:Rt,color:"bg-red-500",metricType:"claims"},{title:"Toplam Prim",value:`${r.totalPremium.toLocaleString("tr-TR",{minimumFractionDigits:2})}`,icon:cf,color:"bg-green-500",metricType:"premium"},{title:"Toplam Hasar Tutar",value:`${r.totalClaimAmount.toLocaleString("tr-TR",{minimumFractionDigits:2})}`,icon:Ka,color:"bg-orange-500",metricType:"claimAmount"},{title:"Hasar/Prim Frekans",value:r.earnedPremium>0?`%${G.toFixed(1)}`:"-%",subtitle:r.earnedPremium>0?ne:"",icon:$v,color:r.earnedPremium>0?U:"bg-gray-400",metricType:null}];if(p)return l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const oe=()=>{const Y=document.createElement("a");Y.href="/deploy-latest.tar.gz",Y.download="stnsigorta-deployment.tar.gz",document.body.appendChild(Y),Y.click(),document.body.removeChild(Y)};return l.jsxs("div",{children:[l.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Ana Sayfa"}),l.jsxs("p",{className:"text-gray-600 mt-2",children:["Ho geldiniz, ",e==null?void 0:e.full_name]})]}),t&&l.jsxs("button",{onClick:oe,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[l.jsx(Qr,{className:"w-5 h-5"}),"Deployment Dosyas ndir"]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:de.map(Y=>{const se=Y.icon;return l.jsxs("div",{onClick:()=>Y.metricType&&B(Y.metricType,Y.title),className:`bg-white rounded-xl shadow-sm border border-gray-200 p-6 ${Y.metricType?"hover:shadow-lg transition cursor-pointer":""}`,children:[l.jsx("div",{className:"flex items-center justify-between mb-4",children:l.jsx("div",{className:`${Y.color} rounded-lg p-3`,children:l.jsx(se,{className:"w-6 h-6 text-white"})})}),l.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-1",children:Y.title}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Y.value}),Y.subtitle&&l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Y.subtitle})]},Y.title)})}),l.jsxs("div",{className:"mt-8 grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(Kr,{className:"w-5 h-5 text-blue-600"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Bu Ay"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Yeni Polieler"}),l.jsx("p",{className:"text-2xl font-bold text-blue-600",children:a.newPolicies})]}),l.jsx(gn,{className:"w-8 h-8 text-blue-400"})]}),l.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Yeni Hasarlar"}),l.jsx("p",{className:"text-2xl font-bold text-red-600",children:a.newClaims})]}),l.jsx(Rt,{className:"w-8 h-8 text-red-400"})]}),l.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Aylk Prim"}),l.jsxs("p",{className:"text-xl font-bold text-green-600",children:["",a.monthlyPremium.toLocaleString("tr-TR")]})]}),l.jsx(cf,{className:"w-8 h-8 text-green-400"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(ua,{className:"w-5 h-5 text-orange-600"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Kritik Hatrlatclar"})]}),l.jsxs("div",{className:"space-y-3",children:[c>0&&l.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigate",{detail:"messages"})),className:"w-full p-3 bg-orange-50 rounded-lg border border-orange-200 hover:bg-orange-100 transition text-left",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ja,{className:"w-5 h-5 text-orange-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Yantlanmam Mesajlar"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[c," mesaj bekliyor"]})]})]}),l.jsx("span",{className:"bg-orange-600 text-white text-xs font-bold px-2 py-1 rounded-full",children:c})]})}),d>0&&l.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigate",{detail:"renewals"})),className:"w-full p-3 bg-blue-50 rounded-lg border border-blue-200 hover:bg-blue-100 transition text-left",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ji,{className:"w-5 h-5 text-blue-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Bekleyen Yenileme Talepleri"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[d," talep onay bekliyor"]})]})]}),l.jsx("span",{className:"bg-blue-600 text-white text-xs font-bold px-2 py-1 rounded-full",children:d})]})}),h>0&&l.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigate",{detail:"documents"})),className:"w-full p-3 bg-green-50 rounded-lg border border-green-200 hover:bg-green-100 transition text-left",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Bv,{className:"w-5 h-5 text-green-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Bugn Yklenen Dosyalar"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[h," yeni dosya"]})]})]}),l.jsx("span",{className:"bg-green-600 text-white text-xs font-bold px-2 py-1 rounded-full",children:h})]})}),a.expiringPolicies>0&&l.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Kr,{className:"w-5 h-5 text-yellow-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Yaklaan Yenilemeler"}),l.jsxs("p",{className:"text-sm text-gray-600",children:["30 gn iinde ",a.expiringPolicies," polie"]})]})]}),l.jsx("span",{className:"bg-yellow-600 text-white text-xs font-bold px-2 py-1 rounded-full",children:a.expiringPolicies})]})}),c===0&&a.expiringPolicies===0&&l.jsxs("div",{className:"text-center py-8 text-gray-500",children:[l.jsx(ua,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),l.jsx("p",{className:"text-sm",children:"u an kritik hatrlatc yok"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(Ka,{className:"w-5 h-5 text-purple-600"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Yaklaan Yenilemeler"})]}),l.jsx("div",{className:"space-y-2",children:i.length>0?i.map(Y=>{var se;return l.jsx("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-medium text-gray-900 text-sm",children:Y.policy_number}),l.jsx("p",{className:"text-xs text-gray-600 mt-1",children:Y.policy_type}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:((se=Y.insurance_companies)==null?void 0:se.name)||"-"})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-xs text-gray-500",children:"Biti"}),l.jsx("p",{className:"text-xs font-medium text-red-600",children:new Date(Y.end_date).toLocaleDateString("tr-TR")})]})]})},Y.id)}):l.jsxs("div",{className:"text-center py-8 text-gray-500",children:[l.jsx(Kr,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),l.jsx("p",{className:"text-sm",children:"30 gn iinde yenilenecek polie yok"})]})})]})]}),l.jsxs("div",{className:"mt-6 bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Hzl Eriim"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigate",{detail:"policies"})),className:"p-4 bg-blue-50 rounded-lg border border-blue-200 hover:bg-blue-100 transition text-left",children:[l.jsx(gn,{className:"w-8 h-8 text-blue-600 mb-2"}),l.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Polieler"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Tm polielerinizi grntleyin ve ynetin"})]}),l.jsxs("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigate",{detail:"claims"})),className:"p-4 bg-red-50 rounded-lg border border-red-200 hover:bg-red-100 transition text-left",children:[l.jsx(Rt,{className:"w-8 h-8 text-red-600 mb-2"}),l.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Hasarlar"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Hasar kaytlarn inceleyin ve analiz edin"})]}),l.jsxs("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigate",{detail:"analytics"})),className:"p-4 bg-green-50 rounded-lg border border-green-200 hover:bg-green-100 transition text-left",children:[l.jsx(Ka,{className:"w-8 h-8 text-green-600 mb-2"}),l.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Analiz & Raporlar"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Detayl raporlar ve istatistikler"})]})]})]}),_&&l.jsx(pN,{isOpen:m,onClose:()=>{v(!1),y(null)},metricType:_.type,metricTitle:_.title})]})}function gN({pdfUrl:e,onClose:t,policyNumber:r}){const{isAdmin:n}=Pr();z.useEffect(()=>{const s=i=>{i.key==="Escape"&&t()};return document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}},[t]);const a=async()=>{try{const i=await(await fetch(e)).blob(),o=window.URL.createObjectURL(i),c=document.createElement("a");c.href=o,c.download=`polices_${r||"document"}.pdf`,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(o)}catch(s){console.error("PDF indirme hatas:",s),alert("PDF indirilemedi")}};return e?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",children:l.jsxs("div",{className:"relative w-full h-full max-w-6xl max-h-[90vh] m-4 bg-white rounded-lg shadow-2xl flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Polie Grntle"}),l.jsxs("div",{className:"flex items-center gap-2",children:[!n&&l.jsxs("button",{onClick:a,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[l.jsx(Qr,{className:"w-5 h-5"}),"ndir"]}),l.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:l.jsx(Kt,{className:"w-6 h-6"})})]})]}),l.jsx("div",{className:"flex-1 relative overflow-hidden",children:l.jsx("iframe",{src:e,className:"w-full h-full",title:"PDF Viewer",style:{border:"none"}})}),l.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50 text-center",children:l.jsx("p",{className:"text-sm text-gray-600",children:n?"Bu belge sadece grntleme amaldr.":"Polienizi grntleyebilir ve indirebilirsiniz."})})]})}):l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-75",children:l.jsxs("div",{className:"bg-white rounded-lg p-8 text-center",children:[l.jsx("p",{className:"text-gray-600",children:"PDF dosyas bulunamad"}),l.jsx("button",{onClick:t,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Kapat"})]})})}function vN({isOpen:e,onClose:t}){const{profile:r,isAdmin:n,clientId:a}=Pr(),[s,i]=z.useState([]),[o,c]=z.useState(!0);z.useEffect(()=>{e&&u()},[e,r,a]);const u=async()=>{try{c(!0);let d=ee.from("claims").select("license_plate, claim_number, payment_amount, policy_type").not("license_plate","is",null);a?d=d.eq("client_id",a):!n&&r&&(d=d.eq("agent_id",r.id));const{data:f,error:h}=await d;if(h)throw h;const g=new Map;f==null||f.forEach(x=>{if(x.license_plate){const m=g.get(x.license_plate)||{claimNumbers:new Set,total:0,policyType:x.policy_type||"-"};x.claim_number&&m.claimNumbers.add(x.claim_number),m.total+=Number(x.payment_amount||0),g.set(x.license_plate,m)}});const p=Array.from(g.entries()).map(([x,m])=>({plate:x,policyType:m.policyType,uniqueClaimsCount:m.claimNumbers.size,totalAmount:m.total})).sort((x,m)=>m.uniqueClaimsCount-x.uniqueClaimsCount);i(p)}catch(d){console.error("Error fetching top plates:",d)}finally{c(!1)}};return e?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Hasar Skl Analizi"}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition",children:l.jsx(Kt,{className:"w-6 h-6"})})]}),l.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:o?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):s.length===0?l.jsx("div",{className:"text-center py-12",children:l.jsx("p",{className:"text-gray-500",children:"Henz hasar kayd bulunmamaktadr."})}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sra"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Plaka / Detay"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Polie Tr"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Benzersiz Dosya Says"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Toplam Hasar Tutar"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map((d,f)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:f+1}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:d.plate}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.policyType}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.uniqueClaimsCount}),l.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["",d.totalAmount.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]},d.plate))})]})})}),l.jsx("div",{className:"flex justify-end gap-3 p-6 border-t border-gray-200",children:l.jsx("button",{onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"Kapat"})})]})}):null}function yN({clientId:e}){const[t,r]=z.useState(null),[n,a]=z.useState(!0);z.useEffect(()=>{s()},[]);const s=async()=>{var i;try{let o=null;if(e){const{data:c}=await ee.from("clients").select("agent_id").eq("id",e).maybeSingle();o=c==null?void 0:c.agent_id}else{const{data:c}=await ee.from("clients").select("agent_id").eq("user_id",(i=(await ee.auth.getUser()).data.user)==null?void 0:i.id).maybeSingle();o=c==null?void 0:c.agent_id}if(o){const{data:c,error:u}=await ee.from("agency_info").select("*").eq("agent_id",o).maybeSingle();if(u)throw u;r(c)}}catch(o){console.error("Error fetching agency info:",o)}finally{a(!1)}};return n?l.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl shadow-sm border border-blue-200 p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-4 bg-blue-200 rounded w-1/2 mb-4"}),l.jsx("div",{className:"h-20 bg-blue-200 rounded"})]})}):t?l.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl shadow-sm border border-blue-200 p-6",children:[l.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[t.logo_url?l.jsx("img",{src:t.logo_url,alt:t.agency_name,className:"w-16 h-16 rounded-lg object-cover"}):l.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-lg flex items-center justify-center",children:l.jsx(kh,{className:"w-8 h-8 text-white"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:t.agency_name}),l.jsx("p",{className:"text-sm text-gray-600",children:t.contact_person})]})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("a",{href:`tel:${t.phone}`,className:"flex items-center gap-3 text-gray-700 hover:text-blue-600 transition group",children:[l.jsx("div",{className:"w-10 h-10 bg-white rounded-lg flex items-center justify-center group-hover:bg-blue-50 transition",children:l.jsx(Hv,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-xs text-gray-500",children:"Telefon"}),l.jsx("p",{className:"font-medium",children:t.phone})]})]}),l.jsxs("a",{href:`mailto:${t.email}`,className:"flex items-center gap-3 text-gray-700 hover:text-blue-600 transition group",children:[l.jsx("div",{className:"w-10 h-10 bg-white rounded-lg flex items-center justify-center group-hover:bg-blue-50 transition",children:l.jsx(zv,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-xs text-gray-500",children:"E-posta"}),l.jsx("p",{className:"font-medium",children:t.email})]})]}),l.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[l.jsx("div",{className:"w-10 h-10 bg-white rounded-lg flex items-center justify-center",children:l.jsx(iN,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-xs text-gray-500",children:"Adres"}),l.jsx("p",{className:"font-medium text-sm",children:t.address})]})]}),t.working_hours&&l.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[l.jsx("div",{className:"w-10 h-10 bg-white rounded-lg flex items-center justify-center",children:l.jsx(x0,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-xs text-gray-500",children:"alma Saatleri"}),l.jsx("p",{className:"font-medium text-sm",children:t.working_hours})]})]}),t.website&&l.jsxs("a",{href:t.website,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 text-gray-700 hover:text-blue-600 transition group",children:[l.jsx("div",{className:"w-10 h-10 bg-white rounded-lg flex items-center justify-center group-hover:bg-blue-50 transition",children:l.jsx(nN,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-xs text-gray-500",children:"Website"}),l.jsx("p",{className:"font-medium text-sm",children:t.website})]})]})]})]}):null}function _N(){const[e,t]=z.useState([]),[r,n]=z.useState(!0),[a,s]=z.useState([]);z.useEffect(()=>{i();const f=localStorage.getItem("dismissedAnnouncements");f&&s(JSON.parse(f))},[]);const i=async()=>{try{const{data:f,error:h}=await ee.from("announcements").select("*").eq("is_active",!0).order("created_at",{ascending:!1}).limit(5);if(h)throw h;t(f||[])}catch(f){console.error("Error fetching announcements:",f)}finally{n(!1)}},o=f=>{const h=[...a,f];s(h),localStorage.setItem("dismissedAnnouncements",JSON.stringify(h))},c=f=>{switch(f){case"high":return l.jsx(Rt,{className:"w-5 h-5 text-red-600"});case"medium":return l.jsx(ua,{className:"w-5 h-5 text-yellow-600"});case"low":return l.jsx(Gx,{className:"w-5 h-5 text-blue-600"});default:return l.jsx(Gx,{className:"w-5 h-5 text-blue-600"})}},u=f=>{switch(f){case"high":return"from-red-50 to-red-100 border-red-200";case"medium":return"from-yellow-50 to-yellow-100 border-yellow-200";case"low":return"from-blue-50 to-blue-100 border-blue-200";default:return"from-blue-50 to-blue-100 border-blue-200"}},d=e.filter(f=>!a.includes(f.id));return r?l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-4"}),l.jsx("div",{className:"h-20 bg-gray-200 rounded"})]})}):d.length===0?null:l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(ua,{className:"w-5 h-5 text-gray-700"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Duyurular"})]}),l.jsx("div",{className:"space-y-3",children:d.map(f=>l.jsxs("div",{className:`bg-gradient-to-br ${u(f.priority)} rounded-lg border p-4 relative`,children:[l.jsx("button",{onClick:()=>o(f.id),className:"absolute top-2 right-2 text-gray-500 hover:text-gray-700",children:l.jsx(Kt,{className:"w-4 h-4"})}),l.jsxs("div",{className:"flex items-start gap-3 pr-6",children:[l.jsx("div",{className:"mt-0.5",children:c(f.priority)}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:f.title}),l.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-line",children:f.content}),l.jsx("p",{className:"text-xs text-gray-500 mt-2",children:new Date(f.created_at).toLocaleDateString("tr-TR",{day:"numeric",month:"long",year:"numeric"})})]})]})]},f.id))})]})}function wN(){const[e,t]=z.useState([]),[r,n]=z.useState(!0);z.useEffect(()=>{a()},[]);const a=async()=>{var c;try{const u=new Date,d=new Date;d.setDate(u.getDate()+30);const{data:f}=await ee.auth.getUser(),{data:h}=await ee.from("clients").select("id").eq("user_id",(c=f.user)==null?void 0:c.id).single();if(!h)return;const{data:g,error:p}=await ee.from("policies").select(`
          id,
          policy_number,
          policy_type,
          end_date,
          plate_number,
          insured_name,
          insurance_companies (name)
        `).eq("client_id",h.id).gte("end_date",u.toISOString()).lte("end_date",d.toISOString()).order("end_date",{ascending:!0}).limit(5);if(p)throw p;t(g||[])}catch(u){console.error("Error fetching expiring policies:",u)}finally{n(!1)}},s=c=>{const u=new Date,f=new Date(c).getTime()-u.getTime();return Math.ceil(f/(1e3*60*60*24))},i=c=>c<=7?"from-red-50 to-red-100 border-red-200":c<=15?"from-yellow-50 to-yellow-100 border-yellow-200":"from-blue-50 to-blue-100 border-blue-200",o=c=>c<=7?"Acil":c<=15?"Yaklayor":"Yaknda";return r?l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"animate-pulse",children:[l.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),l.jsx("div",{className:"h-20 bg-gray-200 rounded"})]})}):e.length===0?l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(Kr,{className:"w-5 h-5 text-gray-700"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Polie Hatrlatclar"})]}),l.jsx("div",{className:"flex items-center justify-center py-8 text-gray-500",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Kr,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),l.jsx("p",{className:"text-sm",children:"nmzdeki 30 gn iinde yenilenecek polie bulunmuyor"})]})})]}):l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(Kr,{className:"w-5 h-5 text-gray-700"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Polie Hatrlatclar"}),l.jsxs("span",{className:"ml-auto bg-red-100 text-red-700 text-xs font-semibold px-2.5 py-1 rounded-full",children:[e.length," Polie"]})]}),l.jsx("div",{className:"space-y-3",children:e.map(c=>{var d;const u=s(c.end_date);return l.jsx("div",{className:`bg-gradient-to-br ${i(u)} rounded-lg border p-4`,children:l.jsxs("div",{className:"flex items-start justify-between gap-3",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("h4",{className:"font-semibold text-gray-900",children:c.policy_number}),l.jsx("span",{className:"text-xs font-medium text-gray-600 bg-white px-2 py-0.5 rounded",children:c.policy_type})]}),l.jsx("p",{className:"text-sm text-gray-700 mb-1",children:((d=c.insurance_companies)==null?void 0:d.name)||"Bilinmiyor"}),(c.plate_number||c.insured_name)&&l.jsx("p",{className:"text-xs text-gray-600",children:c.plate_number||c.insured_name}),l.jsxs("div",{className:"flex items-center gap-1 mt-2 text-xs text-gray-600",children:[l.jsx(Kr,{className:"w-3 h-3"}),l.jsxs("span",{children:["Biti: ",new Date(c.end_date).toLocaleDateString("tr-TR")]})]})]}),l.jsxs("div",{className:"flex flex-col items-end gap-1",children:[l.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 rounded-full text-xs font-semibold ${u<=7?"bg-red-600 text-white":u<=15?"bg-yellow-600 text-white":"bg-blue-600 text-white"}`,children:[u<=7&&l.jsx(QS,{className:"w-3 h-3"}),o(u)]}),l.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[u," gn"]})]})]})},c.id)})}),l.jsx("div",{className:"mt-4 bg-gray-50 rounded-lg p-3",children:l.jsxs("p",{className:"text-xs text-gray-600",children:[l.jsx("strong",{children:"Not:"})," Polielerinizin yenilenmesi iin acente yetkiliniz ile iletiime gemeyi unutmayn."]})})]})}function bN({isOpen:e,onClose:t}){const[r,n]=z.useState(""),[a,s]=z.useState(""),[i,o]=z.useState("medium"),[c,u]=z.useState(!1),d=async f=>{var h;f.preventDefault(),u(!0);try{const{data:g}=await ee.auth.getUser(),{data:p,error:x}=await ee.from("clients").select("id, agent_id").eq("user_id",(h=g.user)==null?void 0:h.id).single();if(x)throw x;const{error:m}=await ee.from("customer_messages").insert({client_id:p.id,agent_id:p.agent_id,subject:r,message:a,priority:i,status:"new"});if(m)throw m;alert("Mesajnz baaryla gnderildi. En ksa srede size dn yaplacaktr."),n(""),s(""),o("medium"),t()}catch(g){console.error("Error sending message:",g),alert("Mesaj gnderilirken bir hata olutu.")}finally{u(!1)}};return e?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Destek Talebi"}),l.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 transition",children:l.jsx(Kt,{className:"w-6 h-6"})})]}),l.jsxs("form",{onSubmit:d,className:"p-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ncelik Dzeyi"}),l.jsxs("select",{value:i,onChange:f=>o(f.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[l.jsx("option",{value:"low",children:"Dk - Genel Bilgi"}),l.jsx("option",{value:"medium",children:"Orta - Normal Talep"}),l.jsx("option",{value:"high",children:"Yksek - Acil Durum"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Konu"}),l.jsx("input",{type:"text",value:r,onChange:f=>n(f.target.value),placeholder:"rn: Polie Yenileme Talebi",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mesajnz"}),l.jsx("textarea",{value:a,onChange:f=>s(f.target.value),placeholder:"Ltfen talebinizi detayl olarak aklayn...",rows:6,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",required:!0})]}),l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("p",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Not:"})," Mesajnz acente yetkilinize iletilecektir. Normal mesajlar 24 saat iinde, acil talepler ise en ksa srede yantlanacaktr."]})})]}),l.jsxs("div",{className:"flex gap-3 justify-end mt-6",children:[l.jsx("button",{type:"button",onClick:t,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",disabled:c,children:"ptal"}),l.jsxs("button",{type:"submit",disabled:c,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[l.jsx(uN,{className:"w-4 h-4"}),c?"Gnderiliyor...":"Gnder"]})]})]})]})}):null}function kN({policies:e,claims:t,visibilitySettings:r}){const n=()=>{const h={};return e.forEach(g=>{const p=g.policy_type;h[p]=(h[p]||0)+1}),Object.entries(h).map(([g,p])=>({type:g,count:p,percentage:p/e.length*100}))},a=()=>{const h={},g=new Date;for(let m=5;m>=0;m--){const _=new Date(g.getFullYear(),g.getMonth()-m,1).toLocaleDateString("tr-TR",{month:"short",year:"numeric"});h[_]=0}e.forEach(m=>{const _=new Date(m.start_date).toLocaleDateString("tr-TR",{month:"short",year:"numeric"});h.hasOwnProperty(_)&&(h[_]+=Number(m.premium_amount))});const p=Object.values(h),x=Math.max(...p,1);return Object.entries(h).map(([m,v])=>({month:m,amount:v,percentage:v/x*100}))},s=()=>{const h={},g=new Date;for(let x=5;x>=0;x--){const v=new Date(g.getFullYear(),g.getMonth()-x,1).toLocaleDateString("tr-TR",{month:"short",year:"numeric"});h[v]={count:0,amount:0}}t.forEach(x=>{const v=new Date(x.claim_date).toLocaleDateString("tr-TR",{month:"short",year:"numeric"});h.hasOwnProperty(v)&&(h[v].count+=1,h[v].amount+=Number(x.payment_amount))});const p=Math.max(...Object.values(h).map(x=>x.count),1);return Object.entries(h).map(([x,m])=>({month:x,count:m.count,amount:m.amount,percentage:m.count/p*100}))},i=()=>{const h={};return e.forEach(g=>{var x;const p=((x=g.insurance_companies)==null?void 0:x.name)||"Dier";h[p]=(h[p]||0)+1}),Object.entries(h).sort((g,p)=>p[1]-g[1]).slice(0,5).map(([g,p])=>({company:g,count:p,percentage:p/e.length*100}))},o=n(),c=a(),u=s(),d=i(),f=["bg-blue-500","bg-green-500","bg-yellow-500","bg-red-500","bg-purple-500","bg-pink-500","bg-indigo-500"];return e.length===0?null:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[r.show_premium_distribution&&l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[l.jsx(Ka,{className:"w-5 h-5 text-blue-600"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Aylk Prim Dalm"})]}),l.jsx("div",{className:"space-y-3",children:c.map((h,g)=>l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[l.jsx("span",{className:"text-gray-600",children:h.month}),l.jsxs("span",{className:"font-semibold text-gray-900",children:["",h.amount.toLocaleString("tr-TR")]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${h.percentage}%`}})})]},g))})]}),r.show_policy_types&&l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[l.jsx(cN,{className:"w-5 h-5 text-green-600"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Polie Trleri"})]}),l.jsx("div",{className:"space-y-3",children:o.map((h,g)=>l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-4 h-4 rounded ${f[g%f.length]}`}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[l.jsx("span",{className:"text-gray-900 font-medium capitalize",children:h.type}),l.jsxs("span",{className:"text-gray-600",children:[h.count," polie (",h.percentage.toFixed(0),"%)"]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:`${f[g%f.length]} h-2 rounded-full transition-all duration-500`,style:{width:`${h.percentage}%`}})})]})]},g))})]}),r.show_claims_trend&&t.length>0&&l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[l.jsx(Kr,{className:"w-5 h-5 text-red-600"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Hasar Trend Analizi"})]}),l.jsx("div",{className:"space-y-3",children:u.map((h,g)=>l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[l.jsx("span",{className:"text-gray-600",children:h.month}),l.jsxs("div",{className:"text-right",children:[l.jsxs("span",{className:"font-semibold text-gray-900",children:[h.count," hasar"]}),h.amount>0&&l.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",h.amount.toLocaleString("tr-TR"),")"]})]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-gradient-to-r from-red-500 to-red-600 h-2 rounded-full transition-all duration-500",style:{width:`${h.percentage}%`}})})]},g))})]}),r.show_insurance_companies&&l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[l.jsx(cf,{className:"w-5 h-5 text-purple-600"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Sigorta irketleri"})]}),l.jsx("div",{className:"space-y-3",children:d.map((h,g)=>l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[l.jsx("span",{className:"text-gray-900 font-medium",children:h.company}),l.jsxs("span",{className:"text-gray-600",children:[h.count," polie (",h.percentage.toFixed(0),"%)"]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-gradient-to-r from-purple-500 to-purple-600 h-2 rounded-full transition-all duration-500",style:{width:`${h.percentage}%`}})})]},g))})]})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var bo={};bo.version="0.18.5";var Yr=1200,Rs=1252,SN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Th={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Q0=function(e){SN.indexOf(e)!=-1&&(Rs=Th[0]=e)};function NN(){Q0(1252)}var xn=function(e){Yr=e,Q0(e)};function Z0(){xn(1200),NN()}function v0(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function EN(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Vv(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Ai=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?EN(e.slice(2)):t==254&&r==255?Vv(e.slice(2)):t==65279?e.slice(1):e},Pl=function(t){return String.fromCharCode(t)},df=function(t){return String.fromCharCode(t)},qe;function TN(e){qe=e,xn=function(t){Yr=t,Q0(t)},Ai=function(t){return t.charCodeAt(0)===255&&t.charCodeAt(1)===254?qe.utils.decode(1200,v0(t.slice(2))):t},Pl=function(r){return Yr===1200?String.fromCharCode(r):qe.utils.decode(Yr,[r&255,r>>8])[0]},df=function(r){return qe.utils.decode(Rs,[r])[0]},_y()}var Ra="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ko(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=Ra.charAt(s)+Ra.charAt(i)+Ra.charAt(o)+Ra.charAt(c);return t}function Zr(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=Ra.indexOf(e.charAt(u++)),i=Ra.indexOf(e.charAt(u++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=Ra.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=Ra.indexOf(e.charAt(u++)),a=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var ze=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),va=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Qa(e){return ze?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function qx(e){return ze?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Wr=function(t){return ze?va(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ho(e){if(typeof ArrayBuffer>"u")return Wr(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function is(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function jN(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function jh(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return jh(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Jt=ze?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:va(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function CN(e){for(var t=[],r=0,n=e.length+250,a=Qa(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Qa(65535),n=65530)}return t.push(a.slice(0,r)),Jt(t)}var gr=/\u0000/g,Dl=/[\u0001-\u0006]/g;function Mi(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Fn(e,t){var r=""+e;return r.length>=t?r:Tt("0",t-r.length)+r}function Ch(e,t){var r=""+e;return r.length>=t?r:Tt(" ",t-r.length)+r}function y0(e,t){var r=""+e;return r.length>=t?r:r+Tt(" ",t-r.length)}function AN(e,t){var r=""+Math.round(e);return r.length>=t?r:Tt("0",t-r.length)+r}function FN(e,t){var r=""+e;return r.length>=t?r:Tt("0",t-r.length)+r}var Xx=Math.pow(2,32);function di(e,t){if(e>Xx||e<-Xx)return AN(e,t);var r=Math.round(e);return FN(r,t)}function _0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Yx=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Vu=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function PN(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Fe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Jx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},DN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function w0(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,c=1,u=0,d=0,f=Math.floor(a);u<t&&(f=Math.floor(a),o=f*i+s,d=f*u+c,!(a-f<5e-8));)a=1/(a-f),s=i,i=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=s):(d=u,o=i)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function Ia(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=BN(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var Gv=new Date(1899,11,31,0,0,0),ON=Gv.getTime(),RN=new Date(1900,2,1,0,0,0);function Kv(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=RN&&(r+=24*60*60*1e3),(r-(ON+(e.getTimezoneOffset()-Gv.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ah(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function IN(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function LN(e){var t=e<0?12:11,r=Ah(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function MN(e){var t=Ah(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function So(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=LN(e):t===10?r=e.toFixed(10).substr(0,12):r=MN(e),Ah(IN(r.toUpperCase()))}function Is(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):So(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return en(14,Kv(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function BN(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function UN(e,t,r,n){var a="",s=0,i=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Vu[r.m-1][1];case 5:return Vu[r.m-1][0];default:return Vu[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return Yx[r.q][0];default:return Yx[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Fn(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=Fn(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?Fn(c,u):"";return d}function La(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var qv=/%/g;function zN(e,t,r){var n=t.replace(qv,""),a=t.length-n.length;return da(e,n,r*Math.pow(10,2*a))+Tt("%",a)}function $N(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return da(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Xv(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Xv(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Yv=/# (\?+)( ?)\/( ?)(\d+)/;function HN(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?Tt(" ",e[1].length+1+e[4].length):Ch(i,e[1].length)+e[2]+"/"+e[3]+Fn(o,e[4].length))}function WN(e,t,r){return r+(t===0?"":""+t)+Tt(" ",e[1].length+2+e[4].length)}var Jv=/^#*0*\.([0#]+)/,Qv=/\).*[0#]/,Zv=/\(###\) ###\\?-####/;function Er(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Qx(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Zx(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function VN(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function GN(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ln(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Qv)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ln("n",n,r):"("+ln("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return $N(e,t,r);if(t.indexOf("%")!==-1)return zN(e,t,r);if(t.indexOf("E")!==-1)return Xv(t,r);if(t.charCodeAt(0)===36)return"$"+ln(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+di(c,t.length);if(t.match(/^[#?]+$/))return a=di(r,0),a==="0"&&(a=""),a.length>t.length?a:Er(t.substr(0,t.length-a.length))+a;if(s=t.match(Yv))return HN(s,c,u);if(t.match(/^#+0+$/))return u+di(c,t.length-t.indexOf("0"));if(s=t.match(Jv))return a=Qx(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Er(s[1])).replace(/\.$/,"."+Er(s[1])).replace(/\.(\d*)$/,function(p,x){return"."+x+Tt("0",Er(s[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+Qx(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+La(di(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ln(e,t,-r):La(""+(Math.floor(r)+VN(r,s[1].length)))+"."+Fn(Zx(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return ln(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Mi(ln(e,t.replace(/[\\-]/g,""),r)),i=0,Mi(Mi(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<a.length?a.charAt(i++):p==="0"?"0":""}));if(t.match(Zv))return a=ln(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=w0(c,Math.pow(10,i)-1,!1),a=""+u,d=da("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=y0(o[2],i),d.length<s[4].length&&(d=Er(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=w0(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ch(o[1],i)+s[2]+"/"+s[3]+y0(o[2],i):Tt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=di(r,0),t.length<=a.length?a:Er(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=t.indexOf(".")-i,h=t.length-a.length-f;return Er(t.substr(0,f)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=Zx(r,s[1].length),r<0?"-"+ln(e,t,-r):La(GN(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Fn(0,3-p.length):"")+p})+"."+Fn(i,s[1].length);switch(t){case"###,##0.00":return ln(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=La(di(c,0));return g!=="0"?u+g:"";case"###,###.00":return ln(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ln(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function KN(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return da(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function qN(e,t,r){var n=t.replace(qv,""),a=t.length-n.length;return da(e,n,r*Math.pow(10,2*a))+Tt("%",a)}function ey(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ey(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function zn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Qv)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?zn("n",n,r):"("+zn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return KN(e,t,r);if(t.indexOf("%")!==-1)return qN(e,t,r);if(t.indexOf("E")!==-1)return ey(t,r);if(t.charCodeAt(0)===36)return"$"+zn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Fn(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Er(t.substr(0,t.length-a.length))+a;if(s=t.match(Yv))return WN(s,c,u);if(t.match(/^#+0+$/))return u+Fn(c,t.length-t.indexOf("0"));if(s=t.match(Jv))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Er(s[1])).replace(/\.$/,"."+Er(s[1])),a=a.replace(/\.(\d*)$/,function(p,x){return"."+x+Tt("0",Er(s[1]).length-x.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+La(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+zn(e,t,-r):La(""+r)+"."+Tt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return zn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Mi(zn(e,t.replace(/[\\-]/g,""),r)),i=0,Mi(Mi(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<a.length?a.charAt(i++):p==="0"?"0":""}));if(t.match(Zv))return a=zn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=w0(c,Math.pow(10,i)-1,!1),a=""+u,d=da("n",s[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=y0(o[2],i),d.length<s[4].length&&(d=Er(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=w0(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Ch(o[1],i)+s[2]+"/"+s[3]+y0(o[2],i):Tt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Er(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var f=t.indexOf(".")-i,h=t.length-a.length-f;return Er(t.substr(0,f)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+zn(e,t,-r):La(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Fn(0,3-p.length):"")+p})+"."+Fn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=La(""+c);return g!=="0"?u+g:"";default:if(t.match(/\.[0#?]*$/))return zn(e,t.slice(0,t.lastIndexOf(".")),r)+Er(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function da(e,t,r){return(r|0)===r?zn(e,t,r):ln(e,t,r)}function XN(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var ty=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ks(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":_0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(ty))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function YN(e,t,r,n){for(var a=[],s="",i=0,o="",c="t",u,d,f,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!_0(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(f=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++i;break;case"\\":var g=e.charAt(++i),p=g==="("||g===")"?g:"t";a[a.length]={t:p,v:g},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=Ia(t,r,e.charAt(i+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Ia(t,r),u==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:s},c=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=Ia(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",i+=5,h="h"):(x.t="t",++i),u==null&&x.t==="T")return"";a[a.length]=x,c=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(ty)){if(u==null&&(u=Ia(t,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ks(e)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var m=0,v=0,_;for(i=a.length-1,c="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=h,c="h",m<1&&(m=1);break;case"s":(_=a[i].v.match(/\.0+$/))&&(v=Math.max(v,_[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":c=a[i].t;break;case"m":c==="s"&&(a[i].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&a[i].v.match(/[Hh]/)&&(m=1),m<2&&a[i].v.match(/[Mm]/)&&(m=2),m<3&&a[i].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",b;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=UN(a[i].t.charCodeAt(0),a[i].v,u,v),a[i].t="t";break;case"n":case"?":for(b=i+1;a[b]!=null&&((o=a[b].t)==="?"||o==="D"||(o===" "||o==="t")&&a[b+1]!=null&&(a[b+1].t==="?"||a[b+1].t==="t"&&a[b+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[b].v==="/"||a[b].v===" "&&a[b+1]!=null&&a[b+1].t=="?"));)a[i].v+=a[b].v,a[b]={v:"",t:";"},++b;y+=a[i].v,i=b-1;break;case"G":a[i].t="t",a[i].v=Is(t,r);break}var E="",T,k;if(y.length>0){y.charCodeAt(0)==40?(T=t<0&&y.charCodeAt(0)===45?-t:t,k=da("n",y,T)):(T=t<0&&n>1?-t:t,k=da("n",y,T),T<0&&a[0]&&a[0].t=="t"&&(k=k.substr(1),a[0].v="-"+a[0].v)),b=k.length-1;var A=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){A=i;break}var M=a.length;if(A===a.length&&k.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(b>=a[i].v.length-1?(b-=a[i].v.length,a[i].v=k.substr(b+1,a[i].v.length)):b<0?a[i].v="":(a[i].v=k.substr(0,b+1),b=-1),a[i].t="t",M=i);b>=0&&M<a.length&&(a[M].v=k.substr(0,b+1)+a[M].v)}else if(A!==a.length&&k.indexOf("E")===-1){for(b=k.indexOf(".")-1,i=A;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(d=a[i].v.indexOf(".")>-1&&i===A?a[i].v.indexOf(".")-1:a[i].v.length-1,E=a[i].v.substr(d+1);d>=0;--d)b>=0&&(a[i].v.charAt(d)==="0"||a[i].v.charAt(d)==="#")&&(E=k.charAt(b--)+E);a[i].v=E,a[i].t="t",M=i}for(b>=0&&M<a.length&&(a[M].v=k.substr(0,b+1)+a[M].v),b=k.indexOf(".")+1,i=A;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==A)){for(d=a[i].v.indexOf(".")>-1&&i===A?a[i].v.indexOf(".")+1:0,E=a[i].v.substr(0,d);d<a[i].v.length;++d)b<k.length&&(E+=k.charAt(b++));a[i].v=E,a[i].t="t",M=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(T=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=da(a[i].t,a[i].v,T),a[i].t="t");var B="";for(i=0;i!==a.length;++i)a[i]!=null&&(B+=a[i].v);return B}var ep=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function tp(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function JN(e,t){var r=XN(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(ep),o=r[1].match(ep);return tp(t,i)?[n,r[0]]:tp(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function en(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Fe)[e],n==null&&(n=r.table&&r.table[Jx[e]]||Fe[Jx[e]]),n==null&&(n=DN[e]||"General");break}if(_0(n,0))return Is(t,r);t instanceof Date&&(t=Kv(t,r.date1904));var a=JN(n,t);if(_0(a[1]))return Is(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return YN(a[1],t,r,a[0])}function Xn(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Fe[r]==null){t<0&&(t=r);continue}if(Fe[r]==e){t=r;break}}t<0&&(t=391)}return Fe[t]=e,t}function Wo(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Xn(e[t],t)}function ll(){Fe=PN()}var ry={format:en,load:Xn,_table:Fe,load_table:Wo,parse_date_code:Ia,is_date:Ks,get_table:function(){return ry._table=Fe}},QN={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ny=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ZN(e){var t=typeof e=="number"?Fe[e]:e;return t=t.replace(ny,"(\\d+)"),new RegExp("^"+t+"$")}function e4(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,c=-1;(t.match(ny)||[]).forEach(function(f,h){var g=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=g;break;case"d":s=g;break;case"h":i=g;break;case"s":c=g;break;case"m":i>=0?o=g:a=g;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?u:n==-1&&a==-1&&s==-1?d:u+"T"+d}var t4=function(){var e={};e.version="1.2.0";function t(){for(var k=0,A=new Array(256),M=0;M!=256;++M)k=M,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,A[M]=k;return typeof Int32Array<"u"?new Int32Array(A):A}var r=t();function n(k){var A=0,M=0,B=0,G=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)G[B]=k[B];for(B=0;B!=256;++B)for(M=k[B],A=256+B;A<4096;A+=256)M=G[A]=M>>>8^k[M&255];var U=[];for(B=1;B!=16;++B)U[B-1]=typeof Int32Array<"u"?G.subarray(B*256,B*256+256):G.slice(B*256,B*256+256);return U}var a=n(r),s=a[0],i=a[1],o=a[2],c=a[3],u=a[4],d=a[5],f=a[6],h=a[7],g=a[8],p=a[9],x=a[10],m=a[11],v=a[12],_=a[13],y=a[14];function b(k,A){for(var M=A^-1,B=0,G=k.length;B<G;)M=M>>>8^r[(M^k.charCodeAt(B++))&255];return~M}function E(k,A){for(var M=A^-1,B=k.length-15,G=0;G<B;)M=y[k[G++]^M&255]^_[k[G++]^M>>8&255]^v[k[G++]^M>>16&255]^m[k[G++]^M>>>24]^x[k[G++]]^p[k[G++]]^g[k[G++]]^h[k[G++]]^f[k[G++]]^d[k[G++]]^u[k[G++]]^c[k[G++]]^o[k[G++]]^i[k[G++]]^s[k[G++]]^r[k[G++]];for(B+=15;G<B;)M=M>>>8^r[(M^k[G++])&255];return~M}function T(k,A){for(var M=A^-1,B=0,G=k.length,U=0,ne=0;B<G;)U=k.charCodeAt(B++),U<128?M=M>>>8^r[(M^U)&255]:U<2048?(M=M>>>8^r[(M^(192|U>>6&31))&255],M=M>>>8^r[(M^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,ne=k.charCodeAt(B++)&1023,M=M>>>8^r[(M^(240|U>>8&7))&255],M=M>>>8^r[(M^(128|U>>2&63))&255],M=M>>>8^r[(M^(128|ne>>6&15|(U&3)<<4))&255],M=M>>>8^r[(M^(128|ne&63))&255]):(M=M>>>8^r[(M^(224|U>>12&15))&255],M=M>>>8^r[(M^(128|U>>6&63))&255],M=M>>>8^r[(M^(128|U&63))&255]);return~M}return e.table=r,e.bstr=b,e.buf=E,e.str=T,e}(),Ce=function(){var t={};t.version="1.2.1";function r(w,N){for(var S=w.split("/"),C=N.split("/"),O=0,I=0,re=Math.min(S.length,C.length);O<re;++O){if(I=S[O].length-C[O].length)return I;if(S[O]!=C[O])return S[O]<C[O]?-1:1}return S.length-C.length}function n(w){if(w.charAt(w.length-1)=="/")return w.slice(0,-1).indexOf("/")===-1?w:n(w.slice(0,-1));var N=w.lastIndexOf("/");return N===-1?w:w.slice(0,N+1)}function a(w){if(w.charAt(w.length-1)=="/")return a(w.slice(0,-1));var N=w.lastIndexOf("/");return N===-1?w:w.slice(N+1)}function s(w,N){typeof N=="string"&&(N=new Date(N));var S=N.getHours();S=S<<6|N.getMinutes(),S=S<<5|N.getSeconds()>>>1,w.write_shift(2,S);var C=N.getFullYear()-1980;C=C<<4|N.getMonth()+1,C=C<<5|N.getDate(),w.write_shift(2,C)}function i(w){var N=w.read_shift(2)&65535,S=w.read_shift(2)&65535,C=new Date,O=S&31;S>>>=5;var I=S&15;S>>>=4,C.setMilliseconds(0),C.setFullYear(S+1980),C.setMonth(I-1),C.setDate(O);var re=N&31;N>>>=5;var ie=N&63;return N>>>=6,C.setHours(N),C.setMinutes(ie),C.setSeconds(re<<1),C}function o(w){rr(w,0);for(var N={},S=0;w.l<=w.length-4;){var C=w.read_shift(2),O=w.read_shift(2),I=w.l+O,re={};switch(C){case 21589:S=w.read_shift(1),S&1&&(re.mtime=w.read_shift(4)),O>5&&(S&2&&(re.atime=w.read_shift(4)),S&4&&(re.ctime=w.read_shift(4))),re.mtime&&(re.mt=new Date(re.mtime*1e3));break}w.l=I,N[C]=re}return N}var c;function u(){return c||(c={})}function d(w,N){if(w[0]==80&&w[1]==75)return kn(w,N);if((w[0]|32)==109&&(w[1]|32)==105)return Mn(w,N);if(w.length<512)throw new Error("CFB file size "+w.length+" < 512");var S=3,C=512,O=0,I=0,re=0,ie=0,W=0,Q=[],le=w.slice(0,512);rr(le,0);var me=f(le);switch(S=me[0],S){case 3:C=512;break;case 4:C=4096;break;case 0:if(me[1]==0)return kn(w,N);default:throw new Error("Major Version: Expected 3 or 4 saw "+S)}C!==512&&(le=w.slice(0,C),rr(le,28));var _e=w.slice(0,C);h(le,S);var Ne=le.read_shift(4,"i");if(S===3&&Ne!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ne);le.l+=4,re=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),ie=le.read_shift(4,"i"),O=le.read_shift(4,"i"),W=le.read_shift(4,"i"),I=le.read_shift(4,"i");for(var pe=-1,Se=0;Se<109&&(pe=le.read_shift(4,"i"),!(pe<0));++Se)Q[Se]=pe;var Oe=g(w,C);m(W,I,Oe,C,Q);var _t=_(Oe,re,Q,C);_t[re].name="!Directory",O>0&&ie!==ne&&(_t[ie].name="!MiniFAT"),_t[Q[0]].name="!FAT",_t.fat_addrs=Q,_t.ssz=C;var wt={},or=[],hl=[],ml=[];y(re,_t,Oe,or,O,wt,hl,ie),p(hl,ml,or),or.shift();var xl={FileIndex:hl,FullPaths:ml};return N&&N.raw&&(xl.raw={header:_e,sectors:Oe}),xl}function f(w){if(w[w.l]==80&&w[w.l+1]==75)return[0,0];w.chk(de,"Header Signature: "),w.l+=16;var N=w.read_shift(2,"u");return[w.read_shift(2,"u"),N]}function h(w,N){var S=9;switch(w.l+=2,S=w.read_shift(2)){case 9:if(N!=3)throw new Error("Sector Shift: Expected 9 saw "+S);break;case 12:if(N!=4)throw new Error("Sector Shift: Expected 12 saw "+S);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+S)}w.chk("0600","Mini Sector Shift: "),w.chk("000000000000","Reserved: ")}function g(w,N){for(var S=Math.ceil(w.length/N)-1,C=[],O=1;O<S;++O)C[O-1]=w.slice(O*N,(O+1)*N);return C[S-1]=w.slice(S*N),C}function p(w,N,S){for(var C=0,O=0,I=0,re=0,ie=0,W=S.length,Q=[],le=[];C<W;++C)Q[C]=le[C]=C,N[C]=S[C];for(;ie<le.length;++ie)C=le[ie],O=w[C].L,I=w[C].R,re=w[C].C,Q[C]===C&&(O!==-1&&Q[O]!==O&&(Q[C]=Q[O]),I!==-1&&Q[I]!==I&&(Q[C]=Q[I])),re!==-1&&(Q[re]=C),O!==-1&&C!=Q[C]&&(Q[O]=Q[C],le.lastIndexOf(O)<ie&&le.push(O)),I!==-1&&C!=Q[C]&&(Q[I]=Q[C],le.lastIndexOf(I)<ie&&le.push(I));for(C=1;C<W;++C)Q[C]===C&&(I!==-1&&Q[I]!==I?Q[C]=Q[I]:O!==-1&&Q[O]!==O&&(Q[C]=Q[O]));for(C=1;C<W;++C)if(w[C].type!==0){if(ie=C,ie!=Q[ie])do ie=Q[ie],N[C]=N[ie]+"/"+N[C];while(ie!==0&&Q[ie]!==-1&&ie!=Q[ie]);Q[C]=-1}for(N[0]+="/",C=1;C<W;++C)w[C].type!==2&&(N[C]+="/")}function x(w,N,S){for(var C=w.start,O=w.size,I=[],re=C;S&&O>0&&re>=0;)I.push(N.slice(re*U,re*U+U)),O-=U,re=vs(S,re*4);return I.length===0?ce(0):Jt(I).slice(0,w.size)}function m(w,N,S,C,O){var I=ne;if(w===ne){if(N!==0)throw new Error("DIFAT chain shorter than expected")}else if(w!==-1){var re=S[w],ie=(C>>>2)-1;if(!re)return;for(var W=0;W<ie&&(I=vs(re,W*4))!==ne;++W)O.push(I);m(vs(re,C-4),N-1,S,C,O)}}function v(w,N,S,C,O){var I=[],re=[];O||(O=[]);var ie=C-1,W=0,Q=0;for(W=N;W>=0;){O[W]=!0,I[I.length]=W,re.push(w[W]);var le=S[Math.floor(W*4/C)];if(Q=W*4&ie,C<4+Q)throw new Error("FAT boundary crossed: "+W+" 4 "+C);if(!w[le])break;W=vs(w[le],Q)}return{nodes:I,data:hp([re])}}function _(w,N,S,C){var O=w.length,I=[],re=[],ie=[],W=[],Q=C-1,le=0,me=0,_e=0,Ne=0;for(le=0;le<O;++le)if(ie=[],_e=le+N,_e>=O&&(_e-=O),!re[_e]){W=[];var pe=[];for(me=_e;me>=0;){pe[me]=!0,re[me]=!0,ie[ie.length]=me,W.push(w[me]);var Se=S[Math.floor(me*4/C)];if(Ne=me*4&Q,C<4+Ne)throw new Error("FAT boundary crossed: "+me+" 4 "+C);if(!w[Se]||(me=vs(w[Se],Ne),pe[me]))break}I[_e]={nodes:ie,data:hp([W])}}return I}function y(w,N,S,C,O,I,re,ie){for(var W=0,Q=C.length?2:0,le=N[w].data,me=0,_e=0,Ne;me<le.length;me+=128){var pe=le.slice(me,me+128);rr(pe,64),_e=pe.read_shift(2),Ne=nu(pe,0,_e-Q),C.push(Ne);var Se={name:Ne,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},Oe=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);Oe!==0&&(Se.ct=b(pe,pe.l-8));var _t=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);_t!==0&&(Se.mt=b(pe,pe.l-8)),Se.start=pe.read_shift(4,"i"),Se.size=pe.read_shift(4,"i"),Se.size<0&&Se.start<0&&(Se.size=Se.type=0,Se.start=ne,Se.name=""),Se.type===5?(W=Se.start,O>0&&W!==ne&&(N[W].name="!StreamData")):Se.size>=4096?(Se.storage="fat",N[Se.start]===void 0&&(N[Se.start]=v(S,Se.start,N.fat_addrs,N.ssz)),N[Se.start].name=Se.name,Se.content=N[Se.start].data.slice(0,Se.size)):(Se.storage="minifat",Se.size<0?Se.size=0:W!==ne&&Se.start!==ne&&N[W]&&(Se.content=x(Se,N[W].data,(N[ie]||{}).data))),Se.content&&rr(Se.content,0),I[Ne]=Se,re.push(Se)}}function b(w,N){return new Date((Yt(w,N+4)/1e7*Math.pow(2,32)+Yt(w,N)/1e7-11644473600)*1e3)}function E(w,N){return u(),d(c.readFileSync(w),N)}function T(w,N){var S=N&&N.type;switch(S||ze&&Buffer.isBuffer(w)&&(S="buffer"),S||"base64"){case"file":return E(w,N);case"base64":return d(Wr(Zr(w)),N);case"binary":return d(Wr(w),N)}return d(w,N)}function k(w,N){var S=N||{},C=S.root||"Root Entry";if(w.FullPaths||(w.FullPaths=[]),w.FileIndex||(w.FileIndex=[]),w.FullPaths.length!==w.FileIndex.length)throw new Error("inconsistent CFB structure");w.FullPaths.length===0&&(w.FullPaths[0]=C+"/",w.FileIndex[0]={name:C,type:5}),S.CLSID&&(w.FileIndex[0].clsid=S.CLSID),A(w)}function A(w){var N="Sh33tJ5";if(!Ce.find(w,"/"+N)){var S=ce(4);S[0]=55,S[1]=S[3]=50,S[2]=54,w.FileIndex.push({name:N,type:2,content:S,size:4,L:69,R:69,C:69}),w.FullPaths.push(w.FullPaths[0]+N),M(w)}}function M(w,N){k(w);for(var S=!1,C=!1,O=w.FullPaths.length-1;O>=0;--O){var I=w.FileIndex[O];switch(I.type){case 0:C?S=!0:(w.FileIndex.pop(),w.FullPaths.pop());break;case 1:case 2:case 5:C=!0,isNaN(I.R*I.L*I.C)&&(S=!0),I.R>-1&&I.L>-1&&I.R==I.L&&(S=!0);break;default:S=!0;break}}if(!(!S&&!N)){var re=new Date(1987,1,19),ie=0,W=Object.create?Object.create(null):{},Q=[];for(O=0;O<w.FullPaths.length;++O)W[w.FullPaths[O]]=!0,w.FileIndex[O].type!==0&&Q.push([w.FullPaths[O],w.FileIndex[O]]);for(O=0;O<Q.length;++O){var le=n(Q[O][0]);C=W[le],C||(Q.push([le,{name:a(le).replace("/",""),type:1,clsid:Y,ct:re,mt:re,content:null}]),W[le]=!0)}for(Q.sort(function(Ne,pe){return r(Ne[0],pe[0])}),w.FullPaths=[],w.FileIndex=[],O=0;O<Q.length;++O)w.FullPaths[O]=Q[O][0],w.FileIndex[O]=Q[O][1];for(O=0;O<Q.length;++O){var me=w.FileIndex[O],_e=w.FullPaths[O];if(me.name=a(_e).replace("/",""),me.L=me.R=me.C=-(me.color=1),me.size=me.content?me.content.length:0,me.start=0,me.clsid=me.clsid||Y,O===0)me.C=Q.length>1?1:-1,me.size=0,me.type=5;else if(_e.slice(-1)=="/"){for(ie=O+1;ie<Q.length&&n(w.FullPaths[ie])!=_e;++ie);for(me.C=ie>=Q.length?-1:ie,ie=O+1;ie<Q.length&&n(w.FullPaths[ie])!=n(_e);++ie);me.R=ie>=Q.length?-1:ie,me.type=1}else n(w.FullPaths[O+1]||"")==n(_e)&&(me.R=O+1),me.type=2}}}function B(w,N){var S=N||{};if(S.fileType=="mad")return dl(w,S);switch(M(w),S.fileType){case"zip":return Me(w,S)}var C=function(Ne){for(var pe=0,Se=0,Oe=0;Oe<Ne.FileIndex.length;++Oe){var _t=Ne.FileIndex[Oe];if(_t.content){var wt=_t.content.length;wt>0&&(wt<4096?pe+=wt+63>>6:Se+=wt+511>>9)}}for(var or=Ne.FullPaths.length+3>>2,hl=pe+7>>3,ml=pe+127>>7,xl=hl+Se+or+ml,ds=xl+127>>7,uu=ds<=109?0:Math.ceil((ds-109)/127);xl+ds+uu+127>>7>ds;)uu=++ds<=109?0:Math.ceil((ds-109)/127);var ta=[1,uu,ds,ml,or,Se,pe,0];return Ne.FileIndex[0].size=pe<<6,ta[7]=(Ne.FileIndex[0].start=ta[0]+ta[1]+ta[2]+ta[3]+ta[4]+ta[5])+(ta[6]+7>>3),ta}(w),O=ce(C[7]<<9),I=0,re=0;{for(I=0;I<8;++I)O.write_shift(1,oe[I]);for(I=0;I<8;++I)O.write_shift(2,0);for(O.write_shift(2,62),O.write_shift(2,3),O.write_shift(2,65534),O.write_shift(2,9),O.write_shift(2,6),I=0;I<3;++I)O.write_shift(2,0);for(O.write_shift(4,0),O.write_shift(4,C[2]),O.write_shift(4,C[0]+C[1]+C[2]+C[3]-1),O.write_shift(4,0),O.write_shift(4,4096),O.write_shift(4,C[3]?C[0]+C[1]+C[2]-1:ne),O.write_shift(4,C[3]),O.write_shift(-4,C[1]?C[0]-1:ne),O.write_shift(4,C[1]),I=0;I<109;++I)O.write_shift(-4,I<C[2]?C[1]+I:-1)}if(C[1])for(re=0;re<C[1];++re){for(;I<236+re*127;++I)O.write_shift(-4,I<C[2]?C[1]+I:-1);O.write_shift(-4,re===C[1]-1?ne:re+1)}var ie=function(Ne){for(re+=Ne;I<re-1;++I)O.write_shift(-4,I+1);Ne&&(++I,O.write_shift(-4,ne))};for(re=I=0,re+=C[1];I<re;++I)O.write_shift(-4,se.DIFSECT);for(re+=C[2];I<re;++I)O.write_shift(-4,se.FATSECT);ie(C[3]),ie(C[4]);for(var W=0,Q=0,le=w.FileIndex[0];W<w.FileIndex.length;++W)le=w.FileIndex[W],le.content&&(Q=le.content.length,!(Q<4096)&&(le.start=re,ie(Q+511>>9)));for(ie(C[6]+7>>3);O.l&511;)O.write_shift(-4,se.ENDOFCHAIN);for(re=I=0,W=0;W<w.FileIndex.length;++W)le=w.FileIndex[W],le.content&&(Q=le.content.length,!(!Q||Q>=4096)&&(le.start=re,ie(Q+63>>6)));for(;O.l&511;)O.write_shift(-4,se.ENDOFCHAIN);for(I=0;I<C[4]<<2;++I){var me=w.FullPaths[I];if(!me||me.length===0){for(W=0;W<17;++W)O.write_shift(4,0);for(W=0;W<3;++W)O.write_shift(4,-1);for(W=0;W<12;++W)O.write_shift(4,0);continue}le=w.FileIndex[I],I===0&&(le.start=le.size?le.start-1:ne);var _e=I===0&&S.root||le.name;if(Q=2*(_e.length+1),O.write_shift(64,_e,"utf16le"),O.write_shift(2,Q),O.write_shift(1,le.type),O.write_shift(1,le.color),O.write_shift(-4,le.L),O.write_shift(-4,le.R),O.write_shift(-4,le.C),le.clsid)O.write_shift(16,le.clsid,"hex");else for(W=0;W<4;++W)O.write_shift(4,0);O.write_shift(4,le.state||0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,0),O.write_shift(4,le.start),O.write_shift(4,le.size),O.write_shift(4,0)}for(I=1;I<w.FileIndex.length;++I)if(le=w.FileIndex[I],le.size>=4096)if(O.l=le.start+1<<9,ze&&Buffer.isBuffer(le.content))le.content.copy(O,O.l,0,le.size),O.l+=le.size+511&-512;else{for(W=0;W<le.size;++W)O.write_shift(1,le.content[W]);for(;W&511;++W)O.write_shift(1,0)}for(I=1;I<w.FileIndex.length;++I)if(le=w.FileIndex[I],le.size>0&&le.size<4096)if(ze&&Buffer.isBuffer(le.content))le.content.copy(O,O.l,0,le.size),O.l+=le.size+63&-64;else{for(W=0;W<le.size;++W)O.write_shift(1,le.content[W]);for(;W&63;++W)O.write_shift(1,0)}if(ze)O.l=O.length;else for(;O.l<O.length;)O.write_shift(1,0);return O}function G(w,N){var S=w.FullPaths.map(function(W){return W.toUpperCase()}),C=S.map(function(W){var Q=W.split("/");return Q[Q.length-(W.slice(-1)=="/"?2:1)]}),O=!1;N.charCodeAt(0)===47?(O=!0,N=S[0].slice(0,-1)+N):O=N.indexOf("/")!==-1;var I=N.toUpperCase(),re=O===!0?S.indexOf(I):C.indexOf(I);if(re!==-1)return w.FileIndex[re];var ie=!I.match(Dl);for(I=I.replace(gr,""),ie&&(I=I.replace(Dl,"!")),re=0;re<S.length;++re)if((ie?S[re].replace(Dl,"!"):S[re]).replace(gr,"")==I||(ie?C[re].replace(Dl,"!"):C[re]).replace(gr,"")==I)return w.FileIndex[re];return null}var U=64,ne=-2,de="d0cf11e0a1b11ae1",oe=[208,207,17,224,161,177,26,225],Y="00000000000000000000000000000000",se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ne,FREESECT:-1,HEADER_SIGNATURE:de,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Z(w,N,S){u();var C=B(w,S);c.writeFileSync(N,C)}function H(w){for(var N=new Array(w.length),S=0;S<w.length;++S)N[S]=String.fromCharCode(w[S]);return N.join("")}function ae(w,N){var S=B(w,N);switch(N&&N.type||"buffer"){case"file":return u(),c.writeFileSync(N.filename,S),S;case"binary":return typeof S=="string"?S:H(S);case"base64":return ko(typeof S=="string"?S:H(S));case"buffer":if(ze)return Buffer.isBuffer(S)?S:va(S);case"array":return typeof S=="string"?Wr(S):S}return S}var K;function P(w){try{var N=w.InflateRaw,S=new N;if(S._processChunk(new Uint8Array([3,0]),S._finishFlushFlag),S.bytesRead)K=w;else throw new Error("zlib does not expose bytesRead")}catch(C){console.error("cannot use native zlib: "+(C.message||C))}}function V(w,N){if(!K)return cs(w,N);var S=K.InflateRaw,C=new S,O=C._processChunk(w.slice(w.l),C._finishFlushFlag);return w.l+=C.bytesRead,O}function D(w){return K?K.deflateRawSync(w):je(w)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],F=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function q(w){var N=(w<<1|w<<11)&139536|(w<<5|w<<15)&558144;return(N>>16|N>>8|N)&255}for(var X=typeof Uint8Array<"u",L=X?new Uint8Array(256):[],J=0;J<256;++J)L[J]=q(J);function j(w,N){var S=L[w&255];return N<=8?S>>>8-N:(S=S<<8|L[w>>8&255],N<=16?S>>>16-N:(S=S<<8|L[w>>16&255],S>>>24-N))}function ke(w,N){var S=N&7,C=N>>>3;return(w[C]|(S<=6?0:w[C+1]<<8))>>>S&3}function ue(w,N){var S=N&7,C=N>>>3;return(w[C]|(S<=5?0:w[C+1]<<8))>>>S&7}function ve(w,N){var S=N&7,C=N>>>3;return(w[C]|(S<=4?0:w[C+1]<<8))>>>S&15}function Te(w,N){var S=N&7,C=N>>>3;return(w[C]|(S<=3?0:w[C+1]<<8))>>>S&31}function he(w,N){var S=N&7,C=N>>>3;return(w[C]|(S<=1?0:w[C+1]<<8))>>>S&127}function Ue(w,N,S){var C=N&7,O=N>>>3,I=(1<<S)-1,re=w[O]>>>C;return S<8-C||(re|=w[O+1]<<8-C,S<16-C)||(re|=w[O+2]<<16-C,S<24-C)||(re|=w[O+3]<<24-C),re&I}function Ke(w,N,S){var C=N&7,O=N>>>3;return C<=5?w[O]|=(S&7)<<C:(w[O]|=S<<C&255,w[O+1]=(S&7)>>8-C),N+3}function nt(w,N,S){var C=N&7,O=N>>>3;return S=(S&1)<<C,w[O]|=S,N+1}function pt(w,N,S){var C=N&7,O=N>>>3;return S<<=C,w[O]|=S&255,S>>>=8,w[O+1]=S,N+8}function Ft(w,N,S){var C=N&7,O=N>>>3;return S<<=C,w[O]|=S&255,S>>>=8,w[O+1]=S&255,w[O+2]=S>>>8,N+16}function Ge(w,N){var S=w.length,C=2*S>N?2*S:N+5,O=0;if(S>=N)return w;if(ze){var I=qx(C);if(w.copy)w.copy(I);else for(;O<w.length;++O)I[O]=w[O];return I}else if(X){var re=new Uint8Array(C);if(re.set)re.set(w);else for(;O<S;++O)re[O]=w[O];return re}return w.length=C,w}function gt(w){for(var N=new Array(w),S=0;S<w;++S)N[S]=0;return N}function ir(w,N,S){var C=1,O=0,I=0,re=0,ie=0,W=w.length,Q=X?new Uint16Array(32):gt(32);for(I=0;I<32;++I)Q[I]=0;for(I=W;I<S;++I)w[I]=0;W=w.length;var le=X?new Uint16Array(W):gt(W);for(I=0;I<W;++I)Q[O=w[I]]++,C<O&&(C=O),le[I]=0;for(Q[0]=0,I=1;I<=C;++I)Q[I+16]=ie=ie+Q[I-1]<<1;for(I=0;I<W;++I)ie=w[I],ie!=0&&(le[I]=Q[ie+16]++);var me=0;for(I=0;I<W;++I)if(me=w[I],me!=0)for(ie=j(le[I],C)>>C-me,re=(1<<C+4-me)-1;re>=0;--re)N[ie|re<<me]=me&15|I<<4;return C}var it=X?new Uint16Array(512):gt(512),zr=X?new Uint16Array(32):gt(32);if(!X){for(var xe=0;xe<512;++xe)it[xe]=0;for(xe=0;xe<32;++xe)zr[xe]=0}(function(){for(var w=[],N=0;N<32;N++)w.push(5);ir(w,zr,32);var S=[];for(N=0;N<=143;N++)S.push(8);for(;N<=255;N++)S.push(9);for(;N<=279;N++)S.push(7);for(;N<=287;N++)S.push(8);ir(S,it,288)})();var ye=function(){for(var N=X?new Uint8Array(32768):[],S=0,C=0;S<F.length-1;++S)for(;C<F[S+1];++C)N[C]=S;for(;C<32768;++C)N[C]=29;var O=X?new Uint8Array(259):[];for(S=0,C=0;S<te.length-1;++S)for(;C<te[S+1];++C)O[C]=S;function I(ie,W){for(var Q=0;Q<ie.length;){var le=Math.min(65535,ie.length-Q),me=Q+le==ie.length;for(W.write_shift(1,+me),W.write_shift(2,le),W.write_shift(2,~le&65535);le-- >0;)W[W.l++]=ie[Q++]}return W.l}function re(ie,W){for(var Q=0,le=0,me=X?new Uint16Array(32768):[];le<ie.length;){var _e=Math.min(65535,ie.length-le);if(_e<10){for(Q=Ke(W,Q,+(le+_e==ie.length)),Q&7&&(Q+=8-(Q&7)),W.l=Q/8|0,W.write_shift(2,_e),W.write_shift(2,~_e&65535);_e-- >0;)W[W.l++]=ie[le++];Q=W.l*8;continue}Q=Ke(W,Q,+(le+_e==ie.length)+2);for(var Ne=0;_e-- >0;){var pe=ie[le];Ne=(Ne<<5^pe)&32767;var Se=-1,Oe=0;if((Se=me[Ne])&&(Se|=le&-32768,Se>le&&(Se-=32768),Se<le))for(;ie[Se+Oe]==ie[le+Oe]&&Oe<250;)++Oe;if(Oe>2){pe=O[Oe],pe<=22?Q=pt(W,Q,L[pe+1]>>1)-1:(pt(W,Q,3),Q+=5,pt(W,Q,L[pe-23]>>5),Q+=3);var _t=pe<8?0:pe-4>>2;_t>0&&(Ft(W,Q,Oe-te[pe]),Q+=_t),pe=N[le-Se],Q=pt(W,Q,L[pe]>>3),Q-=3;var wt=pe<4?0:pe-2>>1;wt>0&&(Ft(W,Q,le-Se-F[pe]),Q+=wt);for(var or=0;or<Oe;++or)me[Ne]=le&32767,Ne=(Ne<<5^ie[le])&32767,++le;_e-=Oe-1}else pe<=143?pe=pe+48:Q=nt(W,Q,1),Q=pt(W,Q,L[pe]),me[Ne]=le&32767,++le}Q=pt(W,Q,0)-1}return W.l=(Q+7)/8|0,W.l}return function(W,Q){return W.length<8?I(W,Q):re(W,Q)}}();function je(w){var N=ce(50+Math.floor(w.length*1.1)),S=ye(w,N);return N.slice(0,S)}var lt=X?new Uint16Array(32768):gt(32768),vt=X?new Uint16Array(32768):gt(32768),at=X?new Uint16Array(128):gt(128),lr=1,br=1;function Ln(w,N){var S=Te(w,N)+257;N+=5;var C=Te(w,N)+1;N+=5;var O=ve(w,N)+4;N+=4;for(var I=0,re=X?new Uint8Array(19):gt(19),ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],W=1,Q=X?new Uint8Array(8):gt(8),le=X?new Uint8Array(8):gt(8),me=re.length,_e=0;_e<O;++_e)re[R[_e]]=I=ue(w,N),W<I&&(W=I),Q[I]++,N+=3;var Ne=0;for(Q[0]=0,_e=1;_e<=W;++_e)le[_e]=Ne=Ne+Q[_e-1]<<1;for(_e=0;_e<me;++_e)(Ne=re[_e])!=0&&(ie[_e]=le[Ne]++);var pe=0;for(_e=0;_e<me;++_e)if(pe=re[_e],pe!=0){Ne=L[ie[_e]]>>8-pe;for(var Se=(1<<7-pe)-1;Se>=0;--Se)at[Ne|Se<<pe]=pe&7|_e<<3}var Oe=[];for(W=1;Oe.length<S+C;)switch(Ne=at[he(w,N)],N+=Ne&7,Ne>>>=3){case 16:for(I=3+ke(w,N),N+=2,Ne=Oe[Oe.length-1];I-- >0;)Oe.push(Ne);break;case 17:for(I=3+ue(w,N),N+=3;I-- >0;)Oe.push(0);break;case 18:for(I=11+he(w,N),N+=7;I-- >0;)Oe.push(0);break;default:Oe.push(Ne),W<Ne&&(W=Ne);break}var _t=Oe.slice(0,S),wt=Oe.slice(S);for(_e=S;_e<286;++_e)_t[_e]=0;for(_e=C;_e<30;++_e)wt[_e]=0;return lr=ir(_t,lt,286),br=ir(wt,vt,30),N}function nn(w,N){if(w[0]==3&&!(w[1]&3))return[Qa(N),2];for(var S=0,C=0,O=qx(N||1<<18),I=0,re=O.length>>>0,ie=0,W=0;!(C&1);){if(C=ue(w,S),S+=3,C>>>1)C>>1==1?(ie=9,W=5):(S=Ln(w,S),ie=lr,W=br);else{S&7&&(S+=8-(S&7));var Q=w[S>>>3]|w[(S>>>3)+1]<<8;if(S+=32,Q>0)for(!N&&re<I+Q&&(O=Ge(O,I+Q),re=O.length);Q-- >0;)O[I++]=w[S>>>3],S+=8;continue}for(;;){!N&&re<I+32767&&(O=Ge(O,I+32767),re=O.length);var le=Ue(w,S,ie),me=C>>>1==1?it[le]:lt[le];if(S+=me&15,me>>>=4,!(me>>>8&255))O[I++]=me;else{if(me==256)break;me-=257;var _e=me<8?0:me-4>>2;_e>5&&(_e=0);var Ne=I+te[me];_e>0&&(Ne+=Ue(w,S,_e),S+=_e),le=Ue(w,S,W),me=C>>>1==1?zr[le]:vt[le],S+=me&15,me>>>=4;var pe=me<4?0:me-2>>1,Se=F[me];for(pe>0&&(Se+=Ue(w,S,pe),S+=pe),!N&&re<Ne&&(O=Ge(O,Ne+100),re=O.length);I<Ne;)O[I]=O[I-Se],++I}}}return N?[O,S+7>>>3]:[O.slice(0,I),S+7>>>3]}function cs(w,N){var S=w.slice(w.l||0),C=nn(S,N);return w.l+=C[1],C[0]}function ei(w,N){if(w)typeof console<"u"&&console.error(N);else throw new Error(N)}function kn(w,N){var S=w;rr(S,0);var C=[],O=[],I={FileIndex:C,FullPaths:O};k(I,{root:N.root});for(var re=S.length-4;(S[re]!=80||S[re+1]!=75||S[re+2]!=5||S[re+3]!=6)&&re>=0;)--re;S.l=re+4,S.l+=4;var ie=S.read_shift(2);S.l+=6;var W=S.read_shift(4);for(S.l=W,re=0;re<ie;++re){S.l+=20;var Q=S.read_shift(4),le=S.read_shift(4),me=S.read_shift(2),_e=S.read_shift(2),Ne=S.read_shift(2);S.l+=8;var pe=S.read_shift(4),Se=o(S.slice(S.l+me,S.l+me+_e));S.l+=me+_e+Ne;var Oe=S.l;S.l=pe+4,ti(S,Q,le,I,Se),S.l=Oe}return I}function ti(w,N,S,C,O){w.l+=2;var I=w.read_shift(2),re=w.read_shift(2),ie=i(w);if(I&8257)throw new Error("Unsupported ZIP encryption");for(var W=w.read_shift(4),Q=w.read_shift(4),le=w.read_shift(4),me=w.read_shift(2),_e=w.read_shift(2),Ne="",pe=0;pe<me;++pe)Ne+=String.fromCharCode(w[w.l++]);if(_e){var Se=o(w.slice(w.l,w.l+_e));(Se[21589]||{}).mt&&(ie=Se[21589].mt),((O||{})[21589]||{}).mt&&(ie=O[21589].mt)}w.l+=_e;var Oe=w.slice(w.l,w.l+Q);switch(re){case 8:Oe=V(w,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+re)}var _t=!1;I&8&&(W=w.read_shift(4),W==134695760&&(W=w.read_shift(4),_t=!0),Q=w.read_shift(4),le=w.read_shift(4)),Q!=N&&ei(_t,"Bad compressed size: "+N+" != "+Q),le!=S&&ei(_t,"Bad uncompressed size: "+S+" != "+le),an(C,Ne,Oe,{unsafe:!0,mt:ie})}function Me(w,N){var S=N||{},C=[],O=[],I=ce(1),re=S.compression?8:0,ie=0,W=0,Q=0,le=0,me=0,_e=w.FullPaths[0],Ne=_e,pe=w.FileIndex[0],Se=[],Oe=0;for(W=1;W<w.FullPaths.length;++W)if(Ne=w.FullPaths[W].slice(_e.length),pe=w.FileIndex[W],!(!pe.size||!pe.content||Ne=="Sh33tJ5")){var _t=le,wt=ce(Ne.length);for(Q=0;Q<Ne.length;++Q)wt.write_shift(1,Ne.charCodeAt(Q)&127);wt=wt.slice(0,wt.l),Se[me]=t4.buf(pe.content,0);var or=pe.content;re==8&&(or=D(or)),I=ce(30),I.write_shift(4,67324752),I.write_shift(2,20),I.write_shift(2,ie),I.write_shift(2,re),pe.mt?s(I,pe.mt):I.write_shift(4,0),I.write_shift(-4,Se[me]),I.write_shift(4,or.length),I.write_shift(4,pe.content.length),I.write_shift(2,wt.length),I.write_shift(2,0),le+=I.length,C.push(I),le+=wt.length,C.push(wt),le+=or.length,C.push(or),I=ce(46),I.write_shift(4,33639248),I.write_shift(2,0),I.write_shift(2,20),I.write_shift(2,ie),I.write_shift(2,re),I.write_shift(4,0),I.write_shift(-4,Se[me]),I.write_shift(4,or.length),I.write_shift(4,pe.content.length),I.write_shift(2,wt.length),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(4,0),I.write_shift(4,_t),Oe+=I.l,O.push(I),Oe+=wt.length,O.push(wt),++me}return I=ce(22),I.write_shift(4,101010256),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(2,me),I.write_shift(2,me),I.write_shift(4,Oe),I.write_shift(4,le),I.write_shift(2,0),Jt([Jt(C),Jt(O),I])}var Be={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function kr(w,N){if(w.ctype)return w.ctype;var S=w.name||"",C=S.match(/\.([^\.]+)$/);return C&&Be[C[1]]||N&&(C=(S=N).match(/[\.\\]([^\.\\])+$/),C&&Be[C[1]])?Be[C[1]]:"application/octet-stream"}function ri(w){for(var N=ko(w),S=[],C=0;C<N.length;C+=76)S.push(N.slice(C,C+76));return S.join(`\r
`)+`\r
`}function ni(w){var N=w.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Q){var le=Q.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});N=N.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),N.charAt(0)==`
`&&(N="=0D"+N.slice(1)),N=N.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var S=[],C=N.split(`\r
`),O=0;O<C.length;++O){var I=C[O];if(I.length==0){S.push("");continue}for(var re=0;re<I.length;){var ie=76,W=I.slice(re,re+ie);W.charAt(ie-1)=="="?ie--:W.charAt(ie-2)=="="?ie-=2:W.charAt(ie-3)=="="&&(ie-=3),W=I.slice(re,re+ie),re+=ie,re<I.length&&(W+="="),S.push(W)}}return S.join(`\r
`)}function ai(w){for(var N=[],S=0;S<w.length;++S){for(var C=w[S];S<=w.length&&C.charAt(C.length-1)=="=";)C=C.slice(0,C.length-1)+w[++S];N.push(C)}for(var O=0;O<N.length;++O)N[O]=N[O].replace(/[=][0-9A-Fa-f]{2}/g,function(I){return String.fromCharCode(parseInt(I.slice(1),16))});return Wr(N.join(`\r
`))}function wa(w,N,S){for(var C="",O="",I="",re,ie=0;ie<10;++ie){var W=N[ie];if(!W||W.match(/^\s*$/))break;var Q=W.match(/^(.*?):\s*([^\s].*)$/);if(Q)switch(Q[1].toLowerCase()){case"content-location":C=Q[2].trim();break;case"content-type":I=Q[2].trim();break;case"content-transfer-encoding":O=Q[2].trim();break}}switch(++ie,O.toLowerCase()){case"base64":re=Wr(Zr(N.slice(ie).join("")));break;case"quoted-printable":re=ai(N.slice(ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+O)}var le=an(w,C.slice(S.length),re,{unsafe:!0});I&&(le.ctype=I)}function Mn(w,N){if(H(w.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var S=N&&N.root||"",C=(ze&&Buffer.isBuffer(w)?w.toString("binary"):H(w)).split(`\r
`),O=0,I="";for(O=0;O<C.length;++O)if(I=C[O],!!/^Content-Location:/i.test(I)&&(I=I.slice(I.indexOf("file")),S||(S=I.slice(0,I.lastIndexOf("/")+1)),I.slice(0,S.length)!=S))for(;S.length>0&&(S=S.slice(0,S.length-1),S=S.slice(0,S.lastIndexOf("/")+1),I.slice(0,S.length)!=S););var re=(C[1]||"").match(/boundary="(.*?)"/);if(!re)throw new Error("MAD cannot find boundary");var ie="--"+(re[1]||""),W=[],Q=[],le={FileIndex:W,FullPaths:Q};k(le);var me,_e=0;for(O=0;O<C.length;++O){var Ne=C[O];Ne!==ie&&Ne!==ie+"--"||(_e++&&wa(le,C.slice(me,O),S),me=O)}return le}function dl(w,N){var S=N||{},C=S.boundary||"SheetJS";C="------="+C;for(var O=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+C.slice(2)+'"',"","",""],I=w.FullPaths[0],re=I,ie=w.FileIndex[0],W=1;W<w.FullPaths.length;++W)if(re=w.FullPaths[W].slice(I.length),ie=w.FileIndex[W],!(!ie.size||!ie.content||re=="Sh33tJ5")){re=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Oe){return"_x"+Oe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Oe){return"_u"+Oe.charCodeAt(0).toString(16)+"_"});for(var Q=ie.content,le=ze&&Buffer.isBuffer(Q)?Q.toString("binary"):H(Q),me=0,_e=Math.min(1024,le.length),Ne=0,pe=0;pe<=_e;++pe)(Ne=le.charCodeAt(pe))>=32&&Ne<128&&++me;var Se=me>=_e*4/5;O.push(C),O.push("Content-Location: "+(S.root||"file:///C:/SheetJS/")+re),O.push("Content-Transfer-Encoding: "+(Se?"quoted-printable":"base64")),O.push("Content-Type: "+kr(ie,re)),O.push(""),O.push(Se?ni(le):ri(le))}return O.push(C+`--\r
`),O.join(`\r
`)}function fl(w){var N={};return k(N,w),N}function an(w,N,S,C){var O=C&&C.unsafe;O||k(w);var I=!O&&Ce.find(w,N);if(!I){var re=w.FullPaths[0];N.slice(0,re.length)==re?re=N:(re.slice(-1)!="/"&&(re+="/"),re=(re+N).replace("//","/")),I={name:a(N),type:2},w.FileIndex.push(I),w.FullPaths.push(re),O||Ce.utils.cfb_gc(w)}return I.content=S,I.size=S?S.length:0,C&&(C.CLSID&&(I.clsid=C.CLSID),C.mt&&(I.mt=C.mt),C.ct&&(I.ct=C.ct)),I}function us(w,N){k(w);var S=Ce.find(w,N);if(S){for(var C=0;C<w.FileIndex.length;++C)if(w.FileIndex[C]==S)return w.FileIndex.splice(C,1),w.FullPaths.splice(C,1),!0}return!1}function Pt(w,N,S){k(w);var C=Ce.find(w,N);if(C){for(var O=0;O<w.FileIndex.length;++O)if(w.FileIndex[O]==C)return w.FileIndex[O].name=a(S),w.FullPaths[O]=S,!0}return!1}function ea(w){M(w,!0)}return t.find=G,t.read=T,t.parse=d,t.write=ae,t.writeFile=Z,t.utils={cfb_new:fl,cfb_add:an,cfb_del:us,cfb_mov:Pt,cfb_gc:ea,ReadShift:ql,CheckField:wy,prep_blob:rr,bconcat:Jt,use_zlib:P,_deflateRaw:je,_inflateRaw:cs,consts:se},t}();let Ma;function r4(e){Ma=e}function n4(e){return typeof e=="string"?Ho(e):Array.isArray(e)?jN(e):e}function Vo(e,t,r){if(typeof Ma<"u"&&Ma.writeFileSync)return r?Ma.writeFileSync(e,t,r):Ma.writeFileSync(e,t);if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Ho(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Gn(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([n4(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=is(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function a4(e){if(typeof Ma<"u")return Ma.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function At(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function rp(e,t){for(var r=[],n=At(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function eu(e){for(var t=[],r=At(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function tu(e){for(var t=[],r=At(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function s4(e){for(var t=[],r=At(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var b0=new Date(1899,11,30,0,0,0);function Gt(e,t){var r=e.getTime(),n=b0.getTime()+(e.getTimezoneOffset()-b0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var ay=new Date,i4=b0.getTime()+(ay.getTimezoneOffset()-b0.getTimezoneOffset())*6e4,np=ay.getTimezoneOffset();function ru(e){var t=new Date;return t.setTime(e*24*60*60*1e3+i4),t.getTimezoneOffset()!==np&&t.setTime(t.getTime()+(t.getTimezoneOffset()-np)*6e4),t}function l4(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var ap=new Date("2017-02-19T19:06:09.000Z"),sy=isNaN(ap.getFullYear())?new Date("2/19/17"):ap,o4=sy.getFullYear()==2017;function xt(e,t){var r=new Date(e);if(o4)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(sy.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ls(e,t){if(ze&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Gn(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Gn(Vv(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Gn(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Gn(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function ot(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ot(e[r]));return t}function Tt(e,t){for(var r="";r.length<t;)r+=e;return r}function On(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var c4=["january","february","march","april","may","june","july","august","september","october","november","december"];function Zi(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&c4.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var u4=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function iy(e){return e?e.content&&e.type?Ls(e.content,!0):e.data?Ai(e.data):e.asNodeBuffer&&ze?Ai(e.asNodeBuffer().toString("binary")):e.asBinary?Ai(e.asBinary()):e._data&&e._data.getContent?Ai(Ls(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function ly(e){if(!e)return null;if(e.data)return v0(e.data);if(e.asNodeBuffer&&ze)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?v0(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function d4(e){return e&&e.name.slice(-4)===".bin"?ly(e):iy(e)}function un(e,t){for(var r=e.FullPaths||At(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function Fh(e,t){var r=un(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Mt(e,t,r){if(!r)return d4(Fh(e,t));if(!t)return null;try{return Mt(e,t)}catch{return null}}function Vr(e,t,r){if(!r)return iy(Fh(e,t));if(!t)return null;try{return Vr(e,t)}catch{return null}}function f4(e,t,r){return ly(Fh(e,t))}function sp(e){for(var t=e.FullPaths||At(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Le(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ze?n=va(r):n=CN(r),Ce.utils.cfb_add(e,t,n)}Ce.utils.cfb_add(e,t,r)}else e.file(t,r)}function Ph(){return Ce.utils.cfb_new()}function oy(e,t){switch(t.type){case"base64":return Ce.read(e,{type:"base64"});case"binary":return Ce.read(e,{type:"binary"});case"buffer":case"array":return Ce.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Ol(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var It=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,h4=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,ip=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,m4=/<[^>]*>/g,wr=It.match(ip)?ip:m4,x4=/<\w*:/,p4=/<(\/?)\w+:/;function De(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(h4),o=0,c="",u=0,d="",f="",h=1;if(i)for(u=0;u!=i.length;++u){for(f=i[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(a=f.charCodeAt(s+1))==34||a==39?1:0,c=f.slice(s+1+h,f.length-h),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var g=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[g]&&d.slice(o-3,o)=="ext")continue;n[g]=c,n[g.toLowerCase()]=c}}return n}function Qn(e){return e.replace(p4,"<$1")}var cy={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Dh=eu(cy),Ye=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,c){return cy[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),Oh=/[&<>'"]/g,g4=/[\u0000-\u0008\u000b-\u001f]/g;function tt(e){var t=e+"";return t.replace(Oh,function(r){return Dh[r]}).replace(g4,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function lp(e){return tt(e).replace(/ /g,"_x0020_")}var uy=/[\u0000-\u001f]/g;function Rh(e){var t=e+"";return t.replace(Oh,function(r){return Dh[r]}).replace(/\n/g,"<br/>").replace(uy,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function v4(e){var t=e+"";return t.replace(Oh,function(r){return Dh[r]}).replace(uy,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var op=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function y4(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function ft(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Gu(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function cp(e){var t=Qa(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function up(e){return va(e,"binary").toString("utf8")}var wc="foo bar baz",st=ze&&(up(wc)==Gu(wc)&&up||cp(wc)==Gu(wc)&&cp)||Gu,Gn=ze?function(e){return va(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},No=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),dy=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),_4=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),w4=/<\/?(?:vt:)?variant>/g,b4=/<(?:vt:)([^>]*)>([\s\S]*)</;function dp(e,t){var r=De(e),n=e.match(_4(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(w4,"").match(b4);i&&a.push({v:st(i[2]),t:i[1]})}),a}var fy=/(^\s|\s$|\n)/;function nr(e,t){return"<"+e+(t.match(fy)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Eo(e){return At(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function we(e,t,r){return"<"+e+(r!=null?Eo(r):"")+(t!=null?(t.match(fy)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function ff(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function k4(e,t){switch(typeof e){case"string":var r=we("vt:lpwstr",tt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return we((e|0)==e?"vt:i4":"vt:r8",tt(String(e)));case"boolean":return we("vt:bool",e?"true":"false")}if(e instanceof Date)return we("vt:filetime",ff(e));throw new Error("Unable to serialize "+e)}function Ih(e){if(ze&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return st(is(jh(e)));throw new Error("Bad input format: expected Buffer or string")}var To=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Wt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},qs=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Hr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function S4(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function N4(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var fp=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},hp=ze?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:va(t)})):fp(e)}:fp,mp=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(oa(e,a)));return n.join("").replace(gr,"")},nu=ze?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(gr,""):mp(e,t,r)}:mp,xp=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},hy=ze?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):xp(e,t,r)}:xp,pp=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(pi(e,a)));return n.join("")},ol=ze?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):pp(t,r,n)}:pp,my=function(e,t){var r=Yt(e,t);return r>0?ol(e,t+4,t+4+r-1):""},Lh=my,xy=function(e,t){var r=Yt(e,t);return r>0?ol(e,t+4,t+4+r-1):""},Mh=xy,py=function(e,t){var r=2*Yt(e,t);return r>0?ol(e,t+4,t+4+r-1):""},Bh=py,gy=function(t,r){var n=Yt(t,r);return n>0?nu(t,r+4,r+4+n):""},Uh=gy,vy=function(e,t){var r=Yt(e,t);return r>0?ol(e,t+4,t+4+r):""},zh=vy,yy=function(e,t){return S4(e,t)},k0=yy,$h=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ze&&(Lh=function(t,r){if(!Buffer.isBuffer(t))return my(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Mh=function(t,r){if(!Buffer.isBuffer(t))return xy(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},Bh=function(t,r){if(!Buffer.isBuffer(t))return py(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Uh=function(t,r){if(!Buffer.isBuffer(t))return gy(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},zh=function(t,r){if(!Buffer.isBuffer(t))return vy(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},k0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):yy(t,r)},$h=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});function _y(){nu=function(e,t,r){return qe.utils.decode(1200,e.slice(t,r)).replace(gr,"")},ol=function(e,t,r){return qe.utils.decode(65001,e.slice(t,r))},Lh=function(e,t){var r=Yt(e,t);return r>0?qe.utils.decode(Rs,e.slice(t+4,t+4+r-1)):""},Mh=function(e,t){var r=Yt(e,t);return r>0?qe.utils.decode(Yr,e.slice(t+4,t+4+r-1)):""},Bh=function(e,t){var r=2*Yt(e,t);return r>0?qe.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Uh=function(e,t){var r=Yt(e,t);return r>0?qe.utils.decode(1200,e.slice(t+4,t+4+r)):""},zh=function(e,t){var r=Yt(e,t);return r>0?qe.utils.decode(65001,e.slice(t+4,t+4+r)):""}}typeof qe<"u"&&_y();var pi=function(e,t){return e[t]},oa=function(e,t){return e[t+1]*256+e[t]},E4=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Yt=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},vs=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},T4=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ql(e,t){var r="",n,a,s=[],i,o,c,u;switch(t){case"dbcs":if(u=this.l,ze&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(oa(this,u)),u+=2;e*=2;break;case"utf8":r=ol(this,this.l,this.l+e);break;case"utf16le":e*=2,r=nu(this,this.l,this.l+e);break;case"wstr":if(typeof qe<"u")r=qe.utils.decode(Yr,this.slice(this.l,this.l+2*e));else return ql.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":r=Lh(this,this.l),e=4+Yt(this,this.l);break;case"lpstr-cp":r=Mh(this,this.l),e=4+Yt(this,this.l);break;case"lpwstr":r=Bh(this,this.l),e=4+2*Yt(this,this.l);break;case"lpp4":e=4+Yt(this,this.l),r=Uh(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Yt(this,this.l),r=zh(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=pi(this,this.l+e++))!==0;)s.push(Pl(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=oa(this,this.l+e))!==0;)s.push(Pl(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=pi(this,u),this.l=u+1,o=ql.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Pl(oa(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":if(typeof qe<"u"){r=qe.utils.decode(Yr,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=pi(this,u),this.l=u+1,o=ql.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Pl(pi(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=pi(this,this.l),this.l++,n;case 2:return n=(t==="i"?E4:oa)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?vs:T4)(this,this.l),this.l+=4,n):(a=Yt(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=k0(this,this.l):a=k0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=hy(this,this.l,e);break}}return this.l+=e,r}var j4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},C4=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},A4=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function F4(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)A4(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){if(typeof qe<"u"&&Rs==874)for(a=0;a!=t.length;++a){var s=qe.utils.encode(Rs,t.charAt(a));this[this.l+a]=s[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,j4(this,t,this.l);break;case 8:if(n=8,r==="f"){N4(this,t,this.l);break}case 16:break;case-4:n=4,C4(this,t,this.l);break}return this.l+=n,this}function wy(e,t){var r=hy(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function rr(e,t){e.l=t,e.read_shift=ql,e.chk=wy,e.write_shift=F4}function _r(e,t){e.l+=t}function ce(e){var t=Qa(e);return rr(t,0),t}function ya(e,t,r){if(e){var n,a,s;rr(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=Do[o]||Do[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;c=e.l+s;var d=u.f&&u.f(e,s,r);if(e.l=c,t(d,u,o))return}}}function Ur(){var e=[],t=ze?256:2048,r=function(u){var d=ce(u);return rr(d,0),d},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},i=function(){return a(),Jt(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function fe(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=Do[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var i=e.next(s);a<=127?i.write_shift(1,a):(i.write_shift(1,(a&127)+128),i.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&$h(r)&&e.push(r)}}function Xl(e,t,r){var n=ot(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function gp(e,t,r){var n=ot(e);return n.s=Xl(n.s,t.s,r),n.e=Xl(n.e,t.s,r),n}function Yl(e,t){if(e.cRel&&e.c<0)for(e=ot(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ot(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Pe(e);return!e.cRel&&e.cRel!=null&&(r=O4(r)),!e.rRel&&e.rRel!=null&&(r=P4(r)),r}function Ku(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+mt(e.s.c)+":"+(e.e.cRel?"":"$")+mt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+jt(e.s.r)+":"+(e.e.rRel?"":"$")+jt(e.e.r):Yl(e.s,t.biff)+":"+Yl(e.e,t.biff)}function Hh(e){return parseInt(D4(e),10)-1}function jt(e){return""+(e+1)}function P4(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function D4(e){return e.replace(/\$(\d+)$/,"$1")}function Wh(e){for(var t=R4(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function mt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function O4(e){return e.replace(/^([A-Z])/,"$$$1")}function R4(e){return e.replace(/^\$([A-Z])/,"$1")}function I4(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function kt(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Pe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Cr(e){var t=e.indexOf(":");return t==-1?{s:kt(e),e:kt(e)}:{s:kt(e.slice(0,t)),e:kt(e.slice(t+1))}}function Ie(e,t){return typeof t>"u"||typeof t=="number"?Ie(e.s,e.e):(typeof e!="string"&&(e=Pe(e)),typeof t!="string"&&(t=Pe(t)),e==t?e:e+":"+t)}function Ve(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function vp(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=en(e.z,r?Gt(t):t)}catch{}try{return e.w=en((e.XF||{}).numFmtId||(r?14:0),r?Gt(t):t)}catch{return""+t}}function Jn(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?_a[e.v]||e.v:t==null?vp(e,e.v):vp(e,t))}function ls(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function by(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?kt(n.origin):n.origin;i=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Ve(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var g={v:t[f][h]},p=i+f,x=o+h;if(u.s.r>p&&(u.s.r=p),u.s.c>x&&(u.s.c=x),u.e.r<p&&(u.e.r=p),u.e.c<x&&(u.e.c=x),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))g=t[f][h];else if(Array.isArray(g.v)&&(g.f=t[f][h][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||Fe[14],n.cellDates?(g.t="d",g.w=en(g.z,Gt(g.v))):(g.t="n",g.v=Gt(g.v),g.w=en(g.z,g.v))):g.t="s";if(a)s[p]||(s[p]=[]),s[p][x]&&s[p][x].z&&(g.z=s[p][x].z),s[p][x]=g;else{var m=Pe({c:x,r:p});s[m]&&s[m].z&&(g.z=s[m].z),s[m]=g}}}return u.s.c<1e7&&(s["!ref"]=Ie(u)),s}function cl(e,t){return by(null,e,t)}function L4(e){return e.read_shift(4,"i")}function Rn(e,t){return t||(t=ce(4)),t.write_shift(4,e),t}function vr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Qt(e,t){var r=!1;return t==null&&(r=!0,t=ce(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function M4(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function B4(e,t){return t||(t=ce(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Vh(e,t){var r=e.l,n=e.read_shift(1),a=vr(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)s.push(M4(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function U4(e,t){var r=!1;return t==null&&(r=!0,t=ce(15+4*e.t.length)),t.write_shift(1,0),Qt(e.t,t),r?t.slice(0,t.l):t}var z4=Vh;function $4(e,t){var r=!1;return t==null&&(r=!0,t=ce(23+4*e.t.length)),t.write_shift(1,1),Qt(e.t,t),t.write_shift(4,1),B4({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function bn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Xs(e,t){return t==null&&(t=ce(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ys(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Js(e,t){return t==null&&(t=ce(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var H4=vr,ky=Qt;function Gh(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function S0(e,t){var r=!1;return t==null&&(r=!0,t=ce(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var W4=vr,hf=Gh,Kh=S0;function qh(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?k0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):vs(t,0)>>2;return r?a/100:a}function Sy(e,t){t==null&&(t=ce(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:a==(a|0)&&a>=-(1<<29)&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Ny(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function V4(e,t){return t||(t=ce(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Qs=Ny,ul=V4;function pr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ms(e,t){return(t||ce(8)).write_shift(8,e,"f")}function G4(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=Ss[a];u&&(t.rgb=Co(u));break;case 2:t.rgb=Co([i,o,c]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function N0(e,t){if(t||(t=ce(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function K4(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function q4(e,t){t||(t=ce(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Ey(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function X4(e){return Ey(e,1)}function Y4(e){return Ey(e,2)}var Xh=2,Dr=3,bc=11,yp=12,E0=19,kc=64,J4=65,Q4=71,Z4=4108,eE=4126,qt=80,Ty=81,tE=[qt,Ty],mf={1:{n:"CodePage",t:Xh},2:{n:"Category",t:qt},3:{n:"PresentationFormat",t:qt},4:{n:"ByteCount",t:Dr},5:{n:"LineCount",t:Dr},6:{n:"ParagraphCount",t:Dr},7:{n:"SlideCount",t:Dr},8:{n:"NoteCount",t:Dr},9:{n:"HiddenCount",t:Dr},10:{n:"MultimediaClipCount",t:Dr},11:{n:"ScaleCrop",t:bc},12:{n:"HeadingPairs",t:Z4},13:{n:"TitlesOfParts",t:eE},14:{n:"Manager",t:qt},15:{n:"Company",t:qt},16:{n:"LinksUpToDate",t:bc},17:{n:"CharacterCount",t:Dr},19:{n:"SharedDoc",t:bc},22:{n:"HyperlinksChanged",t:bc},23:{n:"AppVersion",t:Dr,p:"version"},24:{n:"DigSig",t:J4},26:{n:"ContentType",t:qt},27:{n:"ContentStatus",t:qt},28:{n:"Language",t:qt},29:{n:"Version",t:qt},255:{},2147483648:{n:"Locale",t:E0},2147483651:{n:"Behavior",t:E0},1919054434:{}},xf={1:{n:"CodePage",t:Xh},2:{n:"Title",t:qt},3:{n:"Subject",t:qt},4:{n:"Author",t:qt},5:{n:"Keywords",t:qt},6:{n:"Comments",t:qt},7:{n:"Template",t:qt},8:{n:"LastAuthor",t:qt},9:{n:"RevNumber",t:qt},10:{n:"EditTime",t:kc},11:{n:"LastPrinted",t:kc},12:{n:"CreatedDate",t:kc},13:{n:"ModifiedDate",t:kc},14:{n:"PageCount",t:Dr},15:{n:"WordCount",t:Dr},16:{n:"CharCount",t:Dr},17:{n:"Thumbnail",t:Q4},18:{n:"Application",t:qt},19:{n:"DocSecurity",t:Dr},255:{},2147483648:{n:"Locale",t:E0},2147483651:{n:"Behavior",t:E0},1919054434:{}},_p={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},rE=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function nE(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var aE=nE([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ss=ot(aE),_a={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},jy={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},pf={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Sc={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Yh(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function sE(e){var t=Yh();if(!e||!e.match)return t;var r={};if((e.match(wr)||[]).forEach(function(n){var a=De(n);switch(a[0].replace(x4,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[pf[a.ContentType]]!==void 0&&t[pf[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Wt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Cy(e,t){var r=s4(pf),n=[],a;n[n.length]=It,n[n.length]=we("Types",null,{xmlns:Wt.CT,"xmlns:xsd":Wt.xsd,"xmlns:xsi":Wt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return we("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=we("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Sc[c][t.bookType]||Sc[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(u){n[n.length]=we("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Sc[c][t.bookType]||Sc[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=we("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var $e={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function jo(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Jl(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(wr)||[]).forEach(function(a){var s=De(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Ol(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}function Bi(e){var t=[It,we("Relationships",null,{xmlns:Wt.RELS})];return At(e["!id"]).forEach(function(r){t[t.length]=we("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function et(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[$e.HLINK,$e.XPATH,$e.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var iE="application/vnd.oasis.opendocument.spreadsheet";function lE(e,t){for(var r=Ih(e),n,a;n=To.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=De(n[0],!1),a.path=="/"&&a.type!==iE)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function oE(e){var t=[It];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function wp(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function cE(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function uE(e){var t=[It];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(wp(e[r][0],e[r][1])),t.push(cE("",e[r][0]));return t.push(wp("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Ay(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+bo.version+"</meta:generator></office:meta></office:document-meta>"}var vn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],dE=function(){for(var e=new Array(vn.length),t=0;t<vn.length;++t){var r=vn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Fy(e){var t={};e=st(e);for(var r=0;r<vn.length;++r){var n=vn[r],a=e.match(dE[r]);a!=null&&a.length>0&&(t[n[1]]=Ye(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=xt(t[n[1]]))}return t}function qu(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=tt(t),n[n.length]=r?we(e,t,r):nr(e,t))}function Py(e,t){var r=t||{},n=[It,we("cp:coreProperties",null,{"xmlns:cp":Wt.CORE_PROPS,"xmlns:dc":Wt.dc,"xmlns:dcterms":Wt.dcterms,"xmlns:dcmitype":Wt.dcmitype,"xmlns:xsi":Wt.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&qu("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:ff(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&qu("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:ff(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=vn.length;++s){var i=vn[s],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&qu(i[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ns=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Dy=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Oy(e,t,r,n){var a=[];if(typeof e=="string")a=dp(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(d){return{v:d}}));var i=typeof t=="string"?dp(t,n).map(function(d){return d.v}):t,o=0,c=0;if(i.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function fE(e,t,r){var n={};return t||(t={}),e=st(e),Ns.forEach(function(a){var s=(e.match(No(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=Ye(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Oy(n.HeadingPairs,n.TitlesOfParts,t,r),t}function Ry(e){var t=[],r=we;return e||(e={}),e.Application="SheetJS",t[t.length]=It,t[t.length]=we("Properties",null,{xmlns:Wt.EXT_PROPS,"xmlns:vt":Wt.vt}),Ns.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=tt(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+tt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var hE=/<[^>]+>[^<]*/g;function mE(e,t){var r={},n="",a=e.match(hE);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=De(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Ye(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Ye(d);break;case"bool":r[n]=ft(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=xt(d);break;case"cy":case"error":r[n]=Ye(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function Iy(e){var t=[It,we("Properties",null,{xmlns:Wt.CUST_PROPS,"xmlns:vt":Wt.vt})];if(!e)return t.join("");var r=1;return At(e).forEach(function(a){++r,t[t.length]=we("property",k4(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:tt(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var gf={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Xu;function xE(e,t,r){Xu||(Xu=eu(gf)),t=Xu[t]||t,e[t]=r}function pE(e,t){var r=[];return At(gf).map(function(n){for(var a=0;a<vn.length;++a)if(vn[a][1]==n)return vn[a];for(a=0;a<Ns.length;++a)if(Ns[a][1]==n)return Ns[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(nr(gf[n[1]]||n[1],a))}}),we("DocumentProperties",r.join(""),{xmlns:Hr.o})}function gE(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&At(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var i=0;i<vn.length;++i)if(s==vn[i][1])return;for(i=0;i<Ns.length;++i)if(s==Ns[i][1])return;for(i=0;i<r.length;++i)if(s==r[i])return;var o=e[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(we(lp(s),o,{"dt:dt":c}))}}),t&&At(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var i=t[s],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),a.push(we(lp(s),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Hr.o+'">'+a.join("")+"</"+n+">"}function Jh(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function vE(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var i=ce(8);return i.write_shift(4,n),i.write_shift(4,a),i}function Ly(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function My(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function By(e,t,r){return t===31?My(e):Ly(e,t,r)}function vf(e,t,r){return By(e,t,r===!1?0:4)}function yE(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return By(e,t,0)}function _E(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(gr,""),e.l-a&2&&(e.l+=2)}return r}function wE(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(gr,"");return r}function bE(e){var t=e.l,r=T0(e,Ty);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=T0(e,Dr);return[r,n]}function kE(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(bE(e));return r}function bp(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(gr,"").replace(Dl,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Uy(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function SE(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function T0(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==yp&&n!==t&&tE.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===yp?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return Ly(e,n,4).replace(gr,"");case 31:return My(e);case 64:return Jh(e);case 65:return Uy(e);case 71:return SE(e);case 80:return vf(e,n,!s.raw).replace(gr,"");case 81:return yE(e,n).replace(gr,"");case 4108:return kE(e);case 4126:case 4127:return n==4127?_E(e):wE(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function kp(e,t){var r=ce(4),n=ce(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ce(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=vE(t);break;case 31:case 80:for(n=ce(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Jt([r,n])}function Sp(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,c=-1,u={};for(i=0;i!=a;++i){var d=e.read_shift(4),f=e.read_shift(4);s[i]=[d,f+r]}s.sort(function(_,y){return _[1]-y[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var g=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,g=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],g=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],g=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(g=!1,e.l=s[i][1]),g)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var p=t[s[i][0]];if(h[p.n]=T0(e,p.t,{raw:!0}),p.p==="version"&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(h[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:xn(o=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(s[i][0]===1){if(o=h.CodePage=T0(e,Xh),xn(o),c!==-1){var x=e.l;e.l=s[c][1],u=bp(e,o),e.l=x}}else if(s[i][0]===0){if(o===0){c=i,e.l=s[i+1][1];continue}u=bp(e,o)}else{var m=u[s[i][0]],v;switch(e[e.l]){case 65:e.l+=4,v=Uy(e);break;case 30:e.l+=4,v=vf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=vf(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=Dt(e,4);break;case 64:e.l+=4,v=xt(Jh(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[m]=v}}return e.l=r+n,h}var zy=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function NE(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Np(e,t,r){var n=ce(8),a=[],s=[],i=8,o=0,c=ce(8),u=ce(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),a.push(u),i+=8+c.length,!t){u=ce(8),u.write_shift(4,0),a.unshift(u);var d=[ce(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=ce(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Jt(d),s.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(zy.indexOf(e[o][0])>-1||Dy.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],g=0;if(t){g=+t[e[o][0]];var p=r[g];if(p.p=="version"&&typeof h=="string"){var x=h.split(".");h=(+x[0]<<16)+(+x[1]||0)}c=kp(p.t,h)}else{var m=NE(h);m==-1&&(m=31,h=String(h)),c=kp(m,h)}s.push(c),u=ce(8),u.write_shift(4,t?g:2+o),a.push(u),i+=8+c.length}var v=8*(s.length+1);for(o=0;o<s.length;++o)a[o].write_shift(4,v),v+=s[o].length;return n.write_shift(4,i),n.write_shift(4,s.length),Jt([n].concat(a).concat(s))}function Ep(e,t,r){var n=e.content;if(!n)return{};rr(n,0);var a,s,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==Ce.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),c=n.read_shift(4));var f=Sp(n,t),h={SystemIdentifier:u};for(var g in f)h[g]=f[g];if(h.FMTID=s,a===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var p;try{p=Sp(n,null)}catch{}for(g in p)h[g]=p[g];return h.FMTID=[s,i],h}function Tp(e,t,r,n,a,s){var i=ce(a?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Ce.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,a?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,a?68:48);var c=Np(e,r,n);if(o.push(c),a){var u=Np(a,null,null);i.write_shift(16,s,"hex"),i.write_shift(4,68+c.length),o.push(u)}return Jt(o)}function Sa(e,t){return e.read_shift(t),null}function EE(e,t){t||(t=ce(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function TE(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Dt(e,t){return e.read_shift(t)===1}function Tr(e,t){return t||(t=ce(2)),t.write_shift(2,+!!e),t}function Bt(e){return e.read_shift(2,"u")}function dn(e,t){return t||(t=ce(2)),t.write_shift(2,e),t}function $y(e,t){return TE(e,t,Bt)}function jE(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Hy(e,t,r){return r||(r=ce(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Go(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont",s=Yr;if(r&&r.biff>=8&&(Yr=1200),!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return Yr=s,o}function CE(e){var t=Yr;Yr=1200;var r=e.read_shift(2),n=e.read_shift(1),a=n&4,s=n&8,i=1+(n&1),o=0,c,u={};s&&(o=e.read_shift(2)),a&&(c=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",f=r===0?"":e.read_shift(r,d);return s&&(e.l+=4*o),a&&(e.l+=c),u.t=f,s||(u.raw="<t>"+u.t+"</t>",u.r=u.t),Yr=t,u}function AE(e){var t=e.t||"",r=ce(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ce(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Jt(a)}function Bs(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Ko(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Bs(e,n,r)}function Zs(e,t,r){if(r.biff>5)return Ko(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Wy(e,t,r){return r||(r=ce(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function FE(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function PE(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(gr,"");return n&&(e.l+=24),a}function DE(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(gr,"");return r+i}function OE(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return PE(e);case"0303000000000000c000000000000046":return DE(e);default:throw new Error("Unsupported Moniker "+r)}}function Nc(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(gr,""):"";return r}function jp(e,t){t||(t=ce(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function RE(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,c,u="",d,f;a&16&&(s=Nc(e,r-e.l)),a&128&&(i=Nc(e,r-e.l)),(a&257)===257&&(o=Nc(e,r-e.l)),(a&257)===1&&(c=OE(e,r-e.l)),a&8&&(u=Nc(e,r-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(f=Jh(e)),e.l=r;var h=i||o||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var g={Target:h};return d&&(g.guid=d),f&&(g.time=f),s&&(g.Tooltip=s),g}function IE(e){var t=ce(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(s==28)n=n.slice(1),jp(n,t);else if(s&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),s&8&&jp(a>-1?n.slice(a+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Vy(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function Gy(e,t){var r=Vy(e);return r[3]=0,r}function Zn(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Us(e,t,r,n){return n||(n=ce(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function LE(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function ME(e,t,r){return t===0?"":Zs(e,t,r)}function BE(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function Ky(e){var t=e.read_shift(2),r=qh(e);return[t,r]}function UE(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Go(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function au(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function qy(e,t){return t||(t=ce(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Xy(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var zE=Xy;function Yy(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function $E(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function HE(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function dr(e){e.l+=2,e.l+=e.read_shift(2)}var WE={0:dr,4:dr,5:dr,6:dr,7:HE,8:dr,9:dr,10:dr,11:dr,12:dr,13:$E,14:dr,15:dr,16:dr,17:dr,18:dr,19:dr,20:dr,21:Yy};function VE(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(WE[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Ec(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Qh(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ce(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function GE(e,t){return t===0||e.read_shift(2),1200}function KE(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Zs(e,0,r);return e.read_shift(t+n-e.l),a}function qE(e,t){var r=!t||t.biff==8,n=ce(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function XE(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function YE(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=Go(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function JE(e,t){var r=!t||t.biff>=8?2:1,n=ce(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function QE(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(CE(e));return s.Count=n,s.Unique=a,s}function ZE(e,t){var r=ce(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=AE(e[a]);var s=Jt([r].concat(n));return s.parts=[r.length].concat(n.map(function(i){return i.length})),s}function eT(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function tT(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function rT(e){var t=LE(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function nT(e){return e.read_shift(2),e.read_shift(4)}function Cp(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function aT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:c,TabRatio:u}}function sT(){var e=ce(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function iT(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function lT(e){var t=ce(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function oT(){}function cT(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Go(e,0,r),n}function uT(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=ce(a);return s.write_shift(2,(e.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function dT(e){var t=Zn(e);return t.isst=e.read_shift(4),t}function fT(e,t,r,n){var a=ce(10);return Us(e,t,n,a),a.write_shift(4,r),a}function hT(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Zn(e);r.biff==2&&e.l++;var s=Ko(e,n-e.l,r);return a.val=s,a}function mT(e,t,r,n,a){var s=!a||a.biff==8,i=ce(8+ +s+(1+s)*r.length);return Us(e,t,n,i),i.write_shift(2,r.length),s&&i.write_shift(1,1),i.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),i}function xT(e,t,r){var n=e.read_shift(2),a=Zs(e,0,r);return[n,a]}function pT(e,t,r,n){var a=r&&r.biff==5;n||(n=ce(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var gT=Zs;function Ap(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c}}}function vT(e,t){var r=t.biff==8||!t.biff?4:2,n=ce(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function yT(e){var t=e.read_shift(2),r=e.read_shift(2),n=Ky(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function _T(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(Ky(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function wT(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function bT(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return a.patternType=rE[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function kT(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=bT(e,t,n.fStyle,r),n}function Fp(e,t,r,n){var a=r&&r.biff==5;n||(n=ce(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function ST(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function NT(e){var t=ce(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Pp(e,t,r){var n=Zn(e);(r.biff==2||t==9)&&++e.l;var a=jE(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function ET(e,t,r,n,a,s){var i=ce(8);return Us(e,t,n,i),Hy(r,s,i),i}function TT(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Zn(e),a=pr(e);return n.val=a,n}function jT(e,t,r,n){var a=ce(14);return Us(e,t,n,a),Ms(r,a),a}var Dp=ME;function CT(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=Bs(e,s),o=[];n>e.l;)o.push(Ko(e));return[s,a,i,o]}function Op(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=UE(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var AT=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Rp(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Bs(e,i,r);a&32&&(u=AT[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||o===0||!(d>0)?[]:VC(e,d,r,o);return{chKey:s,Name:u,itab:c,rgce:f}}function Jy(e,t,r){if(r.biff<8)return FT(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(BE(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function FT(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Go(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function PT(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=Bs(e,n,r),i=Bs(e,a,r);return[s,i]}function DT(e,t,r){var n=Xy(e);e.l++;var a=e.read_shift(1);return t-=8,[GC(e,t,r),a,n]}function Ip(e,t,r){var n=zE(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,HC(e,t,r)]}function OT(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function RT(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=Zs(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function IT(e,t,r){return RT(e,t,r)}function LT(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(au(e));return r}function MT(e){var t=ce(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)qy(e[r],t);return t}function BT(e,t,r){if(r&&r.biff<8)return zT(e,t,r);var n=Yy(e),a=VE(e,t-22,n[1]);return{cmo:n,ft:a}}var UT={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function zT(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((UT[n]||_r)(e,t,r)),{cmo:[a,n,s],ft:i}}function $T(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=FE(e,6,r);var o=e.read_shift(2);e.read_shift(2),Bt(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=Bs(e,e.lens[u+1]-e.lens[u]-1);if(a+=f,a.length>=(d?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function HT(e,t){var r=au(e);e.l+=16;var n=RE(e,t-24);return[r,n]}function WT(e){var t=ce(24),r=kt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Jt([t,IE(e[1])])}function VT(e,t){e.read_shift(2);var r=au(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(gr,""),[r,n]}function GT(e){var t=e[1].Tooltip,r=ce(10+2*(t.length+1));r.write_shift(2,2048);var n=kt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function KT(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=_p[r]||r,r=e.read_shift(2),t[1]=_p[r]||r,t}function qT(e){return e||(e=ce(4)),e.write_shift(2,1),e.write_shift(2,1),e}function XT(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Gy(e));return r}function YT(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Gy(e));return r}function JT(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Qy(e,t,r){if(!r.cellStyles)return _r(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:s,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function QT(e,t){var r=ce(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function ZT(e,t){var r={};return t<32||(e.l+=16,r.header=pr(e),r.footer=pr(e),e.l+=2),r}function ej(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function tj(e){for(var t=ce(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var rj=Zn,nj=$y,aj=Ko;function sj(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function ij(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Zn(e);++e.l;var a=Zs(e,t-7,r);return n.t="str",n.val=a,n}function lj(e){var t=Zn(e);++e.l;var r=pr(e);return t.t="n",t.val=r,t}function oj(e,t,r){var n=ce(15);return Jo(n,e,t),n.write_shift(8,r,"f"),n}function cj(e){var t=Zn(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function uj(e,t,r){var n=ce(9);return Jo(n,e,t),n.write_shift(2,r),n}function dj(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function fj(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function hj(e,t,r){var n=e.l+t,a=Zn(e),s=e.read_shift(2),i=Bs(e,s,r);return e.l=n,a.t="str",a.val=i,a}var mj=[2,3,48,49,131,139,140,245],yf=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=eu({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=Qa(1);switch(c.type){case"base64":d=Wr(Zr(o));break;case"binary":d=Wr(o);break;case"buffer":case"array":d=o;break}rr(d,0);var f=d.read_shift(1),h=!!(f&136),g=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:g=!0,h=!0;break;case 49:g=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,m=521;f==2&&(x=d.read_shift(2)),d.l+=3,f!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(m=d.read_shift(2));var v=d.read_shift(2),_=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(_=e[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var y=[],b={},E=Math.min(d.length,f==2?521:m-10-(g?264:0)),T=p?32:11;d.l<E&&d[d.l]!=13;)switch(b={},b.name=qe.utils.decode(_,d.slice(d.l,d.l+T)).replace(/[\u0000\r\n].*$/g,""),d.l+=T,b.type=String.fromCharCode(d.read_shift(1)),f!=2&&!p&&(b.offset=d.read_shift(4)),b.len=d.read_shift(1),f==2&&(b.offset=d.read_shift(2)),b.dec=d.read_shift(1),b.name.length&&y.push(b),f!=2&&(d.l+=p?13:14),b.type){case"B":(!g||b.len!=8)&&c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+b.name+":"+b.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+b.type)}if(d[d.l]!==13&&(d.l=m-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=m;var k=0,A=0;for(u[0]=[],A=0;A!=y.length;++A)u[0][A]=y[A].name;for(;x-- >0;){if(d[d.l]===42){d.l+=v;continue}for(++d.l,u[++k]=[],A=0,A=0;A!=y.length;++A){var M=d.slice(d.l,d.l+y[A].len);d.l+=y[A].len,rr(M,0);var B=qe.utils.decode(_,M);switch(y[A].type){case"C":B.trim().length&&(u[k][A]=B.replace(/\s+$/,""));break;case"D":B.length===8?u[k][A]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):u[k][A]=B;break;case"F":u[k][A]=parseFloat(B.trim());break;case"+":case"I":u[k][A]=p?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":u[k][A]=!0;break;case"N":case"F":u[k][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[k][A]="##MEMO##"+(p?parseInt(B.trim(),10):M.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(u[k][A]=+B||0);break;case"@":u[k][A]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":u[k][A]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":u[k][A]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][A]=-M.read_shift(-8,"f");break;case"B":if(g&&y[A].len==8){u[k][A]=M.read_shift(8,"f");break}case"G":case"P":M.l+=y[A].len;break;case"0":if(y[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[A].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=y,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=cl(r(o,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(o,c){try{return ls(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var u=c||{};if(+u.codepage>=0&&xn(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Ur(),f=A0(o,{header:1,raw:!0,cellDates:!0}),h=f[0],g=f.slice(1),p=o["!cols"]||[],x=0,m=0,v=0,_=1;for(x=0;x<h.length;++x){if(((p[x]||{}).DBF||{}).name){h[x]=p[x].DBF.name,++v;continue}if(h[x]!=null){if(++v,typeof h[x]=="number"&&(h[x]=h[x].toString(10)),typeof h[x]!="string")throw new Error("DBF Invalid column name "+h[x]+" |"+typeof h[x]+"|");if(h.indexOf(h[x])!==x){for(m=0;m<1024;++m)if(h.indexOf(h[x]+"_"+m)==-1){h[x]+="_"+m;break}}}}var y=Ve(o["!ref"]),b=[],E=[],T=[];for(x=0;x<=y.e.c-y.s.c;++x){var k="",A="",M=0,B=[];for(m=0;m<g.length;++m)g[m][x]!=null&&B.push(g[m][x]);if(B.length==0||h[x]==null){b[x]="?";continue}for(m=0;m<B.length;++m){switch(typeof B[m]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=B[m]instanceof Date?"D":"C";break;default:A="C"}M=Math.max(M,String(B[m]).length),k=k&&k!=A?"C":A}M>250&&(M=250),A=((p[x]||{}).DBF||{}).type,A=="C"&&p[x].DBF.len>M&&(M=p[x].DBF.len),k=="B"&&A=="N"&&(k="N",T[x]=p[x].DBF.dec,M=p[x].DBF.len),E[x]=k=="C"||A=="N"?M:s[k]||0,_+=E[x],b[x]=k}var G=d.next(32);for(G.write_shift(4,318902576),G.write_shift(4,g.length),G.write_shift(2,296+32*v),G.write_shift(2,_),x=0;x<4;++x)G.write_shift(4,0);for(G.write_shift(4,0|(+t[Rs]||3)<<8),x=0,m=0;x<h.length;++x)if(h[x]!=null){var U=d.next(32),ne=(h[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);U.write_shift(1,ne,"sbcs"),U.write_shift(1,b[x]=="?"?"C":b[x],"sbcs"),U.write_shift(4,m),U.write_shift(1,E[x]||s[b[x]]||0),U.write_shift(1,T[x]||0),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(1,0),U.write_shift(4,0),U.write_shift(4,0),m+=E[x]||s[b[x]]||0}var de=d.next(264);for(de.write_shift(4,13),x=0;x<65;++x)de.write_shift(4,0);for(x=0;x<g.length;++x){var oe=d.next(_);for(oe.write_shift(1,0),m=0;m<h.length;++m)if(h[m]!=null)switch(b[m]){case"L":oe.write_shift(1,g[x][m]==null?63:g[x][m]?84:70);break;case"B":oe.write_shift(8,g[x][m]||0,"f");break;case"N":var Y="0";for(typeof g[x][m]=="number"&&(Y=g[x][m].toFixed(T[m]||0)),v=0;v<E[m]-Y.length;++v)oe.write_shift(1,32);oe.write_shift(1,Y,"sbcs");break;case"D":g[x][m]?(oe.write_shift(4,("0000"+g[x][m].getFullYear()).slice(-4),"sbcs"),oe.write_shift(2,("00"+(g[x][m].getMonth()+1)).slice(-2),"sbcs"),oe.write_shift(2,("00"+g[x][m].getDate()).slice(-2),"sbcs")):oe.write_shift(8,"00000000","sbcs");break;case"C":var se=String(g[x][m]!=null?g[x][m]:"").slice(0,E[m]);for(oe.write_shift(1,se,"sbcs"),v=0;v<E[m]-se.length;++v)oe.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),Zy=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+At(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,g){var p=e[g];return typeof p=="number"?df(p):p},n=function(h,g,p){var x=g.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return x==59?h:df(x)};e["|"]=254;function a(h,g){switch(g.type){case"base64":return s(Zr(h),g);case"binary":return s(h,g);case"buffer":return s(ze&&Buffer.isBuffer(h)?h.toString("binary"):is(h),g);case"array":return s(Ls(h),g)}throw new Error("Unrecognized type "+g.type)}function s(h,g){var p=h.split(/[\n\r]+/),x=-1,m=-1,v=0,_=0,y=[],b=[],E=null,T={},k=[],A=[],M=[],B=0,G;for(+g.codepage>=0&&xn(+g.codepage);v!==p.length;++v){B=0;var U=p[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ne=U.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),de=ne[0],oe;if(U.length>0)switch(de){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ne[1].charAt(0)=="P"&&b.push(U.slice(3).replace(/;;/g,";"));break;case"C":var Y=!1,se=!1,Z=!1,H=!1,ae=-1,K=-1;for(_=1;_<ne.length;++_)switch(ne[_].charAt(0)){case"A":break;case"X":m=parseInt(ne[_].slice(1))-1,se=!0;break;case"Y":for(x=parseInt(ne[_].slice(1))-1,se||(m=0),G=y.length;G<=x;++G)y[G]=[];break;case"K":oe=ne[_].slice(1),oe.charAt(0)==='"'?oe=oe.slice(1,oe.length-1):oe==="TRUE"?oe=!0:oe==="FALSE"?oe=!1:isNaN(On(oe))?isNaN(Zi(oe).getDate())||(oe=xt(oe)):(oe=On(oe),E!==null&&Ks(E)&&(oe=ru(oe))),typeof qe<"u"&&typeof oe=="string"&&(g||{}).type!="string"&&(g||{}).codepage&&(oe=qe.utils.decode(g.codepage,oe)),Y=!0;break;case"E":H=!0;var P=Ui(ne[_].slice(1),{r:x,c:m});y[x][m]=[y[x][m],P];break;case"S":Z=!0,y[x][m]=[y[x][m],"S5S"];break;case"G":break;case"R":ae=parseInt(ne[_].slice(1))-1;break;case"C":K=parseInt(ne[_].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+U)}if(Y&&(y[x][m]&&y[x][m].length==2?y[x][m][0]=oe:y[x][m]=oe,E=null),Z){if(H)throw new Error("SYLK shared formula cannot have own formula");var V=ae>-1&&y[ae][K];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");y[x][m][1]=g_(V[1],{r:x-ae,c:m-K})}break;case"F":var D=0;for(_=1;_<ne.length;++_)switch(ne[_].charAt(0)){case"X":m=parseInt(ne[_].slice(1))-1,++D;break;case"Y":for(x=parseInt(ne[_].slice(1))-1,G=y.length;G<=x;++G)y[G]=[];break;case"M":B=parseInt(ne[_].slice(1))/20;break;case"F":break;case"G":break;case"P":E=b[parseInt(ne[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=ne[_].slice(1).split(" "),G=parseInt(M[0],10);G<=parseInt(M[1],10);++G)B=parseInt(M[2],10),A[G-1]=B===0?{hidden:!0}:{wch:B},Za(A[G-1]);break;case"C":m=parseInt(ne[_].slice(1))-1,A[m]||(A[m]={});break;case"R":x=parseInt(ne[_].slice(1))-1,k[x]||(k[x]={}),B>0?(k[x].hpt=B,k[x].hpx=tl(B)):B===0&&(k[x].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+U)}D<1&&(E=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+U)}}return k.length>0&&(T["!rows"]=k),A.length>0&&(T["!cols"]=A),g&&g.sheetRows&&(y=y.slice(0,g.sheetRows)),[y,T]}function i(h,g){var p=a(h,g),x=p[0],m=p[1],v=cl(x,g);return At(m).forEach(function(_){v[_]=m[_]}),v}function o(h,g){return ls(i(h,g),g)}function c(h,g,p,x){var m="C;Y"+(p+1)+";X"+(x+1)+";K";switch(h.t){case"n":m+=h.v||0,h.f&&!h.F&&(m+=";E"+am(h.f,{r:p,c:x}));break;case"b":m+=h.v?"TRUE":"FALSE";break;case"e":m+=h.w||h.v;break;case"d":m+='"'+(h.w||h.v)+'"';break;case"s":m+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return m}function u(h,g){g.forEach(function(p,x){var m="F;W"+(x+1)+" "+(x+1)+" ";p.hidden?m+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Ao(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=Fo(p.wpx)),typeof p.wch=="number"&&(m+=Math.round(p.wch))),m.charAt(m.length-1)!=" "&&h.push(m)})}function d(h,g){g.forEach(function(p,x){var m="F;";p.hidden?m+="M0;":p.hpt?m+="M"+20*p.hpt+";":p.hpx&&(m+="M"+20*Po(p.hpx)+";"),m.length>2&&h.push(m+"R"+(x+1))})}function f(h,g){var p=["ID;PWXL;N;E"],x=[],m=Ve(h["!ref"]),v,_=Array.isArray(h),y=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&u(p,h["!cols"]),h["!rows"]&&d(p,h["!rows"]),p.push("B;Y"+(m.e.r-m.s.r+1)+";X"+(m.e.c-m.s.c+1)+";D"+[m.s.c,m.s.r,m.e.c,m.e.r].join(" "));for(var b=m.s.r;b<=m.e.r;++b)for(var E=m.s.c;E<=m.e.c;++E){var T=Pe({r:b,c:E});v=_?(h[b]||[])[E]:h[T],!(!v||v.v==null&&(!v.f||v.F))&&x.push(c(v,h,b,E))}return p.join(y)+y+x.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:i,from_sheet:f}}(),e_=function(){function e(s,i){switch(i.type){case"base64":return t(Zr(s),i);case"binary":return t(s,i);case"buffer":return t(ze&&Buffer.isBuffer(s)?s.toString("binary"):is(s),i);case"array":return t(Ls(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),c=-1,u=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=o[d].trim().split(","),g=h[0],p=h[1];++d;for(var x=o[d]||"";(x.match(/["]/g)||[]).length&1&&d<o.length-1;)x+=`
`+o[++d];switch(x=x.trim(),+g){case-1:if(x==="BOT"){f[++c]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[c][u]=!0:x==="FALSE"?f[c][u]=!1:isNaN(On(p))?isNaN(Zi(p).getDate())?f[c][u]=p:f[c][u]=xt(p):f[c][u]=On(p),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[c][u++]=x!==""?x:null;break}if(x==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(s,i){return cl(e(s,i),i)}function n(s,i){return ls(r(s,i),i)}var a=function(){var s=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},i=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=Ve(c["!ref"]),f,h=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var g=d.s.r;g<=d.e.r;++g){i(u,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var x=Pe({r:g,c:p});if(f=h?(c[g]||[])[p]:c[x],!f){i(u,1,0,"");continue}switch(f.t){case"n":var m=f.w;!m&&f.v!=null&&(m=f.v),m==null?f.f&&!f.F?i(u,1,0,"="+f.f):i(u,1,0,""):i(u,0,m,"V");break;case"b":i(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=en(f.z||Fe[14],Gt(xt(f.v)))),i(u,0,f.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var v=`\r
`,_=u.join(v);return _}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),t_=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var g=f.split(`
`),p=-1,x=-1,m=0,v=[];m!==g.length;++m){var _=g[m].trim().split(":");if(_[0]==="cell"){var y=kt(_[1]);if(v.length<=y.r)for(p=v.length;p<=y.r;++p)v[p]||(v[p]=[]);switch(p=y.r,x=y.c,_[2]){case"t":v[p][x]=e(_[3]);break;case"v":v[p][x]=+_[3];break;case"vtf":var b=_[_.length-1];case"vtc":switch(_[3]){case"nl":v[p][x]=!!+_[4];break;default:v[p][x]=+_[4];break}_[2]=="vtf"&&(v[p][x]=[v[p][x],b])}}}return h&&h.sheetRows&&(v=v.slice(0,h.sheetRows)),v}function n(f,h){return cl(r(f,h),h)}function a(f,h){return ls(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],g=[],p,x="",m=Cr(f["!ref"]),v=Array.isArray(f),_=m.s.r;_<=m.e.r;++_)for(var y=m.s.c;y<=m.e.c;++y)if(x=Pe({r:_,c:y}),p=v?(f[_]||[])[y]:f[x],!(!p||p.v==null||p.t==="z")){switch(g=["cell",x,"t"],p.t){case"s":case"str":g.push(t(p.v));break;case"n":p.f?(g[2]="vtf",g[3]="n",g[4]=p.v,g[5]=t(p.f)):(g[2]="v",g[3]=p.v);break;case"b":g[2]="vt"+(p.f?"f":"c"),g[3]="nl",g[4]=p.v?"1":"0",g[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var b=Gt(xt(p.v));g[2]="vtc",g[3]="nd",g[4]=""+b,g[5]=p.w||en(p.z||Fe[14],b);break;case"e":continue}h.push(g.join(":"))}return h.push("sheet:c:"+(m.e.c-m.s.c+1)+":r:"+(m.e.r-m.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[s,i,o,i,u(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),el=function(){function e(d,f,h,g,p){p.raw?f[h][g]=d:d===""||(d==="TRUE"?f[h][g]=!0:d==="FALSE"?f[h][g]=!1:isNaN(On(d))?isNaN(Zi(d).getDate())?f[h][g]=d:f[h][g]=xt(d):f[h][g]=On(d))}function t(d,f){var h=f||{},g=[];if(!d||d.length===0)return g;for(var p=d.split(/[\r\n]/),x=p.length-1;x>=0&&p[x].length===0;)--x;for(var m=10,v=0,_=0;_<=x;++_)v=p[_].indexOf(" "),v==-1?v=p[_].length:v++,m=Math.max(m,v);for(_=0;_<=x;++_){g[_]=[];var y=0;for(e(p[_].slice(0,m).trim(),g,_,y,h),y=1;y<=(p[_].length-m)/10+1;++y)e(p[_].slice(m+(y-1)*10,m+y*10).trim(),g,_,y,h)}return h.sheetRows&&(g=g.slice(0,h.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},h=!1,g=0,p=0;g<d.length;++g)(p=d.charCodeAt(g))==34?h=!h:!h&&p in r&&(f[p]=(f[p]||0)+1);p=[];for(g in f)Object.prototype.hasOwnProperty.call(f,g)&&p.push([f[g],g]);if(!p.length){f=n;for(g in f)Object.prototype.hasOwnProperty.call(f,g)&&p.push([f[g],g])}return p.sort(function(x,m){return x[0]-m[0]||n[x[1]]-n[m[1]]}),r[p.pop()[1]]||44}function s(d,f){var h=f||{},g="",p=h.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(g=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(g=d.charAt(4),d=d.slice(6)):g=a(d.slice(0,1024)):h&&h.FS?g=h.FS:g=a(d.slice(0,1024));var m=0,v=0,_=0,y=0,b=0,E=g.charCodeAt(0),T=!1,k=0,A=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var M=h.dateNF!=null?ZN(h.dateNF):null;function B(){var G=d.slice(y,b),U={};if(G.charAt(0)=='"'&&G.charAt(G.length-1)=='"'&&(G=G.slice(1,-1).replace(/""/g,'"')),G.length===0)U.t="z";else if(h.raw)U.t="s",U.v=G;else if(G.trim().length===0)U.t="s",U.v=G;else if(G.charCodeAt(0)==61)G.charCodeAt(1)==34&&G.charCodeAt(G.length-1)==34?(U.t="s",U.v=G.slice(2,-1).replace(/""/g,'"')):C6(G)?(U.t="n",U.f=G.slice(1)):(U.t="s",U.v=G);else if(G=="TRUE")U.t="b",U.v=!0;else if(G=="FALSE")U.t="b",U.v=!1;else if(!isNaN(_=On(G)))U.t="n",h.cellText!==!1&&(U.w=G),U.v=_;else if(!isNaN(Zi(G).getDate())||M&&G.match(M)){U.z=h.dateNF||Fe[14];var ne=0;M&&G.match(M)&&(G=e4(G,h.dateNF,G.match(M)||[]),ne=1),h.cellDates?(U.t="d",U.v=xt(G,ne)):(U.t="n",U.v=Gt(xt(G,ne))),h.cellText!==!1&&(U.w=en(U.z,U.v instanceof Date?Gt(U.v):U.v)),h.cellNF||delete U.z}else U.t="s",U.v=G;if(U.t=="z"||(h.dense?(p[m]||(p[m]=[]),p[m][v]=U):p[Pe({c:v,r:m})]=U),y=b+1,A=d.charCodeAt(y),x.e.c<v&&(x.e.c=v),x.e.r<m&&(x.e.r=m),k==E)++v;else if(v=0,++m,h.sheetRows&&h.sheetRows<=m)return!0}e:for(;b<d.length;++b)switch(k=d.charCodeAt(b)){case 34:A===34&&(T=!T);break;case E:case 10:case 13:if(!T&&B())break e;break}return b-y>0&&B(),p["!ref"]=Ie(x),p}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):cl(t(d,f),f)}function o(d,f){var h="",g=f.type=="string"?[0,0,0,0]:hm(d,f);switch(f.type){case"base64":h=Zr(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof qe<"u"?h=qe.utils.decode(f.codepage,d):h=ze&&Buffer.isBuffer(d)?d.toString("binary"):is(d);break;case"array":h=Ls(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return g[0]==239&&g[1]==187&&g[2]==191?h=st(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=st(h):f.type=="binary"&&typeof qe<"u"&&f.codepage&&(h=qe.utils.decode(f.codepage,qe.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?t_.to_sheet(f.type=="string"?h:st(h),f):i(h,f)}function c(d,f){return ls(o(d,f),f)}function u(d){for(var f=[],h=Ve(d["!ref"]),g,p=Array.isArray(d),x=h.s.r;x<=h.e.r;++x){for(var m=[],v=h.s.c;v<=h.e.c;++v){var _=Pe({r:x,c:v});if(g=p?(d[x]||[])[v]:d[_],!g||g.v==null){m.push("          ");continue}for(var y=(g.w||(Jn(g),g.w)||"").slice(0,10);y.length<10;)y+=" ";m.push(y+(v===0?" ":""))}f.push(m.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function xj(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=Zy.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return el.to_workbook(e,t)}}var Es=function(){function e(P,V,D){if(P){rr(P,P.l||0);for(var R=D.Enum||ae;P.l<P.length;){var te=P.read_shift(2),F=R[te]||R[65535],q=P.read_shift(2),X=P.l+q,L=F.f&&F.f(P,q,D);if(P.l=X,V(L,F,te))return}}}function t(P,V){switch(V.type){case"base64":return r(Wr(Zr(P)),V);case"binary":return r(Wr(P),V);case"buffer":case"array":return r(P,V)}throw"Unsupported type "+V.type}function r(P,V){if(!P)return P;var D=V||{},R=D.dense?[]:{},te="Sheet1",F="",q=0,X={},L=[],J=[],j={s:{r:0,c:0},e:{r:0,c:0}},ke=D.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)D.Enum=ae,e(P,function(he,Ue,Ke){switch(Ke){case 0:D.vers=he,he>=4096&&(D.qpro=!0);break;case 6:j=he;break;case 204:he&&(F=he);break;case 222:F=he;break;case 15:case 51:D.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:Ke==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=D.dateNF||Fe[14],D.cellDates&&(he[1].t="d",he[1].v=ru(he[1].v))),D.qpro&&he[3]>q&&(R["!ref"]=Ie(j),X[te]=R,L.push(te),R=D.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},q=he[3],te=F||"Sheet"+(q+1),F="");var nt=D.dense?(R[he[0].r]||[])[he[0].c]:R[Pe(he[0])];if(nt){nt.t=he[1].t,nt.v=he[1].v,he[1].z!=null&&(nt.z=he[1].z),he[1].f!=null&&(nt.f=he[1].f);break}D.dense?(R[he[0].r]||(R[he[0].r]=[]),R[he[0].r][he[0].c]=he[1]):R[Pe(he[0])]=he[1];break}},D);else if(P[2]==26||P[2]==14)D.Enum=K,P[2]==14&&(D.qpro=!0,P.l=0),e(P,function(he,Ue,Ke){switch(Ke){case 204:te=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>q&&(R["!ref"]=Ie(j),X[te]=R,L.push(te),R=D.dense?[]:{},j={s:{r:0,c:0},e:{r:0,c:0}},q=he[3],te="Sheet"+(q+1)),ke>0&&he[0].r>=ke)break;D.dense?(R[he[0].r]||(R[he[0].r]=[]),R[he[0].r][he[0].c]=he[1]):R[Pe(he[0])]=he[1],j.e.c<he[0].c&&(j.e.c=he[0].c),j.e.r<he[0].r&&(j.e.r=he[0].r);break;case 27:he[14e3]&&(J[he[14e3][0]]=he[14e3][1]);break;case 1537:J[he[0]]=he[1],he[0]==q&&(te=he[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(R["!ref"]=Ie(j),X[F||te]=R,L.push(F||te),!J.length)return{SheetNames:L,Sheets:X};for(var ue={},ve=[],Te=0;Te<J.length;++Te)X[L[Te]]?(ve.push(J[Te]||L[Te]),ue[J[Te]]=X[J[Te]]||X[L[Te]]):(ve.push(J[Te]),ue[J[Te]]={"!ref":"A1"});return{SheetNames:ve,Sheets:ue}}function n(P,V){var D=V||{};if(+D.codepage>=0&&xn(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var R=Ur(),te=Ve(P["!ref"]),F=Array.isArray(P),q=[];be(R,0,s(1030)),be(R,6,c(te));for(var X=Math.min(te.e.r,8191),L=te.s.r;L<=X;++L)for(var J=jt(L),j=te.s.c;j<=te.e.c;++j){L===te.s.r&&(q[j]=mt(j));var ke=q[j]+J,ue=F?(P[L]||[])[j]:P[ke];if(!(!ue||ue.t=="z"))if(ue.t=="n")(ue.v|0)==ue.v&&ue.v>=-32768&&ue.v<=32767?be(R,13,g(L,j,ue.v)):be(R,14,x(L,j,ue.v));else{var ve=Jn(ue);be(R,15,f(L,j,ve.slice(0,239)))}}return be(R,1),R.end()}function a(P,V){var D=V||{};if(+D.codepage>=0&&xn(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var R=Ur();be(R,0,i(P));for(var te=0,F=0;te<P.SheetNames.length;++te)(P.Sheets[P.SheetNames[te]]||{})["!ref"]&&be(R,27,H(P.SheetNames[te],F++));var q=0;for(te=0;te<P.SheetNames.length;++te){var X=P.Sheets[P.SheetNames[te]];if(!(!X||!X["!ref"])){for(var L=Ve(X["!ref"]),J=Array.isArray(X),j=[],ke=Math.min(L.e.r,8191),ue=L.s.r;ue<=ke;++ue)for(var ve=jt(ue),Te=L.s.c;Te<=L.e.c;++Te){ue===L.s.r&&(j[Te]=mt(Te));var he=j[Te]+ve,Ue=J?(X[ue]||[])[Te]:X[he];if(!(!Ue||Ue.t=="z"))if(Ue.t=="n")be(R,23,B(ue,Te,q,Ue.v));else{var Ke=Jn(Ue);be(R,22,k(ue,Te,q,Ke.slice(0,239)))}}++q}}return be(R,1),R.end()}function s(P){var V=ce(2);return V.write_shift(2,P),V}function i(P){var V=ce(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var D=0,R=0,te=0,F=0;F<P.SheetNames.length;++F){var q=P.SheetNames[F],X=P.Sheets[q];if(!(!X||!X["!ref"])){++te;var L=Cr(X["!ref"]);D<L.e.r&&(D=L.e.r),R<L.e.c&&(R=L.e.c)}}return D>8191&&(D=8191),V.write_shift(2,D),V.write_shift(1,te),V.write_shift(1,R),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function o(P,V,D){var R={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&D.qpro?(R.s.c=P.read_shift(1),P.l++,R.s.r=P.read_shift(2),R.e.c=P.read_shift(1),P.l++,R.e.r=P.read_shift(2),R):(R.s.c=P.read_shift(2),R.s.r=P.read_shift(2),V==12&&D.qpro&&(P.l+=2),R.e.c=P.read_shift(2),R.e.r=P.read_shift(2),V==12&&D.qpro&&(P.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function c(P){var V=ce(8);return V.write_shift(2,P.s.c),V.write_shift(2,P.s.r),V.write_shift(2,P.e.c),V.write_shift(2,P.e.r),V}function u(P,V,D){var R=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(R[0].c=P.read_shift(1),R[3]=P.read_shift(1),R[0].r=P.read_shift(2),P.l+=2):(R[2]=P.read_shift(1),R[0].c=P.read_shift(2),R[0].r=P.read_shift(2)),R}function d(P,V,D){var R=P.l+V,te=u(P,V,D);if(te[1].t="s",D.vers==20768){P.l++;var F=P.read_shift(1);return te[1].v=P.read_shift(F,"utf8"),te}return D.qpro&&P.l++,te[1].v=P.read_shift(R-P.l,"cstr"),te}function f(P,V,D){var R=ce(7+D.length);R.write_shift(1,255),R.write_shift(2,V),R.write_shift(2,P),R.write_shift(1,39);for(var te=0;te<R.length;++te){var F=D.charCodeAt(te);R.write_shift(1,F>=128?95:F)}return R.write_shift(1,0),R}function h(P,V,D){var R=u(P,V,D);return R[1].v=P.read_shift(2,"i"),R}function g(P,V,D){var R=ce(7);return R.write_shift(1,255),R.write_shift(2,V),R.write_shift(2,P),R.write_shift(2,D,"i"),R}function p(P,V,D){var R=u(P,V,D);return R[1].v=P.read_shift(8,"f"),R}function x(P,V,D){var R=ce(13);return R.write_shift(1,255),R.write_shift(2,V),R.write_shift(2,P),R.write_shift(8,D,"f"),R}function m(P,V,D){var R=P.l+V,te=u(P,V,D);if(te[1].v=P.read_shift(8,"f"),D.qpro)P.l=R;else{var F=P.read_shift(2);b(P.slice(P.l,P.l+F),te),P.l+=F}return te}function v(P,V,D){var R=V&32768;return V&=-32769,V=(R?P:0)+(V>=8192?V-16384:V),(R?"":"$")+(D?mt(V):jt(V))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function b(P,V){rr(P,0);for(var D=[],R=0,te="",F="",q="",X="";P.l<P.length;){var L=P[P.l++];switch(L){case 0:D.push(P.read_shift(8,"f"));break;case 1:F=v(V[0].c,P.read_shift(2),!0),te=v(V[0].r,P.read_shift(2),!1),D.push(F+te);break;case 2:{var J=v(V[0].c,P.read_shift(2),!0),j=v(V[0].r,P.read_shift(2),!1);F=v(V[0].c,P.read_shift(2),!0),te=v(V[0].r,P.read_shift(2),!1),D.push(J+j+":"+F+te)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(P.read_shift(2));break;case 6:{for(var ke="";L=P[P.l++];)ke+=String.fromCharCode(L);D.push('"'+ke.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:X=D.pop(),q=D.pop(),D.push(["AND","OR"][L-20]+"("+q+","+X+")");break;default:if(L<32&&y[L])X=D.pop(),q=D.pop(),D.push(q+y[L]+X);else if(_[L]){if(R=_[L][1],R==69&&(R=P[P.l++]),R>D.length){console.error("WK1 bad formula parse 0x"+L.toString(16)+":|"+D.join("|")+"|");return}var ue=D.slice(-R);D.length-=R,D.push(_[L][0]+"("+ue.join(",")+")")}else return L<=7?console.error("WK1 invalid opcode "+L.toString(16)):L<=24?console.error("WK1 unsupported op "+L.toString(16)):L<=30?console.error("WK1 invalid opcode "+L.toString(16)):L<=115?console.error("WK1 unsupported function opcode "+L.toString(16)):console.error("WK1 unrecognized opcode "+L.toString(16))}}D.length==1?V[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function E(P){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=P.read_shift(2),V[3]=P[P.l++],V[0].c=P[P.l++],V}function T(P,V){var D=E(P);return D[1].t="s",D[1].v=P.read_shift(V-4,"cstr"),D}function k(P,V,D,R){var te=ce(6+R.length);te.write_shift(2,P),te.write_shift(1,D),te.write_shift(1,V),te.write_shift(1,39);for(var F=0;F<R.length;++F){var q=R.charCodeAt(F);te.write_shift(1,q>=128?95:q)}return te.write_shift(1,0),te}function A(P,V){var D=E(P);D[1].v=P.read_shift(2);var R=D[1].v>>1;if(D[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return D[1].v=R,D}function M(P,V){var D=E(P),R=P.read_shift(4),te=P.read_shift(4),F=P.read_shift(2);if(F==65535)return R===0&&te===3221225472?(D[1].t="e",D[1].v=15):R===0&&te===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var q=F&32768;return F=(F&32767)-16446,D[1].v=(1-q*2)*(te*Math.pow(2,F+32)+R*Math.pow(2,F)),D}function B(P,V,D,R){var te=ce(14);if(te.write_shift(2,P),te.write_shift(1,D),te.write_shift(1,V),R==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var F=0,q=0,X=0,L=0;return R<0&&(F=1,R=-R),q=Math.log2(R)|0,R/=Math.pow(2,q-31),L=R>>>0,L&2147483648||(R/=2,++q,L=R>>>0),R-=L,L|=2147483648,L>>>=0,R*=Math.pow(2,32),X=R>>>0,te.write_shift(4,X),te.write_shift(4,L),q+=16383+(F?32768:0),te.write_shift(2,q),te}function G(P,V){var D=M(P);return P.l+=V-14,D}function U(P,V){var D=E(P),R=P.read_shift(4);return D[1].v=R>>6,D}function ne(P,V){var D=E(P),R=P.read_shift(8,"f");return D[1].v=R,D}function de(P,V){var D=ne(P);return P.l+=V-10,D}function oe(P,V){return P[P.l+V-1]==0?P.read_shift(V,"cstr"):""}function Y(P,V){var D=P[P.l++];D>V-1&&(D=V-1);for(var R="";R.length<D;)R+=String.fromCharCode(P[P.l++]);return R}function se(P,V,D){if(!(!D.qpro||V<21)){var R=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var te=P.read_shift(V-21,"cstr");return[R,te]}}function Z(P,V){for(var D={},R=P.l+V;P.l<R;){var te=P.read_shift(2);if(te==14e3){for(D[te]=[0,""],D[te][0]=P.read_shift(2);P[P.l];)D[te][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return D}function H(P,V){var D=ce(5+P.length);D.write_shift(2,14e3),D.write_shift(2,V);for(var R=0;R<P.length;++R){var te=P.charCodeAt(R);D[D.l++]=te>127?95:te}return D[D.l++]=0,D}var ae={0:{n:"BOF",f:Bt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:m},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:oe},222:{n:"SHEETNAMELP",f:Y},65535:{n:""}},K={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:T},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Z},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:U},38:{n:"??"},39:{n:"NUMBER27",f:ne},40:{n:"FORMULA28",f:de},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:oe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function pj(e){var t={},r=e.match(wr),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=De(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=Th[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var gj=function(){var e=No("t"),t=No("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:Ye(i[1])},c=s.match(t);return c&&(o.s=pj(c[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),vj=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),yj=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,_j=/<(?:\w+:)?r>/,wj=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Zh(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Ye(st(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=st(e),r&&(n.h=Rh(n.t))):e.match(_j)&&(n.r=st(e),n.t=Ye(st((e.replace(wj,"").match(yj)||[]).join("").replace(wr,""))),r&&(n.h=vj(gj(n.r)))),n):{t:""}}var bj=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,kj=/<(?:\w+:)?(?:si|sstItem)>/g,Sj=/<\/(?:\w+:)?(?:si|sstItem)>/;function Nj(e,t){var r=[],n="";if(!e)return r;var a=e.match(bj);if(a){n=a[2].replace(kj,"").split(Sj);for(var s=0;s!=n.length;++s){var i=Zh(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=De(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var Ej=/^\s|\s$|[\t\n\r]/;function r_(e,t){if(!t.bookSST)return"";var r=[It];r[r.length]=we("sst",null,{xmlns:qs[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(Ej)&&(s+=' xml:space="preserve"'),s+=">"+tt(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Tj(e){return[e.read_shift(4),e.read_shift(4)]}function jj(e,t){var r=[],n=!1;return ya(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Cj(e,t){return t||(t=ce(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Aj=U4;function Fj(e){var t=Ur();fe(t,159,Cj(e));for(var r=0;r<e.length;++r)fe(t,19,Aj(e[r]));return fe(t,160),t.end()}function n_(e){if(typeof qe<"u")return qe.utils.encode(Rs,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function fa(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Pj(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=fa(e,4),t.U=fa(e,4),t.W=fa(e,4),t}function Dj(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Oj(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Dj(e));return t}function Rj(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Ij(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=fa(e,4),t.U=fa(e,4),t.W=fa(e,4),t}function Lj(e){var t=Ij(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function a_(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function s_(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Mj(e){var t=fa(e);switch(t.Minor){case 2:return[t.Minor,Bj(e)];case 3:return[t.Minor,Uj()];case 4:return[t.Minor,zj(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Bj(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=a_(e,r),a=s_(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Uj(){throw new Error("File is password-protected: ECMA-376 Extensible")}function zj(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(wr,function(s){var i=De(s);switch(Qn(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function $j(e,t){var r={},n=r.EncryptionVersionInfo=fa(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=a_(e,a),t-=a,r.EncryptionVerifier=s_(e,t),r}function Hj(e){var t={},r=t.EncryptionVersionInfo=fa(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function em(e){var t=0,r,n=n_(e),a=n.length+1,s,i,o,c,u;for(r=Qa(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^i;return t^52811}var i_=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],c=104,u=i.length-1;u>=0;--u)for(var d=i[u],f=0;f!=7;++f)d&64&&(o^=r[c]),d*=2,--c;return o};return function(i){for(var o=n_(i),c=s(o),u=o.length,d=Qa(16),f=0;f!=16;++f)d[f]=0;var h,g,p;for((u&1)===1&&(h=c>>8,d[u]=a(e[0],h),--u,h=c&255,g=o[o.length-1],d[u]=a(g,h));u>0;)--u,h=c>>8,d[u]=a(o[u],h),--u,h=c&255,d[u]=a(o[u],h);for(u=15,p=15-o.length;p>0;)h=c>>8,d[u]=a(e[p],h),--u,--p,h=c&255,d[u]=a(o[u],h),--u,--p;return d}}(),Wj=function(e,t,r,n,a){a||(a=t),n||(n=i_(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},Vj=function(e){var t=0,r=i_(e);return function(n){var a=Wj("",n,t,r);return t=a[1],a[0]}};function Gj(e,t,r,n){var a={key:Bt(e),verificationBytes:Bt(e)};return r.password&&(a.verifier=em(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Vj(r.password)),a}function Kj(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Hj(e):n.Data=$j(e,t),n}function qj(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Kj(e,t-2,n):Gj(e,r.biff>=8?t:t-2,r,n),n}var l_=function(){function e(a,s){switch(s.type){case"base64":return t(Zr(a),s);case"binary":return t(a,s);case"buffer":return t(ze&&Buffer.isBuffer(a)?a.toString("binary"):is(a),s);case"array":return t(Ls(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,g=0,p,x=-1;p=h.exec(d);){switch(p[0]){case"\\cell":var m=d.slice(g,h.lastIndex-p[0].length);if(m[0]==" "&&(m=m.slice(1)),++x,m.length){var v={v:m,t:"s"};Array.isArray(o)?o[f][x]=v:o[Pe({r:f,c:x})]=v}break}g=h.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=Ie(u),o}function r(a,s){return ls(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=Ve(a["!ref"]),o,c=Array.isArray(a),u=i.s.r;u<=i.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var f=Pe({r:u,c:d});o=c?(a[u]||[])[d]:a[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Jn(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Xj(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Co(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Yj(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,c=0,u=a+s;switch(c=i/(u>1?2-u:u),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,c,u/2]}function Jj(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=a*o,i[0]+=a,i[1]+=c;break;case 1:c=a*(2-o),i[0]+=c,i[1]+=a;break;case 2:c=a*(o-2),i[1]+=a,i[2]+=c;break;case 3:c=a*(4-o),i[1]+=c,i[2]+=a;break;case 4:c=a*(o-4),i[2]+=a,i[0]+=c;break;case 5:c=a*(6-o),i[2]+=c,i[0]+=a;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function j0(e,t){if(t===0)return e;var r=Yj(Xj(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Co(Jj(r))}var o_=6,Qj=15,Zj=1,xr=o_;function Ao(e){return Math.floor((e+Math.round(128/xr)/256)*xr)}function Fo(e){return Math.floor((e-5)/xr*100+.5)/100}function C0(e){return Math.round((e*xr+5)/xr*256)/256}function Yu(e){return C0(Fo(Ao(e)))}function tm(e){var t=Math.abs(e-Yu(e)),r=xr;if(t>.005)for(xr=Zj;xr<Qj;++xr)Math.abs(e-Yu(e))<=t&&(t=Math.abs(e-Yu(e)),r=xr);xr=r}function Za(e){e.width?(e.wpx=Ao(e.width),e.wch=Fo(e.wpx),e.MDW=xr):e.wpx?(e.wch=Fo(e.wpx),e.width=C0(e.wch),e.MDW=xr):typeof e.wch=="number"&&(e.width=C0(e.wch),e.wpx=Ao(e.width),e.MDW=xr),e.customWidth&&delete e.customWidth}var e3=96,c_=e3;function Po(e){return e*96/c_}function tl(e){return e*c_/96}var t3={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function r3(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(wr)||[]).forEach(function(i){var o=De(i);switch(Qn(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=ft(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=ft(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function n3(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(wr)||[]).forEach(function(i){var o=De(i);switch(Qn(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function a3(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(wr)||[]).forEach(function(i){var o=De(i);switch(Qn(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=st(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?ft(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?ft(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?ft(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?ft(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?ft(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?ft(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?ft(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Th[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=ft(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var c=Ss[a.color.index];a.color.index==81&&(c=Ss[1]),c||(c=Ss[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=j0(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function s3(e,t,r){t.NumberFmt=[];for(var n=At(Fe),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Fe[n[a]];var s=e[0].match(wr);if(s)for(a=0;a<s.length;++a){var i=De(s[a]);switch(Qn(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ye(st(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}Xn(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function i3(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=we("numFmt",null,{numFmtId:n,formatCode:tt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=we("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Tc=["numFmtId","fillId","fontId","borderId","xfId"],jc=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function l3(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(wr)||[]).forEach(function(s){var i=De(s),o=0;switch(Qn(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Tc.length;++o)n[Tc[o]]&&(n[Tc[o]]=parseInt(n[Tc[o]],10));for(o=0;o<jc.length;++o)n[jc[o]]&&(n[jc[o]]=ft(n[jc[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=ft(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function o3(e){var t=[];return t[t.length]=we("cellXfs",null),e.forEach(function(r){t[t.length]=we("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=we("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var c3=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&s3(f,d,u),(f=o.match(a))&&a3(f,d,c,u),(f=o.match(n))&&n3(f,d,c,u),(f=o.match(s))&&r3(f,d,c,u),(f=o.match(r))&&l3(f,d,u),d}}();function u_(e,t){var r=[It,we("styleSheet",null,{xmlns:qs[0],"xmlns:vt":Wt.vt})],n;return e.SSF&&(n=i3(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=o3(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function u3(e,t){var r=e.read_shift(2),n=vr(e);return[r,n]}function d3(e,t,r){r||(r=ce(6+4*t.length)),r.write_shift(2,e),Qt(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function f3(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=K4(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=G4(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=vr(e),n}function h3(e,t){t||(t=ce(25+4*32)),t.write_shift(2,e.sz*20),q4(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),N0(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),Qt(e.name,t),t.length>t.l?t.slice(0,t.l):t}var m3=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ju,x3=_r;function Lp(e,t){t||(t=ce(4*3+8*7+16*1)),Ju||(Ju=eu(m3));var r=Ju[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(N0({auto:1},t),N0({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function p3(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function d_(e,t,r){r||(r=ce(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function El(e,t){return t||(t=ce(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var g3=_r;function v3(e,t){return t||(t=ce(51)),t.write_shift(1,0),El(null,t),El(null,t),El(null,t),El(null,t),El(null,t),t.length>t.l?t.slice(0,t.l):t}function y3(e,t){return t||(t=ce(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),S0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function _3(e,t,r){var n=ce(2052);return n.write_shift(4,e),S0(t,n),S0(r,n),n.length>n.l?n.slice(0,n.l):n}function w3(e,t,r){var n={};n.NumberFmt=[];for(var a in Fe)n.NumberFmt[a]=Fe[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return ya(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],Xn(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=j0(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(d),i=!0;break;case 38:s.pop(),i=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function b3(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(fe(e,615,Rn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&fe(e,44,d3(a,t[a]))}),fe(e,616))}}function k3(e){var t=1;fe(e,611,Rn(t)),fe(e,43,h3({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),fe(e,612)}function S3(e){var t=2;fe(e,603,Rn(t)),fe(e,45,Lp({patternType:"none"})),fe(e,45,Lp({patternType:"gray125"})),fe(e,604)}function N3(e){var t=1;fe(e,613,Rn(t)),fe(e,46,v3()),fe(e,614)}function E3(e){var t=1;fe(e,626,Rn(t)),fe(e,47,d_({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),fe(e,627)}function T3(e,t){fe(e,617,Rn(t.length)),t.forEach(function(r){fe(e,47,d_(r,0))}),fe(e,618)}function j3(e){var t=1;fe(e,619,Rn(t)),fe(e,48,y3({xfId:0,builtinId:0,name:"Normal"})),fe(e,620)}function C3(e){var t=0;fe(e,505,Rn(t)),fe(e,506)}function A3(e){var t=0;fe(e,508,_3(t,"TableStyleMedium9","PivotStyleMedium4")),fe(e,509)}function F3(e,t){var r=Ur();return fe(r,278),b3(r,e.SSF),k3(r),S3(r),N3(r),E3(r),T3(r,t.cellXfs),j3(r),C3(r),A3(r),fe(r,279),r.end()}var P3=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function D3(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(wr)||[]).forEach(function(a){var s=De(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[P3.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function O3(){}function R3(){}var I3=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,L3=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,M3=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function B3(e,t,r){t.themeElements={};var n;[["clrScheme",I3,D3],["fontScheme",L3,O3],["fmtScheme",M3,R3]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var U3=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function f_(e,t){(!e||e.length===0)&&(e=rm());var r,n={};if(!(r=e.match(U3)))throw new Error("themeElements not found in theme");return B3(r[0],n,t),n.raw=e,n}function rm(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[It];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function z3(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=oy(s,{type:"array"})}catch{return}var o=Vr(i,"theme/theme/theme1.xml",!0);if(o)return f_(o,r)}}function $3(e){return e.read_shift(4)}function H3(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=W3(e,4);break;case 2:t.xclrValue=Vy(e);break;case 3:t.xclrValue=$3(e);break;case 4:e.l+=4;break}return e.l+=8,t}function W3(e,t){return _r(e,t)}function V3(e,t){return _r(e,t)}function G3(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=H3(e);break;case 6:n[1]=V3(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function K3(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(G3(e,r-e.l));return{ixfe:n,ext:s}}function q3(e,t){t.forEach(function(r){switch(r[0]){}})}function X3(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:vr(e)}}function Y3(e){var t=ce(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Qt(e.name,t),t.slice(0,t.l)}function J3(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Q3(e){var t=ce(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Z3(e,t){var r=ce(8+2*t.length);return r.write_shift(4,e),Qt(t,r),r.slice(0,r.l)}function e6(e){return e.l+=4,e.read_shift(4)!=0}function t6(e,t){var r=ce(8);return r.write_shift(4,e),r.write_shift(4,1),r}function r6(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return ya(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(d),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!u.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function n6(){var e=Ur();return fe(e,332),fe(e,334,Rn(1)),fe(e,335,Y3({name:"XLDAPR",version:12e4,flags:3496657072})),fe(e,336),fe(e,339,Z3(1,"XLDAPR")),fe(e,52),fe(e,35,Rn(514)),fe(e,4096,Rn(0)),fe(e,4097,dn(1)),fe(e,36),fe(e,53),fe(e,340),fe(e,337,t6(1)),fe(e,51,Q3([[1,0]])),fe(e,338),fe(e,333),e.end()}function a6(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(wr,function(o){var c=De(o);switch(Qn(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function h_(){var e=[It];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function s6(e){var t=[];if(!e)return t;var r=1;return(e.match(wr)||[]).forEach(function(n){var a=De(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function i6(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Pe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function l6(e,t,r){var n=[];return ya(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function o6(e,t,r,n){if(!e)return e;var a=n||{},s=!1;ya(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function c6(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Fi=1024;function m_(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[we("xml",null,{"xmlns:v":Hr.v,"xmlns:o":Hr.o,"xmlns:x":Hr.x,"xmlns:mv":Hr.mv}).replace(/\/>/,">"),we("o:shapelayout",we("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),we("v:shapetype",[we("v:stroke",null,{joinstyle:"miter"}),we("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Fi<e*1e3;)Fi+=1e3;return t.forEach(function(s){var i=kt(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?we("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=we("v:fill",c,o),d={on:"t",obscured:"t"};++Fi,a=a.concat(["<v:shape"+Eo({id:"_x0000_s"+Fi,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,we("v:shadow",null,d),we("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",nr("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),nr("x:AutoFill","False"),nr("x:Row",String(i.r)),nr("x:Column",String(i.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Mp(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=kt(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var c=Ve(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=Ie(c);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function u6(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=De(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=kt(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Zh(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function x_(e){var t=[It,we("comments",null,{xmlns:qs[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=tt(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(tt(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(nr("t",tt(s[0]||"")));else{for(var i=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)i+=`Reply:
    `+s[o]+`
`;t.push(nr("t",tt(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function d6(e,t){var r=[],n=!1,a={},s=0;return e.replace(wr,function(o,c){var u=De(o);switch(Qn(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":a.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function f6(e,t,r){var n=[It,we("ThreadedComments",null,{xmlns:Wt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(we("threadedComment",nr("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function h6(e,t){var r=[],n=!1;return e.replace(wr,function(s){var i=De(s);switch(Qn(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function m6(e){var t=[It,we("personList",null,{xmlns:Wt.TCMNT,"xmlns:x":qs[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(we("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function x6(e){var t={};t.iauthor=e.read_shift(4);var r=Qs(e);return t.rfx=r.s,t.ref=Pe(r.s),e.l+=16,t}function p6(e,t){return t==null&&(t=ce(36)),t.write_shift(4,e[1].iauthor),ul(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var g6=vr;function v6(e){return Qt(e.slice(0,54))}function y6(e,t){var r=[],n=[],a={},s=!1;return ya(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function _6(e){var t=Ur(),r=[];return fe(t,628),fe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),fe(t,632,v6(a.a)))})}),fe(t,631),fe(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:kt(n[0]),e:kt(n[0])};fe(t,635,p6([s,a])),a.t&&a.t.length>0&&fe(t,637,$4(a)),fe(t,636),delete a.iauthor})}),fe(t,634),fe(t,629),t.end()}var w6="application/vnd.ms-office.vbaProject";function b6(e){var t=Ce.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ce.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ce.write(t)}function k6(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Ce.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var p_=["xlsb","xlsm","xlam","biff8","xla"];function S6(){return{"!type":"dialog"}}function N6(){return{"!type":"dialog"}}function E6(){return{"!type":"macro"}}function T6(){return{"!type":"macro"}}var Ui=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,a+(o?"":"$")+mt(d)+(c?"":"$")+jt(u)}return function(a,s){return t=s,a.replace(e,r)}}(),nm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,am=function(){return function(t,r){return t.replace(nm,function(n,a,s,i,o,c){var u=Wh(i)-(s?0:r.c),d=Hh(c)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",h=u==0?"":s?u+1:"["+u+"]";return a+"R"+f+"C"+h})}}();function g_(e,t){return e.replace(nm,function(r,n,a,s,i,o){return n+(a=="$"?a+s:mt(Wh(s)+t.c))+(i=="$"?i+o:jt(Hh(o)+t.r))})}function j6(e,t,r){var n=Cr(t),a=n.s,s=kt(r),i={r:s.r-a.r,c:s.c-a.c};return g_(e,i)}function C6(e){return e.length!=1}function Bp(e){return e.replace(/_xlfn\./g,"")}function Lt(e){e.l+=1}function es(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function v_(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return y_(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=es(e),o=es(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function y_(e){var t=es(e),r=es(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function A6(e,t,r){if(r.biff<8)return y_(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=es(e),i=es(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function __(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return F6(e);var n=e.read_shift(r&&r.biff==12?4:2),a=es(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function F6(e){var t=es(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function P6(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function D6(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return O6(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function O6(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function R6(e,t,r){var n=(e[e.l++]&96)>>5,a=v_(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function I6(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=v_(e,s,r);return[n,a,i]}function L6(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function M6(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function B6(e,t,r){var n=(e[e.l++]&96)>>5,a=A6(e,t-1,r);return[n,a]}function U6(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Up(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function z6(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function $6(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function H6(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function W6(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function V6(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function w_(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function G6(e){return e.read_shift(2),w_(e)}function K6(e){return e.read_shift(2),w_(e)}function q6(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=__(e,0,r);return[n,a]}function X6(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=D6(e,0,r);return[n,a]}function Y6(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=__(e,0,r);return[n,a,s]}function J6(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[e5[a],S_[a],n]}function Q6(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Z6(e);return[a,(s[0]===0?S_:ZC)[s[1]]]}function Z6(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function eC(e,t,r){e.l+=r&&r.biff==2?3:4}function tC(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function rC(e){return e.l++,_a[e.read_shift(1)]}function nC(e){return e.l++,e.read_shift(2)}function aC(e){return e.l++,e.read_shift(1)!==0}function sC(e){return e.l++,pr(e)}function iC(e,t,r){return e.l++,Go(e,t-1,r)}function lC(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Dt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=_a[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=pr(e);break;case 2:r[1]=Zs(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function oC(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?Qs:au)(e));return a}function cC(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=lC(e,r.biff);return i}function uC(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function dC(e,t,r){if(r.biff==5)return fC(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function fC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function hC(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function mC(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function xC(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function pC(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var gC=_r,vC=_r,yC=_r;function qo(e,t,r){return e.l+=2,[P6(e)]}function sm(e){return e.l+=6,[]}var _C=qo,wC=sm,bC=sm,kC=qo;function b_(e){return e.l+=2,[Bt(e),e.read_shift(2)&1]}var SC=qo,NC=b_,EC=sm,TC=qo,jC=qo,CC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function AC(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=CC[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function FC(e){return e.l+=2,[e.read_shift(4)]}function PC(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function DC(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function OC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function RC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function IC(e){return e.l+=4,[0,0]}var zp={1:{n:"PtgExp",f:tC},2:{n:"PtgTbl",f:yC},3:{n:"PtgAdd",f:Lt},4:{n:"PtgSub",f:Lt},5:{n:"PtgMul",f:Lt},6:{n:"PtgDiv",f:Lt},7:{n:"PtgPower",f:Lt},8:{n:"PtgConcat",f:Lt},9:{n:"PtgLt",f:Lt},10:{n:"PtgLe",f:Lt},11:{n:"PtgEq",f:Lt},12:{n:"PtgGe",f:Lt},13:{n:"PtgGt",f:Lt},14:{n:"PtgNe",f:Lt},15:{n:"PtgIsect",f:Lt},16:{n:"PtgUnion",f:Lt},17:{n:"PtgRange",f:Lt},18:{n:"PtgUplus",f:Lt},19:{n:"PtgUminus",f:Lt},20:{n:"PtgPercent",f:Lt},21:{n:"PtgParen",f:Lt},22:{n:"PtgMissArg",f:Lt},23:{n:"PtgStr",f:iC},26:{n:"PtgSheet",f:PC},27:{n:"PtgEndSheet",f:DC},28:{n:"PtgErr",f:rC},29:{n:"PtgBool",f:aC},30:{n:"PtgInt",f:nC},31:{n:"PtgNum",f:sC},32:{n:"PtgArray",f:U6},33:{n:"PtgFunc",f:J6},34:{n:"PtgFuncVar",f:Q6},35:{n:"PtgName",f:uC},36:{n:"PtgRef",f:q6},37:{n:"PtgArea",f:R6},38:{n:"PtgMemArea",f:hC},39:{n:"PtgMemErr",f:gC},40:{n:"PtgMemNoMem",f:vC},41:{n:"PtgMemFunc",f:mC},42:{n:"PtgRefErr",f:xC},43:{n:"PtgAreaErr",f:L6},44:{n:"PtgRefN",f:X6},45:{n:"PtgAreaN",f:B6},46:{n:"PtgMemAreaN",f:OC},47:{n:"PtgMemNoMemN",f:RC},57:{n:"PtgNameX",f:dC},58:{n:"PtgRef3d",f:Y6},59:{n:"PtgArea3d",f:I6},60:{n:"PtgRefErr3d",f:pC},61:{n:"PtgAreaErr3d",f:M6},255:{}},LC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},MC={1:{n:"PtgElfLel",f:b_},2:{n:"PtgElfRw",f:TC},3:{n:"PtgElfCol",f:_C},6:{n:"PtgElfRwV",f:jC},7:{n:"PtgElfColV",f:kC},10:{n:"PtgElfRadical",f:SC},11:{n:"PtgElfRadicalS",f:EC},13:{n:"PtgElfColS",f:wC},15:{n:"PtgElfColSV",f:bC},16:{n:"PtgElfRadicalLel",f:NC},25:{n:"PtgList",f:AC},29:{n:"PtgSxName",f:FC},255:{}},BC={0:{n:"PtgAttrNoop",f:IC},1:{n:"PtgAttrSemi",f:V6},2:{n:"PtgAttrIf",f:H6},4:{n:"PtgAttrChoose",f:z6},8:{n:"PtgAttrGoto",f:$6},16:{n:"PtgAttrSum",f:eC},32:{n:"PtgAttrBaxcel",f:Up},33:{n:"PtgAttrBaxcel",f:Up},64:{n:"PtgAttrSpace",f:G6},65:{n:"PtgAttrSpaceSemi",f:K6},128:{n:"PtgAttrIfError",f:W6},255:{}};function Xo(e,t,r,n){if(n.biff<8)return _r(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=cC(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=oC(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(_r(e,t)),s}function Yo(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=zp[s]||zp[LC[s]],(s===24||s===25)&&(a=(s===24?MC:BC)[e[e.l+1]]),!a||!a.f?_r(e,t):i.push([a.n,a.f(e,t,r)]);return i}function UC(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var zC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function $C(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function k_(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function $p(e,t,r){var n=k_(e,t,r);return n=="#REF"?n:$C(n,r)}function hr(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,u,d,f=0,h=0,g,p="";if(!e[0]||!e[0][0])return"";for(var x=-1,m="",v=0,_=e[0].length;v<_;++v){var y=e[0][v];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),x>=0){switch(e[0][x][1][0]){case 0:m=Tt(" ",e[0][x][1][1]);break;case 1:m=Tt("\r",e[0][x][1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}u=u+m,x=-1}o.push(u+zC[y[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Xl(y[1][1],i,a),o.push(Yl(d,s));break;case"PtgRefN":d=r?Xl(y[1][1],r,a):y[1][1],o.push(Yl(d,s));break;case"PtgRef3d":f=y[1][1],d=Xl(y[1][2],i,a),p=$p(n,f,a),o.push(p+"!"+Yl(d,s));break;case"PtgFunc":case"PtgFuncVar":var b=y[1][0],E=y[1][1];b||(b=0),b&=127;var T=b==0?[]:o.slice(-b);o.length-=b,E==="User"&&(E=T.shift()),o.push(E+"("+T.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":g=gp(y[1][1],r?{s:r}:i,a),o.push(Ku(g,a));break;case"PtgArea":g=gp(y[1][1],i,a),o.push(Ku(g,a));break;case"PtgArea3d":f=y[1][1],g=y[1][2],p=$p(n,f,a),o.push(p+"!"+Ku(g,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var k=(n.names||[])[h-1]||(n[0]||[])[h],A=k?k.Name:"SH33TJSNAME"+String(h);A&&A.slice(0,6)=="_xlfn."&&!a.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var M=y[1][1];h=y[1][2];var B;if(a.biff<=5)M<0&&(M=-M),n[M]&&(B=n[M][h]);else{var G="";if(((n[M]||[])[0]||[])[0]==14849||(((n[M]||[])[0]||[])[0]==1025?n[M][h]&&n[M][h].itab>0&&(G=n.SheetNames[n[M][h].itab-1]+"!"):G=n.SheetNames[h-1]+"!"),n[M]&&n[M][h])G+=n[M][h].Name;else if(n[0]&&n[0][h])G+=n[0][h].Name;else{var U=(k_(n,M,a)||"").split(";;");U[h-1]?G=U[h-1]:G+="SH33TJSERRX"}o.push(G);break}B||(B={Name:"SH33TJSERRY"}),o.push(B.Name);break;case"PtgParen":var ne="(",de=")";if(x>=0){switch(m="",e[0][x][1][0]){case 2:ne=Tt(" ",e[0][x][1][1])+ne;break;case 3:ne=Tt("\r",e[0][x][1][1])+ne;break;case 4:de=Tt(" ",e[0][x][1][1])+de;break;case 5:de=Tt("\r",e[0][x][1][1])+de;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}o.push(ne+o.pop()+de);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var oe={c:r.c,r:r.r};if(n.sharedf[Pe(d)]){var Y=n.sharedf[Pe(d)];o.push(hr(Y,i,oe,n,a))}else{var se=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(hr(u[1],i,oe,n,a)),se=!0;break}se||o.push(y[1])}break;case"PtgArray":o.push("{"+UC(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var Z=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&Z.indexOf(e[0][v][0])==-1){y=e[0][x];var H=!0;switch(y[1][0]){case 4:H=!1;case 0:m=Tt(" ",y[1][1]);break;case 5:H=!1;case 1:m=Tt("\r",y[1][1]);break;default:if(m="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((H?m:"")+o.pop()+(H?"":m)),x=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function HC(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],_r(e,t-2)];var o=Yo(e,i,r);return t!==i+a&&(s=Xo(e,t-i-a,o,r)),e.l=n,[o,s]}function WC(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],_r(e,t-2)];var o=Yo(e,i,r);return t!==i+a&&(s=Xo(e,t-i-a,o,r)),e.l=n,[o,s]}function VC(e,t,r,n){var a=e.l+t,s=Yo(e,n,r),i;return a!==e.l&&(i=Xo(e,a-e.l,s,r)),[s,i]}function GC(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=Yo(e,s,r);return s==65535?[[],_r(e,t-2)]:(t!==s+2&&(a=Xo(e,n-s-2,i,r)),[i,a])}function KC(e){var t;if(oa(e,e.l+6)!==65535)return[pr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function qC(e){if(e==null){var t=ce(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ms(e);return Ms(0)}function Qu(e,t,r){var n=e.l+t,a=Zn(e);r.biff==2&&++e.l;var s=KC(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=WC(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function XC(e,t,r,n,a){var s=Us(t,r,a),i=qC(e.v),o=ce(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=ce(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=Jt([s,i,o,u]);return f}function su(e,t,r){var n=e.read_shift(4),a=Yo(e,n,r),s=e.read_shift(4),i=s>0?Xo(e,s,a,r):null;return[a,i]}var YC=su,iu=su,JC=su,QC=su,ZC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},S_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},e5={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Hp(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function t5(e){var t="of:="+e.replace(nm,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Zu(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function r5(e){return e.replace(/\./,"!")}var Ql={},zi={},Zl=typeof Map<"u";function im(e,t,r){var n=0,a=e.length;if(r){if(Zl?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Zl?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Zl?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function lu(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(xr=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Fo(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=C0(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Ts(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function os(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){Xn(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function N_(e,t,r,n,a,s){try{n.cellNF&&(e.z=Fe[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=xt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Fe[t]==null&&Xn(QN[t]||"General",t),e.t==="e")e.w=e.w||_a[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=So(e.v);else if(e.t==="d"){var i=Gt(e.v);(i|0)===i?e.w=i.toString(10):e.w=So(i)}else{if(e.v===void 0)return"";e.w=Is(e.v,zi)}else e.t==="d"?e.w=en(t,Gt(e.v),zi):e.w=en(t,e.v,zi)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=j0(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=j0(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function n5(e,t,r){if(e&&e["!ref"]){var n=Ve(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function a5(e,t){var r=Ve(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ie(r))}var s5=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,i5=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,l5=/<(?:\w:)?hyperlink [^>]*>/mg,o5=/"(\w*:\w*)"/,c5=/<(?:\w:)?col\b[^>]*[\/]?>/g,u5=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,d5=/<(?:\w:)?pageMargins[^>]*\/>/g,E_=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,f5=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,h5=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function m5(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(i5);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(E_);h?lm(h[0],o,a,r):(h=u.match(f5))&&p5(h[0],h[1]||"",o,a,r);var g=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var p=u.slice(g,g+50).match(o5);p&&a5(o,p[1])}var x=u.match(h5);x&&x[1]&&C5(x[1],a);var m=[];if(t.cellStyles){var v=u.match(c5);v&&S5(m,v)}f&&P5(f[1],o,t,c,s,i);var _=d.match(u5);_&&(o["!autofilter"]=E5(_[0]));var y=[],b=d.match(s5);if(b)for(g=0;g!=b.length;++g)y[g]=Ve(b[g].slice(b[g].indexOf('"')+1));var E=d.match(l5);E&&w5(o,E,n);var T=d.match(d5);if(T&&(o["!margins"]=b5(De(T[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ie(c)),t.sheetRows>0&&o["!ref"]){var k=Ve(o["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>c.e.r&&(k.e.r=c.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>c.e.c&&(k.e.c=c.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ie(k))}return m.length>0&&(o["!cols"]=m),y.length>0&&(o["!merges"]=y),o}function x5(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ie(e[r])+'"/>';return t+"</mergeCells>"}function lm(e,t,r,n){var a=De(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Ye(st(a.codeName)))}function p5(e,t,r,n,a){lm(e.slice(0,e.indexOf(">")),r,n,a)}function g5(e,t,r,n,a){var s=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,i.codeName=Gn(tt(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+we("outlinePr",null,u)}!s&&!o||(a[a.length]=we("sheetPr",o,i))}var v5=["objects","scenarios","selectLockedCells","selectUnlockedCells"],y5=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function _5(e){var t={sheet:1};return v5.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),y5.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=em(e.password).toString(16).toUpperCase()),we("sheetProtection",null,t)}function w5(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=De(st(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+Ye(s.location))):(s.Target="#"+Ye(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Ve(s.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=Pe({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function b5(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function k5(e){return Ts(e),we("pageMargins",null,e)}function S5(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=De(t[n],!0);a.hidden&&(a.hidden=ft(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,tm(a.width)),Za(a);s<=i;)e[s++]=ot(a)}}function N5(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=we("col",null,lu(a,n)));return r[r.length]="</cols>",r.join("")}function E5(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function T5(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Ie(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,i=Cr(a);i.s.r==i.e.r&&(i.e.r=Cr(t["!ref"]).e.r,a=Ie(i));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),we("autoFilter",null,{ref:a})}var j5=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function C5(e,t){t.Views||(t.Views=[{}]),(e.match(j5)||[]).forEach(function(r,n){var a=De(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),ft(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function A5(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),we("sheetViews",we("sheetView",null,a),{})}function F5(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=_a[e.v];break;case"d":n&&n.cellDates?a=xt(e.v,-1).toISOString():(e=ot(e),e.t="n",a=""+(e.v=Gt(xt(e.v)))),typeof e.z>"u"&&(e.z=Fe[14]);break;default:a=e.v;break}var o=nr("v",tt(a)),c={r:t},u=os(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=nr("v",""+im(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=we("f",tt(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),we("c",o,c)}var P5=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=No("v"),i=No("f");return function(c,u,d,f,h,g){for(var p=0,x="",m=[],v=[],_=0,y=0,b=0,E="",T,k,A=0,M=0,B,G,U=0,ne=0,de=Array.isArray(g.CellXf),oe,Y=[],se=[],Z=Array.isArray(u),H=[],ae={},K=!1,P=!!d.sheetStubs,V=c.split(t),D=0,R=V.length;D!=R;++D){x=V[D].trim();var te=x.length;if(te!==0){var F=0;e:for(p=0;p<te;++p)switch(x[p]){case">":if(x[p-1]!="/"){++p;break e}if(d&&d.cellStyles){if(k=De(x.slice(F,p),!0),A=k.r!=null?parseInt(k.r,10):A+1,M=-1,d.sheetRows&&d.sheetRows<A)continue;ae={},K=!1,k.ht&&(K=!0,ae.hpt=parseFloat(k.ht),ae.hpx=tl(ae.hpt)),k.hidden=="1"&&(K=!0,ae.hidden=!0),k.outlineLevel!=null&&(K=!0,ae.level=+k.outlineLevel),K&&(H[A-1]=ae)}break;case"<":F=p;break}if(F>=p)break;if(k=De(x.slice(F,p),!0),A=k.r!=null?parseInt(k.r,10):A+1,M=-1,!(d.sheetRows&&d.sheetRows<A)){f.s.r>A-1&&(f.s.r=A-1),f.e.r<A-1&&(f.e.r=A-1),d&&d.cellStyles&&(ae={},K=!1,k.ht&&(K=!0,ae.hpt=parseFloat(k.ht),ae.hpx=tl(ae.hpt)),k.hidden=="1"&&(K=!0,ae.hidden=!0),k.outlineLevel!=null&&(K=!0,ae.level=+k.outlineLevel),K&&(H[A-1]=ae)),m=x.slice(p).split(e);for(var q=0;q!=m.length&&m[q].trim().charAt(0)=="<";++q);for(m=m.slice(q),p=0;p!=m.length;++p)if(x=m[p].trim(),x.length!==0){if(v=x.match(r),_=p,y=0,b=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,v!=null&&v.length===2){for(_=0,E=v[1],y=0;y!=E.length&&!((b=E.charCodeAt(y)-64)<1||b>26);++y)_=26*_+b;--_,M=_}else++M;for(y=0;y!=x.length&&x.charCodeAt(y)!==62;++y);if(++y,k=De(x.slice(0,y),!0),k.r||(k.r=Pe({r:A-1,c:M})),E=x.slice(y),T={t:""},(v=E.match(s))!=null&&v[1]!==""&&(T.v=Ye(v[1])),d.cellFormula){if((v=E.match(i))!=null&&v[1]!==""){if(T.f=Ye(st(v[1])).replace(/\r\n/g,`
`),d.xlfn||(T.f=Bp(T.f)),v[0].indexOf('t="array"')>-1)T.F=(E.match(a)||[])[1],T.F.indexOf(":")>-1&&Y.push([Ve(T.F),T.F]);else if(v[0].indexOf('t="shared"')>-1){G=De(v[0]);var X=Ye(st(v[1]));d.xlfn||(X=Bp(X)),se[parseInt(G.si,10)]=[G,X,k.r]}}else(v=E.match(/<f[^>]*\/>/))&&(G=De(v[0]),se[G.si]&&(T.f=j6(se[G.si][1],se[G.si][2],k.r)));var L=kt(k.r);for(y=0;y<Y.length;++y)L.r>=Y[y][0].s.r&&L.r<=Y[y][0].e.r&&L.c>=Y[y][0].s.c&&L.c<=Y[y][0].e.c&&(T.F=Y[y][1])}if(k.t==null&&T.v===void 0)if(T.f||T.F)T.v=0,T.t="n";else if(P)T.t="z";else continue;else T.t=k.t||"n";switch(f.s.c>M&&(f.s.c=M),f.e.c<M&&(f.e.c=M),T.t){case"n":if(T.v==""||T.v==null){if(!P)continue;T.t="z"}else T.v=parseFloat(T.v);break;case"s":if(typeof T.v>"u"){if(!P)continue;T.t="z"}else B=Ql[parseInt(T.v,10)],T.v=B.t,T.r=B.r,d.cellHTML&&(T.h=B.h);break;case"str":T.t="s",T.v=T.v!=null?st(T.v):"",d.cellHTML&&(T.h=Rh(T.v));break;case"inlineStr":v=E.match(n),T.t="s",v!=null&&(B=Zh(v[1]))?(T.v=B.t,d.cellHTML&&(T.h=B.h)):T.v="";break;case"b":T.v=ft(T.v);break;case"d":d.cellDates?T.v=xt(T.v,1):(T.v=Gt(xt(T.v,1)),T.t="n");break;case"e":(!d||d.cellText!==!1)&&(T.w=T.v),T.v=jy[T.v];break}if(U=ne=0,oe=null,de&&k.s!==void 0&&(oe=g.CellXf[k.s],oe!=null&&(oe.numFmtId!=null&&(U=oe.numFmtId),d.cellStyles&&oe.fillId!=null&&(ne=oe.fillId))),N_(T,U,ne,d,h,g),d.cellDates&&de&&T.t=="n"&&Ks(Fe[U])&&(T.t="d",T.v=ru(T.v)),k.cm&&d.xlmeta){var J=(d.xlmeta.Cell||[])[+k.cm-1];J&&J.type=="XLDAPR"&&(T.D=!0)}if(Z){var j=kt(k.r);u[j.r]||(u[j.r]=[]),u[j.r][j.c]=T}else u[k.r]=T}}}}H.length>0&&(u["!rows"]=H)}}();function D5(e,t,r,n){var a=[],s=[],i=Ve(e["!ref"]),o="",c,u="",d=[],f=0,h=0,g=e["!rows"],p=Array.isArray(e),x={r:u},m,v=-1;for(h=i.s.c;h<=i.e.c;++h)d[h]=mt(h);for(f=i.s.r;f<=i.e.r;++f){for(s=[],u=jt(f),h=i.s.c;h<=i.e.c;++h){c=d[h]+u;var _=p?(e[f]||[])[h]:e[c];_!==void 0&&(o=F5(_,c,e,t))!=null&&s.push(o)}(s.length>0||g&&g[f])&&(x={r:u},g&&g[f]&&(m=g[f],m.hidden&&(x.hidden=1),v=-1,m.hpx?v=Po(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(x.ht=v,x.customHeight=1),m.level&&(x.outlineLevel=m.level)),a[a.length]=we("row",s.join(""),x))}if(g)for(;f<g.length;++f)g&&g[f]&&(x={r:f+1},m=g[f],m.hidden&&(x.hidden=1),v=-1,m.hpx?v=Po(m.hpx):m.hpt&&(v=m.hpt),v>-1&&(x.ht=v,x.customHeight=1),m.level&&(x.outlineLevel=m.level),a[a.length]=we("row","",x));return a.join("")}function T_(e,t,r,n){var a=[It,we("worksheet",null,{xmlns:qs[0],"xmlns:r":Wt.r})],s=r.SheetNames[e],i=0,o="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=Ve(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Ie(d)}n||(n={}),c["!comments"]=[];var f=[];g5(c,r,e,t,a),a[a.length]=we("dimension",null,{ref:u}),a[a.length]=A5(c,t,e,r),t.sheetFormat&&(a[a.length]=we("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=N5(c,c["!cols"])),a[i=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=D5(c,t),o.length>0&&(a[a.length]=o)),a.length>i+1&&(a[a.length]="</sheetData>",a[i]=a[i].replace("/>",">")),c["!protect"]&&(a[a.length]=_5(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=T5(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=x5(c["!merges"]));var h=-1,g,p=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(g={ref:x[0]},x[1].Target.charAt(0)!="#"&&(p=et(n,-1,tt(x[1].Target).replace(/#.*$/,""),$e.HLINK),g["r:id"]="rId"+p),(h=x[1].Target.indexOf("#"))>-1&&(g.location=tt(x[1].Target.slice(h+1))),x[1].Tooltip&&(g.tooltip=tt(x[1].Tooltip)),a[a.length]=we("hyperlink",null,g))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=k5(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=nr("ignoredErrors",we("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(p=et(n,-1,"../drawings/drawing"+(e+1)+".xml",$e.DRAW),a[a.length]=we("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=f),c["!comments"].length>0&&(p=et(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",$e.VML),a[a.length]=we("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function O5(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function R5(e,t,r){var n=ce(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=Po(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var i=0;a.level&&(i|=a.level),a.hidden&&(i|=16),(a.hpx||a.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,g=d<<10;g<d+1<<10;++g){u.c=g;var p=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Pe(u)];p&&(f<0&&(f=g),h=g)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var x=n.l;return n.l=c,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function I5(e,t,r,n){var a=R5(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&fe(e,0,a)}var L5=Qs,M5=ul;function B5(){}function U5(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=H4(e),r}function z5(e,t,r){r==null&&(r=ce(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return N0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),ky(e,r),r.slice(0,r.l)}function $5(e){var t=bn(e);return[t]}function H5(e,t,r){return r==null&&(r=ce(8)),Xs(t,r)}function W5(e){var t=Ys(e);return[t]}function V5(e,t,r){return r==null&&(r=ce(4)),Js(t,r)}function G5(e){var t=bn(e),r=e.read_shift(1);return[t,r,"b"]}function K5(e,t,r){return r==null&&(r=ce(9)),Xs(t,r),r.write_shift(1,e.v?1:0),r}function q5(e){var t=Ys(e),r=e.read_shift(1);return[t,r,"b"]}function X5(e,t,r){return r==null&&(r=ce(5)),Js(t,r),r.write_shift(1,e.v?1:0),r}function Y5(e){var t=bn(e),r=e.read_shift(1);return[t,r,"e"]}function J5(e,t,r){return r==null&&(r=ce(9)),Xs(t,r),r.write_shift(1,e.v),r}function Q5(e){var t=Ys(e),r=e.read_shift(1);return[t,r,"e"]}function Z5(e,t,r){return r==null&&(r=ce(8)),Js(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function eA(e){var t=bn(e),r=e.read_shift(4);return[t,r,"s"]}function tA(e,t,r){return r==null&&(r=ce(12)),Xs(t,r),r.write_shift(4,t.v),r}function rA(e){var t=Ys(e),r=e.read_shift(4);return[t,r,"s"]}function nA(e,t,r){return r==null&&(r=ce(8)),Js(t,r),r.write_shift(4,t.v),r}function aA(e){var t=bn(e),r=pr(e);return[t,r,"n"]}function sA(e,t,r){return r==null&&(r=ce(16)),Xs(t,r),Ms(e.v,r),r}function j_(e){var t=Ys(e),r=pr(e);return[t,r,"n"]}function iA(e,t,r){return r==null&&(r=ce(12)),Js(t,r),Ms(e.v,r),r}function lA(e){var t=bn(e),r=qh(e);return[t,r,"n"]}function oA(e,t,r){return r==null&&(r=ce(12)),Xs(t,r),Sy(e.v,r),r}function cA(e){var t=Ys(e),r=qh(e);return[t,r,"n"]}function uA(e,t,r){return r==null&&(r=ce(8)),Js(t,r),Sy(e.v,r),r}function dA(e){var t=bn(e),r=Vh(e);return[t,r,"is"]}function fA(e){var t=bn(e),r=vr(e);return[t,r,"str"]}function hA(e,t,r){return r==null&&(r=ce(12+4*e.v.length)),Xs(t,r),Qt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function mA(e){var t=Ys(e),r=vr(e);return[t,r,"str"]}function xA(e,t,r){return r==null&&(r=ce(8+4*e.v.length)),Js(t,r),Qt(e.v,r),r.length>r.l?r.slice(0,r.l):r}function pA(e,t,r){var n=e.l+t,a=bn(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=iu(e,n-e.l,r);i[3]=hr(o,null,a,r.supbooks,r)}else e.l=n;return i}function gA(e,t,r){var n=e.l+t,a=bn(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=iu(e,n-e.l,r);i[3]=hr(o,null,a,r.supbooks,r)}else e.l=n;return i}function vA(e,t,r){var n=e.l+t,a=bn(e);a.r=r["!row"];var s=pr(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=iu(e,n-e.l,r);i[3]=hr(o,null,a,r.supbooks,r)}else e.l=n;return i}function yA(e,t,r){var n=e.l+t,a=bn(e);a.r=r["!row"];var s=vr(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=iu(e,n-e.l,r);i[3]=hr(o,null,a,r.supbooks,r)}else e.l=n;return i}var _A=Qs,wA=ul;function bA(e,t){return t==null&&(t=ce(4)),t.write_shift(4,e),t}function kA(e,t){var r=e.l+t,n=Qs(e),a=Gh(e),s=vr(e),i=vr(e),o=vr(e);e.l=r;var c={rfx:n,relId:a,loc:s,display:o};return i&&(c.Tooltip=i),c}function SA(e,t){var r=ce(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ul({s:kt(e[0]),e:kt(e[0])},r),Kh("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Qt(a||"",r),Qt(e[1].Tooltip||"",r),Qt("",r),r.slice(0,r.l)}function NA(){}function EA(e,t,r){var n=e.l+t,a=Ny(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=YC(e,n-e.l,r);i[1]=o}else e.l=n;return i}function TA(e,t,r){var n=e.l+t,a=Qs(e),s=[a];if(r.cellFormula){var i=QC(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}function jA(e,t,r){r==null&&(r=ce(18));var n=lu(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var C_=["left","right","top","bottom","header","footer"];function CA(e){var t={};return C_.forEach(function(r){t[r]=pr(e)}),t}function AA(e,t){return t==null&&(t=ce(6*8)),Ts(e),C_.forEach(function(r){Ms(e[r],t)}),t}function FA(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function PA(e,t,r){r==null&&(r=ce(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function DA(e){var t=ce(24);return t.write_shift(4,4),t.write_shift(4,1),ul(e,t),t}function OA(e,t){return t==null&&(t=ce(16*4+2)),t.write_shift(2,e.password?em(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function RA(){}function IA(){}function LA(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,g,p,x,m,v,_,y,b,E,T=[];o.biff=12,o["!row"]=0;var k=0,A=!1,M=[],B={},G=o.supbooks||a.supbooks||[[]];if(G.sharedf=B,G.arrayf=M,G.SheetNames=a.SheetNames||a.Sheets.map(function(Z){return Z.name}),!o.supbooks&&(o.supbooks=G,a.Names))for(var U=0;U<a.Names.length;++U)G[0][U+1]=a.Names[U];var ne=[],de=[],oe=!1;Do[16]={n:"BrtShortReal",f:j_};var Y;if(ya(e,function(H,ae,K){if(!h)switch(K){case 148:u=H;break;case 0:g=H,o.sheetRows&&o.sheetRows<=g.r&&(h=!0),b=jt(m=g.r),o["!row"]=g.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=tl(H.hpt)),de[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:H[2]},H[2]){case"n":p.v=H[1];break;case"s":y=Ql[H[1]],p.v=y.t,p.r=y.r;break;case"b":p.v=!!H[1];break;case"e":p.v=H[1],o.cellText!==!1&&(p.w=_a[p.v]);break;case"str":p.t="s",p.v=H[1];break;case"is":p.t="s",p.v=H[1].t;break}if((x=i.CellXf[H[0].iStyleRef])&&N_(p,x.numFmtId,null,o,s,i),v=H[0].c==-1?v+1:H[0].c,o.dense?(c[m]||(c[m]=[]),c[m][v]=p):c[mt(v)+b]=p,o.cellFormula){for(A=!1,k=0;k<M.length;++k){var P=M[k];g.r>=P[0].s.r&&g.r<=P[0].e.r&&v>=P[0].s.c&&v<=P[0].e.c&&(p.F=Ie(P[0]),A=!0)}!A&&H.length>3&&(p.f=H[3])}if(d.s.r>g.r&&(d.s.r=g.r),d.s.c>v&&(d.s.c=v),d.e.r<g.r&&(d.e.r=g.r),d.e.c<v&&(d.e.c=v),o.cellDates&&x&&p.t=="n"&&Ks(Fe[x.numFmtId])){var V=Ia(p.v);V&&(p.t="d",p.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}Y&&(Y.type=="XLDAPR"&&(p.D=!0),Y=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;p={t:"z",v:void 0},v=H[0].c==-1?v+1:H[0].c,o.dense?(c[m]||(c[m]=[]),c[m][v]=p):c[mt(v)+b]=p,d.s.r>g.r&&(d.s.r=g.r),d.s.c>v&&(d.s.c=v),d.e.r<g.r&&(d.e.r=g.r),d.e.c<v&&(d.e.c=v),Y&&(Y.type=="XLDAPR"&&(p.D=!0),Y=void 0);break;case 176:T.push(H);break;case 49:Y=((o.xlmeta||{}).Cell||[])[H-1];break;case 494:var D=n["!id"][H.relId];for(D?(H.Target=D.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=D):H.relId==""&&(H.Target="#"+H.loc),m=H.rfx.s.r;m<=H.rfx.e.r;++m)for(v=H.rfx.s.c;v<=H.rfx.e.c;++v)o.dense?(c[m]||(c[m]=[]),c[m][v]||(c[m][v]={t:"z",v:void 0}),c[m][v].l=H):(_=Pe({c:v,r:m}),c[_]||(c[_]={t:"z",v:void 0}),c[_].l=H);break;case 426:if(!o.cellFormula)break;M.push(H),E=o.dense?c[m][v]:c[mt(v)+b],E.f=hr(H[1],d,{r:g.r,c:v},G,o),E.F=Ie(H[0]);break;case 427:if(!o.cellFormula)break;B[Pe(H[0].s)]=H[1],E=o.dense?c[m][v]:c[mt(v)+b],E.f=hr(H[1],d,{r:g.r,c:v},G,o);break;case 60:if(!o.cellStyles)break;for(;H.e>=H.s;)ne[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},oe||(oe=!0,tm(H.w/256)),Za(ne[H.e+1]);break;case 161:c["!autofilter"]={ref:Ie(H)};break;case 476:c["!margins"]=H;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),H.name&&(a.Sheets[r].CodeName=H.name),(H.above||H.left)&&(c["!outline"]={above:H.above,left:H.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),H.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ae.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+K.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Ie(u||d)),o.sheetRows&&c["!ref"]){var se=Ve(c["!ref"]);o.sheetRows<=+se.e.r&&(se.e.r=o.sheetRows-1,se.e.r>d.e.r&&(se.e.r=d.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>d.e.c&&(se.e.c=d.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ie(se))}return T.length>0&&(c["!merges"]=T),ne.length>0&&(c["!cols"]=ne),de.length>0&&(c["!rows"]=de),c}function MA(e,t,r,n,a,s,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=ot(t),t.z=t.z||Fe[14],t.v=Gt(xt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=os(a.cellXfs,t,a),t.l&&s["!links"].push([Pe(c),t.l]),t.c&&s["!comments"].push([Pe(c),t.c]),t.t){case"s":case"str":return a.bookSST?(o=im(a.Strings,t.v,a.revStrings),c.t="s",c.v=o,i?fe(e,18,nA(t,c)):fe(e,7,tA(t,c))):(c.t="str",i?fe(e,17,xA(t,c)):fe(e,6,hA(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?fe(e,13,uA(t,c)):fe(e,2,oA(t,c)):i?fe(e,16,iA(t,c)):fe(e,5,sA(t,c)),!0;case"b":return c.t="b",i?fe(e,15,X5(t,c)):fe(e,4,K5(t,c)),!0;case"e":return c.t="e",i?fe(e,14,Z5(t,c)):fe(e,3,J5(t,c)),!0}return i?fe(e,12,V5(t,c)):fe(e,1,H5(t,c)),!0}function BA(e,t,r,n){var a=Ve(t["!ref"]||"A1"),s,i="",o=[];fe(e,145);var c=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var d=a.s.r;d<=u;++d){i=jt(d),I5(e,t,a,d);var f=!1;if(d<=a.e.r)for(var h=a.s.c;h<=a.e.c;++h){d===a.s.r&&(o[h]=mt(h)),s=o[h]+i;var g=c?(t[d]||[])[h]:t[s];if(!g){f=!1;continue}f=MA(e,g,d,h,n,t,f)}}fe(e,146)}function UA(e,t){!t||!t["!merges"]||(fe(e,177,bA(t["!merges"].length)),t["!merges"].forEach(function(r){fe(e,176,wA(r))}),fe(e,178))}function zA(e,t){!t||!t["!cols"]||(fe(e,390),t["!cols"].forEach(function(r,n){r&&fe(e,60,jA(n,r))}),fe(e,391))}function $A(e,t){!t||!t["!ref"]||(fe(e,648),fe(e,649,DA(Ve(t["!ref"]))),fe(e,650))}function HA(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=et(r,-1,n[1].Target.replace(/#.*$/,""),$e.HLINK);fe(e,494,SA(n,a))}}),delete t["!links"]}function WA(e,t,r,n){if(t["!comments"].length>0){var a=et(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",$e.VML);fe(e,551,Kh("rId"+a)),t["!legacy"]=a}}function VA(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:Ie(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Cr(s);o.s.r==o.e.r&&(o.e.r=Cr(t["!ref"]).e.r,s=Ie(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),fe(e,161,ul(Ve(s))),fe(e,162)}}function GA(e,t,r){fe(e,133),fe(e,137,PA(t,r)),fe(e,138),fe(e,134)}function KA(e,t){t["!protect"]&&fe(e,535,OA(t["!protect"]))}function qA(e,t,r,n){var a=Ur(),s=r.SheetNames[e],i=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Ve(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],fe(a,129),(r.vbaraw||i["!outline"])&&fe(a,147,z5(o,i["!outline"])),fe(a,148,M5(c)),GA(a,i,r.Workbook),zA(a,i),BA(a,i,e,t),KA(a,i),VA(a,i,r,e),UA(a,i),HA(a,i,n),i["!margins"]&&fe(a,476,AA(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&$A(a,i),WA(a,i,e,n),fe(a,130),a.end()}function XA(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=Ye((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function YA(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=XA(f);d.s.r=d.s.c=0,d.e.c=o,u=mt(o),h[0].forEach(function(g,p){i[u+jt(p)]={t:"n",v:g,z:h[1]},c=p}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(i["!ref"]=Ie(d)),i}function JA(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(E_);return o&&lm(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function QA(e,t){e.l+=10;var r=vr(e);return{name:r}}function ZA(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return ya(e,function(c,u,d){switch(d){case 550:s["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var om=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],eF=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],tF=[],rF=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Wp(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=ft(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function Vp(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=ft(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function A_(e){Vp(e.WBProps,om),Vp(e.CalcPr,rF),Wp(e.WBView,eF),Wp(e.Sheets,tF),zi.date1904=ft(e.WBProps.date1904)}function nF(e){return!e.Workbook||!e.Workbook.WBProps?"false":ft(e.Workbook.WBProps.date1904)?"true":"false"}var aF="][*?/\\".split("");function F_(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return aF.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function sF(e,t,r){e.forEach(function(n,a){F_(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[a]&&t[a].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function P_(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];sF(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)n5(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var iF=/<\w+:workbook/;function lF(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(wr,function(c,u){var d=De(c);switch(Qn(d[0])){case"<?xml":break;case"<workbook":c.match(iF)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":om.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=ft(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=st(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Ye(st(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=st(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),ft(d.hidden||"0")&&(s.Hidden=!0),i=u+c.length;break;case"</definedName>":s.Ref=Ye(st(e.slice(i,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),qs.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return A_(r),r}function D_(e){var t=[It];t[t.length]=we("workbook",null,{xmlns:qs[0],"xmlns:r":Wt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(om.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=we("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var i={name:tt(e.SheetNames[s].slice(0,31))};if(i.sheetId=""+(s+1),i["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=we("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=we("definedName",tt(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function oF(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=hf(e),r.name=vr(e),r}function cF(e,t){return t||(t=ce(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Kh(e.strRelID,t),Qt(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function uF(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?vr(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function dF(e,t){t||(t=ce(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),ky(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function fF(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function hF(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=W4(e),i=JC(e,0,r),o=Gh(e);e.l=n;var c={Name:s,Ptg:i};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function mF(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],Do[16]={n:"BrtFRTArchID$",f:fF},ya(e,function(c,u,d){switch(d){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=hr(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,c]):i[0]=[d,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),A_(r),r.Names=s,r.supbooks=i,r}function xF(e,t){fe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};fe(e,156,cF(a))}fe(e,144)}function pF(e,t){t||(t=ce(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Qt("SheetJS",t),Qt(bo.version,t),Qt(bo.version,t),Qt("7262",t),t.length>t.l?t.slice(0,t.l):t}function gF(e,t){t||(t=ce(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function vF(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(fe(e,135),fe(e,158,gF(a)),fe(e,136))}}function yF(e,t){var r=Ur();return fe(r,131),fe(r,128,pF()),fe(r,153,dF(e.Workbook&&e.Workbook.WBProps||null)),vF(r,e),xF(r,e),fe(r,132),r.end()}function _F(e,t,r){return t.slice(-4)===".bin"?mF(e,r):lF(e,r)}function wF(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?LA(e,n,r,a,s,i,o):m5(e,n,r,a,s,i,o)}function bF(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?ZA(e,n,r,a,s):JA(e,n,r,a,s)}function kF(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?E6():T6()}function SF(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?S6():N6()}function NF(e,t,r,n){return t.slice(-4)===".bin"?w3(e,r,n):c3(e,r,n)}function EF(e,t,r){return f_(e,r)}function TF(e,t,r){return t.slice(-4)===".bin"?jj(e,r):Nj(e,r)}function jF(e,t,r){return t.slice(-4)===".bin"?y6(e,r):u6(e,r)}function CF(e,t,r){return t.slice(-4)===".bin"?l6(e):s6(e)}function AF(e,t,r,n){return r.slice(-4)===".bin"?o6(e,t,r,n):void 0}function FF(e,t,r){return t.slice(-4)===".bin"?r6(e,t,r):a6(e,t,r)}function PF(e,t,r){return(t.slice(-4)===".bin"?yF:D_)(e)}function DF(e,t,r,n,a){return(t.slice(-4)===".bin"?qA:T_)(e,r,n,a)}function OF(e,t,r){return(t.slice(-4)===".bin"?F3:u_)(e,r)}function RF(e,t,r){return(t.slice(-4)===".bin"?Fj:r_)(e,r)}function IF(e,t,r){return(t.slice(-4)===".bin"?_6:x_)(e)}function LF(e){return(e.slice(-4)===".bin"?n6:h_)()}var O_=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,R_=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Nn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(O_),s,i,o,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(R_),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function MF(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(O_),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(R_),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var eo;function BF(e,t){var r=eo[e]||Ye(e);return r==="General"?Is(t):en(r,t)}function UF(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=ft(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=xt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ye(t)]=a}function zF(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||_a[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=So(e.v):e.w=Is(e.v):e.w=BF(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=eo[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ks(n)){var a=Ia(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function $F(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=t3[n.Pattern]||n.Pattern)}e[t.ID]=t}function HF(e,t,r,n,a,s,i,o,c,u){var d="General",f=n.StyleID,h={};u=u||{};var g=[],p=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&i&&(f=i.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&g.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ft(e);break;case"String":n.t="s",n.r=op(Ye(e)),n.v=e.indexOf("<")>-1?Ye(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(xt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Ye(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=jy[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=op(t||e));break}if(zF(n,d,u),u.cellFormula!==!1)if(n.Formula){var x=Ye(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=Ui(x,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Ui("RC:RC",a):n.ArrayRange&&(n.F=Ui(n.ArrayRange,a),c.push([Ve(n.F),n.F]))}else for(p=0;p<c.length;++p)a.r>=c[p][0].s.r&&a.r<=c[p][0].e.r&&a.c>=c[p][0].s.c&&a.c<=c[p][0].e.c&&(n.F=c[p][1]);u.cellStyles&&(g.forEach(function(m){!h.patternType&&m.patternType&&(h.patternType=m.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function WF(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ed(e,t){var r=t||{};ll();var n=Ai(Ih(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof qe<"u"?n=qe.utils.decode(65001,v0(n)):n=st(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=ot(r);return i.type="string",el.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ue){a.indexOf("<"+Ue)>=0&&(s=!0)}),s)return E8(n,r);eo={"General Number":"General","General Date":Fe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Fe[15],"Short Date":Fe[14],"Long Time":Fe[19],"Medium Time":Fe[18],"Short Time":Fe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Fe[2],Standard:Fe[4],Percent:Fe[10],Scientific:Fe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},f=[],h=r.dense?[]:{},g="",p={},x={},m=Nn('<Data ss:Type="String">'),v=0,_=0,y=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},T={},k="",A=0,M=[],B={},G={},U=0,ne=[],de=[],oe={},Y=[],se,Z=!1,H=[],ae=[],K={},P=0,V=0,D={Sheets:[],WBProps:{date1904:!1}},R={};To.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";o=To.exec(n);)switch(o[3]=(te=o[3]).toLowerCase()){case"data":if(te=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?HF(n.slice(v,o.index),k,m,c[c.length-1][0]=="comment"?oe:p,{c:_,r:y},E,Y[_],x,H,r):(k="",m=Nn(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(de.length>0&&(p.c=de),(!r.sheetRows||r.sheetRows>y)&&p.v!==void 0&&(r.dense?(h[y]||(h[y]=[]),h[y][_]=p):h[mt(_)+jt(y)]=p),p.HRef&&(p.l={Target:Ye(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(P=_+(parseInt(p.MergeAcross,10)|0),V=y+(parseInt(p.MergeDown,10)|0),M.push({s:{c:_,r:y},e:{c:P,r:V}})),!r.sheetStubs)p.MergeAcross?_=P+1:++_;else if(p.MergeAcross||p.MergeDown){for(var F=_;F<=P;++F)for(var q=y;q<=V;++q)(F>_||q>y)&&(r.dense?(h[q]||(h[q]=[]),h[q][F]={t:"z"}):h[mt(F)+jt(q)]={t:"z"});_=P+1}else++_;else p=MF(o[0]),p.Index&&(_=+p.Index-1),_<b.s.c&&(b.s.c=_),_>b.e.c&&(b.e.c=_),o[0].slice(-2)==="/>"&&++_,de=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<b.s.r&&(b.s.r=y),y>b.e.r&&(b.e.r=y),o[0].slice(-2)==="/>"&&(x=Nn(o[0]),x.Index&&(y=+x.Index-1)),_=0,++y):(x=Nn(o[0]),x.Index&&(y=+x.Index-1),K={},(x.AutoFitHeight=="0"||x.Height)&&(K.hpx=parseInt(x.Height,10),K.hpt=Po(K.hpx),ae[y]=K),x.Hidden=="1"&&(K.hidden=!0,ae[y]=K));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));f.push(g),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(h["!ref"]=Ie(b),r.sheetRows&&r.sheetRows<=b.e.r&&(h["!fullref"]=h["!ref"],b.e.r=r.sheetRows-1,h["!ref"]=Ie(b))),M.length&&(h["!merges"]=M),Y.length>0&&(h["!cols"]=Y),ae.length>0&&(h["!rows"]=ae),d[g]=h}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=_=0,c.push([o[3],!1]),u=Nn(o[0]),g=Ye(u.Name),h=r.dense?[]:{},M=[],H=[],ae=[],R={name:g,Hidden:0},D.Sheets.push(R);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Y=[],Z=!1}break;case"style":o[1]==="/"?$F(E,T,r):T=Nn(o[0]);break;case"numberformat":T.nf=Ye(Nn(o[0]).Format||"General"),eo[T.nf]&&(T.nf=eo[T.nf]);for(var X=0;X!=392&&Fe[X]!=T.nf;++X);if(X==392){for(X=57;X!=392;++X)if(Fe[X]==null){Xn(T.nf,X);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(se=Nn(o[0]),se.Hidden&&(se.hidden=!0,delete se.Hidden),se.Width&&(se.wpx=parseInt(se.Width,10)),!Z&&se.wpx>10){Z=!0,xr=o_;for(var L=0;L<Y.length;++L)Y[L]&&Za(Y[L])}Z&&Za(se),Y[se.Index-1||Y.length]=se;for(var J=0;J<+se.Span;++J)Y[Y.length]=ot(se);break;case"namedrange":if(o[1]==="/")break;D.Names||(D.Names=[]);var j=De(o[0]),ke={Name:j.Name,Ref:Ui(j.RefersTo.slice(1),{r:0,c:0})};D.Sheets.length>0&&(ke.Sheet=D.Sheets.length-1),D.Names.push(ke);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=n.slice(A,o.index):A=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;T.Interior=Nn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?xE(B,te,n.slice(U,o.index)):U=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));WF(oe),de.push(oe)}else c.push([o[3],!1]),u=Nn(o[0]),oe={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ue=Nn(o[0]);h["!autofilter"]={ref:Ui(ue.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Yp(n,r);var ve=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ve=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ve=!1}break;case"excelworkbook":switch(o[3]){case"date1904":D.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ve=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ve=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(U,o.index)){case"SheetHidden":R.Hidden=1;break;case"SheetVeryHidden":R.Hidden=2;break}else U=o.index+o[0].length;break;case"header":h["!margins"]||Ts(h["!margins"]={},"xlml"),isNaN(+De(o[0]).Margin)||(h["!margins"].header=+De(o[0]).Margin);break;case"footer":h["!margins"]||Ts(h["!margins"]={},"xlml"),isNaN(+De(o[0]).Margin)||(h["!margins"].footer=+De(o[0]).Margin);break;case"pagemargins":var Te=De(o[0]);h["!margins"]||Ts(h["!margins"]={},"xlml"),isNaN(+Te.Top)||(h["!margins"].top=+Te.Top),isNaN(+Te.Left)||(h["!margins"].left=+Te.Left),isNaN(+Te.Right)||(h["!margins"].right=+Te.Right),isNaN(+Te.Bottom)||(h["!margins"].bottom=+Te.Bottom);break;case"displayrighttoleft":D.Views||(D.Views=[]),D.Views[0]||(D.Views[0]={}),D.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ve=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ve=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ve=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ve=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ve=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ve=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ve=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ve=!1}break;case"smarttags":break;default:ve=!1;break}if(ve||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?UF(G,te,ne,n.slice(U,o.index)):(ne=o,U=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var he={};return!r.bookSheets&&!r.bookProps&&(he.Sheets=d),he.SheetNames=f,he.Workbook=D,he.SSF=ot(Fe),he.Props=B,he.Custprops=G,he}function _f(e,t){switch(dm(t=t||{}),t.type||"base64"){case"base64":return ed(Zr(e),t);case"binary":case"buffer":case"file":return ed(e,t);case"array":return ed(is(e),t)}}function VF(e,t){var r=[];return e.Props&&r.push(pE(e.Props,t)),e.Custprops&&r.push(gE(e.Props,e.Custprops)),r.join("")}function GF(){return""}function KF(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(we("NumberFormat",null,{"ss:Format":tt(Fe[n.numFmtId])}));var i={"ss:ID":"s"+(21+a)};r.push(we("Style",s.join(""),i))}),we("Styles",r.join(""))}function I_(e){return we("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+am(e.Ref,{r:0,c:0})})}function qF(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(I_(a)))}return we("Names",r.join(""))}function XF(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],i=0;i<a.length;++i){var o=a[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(I_(o)))}return s.join("")}function YF(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(we("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(we("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(we("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(we("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(nr("ProtectContents","True")),e["!protect"].objects&&a.push(nr("ProtectObjects","True")),e["!protect"].scenarios&&a.push(nr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(nr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(nr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&a.push("<"+i[1]+"/>")})),a.length==0?"":we("WorksheetOptions",a.join(""),{xmlns:Hr.x})}function JF(e){return e.map(function(t){var r=y4(t.t||""),n=we("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return we("Comment",n,{"ss:Author":t.a})}).join("")}function QF(e,t,r,n,a,s,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+tt(am(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=kt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=tt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=tt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=_a[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Fe[14]);break;case"s":f="String",h=v4(e.v||"");break}var g=os(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=i.c+1;var p=e.v!=null?h:"",x=e.t=="z"?"":'<Data ss:Type="'+f+'">'+p+"</Data>";return(e.c||[]).length>0&&(x+=JF(e.c)),we("Cell",x,o)}function ZF(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=tl(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function e8(e,t,r,n){if(!e["!ref"])return"";var a=Ve(e["!ref"]),s=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(m,v){Za(m);var _=!!m.width,y=lu(v,m),b={"ss:Index":v+1};_&&(b["ss:Width"]=Ao(y.width)),m.hidden&&(b["ss:Hidden"]="1"),o.push(we("Column",null,b))});for(var c=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var d=[ZF(u,(e["!rows"]||[])[u])],f=a.s.c;f<=a.e.c;++f){var h=!1;for(i=0;i!=s.length;++i)if(!(s[i].s.c>f)&&!(s[i].s.r>u)&&!(s[i].e.c<f)&&!(s[i].e.r<u)){(s[i].s.c!=f||s[i].s.r!=u)&&(h=!0);break}if(!h){var g={r:u,c:f},p=Pe(g),x=c?(e[u]||[])[f]:e[p];d.push(QF(x,p,e,t,r,n,g))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function t8(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],i=s?XF(s,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=s?e8(s,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(YF(s,t,e,r)),n.join("")}function r8(e,t){t||(t={}),e.SSF||(e.SSF=ot(Fe)),e.SSF&&(ll(),Wo(e.SSF),t.revssf=tu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],os(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(VF(e,t)),r.push(GF()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(we("Worksheet",t8(n,t,e),{"ss:Name":tt(e.SheetNames[n])}));return r[2]=KF(e,t),r[3]=qF(e),It+we("Workbook",r.join(""),{xmlns:Hr.ss,"xmlns:o":Hr.o,"xmlns:x":Hr.x,"xmlns:ss":Hr.ss,"xmlns:dt":Hr.dt,"xmlns:html":Hr.html})}function n8(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=X4(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Y4(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var a8=[60,1084,2066,2165,2175];function s8(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var c=oa(r,r.l),u=wf[c],d=0;u!=null&&a8.indexOf(c)>-1;)s=oa(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+s),i.push(o),r.l+=4+s,u=wf[c=oa(r,r.l)];var f=Jt(i);rr(f,0);var h=0;f.lens=[];for(var g=0;g<i.length;++g)f.lens.push(h),h+=i[g].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function Un(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Fe[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||_a[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=So(e.v):e.w=Is(e.v):e.w=en(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Ks(Fe[n]||String(n))){var a=Ia(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Cc(e,t,r){return{v:e,ixfe:t,t:r}}function i8(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,c=[],u="",d={},f,h="",g,p,x,m,v={},_=[],y,b,E=[],T=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},M=function(je){return je<8?Ss[je]:je<64&&T[je-8]||Ss[je]},B=function(je,lt,vt){var at=lt.XF.data;if(!(!at||!at.patternType||!vt||!vt.cellStyles)){lt.s={},lt.s.patternType=at.patternType;var lr;(lr=Co(M(at.icvFore)))&&(lt.s.fgColor={rgb:lr}),(lr=Co(M(at.icvBack)))&&(lt.s.bgColor={rgb:lr})}},G=function(je,lt,vt){if(!(K>1)&&!(vt.sheetRows&&je.r>=vt.sheetRows)){if(vt.cellStyles&&lt.XF&&lt.XF.data&&B(je,lt,vt),delete lt.ixfe,delete lt.XF,f=je,h=Pe(je),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),je.r<i.s.r&&(i.s.r=je.r),je.c<i.s.c&&(i.s.c=je.c),je.r+1>i.e.r&&(i.e.r=je.r+1),je.c+1>i.e.c&&(i.e.c=je.c+1),vt.cellFormula&&lt.f){for(var at=0;at<_.length;++at)if(!(_[at][0].s.c>je.c||_[at][0].s.r>je.r)&&!(_[at][0].e.c<je.c||_[at][0].e.r<je.r)){lt.F=Ie(_[at][0]),(_[at][0].s.c!=je.c||_[at][0].s.r!=je.r)&&delete lt.f,lt.f&&(lt.f=""+hr(_[at][1],i,je,H,U));break}}vt.dense?(a[je.r]||(a[je.r]=[]),a[je.r][je.c]=lt):a[h]=lt}},U={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(U.password=t.password);var ne,de=[],oe=[],Y=[],se=[],Z=!1,H=[];H.SheetNames=U.snames,H.sharedf=U.sharedf,H.arrayf=U.arrayf,H.names=[],H.XTI=[];var ae=0,K=0,P=0,V=[],D=[],R;U.codepage=1200,xn(1200);for(var te=!1;e.l<e.length-1;){var F=e.l,q=e.read_shift(2);if(q===0&&ae===10)break;var X=e.l===e.length?0:e.read_shift(2),L=wf[q];if(L&&L.f){if(t.bookSheets&&ae===133&&q!==133)break;if(ae=q,L.r===2||L.r==12){var J=e.read_shift(2);if(X-=2,!U.enc&&J!==q&&((J&255)<<8|J>>8)!==q)throw new Error("rt mismatch: "+J+"!="+q);L.r==12&&(e.l+=10,X-=10)}var j={};if(q===10?j=L.f(e,X,U):j=s8(q,L,e,X,U),K==0&&[9,521,1033,2057].indexOf(ae)===-1)continue;switch(q){case 34:r.opts.Date1904=k.WBProps.date1904=j;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(U.enc||(e.l=0),U.enc=j,!t.password)throw new Error("File is password-protected");if(j.valid==null)throw new Error("Encryption scheme unsupported");if(!j.valid)throw new Error("Password is incorrect");break;case 92:U.lastuser=j;break;case 66:var ke=Number(j);switch(ke){case 21010:ke=1200;break;case 32768:ke=1e4;break;case 32769:ke=1252;break}xn(U.codepage=ke),te=!0;break;case 317:U.rrtabid=j;break;case 25:U.winlocked=j;break;case 439:r.opts.RefreshAll=j;break;case 12:r.opts.CalcCount=j;break;case 16:r.opts.CalcDelta=j;break;case 17:r.opts.CalcIter=j;break;case 13:r.opts.CalcMode=j;break;case 14:r.opts.CalcPrecision=j;break;case 95:r.opts.CalcSaveRecalc=j;break;case 15:U.CalcRefMode=j;break;case 2211:r.opts.FullCalc=j;break;case 129:j.fDialog&&(a["!type"]="dialog"),j.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),j.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:E.push(j);break;case 430:H.push([j]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(j);break;case 24:case 536:R={Name:j.Name,Ref:hr(j.rgce,i,null,H,U)},j.itab>0&&(R.Sheet=j.itab-1),H.names.push(R),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(j),j.Name=="_xlnm._FilterDatabase"&&j.itab>0&&j.rgce&&j.rgce[0]&&j.rgce[0][0]&&j.rgce[0][0][0]=="PtgArea3d"&&(D[j.itab-1]={ref:Ie(j.rgce[0][0][1][2])});break;case 22:U.ExternCount=j;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(j),H.XTI=H.XTI.concat(j);break;case 2196:if(U.biff<8)break;R!=null&&(R.Comment=j[1]);break;case 18:a["!protect"]=j;break;case 19:j!==0&&U.WTF&&console.error("Password verifier: "+j);break;case 133:s[j.pos]=j,U.snames.push(j.name);break;case 10:{if(--K)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=Ie(i),t.sheetRows&&t.sheetRows<=i.e.r){var ue=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ie(i),i.e.r=ue}i.e.r++,i.e.c++}de.length>0&&(a["!merges"]=de),oe.length>0&&(a["!objects"]=oe),Y.length>0&&(a["!cols"]=Y),se.length>0&&(a["!rows"]=se),k.Sheets.push(A)}u===""?d=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(U.biff===8&&(U.biff={9:2,521:3,1033:4}[q]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[j.BIFFVer]||8),U.biffguess=j.BIFFVer==0,j.BIFFVer==0&&j.dt==4096&&(U.biff=5,te=!0,xn(U.codepage=28591)),U.biff==8&&j.BIFFVer==0&&j.dt==16&&(U.biff=2),K++)break;if(a=t.dense?[]:{},U.biff<8&&!te&&(te=!0,xn(U.codepage=t.codepage||1252)),U.biff<5||j.BIFFVer==0&&j.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var ve={pos:e.l-X,name:u};s[ve.pos]=ve,U.snames.push(u)}else u=(s[F]||{name:""}).name;j.dt==32&&(a["!type"]="chart"),j.dt==64&&(a["!type"]="macro"),de=[],oe=[],U.arrayf=_=[],Y=[],se=[],Z=!1,A={Hidden:(s[F]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[j.r]||[])[j.c]:a[Pe({c:j.c,r:j.r})])&&++j.c,y={ixfe:j.ixfe,XF:E[j.ixfe]||{},v:j.val,t:"n"},P>0&&(y.z=V[y.ixfe>>8&63]),Un(y,t,r.opts.Date1904),G({c:j.c,r:j.r},y,t);break;case 5:case 517:y={ixfe:j.ixfe,XF:E[j.ixfe],v:j.val,t:j.t},P>0&&(y.z=V[y.ixfe>>8&63]),Un(y,t,r.opts.Date1904),G({c:j.c,r:j.r},y,t);break;case 638:y={ixfe:j.ixfe,XF:E[j.ixfe],v:j.rknum,t:"n"},P>0&&(y.z=V[y.ixfe>>8&63]),Un(y,t,r.opts.Date1904),G({c:j.c,r:j.r},y,t);break;case 189:for(var Te=j.c;Te<=j.C;++Te){var he=j.rkrec[Te-j.c][0];y={ixfe:he,XF:E[he],v:j.rkrec[Te-j.c][1],t:"n"},P>0&&(y.z=V[y.ixfe>>8&63]),Un(y,t,r.opts.Date1904),G({c:Te,r:j.r},y,t)}break;case 6:case 518:case 1030:{if(j.val=="String"){o=j;break}if(y=Cc(j.val,j.cell.ixfe,j.tt),y.XF=E[y.ixfe],t.cellFormula){var Ue=j.formula;if(Ue&&Ue[0]&&Ue[0][0]&&Ue[0][0][0]=="PtgExp"){var Ke=Ue[0][0][1][0],nt=Ue[0][0][1][1],pt=Pe({r:Ke,c:nt});v[pt]?y.f=""+hr(j.formula,i,j.cell,H,U):y.F=((t.dense?(a[Ke]||[])[nt]:a[pt])||{}).F}else y.f=""+hr(j.formula,i,j.cell,H,U)}P>0&&(y.z=V[y.ixfe>>8&63]),Un(y,t,r.opts.Date1904),G(j.cell,y,t),o=j}break;case 7:case 519:if(o)o.val=j,y=Cc(j,o.cell.ixfe,"s"),y.XF=E[y.ixfe],t.cellFormula&&(y.f=""+hr(o.formula,i,o.cell,H,U)),P>0&&(y.z=V[y.ixfe>>8&63]),Un(y,t,r.opts.Date1904),G(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(j);var Ft=Pe(j[0].s);if(g=t.dense?(a[j[0].s.r]||[])[j[0].s.c]:a[Ft],t.cellFormula&&g){if(!o||!Ft||!g)break;g.f=""+hr(j[1],i,j[0],H,U),g.F=Ie(j[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;v[Pe(o.cell)]=j[0],g=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Pe(o.cell)],(g||{}).f=""+hr(j[0],i,f,H,U)}}break;case 253:y=Cc(c[j.isst].t,j.ixfe,"s"),c[j.isst].h&&(y.h=c[j.isst].h),y.XF=E[y.ixfe],P>0&&(y.z=V[y.ixfe>>8&63]),Un(y,t,r.opts.Date1904),G({c:j.c,r:j.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:j.ixfe,XF:E[j.ixfe],t:"z"},P>0&&(y.z=V[y.ixfe>>8&63]),Un(y,t,r.opts.Date1904),G({c:j.c,r:j.r},y,t));break;case 190:if(t.sheetStubs)for(var Ge=j.c;Ge<=j.C;++Ge){var gt=j.ixfe[Ge-j.c];y={ixfe:gt,XF:E[gt],t:"z"},P>0&&(y.z=V[y.ixfe>>8&63]),Un(y,t,r.opts.Date1904),G({c:Ge,r:j.r},y,t)}break;case 214:case 516:case 4:y=Cc(j.val,j.ixfe,"s"),y.XF=E[y.ixfe],P>0&&(y.z=V[y.ixfe>>8&63]),Un(y,t,r.opts.Date1904),G({c:j.c,r:j.r},y,t);break;case 0:case 512:K===1&&(i=j);break;case 252:c=j;break;case 1054:if(U.biff==4){V[P++]=j[1];for(var ir=0;ir<P+163&&Fe[ir]!=j[1];++ir);ir>=163&&Xn(j[1],P+163)}else Xn(j[1],j[0]);break;case 30:{V[P++]=j;for(var it=0;it<P+163&&Fe[it]!=j;++it);it>=163&&Xn(j,P+163)}break;case 229:de=de.concat(j);break;case 93:oe[j.cmo[0]]=U.lastobj=j;break;case 438:U.lastobj.TxO=j;break;case 127:U.lastobj.ImData=j;break;case 440:for(m=j[0].s.r;m<=j[0].e.r;++m)for(x=j[0].s.c;x<=j[0].e.c;++x)g=t.dense?(a[m]||[])[x]:a[Pe({c:x,r:m})],g&&(g.l=j[1]);break;case 2048:for(m=j[0].s.r;m<=j[0].e.r;++m)for(x=j[0].s.c;x<=j[0].e.c;++x)g=t.dense?(a[m]||[])[x]:a[Pe({c:x,r:m})],g&&g.l&&(g.l.Tooltip=j[1]);break;case 28:{if(U.biff<=5&&U.biff>=2)break;g=t.dense?(a[j[0].r]||[])[j[0].c]:a[Pe(j[0])];var zr=oe[j[2]];g||(t.dense?(a[j[0].r]||(a[j[0].r]=[]),g=a[j[0].r][j[0].c]={t:"z"}):g=a[Pe(j[0])]={t:"z"},i.e.r=Math.max(i.e.r,j[0].r),i.s.r=Math.min(i.s.r,j[0].r),i.e.c=Math.max(i.e.c,j[0].c),i.s.c=Math.min(i.s.c,j[0].c)),g.c||(g.c=[]),p={a:j[1],t:zr.TxO.t},g.c.push(p)}break;case 2173:q3(E[j.ixfe],j.ext);break;case 125:{if(!U.cellStyles)break;for(;j.e>=j.s;)Y[j.e--]={width:j.w/256,level:j.level||0,hidden:!!(j.flags&1)},Z||(Z=!0,tm(j.w/256)),Za(Y[j.e+1])}break;case 520:{var xe={};j.level!=null&&(se[j.r]=xe,xe.level=j.level),j.hidden&&(se[j.r]=xe,xe.hidden=!0),j.hpt&&(se[j.r]=xe,xe.hpt=j.hpt,xe.hpx=tl(j.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Ts(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[q]]=j;break;case 161:a["!margins"]||Ts(a["!margins"]={}),a["!margins"].header=j.header,a["!margins"].footer=j.footer;break;case 574:j.RTL&&(k.Views[0].RTL=!0);break;case 146:T=j;break;case 2198:ne=j;break;case 140:b=j;break;case 442:u?A.CodeName=j||A.name:k.WBProps.CodeName=j||"ThisWorkbook";break}}else L||console.error("Missing Info for XLS Record 0x"+q.toString(16)),e.l+=X}return r.SheetNames=At(s).sort(function(ye,je){return Number(ye)-Number(je)}).map(function(ye){return s[ye].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&D.forEach(function(ye,je){r.Sheets[r.SheetNames[je]]["!autofilter"]=ye}),r.Strings=c,r.SSF=ot(Fe),U.enc&&(r.Encryption=U.enc),ne&&(r.Themes=ne),r.Metadata={},b!==void 0&&(r.Metadata.Country=b),H.names.length>0&&(k.Names=H.names),r.Workbook=k,r}var to={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function l8(e,t,r){var n=Ce.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Ep(n,mf,to.DSI);for(var s in a)t[s]=a[s]}catch(u){if(r.WTF)throw u}var i=Ce.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Ep(i,xf,to.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(Oy(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function o8(e,t){var r=[],n=[],a=[],s=0,i,o=rp(mf,"n"),c=rp(xf,"n");if(e.Props)for(i=At(e.Props),s=0;s<i.length;++s)(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(c,i[s])?n:a).push([i[s],e.Props[i[s]]]);if(e.Custprops)for(i=At(e.Custprops),s=0;s<i.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},i[s])||(Object.prototype.hasOwnProperty.call(o,i[s])?r:Object.prototype.hasOwnProperty.call(c,i[s])?n:a).push([i[s],e.Custprops[i[s]]]);var u=[];for(s=0;s<a.length;++s)zy.indexOf(a[s][0])>-1||Dy.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&Ce.utils.cfb_add(t,"/SummaryInformation",Tp(n,to.SI,c,xf)),(r.length||u.length)&&Ce.utils.cfb_add(t,"/DocumentSummaryInformation",Tp(r,to.DSI,o,mf,u.length?u:null,to.UDI))}function cm(e,t){t||(t={}),dm(t),Z0(),t.codepage&&Q0(t.codepage);var r,n;if(e.FullPaths){if(Ce.find(e,"/encryption"))throw new Error("File is password-protected");r=Ce.find(e,"!CompObj"),n=Ce.find(e,"/Workbook")||Ce.find(e,"/Book")}else{switch(t.type){case"base64":e=Wr(Zr(e));break;case"binary":e=Wr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}rr(e,0),n={content:e}}var a,s;if(r&&n8(r),t.bookProps&&!t.bookSheets)a={};else{var i=ze?"buffer":"array";if(n&&n.content)a=i8(n.content,t);else if((s=Ce.find(e,"PerfectOffice_MAIN"))&&s.content)a=Es.to_workbook(s.content,(t.type=i,t));else if((s=Ce.find(e,"NativeContent_MAIN"))&&s.content)a=Es.to_workbook(s.content,(t.type=i,t));else throw(s=Ce.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ce.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=b6(e))}var o={};return e.FullPaths&&l8(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}function c8(e,t){var r=t||{},n=Ce.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ce.utils.cfb_add(n,a,L_(e,r)),r.biff==8&&(e.Props||e.Custprops)&&o8(e,n),r.biff==8&&e.vbaraw&&k6(n,Ce.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Do={0:{f:O5},1:{f:$5},2:{f:lA},3:{f:Y5},4:{f:G5},5:{f:aA},6:{f:fA},7:{f:eA},8:{f:yA},9:{f:vA},10:{f:pA},11:{f:gA},12:{f:W5},13:{f:cA},14:{f:Q5},15:{f:q5},16:{f:j_},17:{f:mA},18:{f:rA},19:{f:Vh},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:hF},40:{},42:{},43:{f:f3},44:{f:u3},45:{f:x3},46:{f:g3},47:{f:p3},48:{},49:{f:L4},50:{},51:{f:J3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Qy},62:{f:dA},63:{f:i6},64:{f:RA},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:_r,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:FA},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:U5},148:{f:L5,p:16},151:{f:NA},152:{},153:{f:uF},154:{},155:{},156:{f:oF},157:{},158:{},159:{T:1,f:Tj},160:{T:-1},161:{T:1,f:Qs},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_A},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:X3},336:{T:-1},337:{f:e6,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hf},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Jy},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:EA},427:{f:TA},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:CA},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:B5},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:kA},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hf},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:g6},633:{T:1},634:{T:-1},635:{T:1,f:x6},636:{T:-1},637:{f:z4},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:QA},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:IA},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},wf={6:{f:Qu},10:{f:Sa},12:{f:Bt},13:{f:Bt},14:{f:Dt},15:{f:Dt},16:{f:pr},17:{f:Dt},18:{f:Dt},19:{f:Bt},20:{f:Dp},21:{f:Dp},23:{f:Jy},24:{f:Rp},25:{f:Dt},26:{},27:{},28:{f:IT},29:{},34:{f:Dt},35:{f:Op},38:{f:pr},39:{f:pr},40:{f:pr},41:{f:pr},42:{f:Dt},43:{f:Dt},47:{f:qj},49:{f:cT},51:{f:Bt},60:{},61:{f:aT},64:{f:Dt},65:{f:oT},66:{f:Bt},77:{},80:{},81:{},82:{},85:{f:Bt},89:{},90:{},91:{},92:{f:KE},93:{f:BT},94:{},95:{f:Dt},96:{},97:{},99:{f:Dt},125:{f:Qy},128:{f:ST},129:{f:XE},130:{f:Bt},131:{f:Dt},132:{f:Dt},133:{f:YE},134:{},140:{f:KT},141:{f:Bt},144:{},146:{f:YT},151:{},152:{},153:{},154:{},155:{},156:{f:Bt},157:{},158:{},160:{f:nj},161:{f:ZT},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:_T},190:{f:wT},193:{f:Sa},197:{},198:{},199:{},200:{},201:{},202:{f:Dt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Bt},220:{},221:{f:Dt},222:{},224:{f:kT},225:{f:GE},226:{f:Sa},227:{},229:{f:LT},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:QE},253:{f:dT},255:{f:eT},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:$y},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Dt},353:{f:Sa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:CT},431:{f:Dt},432:{},433:{},434:{},437:{},438:{f:$T},439:{f:Dt},440:{f:HT},441:{},442:{f:Ko},443:{},444:{f:Bt},445:{},446:{},448:{f:Sa},449:{f:nT,r:2},450:{f:Sa},512:{f:Ap},513:{f:rj},515:{f:TT},516:{f:hT},517:{f:Pp},519:{f:aj},520:{f:tT},523:{},545:{f:Ip},549:{f:Cp},566:{},574:{f:iT},638:{f:yT},659:{},1048:{},1054:{f:xT},1084:{},1212:{f:DT},2048:{f:VT},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ec},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Sa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:JT,r:12},2173:{f:K3,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Dt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:PT,r:12},2197:{},2198:{f:z3,r:12},2199:{},2200:{},2201:{},2202:{f:OT,r:12},2203:{f:Sa},2204:{},2205:{},2206:{},2207:{},2211:{f:rT},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Bt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:ej},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:XT},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Ap},1:{},2:{f:cj},3:{f:lj},4:{f:ij},5:{f:Pp},7:{f:dj},8:{},9:{f:Ec},11:{},22:{f:Bt},30:{f:gT},31:{},32:{},33:{f:Ip},36:{},37:{f:Cp},50:{f:fj},62:{},52:{},67:{},68:{f:Bt},69:{},86:{},126:{},127:{f:sj},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:hj},223:{},234:{},354:{},421:{},518:{f:Qu},521:{f:Ec},536:{f:Rp},547:{f:Op},561:{},579:{},1030:{f:Qu},1033:{f:Ec},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function be(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&$h(r)&&e.push(r)}}function u8(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return be(e,t,r,a);var s=t;if(!isNaN(s)){for(var i=r.parts||[],o=0,c=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Jo(e,t,r){return e||(e=ce(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function d8(e,t,r,n){var a=ce(9);return Jo(a,e,t),Hy(r,n||"b",a),a}function f8(e,t,r){var n=ce(8+2*r.length);return Jo(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function h8(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Gt(xt(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?be(e,2,uj(r,n,a)):be(e,3,oj(r,n,a));return;case"b":case"e":be(e,5,d8(r,n,t.v,t.t));return;case"s":case"str":be(e,4,f8(r,n,(t.v||"").slice(0,255)));return}be(e,1,Jo(null,r,n))}function m8(e,t,r,n){var a=Array.isArray(t),s=Ve(t["!ref"]||"A1"),i,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),i=Ie(s)}for(var u=s.s.r;u<=s.e.r;++u){o=jt(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=mt(d)),i=c[d]+o;var f=a?(t[u]||[])[d]:t[i];f&&h8(e,f,u,d)}}}function x8(e,t){for(var r=t||{},n=Ur(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return be(n,r.biff==4?1033:r.biff==3?521:9,Qh(e,16,r)),m8(n,e.Sheets[e.SheetNames[a]],a,r),be(n,10),n.end()}function p8(e,t,r){be(e,49,uT({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function g8(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&be(e,1054,pT(a,t[a],r))})}function v8(e,t){var r=ce(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),be(e,2151,r),r=ce(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),qy(Ve(t["!ref"]||"A1"),r),r.write_shift(4,4),be(e,2152,r)}function y8(e,t){for(var r=0;r<16;++r)be(e,224,Fp({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){be(e,224,Fp(n,0,t))})}function _8(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];be(e,440,WT(n)),n[1].Tooltip&&be(e,2048,GT(n))}delete t["!links"]}function w8(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&be(e,125,QT(lu(a,n),a))})}}function b8(e,t,r,n,a){var s=16+os(a.cellXfs,t,a);if(t.v==null&&!t.bf){be(e,513,Us(r,n,s));return}if(t.bf)be(e,6,XC(t,r,n,a,s));else switch(t.t){case"d":case"n":var i=t.t=="d"?Gt(xt(t.v)):t.v;be(e,515,jT(r,n,i,s));break;case"b":case"e":be(e,517,ET(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var o=im(a.Strings,t.v,a.revStrings);be(e,253,fT(r,n,o,s))}else be(e,516,mT(r,n,(t.v||"").slice(0,255),s,a));break;default:be(e,513,Us(r,n,s))}}function k8(e,t,r){var n=Ur(),a=r.SheetNames[e],s=r.Sheets[a]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(s),u=t.biff==8,d,f="",h=[],g=Ve(s["!ref"]||"A1"),p=u?65536:16384;if(g.e.c>255||g.e.r>=p){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,p-1)}be(n,2057,Qh(r,16,t)),be(n,13,dn(1)),be(n,12,dn(100)),be(n,15,Tr(!0)),be(n,17,Tr(!1)),be(n,16,Ms(.001)),be(n,95,Tr(!0)),be(n,42,Tr(!1)),be(n,43,Tr(!1)),be(n,130,dn(1)),be(n,128,NT()),be(n,131,Tr(!1)),be(n,132,Tr(!1)),u&&w8(n,s["!cols"]),be(n,512,vT(g,t)),u&&(s["!links"]=[]);for(var x=g.s.r;x<=g.e.r;++x){f=jt(x);for(var m=g.s.c;m<=g.e.c;++m){x===g.s.r&&(h[m]=mt(m)),d=h[m]+f;var v=c?(s[x]||[])[m]:s[d];v&&(b8(n,v,x,m,t),u&&v.l&&s["!links"].push([d,v.l]))}}var _=o.CodeName||o.name||a;return u&&be(n,574,lT((i.Views||[])[0])),u&&(s["!merges"]||[]).length&&be(n,229,MT(s["!merges"])),u&&_8(n,s),be(n,442,Wy(_)),u&&v8(n,s),be(n,10),n.end()}function S8(e,t,r){var n=Ur(),a=(e||{}).Workbook||{},s=a.Sheets||[],i=a.WBProps||{},o=r.biff==8,c=r.biff==5;if(be(n,2057,Qh(e,5,r)),r.bookType=="xla"&&be(n,135),be(n,225,o?dn(1200):null),be(n,193,EE(2)),c&&be(n,191),c&&be(n,192),be(n,226),be(n,92,qE("SheetJS",r)),be(n,66,dn(o?1200:1252)),o&&be(n,353,dn(0)),o&&be(n,448),be(n,317,tj(e.SheetNames.length)),o&&e.vbaraw&&be(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";be(n,442,Wy(u))}be(n,156,dn(17)),be(n,25,Tr(!1)),be(n,18,Tr(!1)),be(n,19,dn(0)),o&&be(n,431,Tr(!1)),o&&be(n,444,dn(0)),be(n,61,sT()),be(n,64,Tr(!1)),be(n,141,dn(0)),be(n,34,Tr(nF(e)=="true")),be(n,14,Tr(!0)),o&&be(n,439,Tr(!1)),be(n,218,dn(0)),p8(n,e,r),g8(n,e.SSF,r),y8(n,r),o&&be(n,352,Tr(!1));var d=n.end(),f=Ur();o&&be(f,140,qT()),o&&r.Strings&&u8(f,252,ZE(r.Strings)),be(f,10);var h=f.end(),g=Ur(),p=0,x=0;for(x=0;x<e.SheetNames.length;++x)p+=(o?12:11)+(o?2:1)*e.SheetNames[x].length;var m=d.length+p+h.length;for(x=0;x<e.SheetNames.length;++x){var v=s[x]||{};be(g,133,JE({pos:m,hs:v.Hidden||0,dt:0,name:e.SheetNames[x]},r)),m+=t[x].length}var _=g.end();if(p!=_.length)throw new Error("BS8 "+p+" != "+_.length);var y=[];return d.length&&y.push(d),_.length&&y.push(_),h.length&&y.push(h),Jt(y)}function N8(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ot(Fe)),e&&e.SSF&&(ll(),Wo(e.SSF),r.revssf=tu(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,fm(r),r.cellXfs=[],os(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=k8(a,r,e);return n.unshift(S8(e,n,r)),Jt(n)}function L_(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Cr(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return N8(e,t);case 4:case 3:case 2:return x8(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Gp(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,c=u4(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(i=0;i<c.length;++i){var x=c[i].trim(),m=x.slice(0,3).toLowerCase();if(m=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(m!="<td"&&m!="<th")){var v=x.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var _=v[o].trim();if(_.match(/<t[dh]/i)){for(var y=_,b=0;y.charAt(0)=="<"&&(b=y.indexOf(">"))>-1;)y=y.slice(b+1);for(var E=0;E<p.length;++E){var T=p[E];T.s.c==d&&T.s.r<u&&u<=T.e.r&&(d=T.e.c+1,E=-1)}var k=De(_.slice(0,_.indexOf(">")));h=k.colspan?+k.colspan:1,((f=+k.rowspan)>1||h>1)&&p.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var A=k.t||k["data-t"]||"";if(!y.length){d+=h;continue}if(y=dy(y),g.s.r>u&&(g.s.r=u),g.e.r<u&&(g.e.r=u),g.s.c>d&&(g.s.c=d),g.e.c<d&&(g.e.c=d),!y.length){d+=h;continue}var M={t:"s",v:y};r.raw||!y.trim().length||A=="s"||(y==="TRUE"?M={t:"b",v:!0}:y==="FALSE"?M={t:"b",v:!1}:isNaN(On(y))?isNaN(Zi(y).getDate())||(M={t:"d",v:xt(y)},r.cellDates||(M={t:"n",v:Gt(M.v)}),M.z=r.dateNF||Fe[14]):M={t:"n",v:On(y)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=M):n[Pe({r:u,c:d})]=M,d+=h}}}}return n["!ref"]=Ie(g),p.length&&(n["!merges"]=p),n}function M_(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>i)&&!(a[u].e.r<r||a[u].e.c<i)){if(a[u].s.r<r||a[u].s.c<i){o=-1;break}o=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var d=Pe({r,c:i}),f=n.dense?(e[r]||[])[i]:e[d],h=f&&f.v!=null&&(f.h||Rh(f.w||(Jn(f),f.w)||""))||"",g={};o>1&&(g.rowspan=o),c>1&&(g.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(g["data-t"]=f&&f.t||"z",f.v!=null&&(g["data-v"]=f.v),f.z!=null&&(g["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),g.id=(n.id||"sjs")+"-"+d,s.push(we("td",h,g))}}var p="<tr>";return p+s.join("")+"</tr>"}var B_='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',U_="</body></html>";function E8(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ls(Gp(r[0],t),t);var n=gm();return r.forEach(function(a,s){vm(n,Gp(a,t),"Sheet"+(s+1))}),n}function z_(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function $_(e,t){var r=t||{},n=r.header!=null?r.header:B_,a=r.footer!=null?r.footer:U_,s=[n],i=Cr(e["!ref"]);r.dense=Array.isArray(e),s.push(z_(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(M_(e,i,o,r));return s.push("</table>"+a),s.join("")}function H_(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?kt(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var d=Cr(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],h=0,g=e["!rows"]||(e["!rows"]=[]),p=0,x=0,m=0,v=0,_=0,y=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&x<c;++p){var b=o[p];if(Kp(b)){if(n.display)continue;g[x]={hidden:!0}}var E=b.children;for(m=v=0;m<E.length;++m){var T=E[m];if(!(n.display&&Kp(T))){var k=T.hasAttribute("data-v")?T.getAttribute("data-v"):T.hasAttribute("v")?T.getAttribute("v"):dy(T.innerHTML),A=T.getAttribute("data-z")||T.getAttribute("z");for(h=0;h<f.length;++h){var M=f[h];M.s.c==v+s&&M.s.r<x+a&&x+a<=M.e.r&&(v=M.e.c+1-s,h=-1)}y=+T.getAttribute("colspan")||1,((_=+T.getAttribute("rowspan")||1)>1||y>1)&&f.push({s:{r:x+a,c:v+s},e:{r:x+a+(_||1)-1,c:v+s+(y||1)-1}});var B={t:"s",v:k},G=T.getAttribute("data-t")||T.getAttribute("t")||"";k!=null&&(k.length==0?B.t=G||"z":n.raw||k.trim().length==0||G=="s"||(k==="TRUE"?B={t:"b",v:!0}:k==="FALSE"?B={t:"b",v:!1}:isNaN(On(k))?isNaN(Zi(k).getDate())||(B={t:"d",v:xt(k)},n.cellDates||(B={t:"n",v:Gt(B.v)}),B.z=n.dateNF||Fe[14]):B={t:"n",v:On(k)})),B.z===void 0&&A!=null&&(B.z=A);var U="",ne=T.getElementsByTagName("A");if(ne&&ne.length)for(var de=0;de<ne.length&&!(ne[de].hasAttribute("href")&&(U=ne[de].getAttribute("href"),U.charAt(0)!="#"));++de);U&&U.charAt(0)!="#"&&(B.l={Target:U}),n.dense?(e[x+a]||(e[x+a]=[]),e[x+a][v+s]=B):e[Pe({c:v+s,r:x+a})]=B,u.e.c<v+s&&(u.e.c=v+s),v+=y}}++x}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,x-1+a),e["!ref"]=Ie(u),x>=c&&(e["!fullref"]=Ie((u.e.r=o.length-p+x-1+a,u))),e}function W_(e,t){var r=t||{},n=r.dense?[]:{};return H_(n,e,t)}function T8(e,t){return ls(W_(e,t),t)}function Kp(e){var t="",r=j8(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function j8(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function C8(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ye(t.replace(/<[^>]*>/g,""));return[r]}var qp={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function V_(e,t){var r=t||{},n=Ih(e),a=[],s,i,o={name:""},c="",u=0,d,f,h={},g=[],p=r.dense?[]:{},x,m,v={value:""},_="",y=0,b=[],E=-1,T=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,M={},B=[],G={},U=0,ne=0,de=[],oe=1,Y=1,se=[],Z={Names:[]},H={},ae=["",""],K=[],P={},V="",D=0,R=!1,te=!1,F=0;for(To.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=To.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?p["!ref"]=Ie(k):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(p["!fullref"]=p["!ref"],k.e.r=r.sheetRows-1,p["!ref"]=Ie(k)),B.length&&(p["!merges"]=B),de.length&&(p["!rows"]=de),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),g.push(d.name),h[d.name]=p,te=!1):x[0].charAt(x[0].length-2)!=="/"&&(d=De(x[0],!1),E=T=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,p=r.dense?[]:{},B=[],de=[],te=!0);break;case"table-row-group":x[1]==="/"?--A:++A;break;case"table-row":case"":if(x[1]==="/"){E+=oe,oe=1;break}if(f=De(x[0],!1),f.?E=f.-1:E==-1&&(E=0),oe=+f["number-rows-repeated"]||1,oe<10)for(F=0;F<oe;++F)A>0&&(de[E+F]={level:A});T=-1;break;case"covered-table-cell":x[1]!=="/"&&++T,r.sheetStubs&&(r.dense?(p[E]||(p[E]=[]),p[E][T]={t:"z"}):p[Pe({r:E,c:T})]={t:"z"}),_="",b=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++T,v=De(x[0],!1),Y=parseInt(v["number-columns-repeated"]||"1",10),m={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(m.f=Hp(Ye(v.formula))),(v.||v["value-type"])=="string"&&(m.t="s",m.v=Ye(v["string-value"]||""),r.dense?(p[E]||(p[E]=[]),p[E][T]=m):p[Pe({r:E,c:T})]=m),T+=Y-1;else if(x[1]!=="/"){++T,_="",y=0,b=[],Y=1;var q=oe?E+oe-1:E;if(T>k.e.c&&(k.e.c=T),T<k.s.c&&(k.s.c=T),E<k.s.r&&(k.s.r=E),q>k.e.r&&(k.e.r=q),v=De(x[0],!1),K=[],P={},m={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=Ye(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(U=parseInt(v["number-matrix-rows-spanned"],10)||0,ne=parseInt(v["number-matrix-columns-spanned"],10)||0,G={s:{r:E,c:T},e:{r:E+U-1,c:T+ne-1}},m.F=Ie(G),se.push([G,m.F])),v.formula)m.f=Hp(v.formula);else for(F=0;F<se.length;++F)E>=se[F][0].s.r&&E<=se[F][0].e.r&&T>=se[F][0].s.c&&T<=se[F][0].e.c&&(m.F=se[F][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(U=parseInt(v["number-rows-spanned"],10)||0,ne=parseInt(v["number-columns-spanned"],10)||0,G={s:{r:E,c:T},e:{r:E+U-1,c:T+ne-1}},B.push(G)),v["number-columns-repeated"]&&(Y=parseInt(v["number-columns-repeated"],10)),m.t){case"boolean":m.t="b",m.v=ft(v["boolean-value"]);break;case"float":m.t="n",m.v=parseFloat(v.value);break;case"percentage":m.t="n",m.v=parseFloat(v.value);break;case"currency":m.t="n",m.v=parseFloat(v.value);break;case"date":m.t="d",m.v=xt(v["date-value"]),r.cellDates||(m.t="n",m.v=Gt(m.v)),m.z="m/d/yy";break;case"time":m.t="n",m.v=l4(v["time-value"])/86400,r.cellDates&&(m.t="d",m.v=ru(m.v)),m.z="HH:MM:SS";break;case"number":m.t="n",m.v=parseFloat(v.);break;default:if(m.t==="string"||m.t==="text"||!m.t)m.t="s",v["string-value"]!=null&&(_=Ye(v["string-value"]),b=[]);else throw new Error("Unsupported value type "+m.t)}}else{if(R=!1,m.t==="s"&&(m.v=_||"",b.length&&(m.R=b),R=y==0),H.Target&&(m.l=H),K.length>0&&(m.c=K,K=[]),_&&r.cellText!==!1&&(m.w=_),R&&(m.t="z",delete m.v),(!R||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var X=0;X<oe;++X){if(Y=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(p[E+X]||(p[E+X]=[]),p[E+X][T]=X==0?m:ot(m);--Y>0;)p[E+X][T+Y]=ot(m);else for(p[Pe({r:E+X,c:T})]=m;--Y>0;)p[Pe({r:E+X,c:T+Y})]=ot(m);k.e.c<=T&&(k.e.c=T)}Y=parseInt(v["number-columns-repeated"]||"1",10),T+=Y-1,Y=0,m={},_="",b=[]}H={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((s=a.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((s=a.pop())[0]!==x[3])throw"Bad state: "+s;P.t=_,b.length&&(P.R=b),P.a=V,K.push(P)}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);V="",D=0,_="",y=0,b=[];break;case"creator":x[1]==="/"?V=n.slice(D,x.index):D=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((s=a.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&a.push([x[3],!1]);_="",y=0,b=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(M[o.name]=c,(s=a.pop())[0]!==x[3])throw"Bad state: "+s}else x[0].charAt(x[0].length-2)!=="/"&&(c="",o=De(x[0],!1),a.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=De(x[0],!1),c+=qp[x[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=De(x[0],!1),c+=qp[x[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":i=De(x[0],!1),ae=Zu(i["cell-range-address"]);var L={Name:i.name,Ref:ae[0]+"!"+ae[1]};te&&(L.Sheet=g.length),Z.Names.push(L);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(x[1]==="/"&&(!v||!v["string-value"])){var J=C8(n.slice(y,x.index));_=(_.length>0?_+`
`:"")+J[0]}else De(x[0],!1),y=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{ae=Zu(De(x[0])["target-range-address"]),h[ae[0]]["!autofilter"]={ref:ae[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(H=De(x[0],!1),!H.href)break;H.Target=Ye(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(ae=Zu(H.Target.slice(1)),H.Target="#"+ae[0]+"!"+ae[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var j={Sheets:h,SheetNames:g,Workbook:Z};return r.bookSheets&&delete j.Sheets,j}function Xp(e,t){t=t||{},un(e,"META-INF/manifest.xml")&&lE(Mt(e,"META-INF/manifest.xml"),t);var r=Vr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=V_(st(r),t);return un(e,"meta.xml")&&(n.Props=Fy(Mt(e,"meta.xml"))),n}function Yp(e,t){return V_(e,t)}var A8=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Eo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return It+t}}(),Jp=function(){var e=function(s){return tt(s).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,i,o){var c=[];c.push('      <table:table table:name="'+tt(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,f=Cr(s["!ref"]||"A1"),h=s["!merges"]||[],g=0,p=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",m=s["!rows"]||[];for(u=0;u<f.s.r;++u)x=m[u]?' table:style-name="ro'+m[u].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=f.e.r;++u){for(x=m[u]?' table:style-name="ro'+m[u].ods+'"':"",c.push("        <table:table-row"+x+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var v=!1,_={},y="";for(g=0;g!=h.length;++g)if(!(h[g].s.c>d)&&!(h[g].s.r>u)&&!(h[g].e.c<d)&&!(h[g].e.r<u)){(h[g].s.c!=d||h[g].s.r!=u)&&(v=!0),_["table:number-columns-spanned"]=h[g].e.c-h[g].s.c+1,_["table:number-rows-spanned"]=h[g].e.r-h[g].s.r+1;break}if(v){c.push(r);continue}var b=Pe({r:u,c:d}),E=p?(s[u]||[])[d]:s[b];if(E&&E.f&&(_["table:formula"]=tt(t5(E.f)),E.F&&E.F.slice(0,b.length)==b)){var T=Cr(E.F);_["table:number-matrix-columns-spanned"]=T.e.c-T.s.c+1,_["table:number-matrix-rows-spanned"]=T.e.r-T.s.r+1}if(!E){c.push(t);continue}switch(E.t){case"b":y=E.v?"TRUE":"FALSE",_["office:value-type"]="boolean",_["office:boolean-value"]=E.v?"true":"false";break;case"n":y=E.w||String(E.v||0),_["office:value-type"]="float",_["office:value"]=E.v||0;break;case"s":case"str":y=E.v==null?"":E.v,_["office:value-type"]="string";break;case"d":y=E.w||xt(E.v).toISOString(),_["office:value-type"]="date",_["office:date-value"]=xt(E.v).toISOString(),_["table:style-name"]="ce1";break;default:c.push(t);continue}var k=e(y);if(E.l&&E.l.Target){var A=E.l.Target;A=A.charAt(0)=="#"?"#"+r5(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),k=we("text:a",k,{"xlink:href":A.replace(/&/g,"&amp;")})}c.push("          "+we("table:table-cell",we("text:p",k,{}),_)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,i){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Za(f),f.ods=o;var h=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(i,o){var c=[It],u=Eo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Eo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(Ay().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=i.SheetNames.length;++f)c.push(n(i.Sheets[i.SheetNames[f]],i,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function G_(e,t){if(t.bookType=="fods")return Jp(e,t);var r=Ph(),n="",a=[],s=[];return n="mimetype",Le(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Le(r,n,Jp(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Le(r,n,A8(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Le(r,n,It+Ay()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Le(r,n,uE(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Le(r,n,oE(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function zs(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function bf(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):st(is(e))}function F8(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Wr(Gn(e))}function P8(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ts(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function Qp(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function D8(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function O8(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function Oo(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ze(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ct(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Je(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Oo(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Oo(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:s};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function er(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Ze(n*8+a.type)),a.type==2&&t.push(Ze(a.data.length)),t.push(a.data))})}),ts(t)}function um(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function on(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Oo(e,n),s=Je(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:Ct(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=Je(o.data),u=Ct(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(i.merge=Ct(s[3][0].data)>>>0>0),r.push(i)}return r}function fi(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ze(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ze(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(i){a.push(i.data),i.meta[3]=[{type:0,data:Ze(i.data.length)}],n[2].push({data:er(i.meta),type:2})});var s=er(n);t.push(Ze(s.length)),t.push(s),a.forEach(function(i){return t.push(i)})}),ts(t)}function R8(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Oo(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[ts(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var d=ts(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function cn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(R8(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ts(t)}function hi(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=Ze(n),i=s.length;t.push(s),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,a[0]=0,a[1]=i&255,a[2]=i>>8&255,a[3]=i>>16&255,r+=n}return ts(t)}function I8(e,t,r,n){var a=zs(e),s=a.getUint32(4,!0),i=(n>1?12:8)+Qp(s&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=Qp(s&(n>1?12288:4096))*4,s&16&&(c=a.getUint32(i,!0),i+=4),s&32&&(u=a.getFloat64(i,!0),i+=8),s&64&&(d.setTime(d.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function L8(e,t,r){var n=zs(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);a&1&&(c=D8(e,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function td(e,t){var r=new Uint8Array(32),n=zs(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,O8(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function rd(e,t){var r=new Uint8Array(32),n=zs(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function M8(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return I8(e,t,r,e[0]);case 5:return L8(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function fr(e){var t=Je(e);return Oo(t[1][0].data)}function Zp(e,t){var r=Je(t.data),n=Ct(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=Je(i.data),c=Ct(o[1][0].data)>>>0;switch(n){case 1:s[c]=bf(o[3][0].data);break;case 8:{var u=e[fr(o[9][0].data)][0],d=Je(u.data),f=e[fr(d[1][0].data)][0],h=Ct(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var g=Je(f.data);s[c]=g[3].map(function(p){return bf(p.data)}).join("")}break}}),s}function B8(e,t){var r,n,a,s,i,o,c,u,d,f,h,g,p,x,m=Je(e),v=Ct(m[1][0].data)>>>0,_=Ct(m[2][0].data)>>>0,y=((n=(r=m[8])==null?void 0:r[0])==null?void 0:n.data)&&Ct(m[8][0].data)>0||!1,b,E;if((s=(a=m[7])==null?void 0:a[0])!=null&&s.data&&t!=0)b=(o=(i=m[7])==null?void 0:i[0])==null?void 0:o.data,E=(u=(c=m[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=m[4])==null?void 0:d[0])!=null&&f.data&&t!=1)b=(g=(h=m[4])==null?void 0:h[0])==null?void 0:g.data,E=(x=(p=m[3])==null?void 0:p[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var T=y?4:1,k=zs(b),A=[],M=0;M<b.length/2;++M){var B=k.getUint16(M*2,!0);B<65535&&A.push([M,B])}if(A.length!=_)throw"Expected ".concat(_," cells, found ").concat(A.length);var G=[];for(M=0;M<A.length-1;++M)G[A[M][0]]=E.subarray(A[M][1]*T,A[M+1][1]*T);return A.length>=1&&(G[A[A.length-1][0]]=E.subarray(A[A.length-1][1]*T)),{R:v,cells:G}}function U8(e,t){var r,n=Je(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Ct(n[7][0].data)>>>0>0?1:0:-1,s=um(n[5],function(i){return B8(i,a)});return{nrows:Ct(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=c}),i},[])}}function z8(e,t,r){var n,a=Je(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ct(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Ct(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ie(s);var i=Je(a[4][0].data),o=Zp(e,e[fr(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?Zp(e,e[fr(i[17][0].data)][0]):[],u=Je(i[3][0].data),d=0;u[1].forEach(function(f){var h=Je(f.data),g=e[fr(h[2][0].data)][0],p=Ct(g.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var x=U8(e,g);x.data.forEach(function(m,v){m.forEach(function(_,y){var b=Pe({r:d+v,c:y}),E=M8(_,o,c);E&&(r[b]=E)})}),d+=x.nrows})}function $8(e,t){var r=Je(t.data),n={"!ref":"A1"},a=e[fr(r[2][0].data)],s=Ct(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return z8(e,a[0],n),n}function H8(e,t){var r,n=Je(t.data),a={name:(r=n[1])!=null&&r[0]?bf(n[1][0].data):"",sheets:[]},s=um(n[2],fr);return s.forEach(function(i){e[i].forEach(function(o){var c=Ct(o.meta[1][0].data);c==6e3&&a.sheets.push($8(e,o))})}),a}function W8(e,t){var r=gm(),n=Je(t.data),a=um(n[1],fr);if(a.forEach(function(s){e[s].forEach(function(i){var o=Ct(i.meta[1][0].data);if(o==2){var c=H8(e,i);c.sheets.forEach(function(u,d){vm(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function nd(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=cn(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=on(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Ct(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(c){s[c].forEach(function(u){var d=Ct(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return W8(s,o)}function V8(e,t,r){var n,a,s,i;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(s=e[8])==null?void 0:s[0])==null?void 0:i.data)&&Ct(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=zs(e[7][0].data),d=0,f=[],h=zs(e[4][0].data),g=0,p=[],x=0;x<t.length;++x){if(t[x]==null){u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535);continue}u.setUint16(x*2,d,!0),h.setUint16(x*2,g,!0);var m,v;switch(typeof t[x]){case"string":m=td({t:"s",v:t[x]},r),v=rd({t:"s",v:t[x]},r);break;case"number":m=td({t:"n",v:t[x]},r),v=rd({t:"n",v:t[x]},r);break;case"boolean":m=td({t:"b",v:t[x]},r),v=rd({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}f.push(m),d+=m.length,p.push(v),g+=v.length,++c}for(e[2][0].data=Ze(c);x<e[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535,!0);return e[6][0].data=ts(f),e[3][0].data=ts(p),c}function G8(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Cr(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Ie(n)));var s=A0(r,{range:n,header:1}),i=["~Sh33tJ5~"];s.forEach(function(V){return V.forEach(function(D){typeof D=="string"&&i.push(D)})});var o={},c=[],u=Ce.read(t.numbers,{type:"base64"});u.FileIndex.map(function(V,D){return[V,u.FullPaths[D]]}).forEach(function(V){var D=V[0],R=V[1];if(D.type==2&&D.name.match(/\.iwa/)){var te=D.content,F=cn(te),q=on(F);q.forEach(function(X){c.push(X.id),o[X.id]={deps:[],location:R,type:Ct(X.messages[0].meta[1][0].data)}})}}),c.sort(function(V,D){return V-D});var d=c.filter(function(V){return V>1}).map(function(V){return[V,Ze(V)]});u.FileIndex.map(function(V,D){return[V,u.FullPaths[D]]}).forEach(function(V){var D=V[0];if(V[1],!!D.name.match(/\.iwa/)){var R=on(cn(D.content));R.forEach(function(te){te.messages.forEach(function(F){d.forEach(function(q){te.messages.some(function(X){return Ct(X.meta[1][0].data)!=11006&&P8(X.data,q[1])})&&o[q[0]].deps.push(te.id)})})})}});for(var f=Ce.find(u,o[1].location),h=on(cn(f.content)),g,p=0;p<h.length;++p){var x=h[p];x.id==1&&(g=x)}var m=fr(Je(g.messages[0].data)[1][0].data);for(f=Ce.find(u,o[m].location),h=on(cn(f.content)),p=0;p<h.length;++p)x=h[p],x.id==m&&(g=x);for(m=fr(Je(g.messages[0].data)[2][0].data),f=Ce.find(u,o[m].location),h=on(cn(f.content)),p=0;p<h.length;++p)x=h[p],x.id==m&&(g=x);for(m=fr(Je(g.messages[0].data)[2][0].data),f=Ce.find(u,o[m].location),h=on(cn(f.content)),p=0;p<h.length;++p)x=h[p],x.id==m&&(g=x);var v=Je(g.messages[0].data);{v[6][0].data=Ze(n.e.r+1),v[7][0].data=Ze(n.e.c+1);var _=fr(v[46][0].data),y=Ce.find(u,o[_].location),b=on(cn(y.content));{for(var E=0;E<b.length&&b[E].id!=_;++E);if(b[E].id!=_)throw"Bad ColumnRowUIDMapArchive";var T=Je(b[E].messages[0].data);T[1]=[],T[2]=[],T[3]=[];for(var k=0;k<=n.e.c;++k){var A=[];A[1]=A[2]=[{type:0,data:Ze(k+420690)}],T[1].push({type:2,data:er(A)}),T[2].push({type:0,data:Ze(k)}),T[3].push({type:0,data:Ze(k)})}T[4]=[],T[5]=[],T[6]=[];for(var M=0;M<=n.e.r;++M)A=[],A[1]=A[2]=[{type:0,data:Ze(M+726270)}],T[4].push({type:2,data:er(A)}),T[5].push({type:0,data:Ze(M)}),T[6].push({type:0,data:Ze(M)});b[E].messages[0].data=er(T)}y.content=hi(fi(b)),y.size=y.content.length,delete v[46];var B=Je(v[4][0].data);{B[7][0].data=Ze(n.e.r+1);var G=Je(B[1][0].data),U=fr(G[2][0].data);y=Ce.find(u,o[U].location),b=on(cn(y.content));{if(b[0].id!=U)throw"Bad HeaderStorageBucket";var ne=Je(b[0].messages[0].data);for(M=0;M<s.length;++M){var de=Je(ne[2][0].data);de[1][0].data=Ze(M),de[4][0].data=Ze(s[M].length),ne[2][M]={type:ne[2][0].type,data:er(de)}}b[0].messages[0].data=er(ne)}y.content=hi(fi(b)),y.size=y.content.length;var oe=fr(B[2][0].data);y=Ce.find(u,o[oe].location),b=on(cn(y.content));{if(b[0].id!=oe)throw"Bad HeaderStorageBucket";for(ne=Je(b[0].messages[0].data),k=0;k<=n.e.c;++k)de=Je(ne[2][0].data),de[1][0].data=Ze(k),de[4][0].data=Ze(n.e.r+1),ne[2][k]={type:ne[2][0].type,data:er(de)};b[0].messages[0].data=er(ne)}y.content=hi(fi(b)),y.size=y.content.length;var Y=fr(B[4][0].data);(function(){for(var V=Ce.find(u,o[Y].location),D=on(cn(V.content)),R,te=0;te<D.length;++te){var F=D[te];F.id==Y&&(R=F)}var q=Je(R.messages[0].data);{q[3]=[];var X=[];i.forEach(function(j,ke){X[1]=[{type:0,data:Ze(ke)}],X[2]=[{type:0,data:Ze(1)}],X[3]=[{type:2,data:F8(j)}],q[3].push({type:2,data:er(X)})})}R.messages[0].data=er(q);var L=fi(D),J=hi(L);V.content=J,V.size=V.content.length})();var se=Je(B[3][0].data);{var Z=se[1][0];delete se[2];var H=Je(Z.data);{var ae=fr(H[2][0].data);(function(){for(var V=Ce.find(u,o[ae].location),D=on(cn(V.content)),R,te=0;te<D.length;++te){var F=D[te];F.id==ae&&(R=F)}var q=Je(R.messages[0].data);{delete q[6],delete se[7];var X=new Uint8Array(q[5][0].data);q[5]=[];for(var L=0,J=0;J<=n.e.r;++J){var j=Je(X);L+=V8(j,s[J],i),j[1][0].data=Ze(J),q[5].push({data:er(j),type:2})}q[1]=[{type:0,data:Ze(n.e.c+1)}],q[2]=[{type:0,data:Ze(n.e.r+1)}],q[3]=[{type:0,data:Ze(L)}],q[4]=[{type:0,data:Ze(n.e.r+1)}]}R.messages[0].data=er(q);var ke=fi(D),ue=hi(ke);V.content=ue,V.size=V.content.length})()}Z.data=er(H)}B[3][0].data=er(se)}v[4][0].data=er(B)}g.messages[0].data=er(v);var K=fi(h),P=hi(K);return f.content=P,f.size=f.content.length,u}function K_(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function dm(e){K_([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function fm(e){K_([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function K8(e){return $e.WS.indexOf(e)>-1?"sheet":e==$e.CS?"chart":e==$e.DS?"dialog":e==$e.MS?"macro":e&&e.length?e:"sheet"}function q8(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,K8(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function X8(e,t,r,n,a,s,i,o,c,u,d,f){try{s[n]=Jl(Vr(e,r,!0),t);var h=Mt(e,t),g;switch(o){case"sheet":g=wF(h,t,a,c,s[n],u,d,f);break;case"chart":if(g=bF(h,t,a,c,s[n],u,d,f),!g||!g["!drawel"])break;var p=Ol(g["!drawel"].Target,t),x=jo(p),m=c6(Vr(e,p,!0),Jl(Vr(e,x,!0),p)),v=Ol(m,p),_=jo(v);g=YA(Vr(e,v,!0),v,c,Jl(Vr(e,_,!0),v),u,g);break;case"macro":g=kF(h,t,a,c,s[n],u,d,f);break;case"dialog":g=SF(h,t,a,c,s[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=g;var y=[];s&&s[n]&&At(s[n]).forEach(function(b){var E="";if(s[n][b].Type==$e.CMNT){E=Ol(s[n][b].Target,t);var T=jF(Mt(e,E,!0),E,c);if(!T||!T.length)return;Mp(g,T,!1)}s[n][b].Type==$e.TCMNT&&(E=Ol(s[n][b].Target,t),y=y.concat(d6(Mt(e,E,!0),c)))}),y&&y.length&&Mp(g,y,!0,c.people||[])}catch(b){if(c.WTF)throw b}}function sn(e){return e.charAt(0)=="/"?e.slice(1):e}function q_(e,t){if(ll(),t=t||{},dm(t),un(e,"META-INF/manifest.xml")||un(e,"objectdata.xml"))return Xp(e,t);if(un(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof nd<"u"){if(e.FileIndex)return nd(e);var r=Ce.utils.cfb_new();return sp(e).forEach(function(de){Le(r,de,f4(e,de))}),nd(r)}throw new Error("Unsupported NUMBERS file")}if(!un(e,"[Content_Types].xml"))throw un(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):un(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=sp(e),a=sE(Vr(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Mt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Mt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Ql=[],a.sst)try{Ql=TF(Mt(e,sn(a.sst)),a.sst,t)}catch(de){if(t.WTF)throw de}t.cellStyles&&a.themes.length&&(c=EF(Vr(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=NF(Mt(e,sn(a.style)),a.style,c,t))}a.links.map(function(de){try{var oe=Jl(Vr(e,jo(sn(de))),de);return AF(Mt(e,sn(de)),oe,de,t)}catch{}});var d=_F(Mt(e,sn(a.workbooks[0])),a.workbooks[0],t),f={},h="";a.coreprops.length&&(h=Mt(e,sn(a.coreprops[0]),!0),h&&(f=Fy(h)),a.extprops.length!==0&&(h=Mt(e,sn(a.extprops[0]),!0),h&&fE(h,f,t)));var g={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=Vr(e,sn(a.custprops[0]),!0),h&&(g=mE(h,t)));var p={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(oe){return oe.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),t.bookProps&&(p.Props=f,p.Custprops=g),t.bookSheets&&typeof i<"u"&&(p.SheetNames=i),t.bookSheets?p.SheetNames:t.bookProps))return p;i={};var x={};t.bookDeps&&a.calcchain&&(x=CF(Mt(e,sn(a.calcchain)),a.calcchain));var m=0,v={},_,y;{var b=d.Sheets;f.Worksheets=b.length,f.SheetNames=[];for(var E=0;E!=b.length;++E)f.SheetNames[E]=b[E].name}var T=s?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),A=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");un(e,A)||(A="xl/_rels/workbook."+T+".rels");var M=Jl(Vr(e,A,!0),A.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=FF(Mt(e,sn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=h6(Mt(e,sn(a.people[0])),t)),M&&(M=q8(M,d.Sheets));var B=Mt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(m=0;m!=f.Worksheets;++m){var G="sheet";if(M&&M[m]?(_="xl/"+M[m][1].replace(/[\/]?xl\//,""),un(e,_)||(_=M[m][1]),un(e,_)||(_=A.replace(/_rels\/.*$/,"")+M[m][1]),G=M[m][2]):(_="xl/worksheets/sheet"+(m+1-B)+"."+T,_=_.replace(/sheet0\./,"sheet.")),y=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(m!=t.sheets)continue e;break;case"string":if(f.SheetNames[m].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var U=!1,ne=0;ne!=t.sheets.length;++ne)typeof t.sheets[ne]=="number"&&t.sheets[ne]==m&&(U=1),typeof t.sheets[ne]=="string"&&t.sheets[ne].toLowerCase()==f.SheetNames[m].toLowerCase()&&(U=1);if(!U)continue e}}X8(e,_,y,f.SheetNames[m],m,v,i,G,t,d,c,u)}return p={Directory:a,Workbook:d,Props:f,Custprops:g,Deps:x,Sheets:i,SheetNames:f.SheetNames,Strings:Ql,Styles:u,Themes:c,SSF:ot(Fe)},t&&t.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(de,oe){de=de.replace(/^Root Entry[\/]/,""),p.keys.push(de),p.files[de]=e.FileIndex[oe]}))),t&&t.bookVBA&&(a.vba.length>0?p.vbaraw=Mt(e,sn(a.vba[0]),!0):a.defaults&&a.defaults.bin===w6&&(p.vbaraw=Mt(e,"xl/vbaProject.bin",!0))),p}function Y8(e,t){var r=t||{},n="Workbook",a=Ce.find(e,n);try{if(n="/!DataSpaces/Version",a=Ce.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Pj(a.content),n="/!DataSpaces/DataSpaceMap",a=Ce.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=Oj(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ce.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Rj(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ce.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Lj(a.content)}catch{}if(n="/EncryptionInfo",a=Ce.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Mj(a.content);if(n="/EncryptedPackage",a=Ce.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function J8(e,t){return t.bookType=="ods"?G_(e,t):t.bookType=="numbers"?G8(e,t):t.bookType=="xlsb"?Q8(e,t):X_(e,t)}function Q8(e,t){Fi=1024,e&&!e.SSF&&(e.SSF=ot(Fe)),e&&e.SSF&&(ll(),Wo(e.SSF),t.revssf=tu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Zl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=p_.indexOf(t.bookType)>-1,a=Yh();fm(t=t||{});var s=Ph(),i="",o=0;if(t.cellXfs=[],os(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Le(s,i,Py(e.Props,t)),a.coreprops.push(i),et(t.rels,2,i,$e.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Le(s,i,Ry(e.Props)),a.extprops.push(i),et(t.rels,3,i,$e.EXT_PROPS),e.Custprops!==e.Props&&At(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Le(s,i,Iy(e.Custprops)),a.custprops.push(i),et(t.rels,4,i,$e.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Le(s,i,DF(o-1,i,t,e,d)),a.sheets.push(i),et(t.wbrels,-1,"worksheets/sheet"+o+"."+r,$e.WS[0])}if(f){var g=f["!comments"],p=!1,x="";g&&g.length>0&&(x="xl/comments"+o+"."+r,Le(s,x,IF(g,x)),a.comments.push(x),et(d,-1,"../comments"+o+"."+r,$e.CMNT),p=!0),f["!legacy"]&&p&&Le(s,"xl/drawings/vmlDrawing"+o+".vml",m_(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Le(s,jo(i),Bi(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Le(s,i,RF(t.Strings,i,t)),a.strs.push(i),et(t.wbrels,-1,"sharedStrings."+r,$e.SST)),i="xl/workbook."+r,Le(s,i,PF(e,i)),a.workbooks.push(i),et(t.rels,1,i,$e.WB),i="xl/theme/theme1.xml",Le(s,i,rm(e.Themes,t)),a.themes.push(i),et(t.wbrels,-1,"theme/theme1.xml",$e.THEME),i="xl/styles."+r,Le(s,i,OF(e,i,t)),a.styles.push(i),et(t.wbrels,-1,"styles."+r,$e.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Le(s,i,e.vbaraw),a.vba.push(i),et(t.wbrels,-1,"vbaProject.bin",$e.VBA)),i="xl/metadata."+r,Le(s,i,LF(i)),a.metadata.push(i),et(t.wbrels,-1,"metadata."+r,$e.XLMETA),Le(s,"[Content_Types].xml",Cy(a,t)),Le(s,"_rels/.rels",Bi(t.rels)),Le(s,"xl/_rels/workbook."+r+".rels",Bi(t.wbrels)),delete t.revssf,delete t.ssf,s}function X_(e,t){Fi=1024,e&&!e.SSF&&(e.SSF=ot(Fe)),e&&e.SSF&&(ll(),Wo(e.SSF),t.revssf=tu(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Zl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=p_.indexOf(t.bookType)>-1,a=Yh();fm(t=t||{});var s=Ph(),i="",o=0;if(t.cellXfs=[],os(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Le(s,i,Py(e.Props,t)),a.coreprops.push(i),et(t.rels,2,i,$e.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Le(s,i,Ry(e.Props)),a.extprops.push(i),et(t.rels,3,i,$e.EXT_PROPS),e.Custprops!==e.Props&&At(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Le(s,i,Iy(e.Custprops)),a.custprops.push(i),et(t.rels,4,i,$e.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],g=(h||{})["!type"]||"sheet";switch(g){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Le(s,i,T_(o-1,t,e,f)),a.sheets.push(i),et(t.wbrels,-1,"worksheets/sheet"+o+"."+r,$e.WS[0])}if(h){var p=h["!comments"],x=!1,m="";if(p&&p.length>0){var v=!1;p.forEach(function(_){_[1].forEach(function(y){y.T==!0&&(v=!0)})}),v&&(m="xl/threadedComments/threadedComment"+o+"."+r,Le(s,m,f6(p,d,t)),a.threadedcomments.push(m),et(f,-1,"../threadedComments/threadedComment"+o+"."+r,$e.TCMNT)),m="xl/comments"+o+"."+r,Le(s,m,x_(p)),a.comments.push(m),et(f,-1,"../comments"+o+"."+r,$e.CMNT),x=!0}h["!legacy"]&&x&&Le(s,"xl/drawings/vmlDrawing"+o+".vml",m_(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Le(s,jo(i),Bi(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Le(s,i,r_(t.Strings,t)),a.strs.push(i),et(t.wbrels,-1,"sharedStrings."+r,$e.SST)),i="xl/workbook."+r,Le(s,i,D_(e)),a.workbooks.push(i),et(t.rels,1,i,$e.WB),i="xl/theme/theme1.xml",Le(s,i,rm(e.Themes,t)),a.themes.push(i),et(t.wbrels,-1,"theme/theme1.xml",$e.THEME),i="xl/styles."+r,Le(s,i,u_(e,t)),a.styles.push(i),et(t.wbrels,-1,"styles."+r,$e.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Le(s,i,e.vbaraw),a.vba.push(i),et(t.wbrels,-1,"vbaProject.bin",$e.VBA)),i="xl/metadata."+r,Le(s,i,h_()),a.metadata.push(i),et(t.wbrels,-1,"metadata."+r,$e.XLMETA),d.length>1&&(i="xl/persons/person.xml",Le(s,i,m6(d)),a.people.push(i),et(t.wbrels,-1,"persons/person.xml",$e.PEOPLE)),Le(s,"[Content_Types].xml",Cy(a,t)),Le(s,"_rels/.rels",Bi(t.rels)),Le(s,"xl/_rels/workbook."+r+".rels",Bi(t.wbrels)),delete t.revssf,delete t.ssf,s}function hm(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Zr(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Z8(e,t){return Ce.find(e,"EncryptedPackage")?Y8(e,t):cm(e,t)}function eP(e,t){var r,n=e,a=t||{};return a.type||(a.type=ze&&Buffer.isBuffer(e)?"buffer":"base64"),r=oy(n,a),q_(r,a)}function Y_(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return _f(e.slice(r),t);default:break e}return el.to_workbook(e,t)}function tP(e,t){var r="",n=hm(e,t);switch(t.type){case"base64":r=Zr(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ls(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=st(r)),t.type="binary",Y_(r,t)}function rP(e,t){var r=e;return t.type=="base64"&&(r=Zr(r)),r=qe.utils.decode(1200,r.slice(2),"str"),t.type="binary",Y_(r,t)}function nP(e){return e.match(/[^\x00-\x7F]/)?Gn(e):e}function ad(e,t,r,n){return n?(r.type="string",el.to_workbook(e,r)):el.to_workbook(t,r)}function $s(e,t){Z0();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return $s(new Uint8Array(e),(r=ot(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),zi={},r.dateNF&&(zi.dateNF=r.dateNF),r.type||(r.type=ze&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ze?"buffer":"binary",n=a4(e),typeof Uint8Array<"u"&&!ze&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=nP(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=ot(r),r.type="array",$s(jh(n),r)}switch((a=hm(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Z8(Ce.read(n,r),r);break;case 9:if(a[1]<=8)return cm(n,r);break;case 60:return _f(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return xj(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return e_.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?eP(n,r):ad(e,n,r,s);case 239:return a[3]===60?_f(n,r):ad(e,n,r,s);case 255:if(a[1]===254)return rP(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Es.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Es.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return yf.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return l_.to_workbook(n,r);break;case 10:case 13:case 32:return tP(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return mj.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?yf.to_workbook(n,r):ad(e,n,r,s)}function eg(e,t){var r=t||{};return r.type="file",$s(e,r)}function J_(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Vo(t.file,Ce.write(e,{type:ze?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ce.write(e,t)}function aP(e,t){var r=ot(t||{}),n=J8(e,r);return Q_(n,r)}function sP(e,t){var r=ot(t||{}),n=X_(e,r);return Q_(n,r)}function Q_(e,t){var r={},n=ze?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?Ce.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Ho(a))}return t.password&&typeof encrypt_agile<"u"?J_(encrypt_agile(a,t.password),t):t.type==="file"?Vo(t.file,a):t.type=="string"?st(a):a}function iP(e,t){var r=t||{},n=c8(e,r);return J_(n,r)}function $n(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return ko(Gn(n));case"binary":return Gn(n);case"string":return e;case"file":return Vo(t.file,n,"utf8");case"buffer":return ze?va(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):$n(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function lP(e,t){switch(t.type){case"base64":return ko(e);case"binary":return e;case"string":return e;case"file":return Vo(t.file,e,"binary");case"buffer":return ze?va(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ac(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?ko(r):t.type=="string"?st(r):r;case"file":return Vo(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function mm(e,t){Z0(),P_(e);var r=ot(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=mm(e,r);return r.type="array",Ho(n)}return sP(e,r)}function ou(e,t){Z0(),P_(e);var r=ot(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=ou(e,r);return r.type="array",Ho(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return $n(r8(e,r),r);case"slk":case"sylk":return $n(Zy.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return $n($_(e.Sheets[e.SheetNames[a]],r),r);case"txt":return lP(t2(e.Sheets[e.SheetNames[a]],r),r);case"csv":return $n(pm(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return $n(e_.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Ac(yf.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return $n(el.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return $n(l_.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return $n(t_.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return $n(G_(e,r),r);case"wk1":return Ac(Es.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Ac(Es.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Ac(L_(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),iP(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return aP(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function xm(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Hs(e,t,r){var n=r||{};return n.type="file",n.file=t,xm(n),ou(e,n)}function oP(e,t,r){var n=r||{};return n.type="file",n.file=t,xm(n),mm(e,n)}function cP(e,t,r,n){var a=r||{};a.type="file",a.file=e,xm(a),a.type="buffer";var s=n;return s instanceof Function||(s=r),Ma.writeFile(e,ou(t,a),s)}function Z_(e,t,r,n,a,s,i,o){var c=jt(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var g=t.s.c;g<=t.e.c;++g){var p=i?e[r][g]:e[n[g]+c];if(p===void 0||p.t===void 0){if(u===void 0)continue;s[g]!=null&&(h[s[g]]=u);continue}var x=p.v;switch(p.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(s[g]!=null){if(x==null)if(p.t=="e"&&x===null)h[s[g]]=null;else if(u!==void 0)h[s[g]]=u;else if(d&&x===null)h[s[g]]=null;else continue;else h[s[g]]=d&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?x:Jn(p,x,o);x!=null&&(f=!1)}}return{row:h,isempty:f}}function A0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=Ve(d);break;case"number":c=Ve(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var f=jt(c.s.r),h=[],g=[],p=0,x=0,m=Array.isArray(e),v=c.s.r,_=0,y={};m&&!e[v]&&(e[v]=[]);var b=u.skipHidden&&e["!cols"]||[],E=u.skipHidden&&e["!rows"]||[];for(_=c.s.c;_<=c.e.c;++_)if(!(b[_]||{}).hidden)switch(h[_]=mt(_),r=m?e[v][_]:e[h[_]+f],n){case 1:s[_]=_-c.s.c;break;case 2:s[_]=h[_];break;case 3:s[_]=u.header[_-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Jn(r,null,u),x=y[i]||0,!x)y[i]=1;else{do o=i+"_"+x++;while(y[o]);y[i]=x,y[o]=1}s[_]=o}for(v=c.s.r+a;v<=c.e.r;++v)if(!(E[v]||{}).hidden){var T=Z_(e,c,v,h,n,s,m,u);(T.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(g[p++]=T.row)}return g.length=p,g}var tg=/"/g;function e2(e,t,r,n,a,s,i,o){for(var c=!0,u=[],d="",f=jt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var g=o.dense?(e[r]||[])[h]:e[n[h]+f];if(g==null)d="";else if(g.v!=null){c=!1,d=""+(o.rawNumbers&&g.t=="n"?g.v:Jn(g,null,o));for(var p=0,x=0;p!==d.length;++p)if((x=d.charCodeAt(p))===a||x===s||x===34||o.forceQuotes){d='"'+d.replace(tg,'""')+'"';break}d=="ID"&&(d='"ID"')}else g.f!=null&&!g.F?(c=!1,d="="+g.f,d.indexOf(",")>=0&&(d='"'+d.replace(tg,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(i)}function pm(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Ve(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],g=n.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(h[p]||{}).hidden||(f[p]=mt(p));for(var x=0,m=a.s.r;m<=a.e.r;++m)(g[m]||{}).hidden||(d=e2(e,a,m,f,i,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((x++?o:"")+d)));return delete n.dense,r.join("")}function t2(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=pm(e,t);if(typeof qe>"u"||t.type=="string")return r;var n=qe.utils.encode(1200,r,"str");return""+n}function uP(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Ve(e["!ref"]),s="",i=[],o,c=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=mt(o);for(var d=a.s.r;d<=a.e.r;++d)for(s=jt(d),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=u?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function r2(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?kt(n.origin):n.origin;i=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var f=Ve(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(i=f.e.r+1,d.e.r=i+t.length-1+a)}else i==-1&&(i=0,d.e.r=t.length-1+a);var h=n.header||[],g=0;t.forEach(function(x,m){At(x).forEach(function(v){(g=h.indexOf(v))==-1&&(h[g=h.length]=v);var _=x[v],y="z",b="",E=Pe({c:o+g,r:i+m+a});u=Ro(s,E),_&&typeof _=="object"&&!(_ instanceof Date)?s[E]=_:(typeof _=="number"?y="n":typeof _=="boolean"?y="b":typeof _=="string"?y="s":_ instanceof Date?(y="d",n.cellDates||(y="n",_=Gt(_)),b=n.dateNF||Fe[14]):_===null&&n.nullError&&(y="e",_=0),u?(u.t=y,u.v=_,delete u.w,delete u.R,b&&(u.z=b)):s[E]=u={t:y,v:_},b&&(u.z=b))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var p=jt(i);if(a)for(g=0;g<h.length;++g)s[mt(g+o)+p]={t:"s",v:h[g]};return s["!ref"]=Ie(d),s}function dP(e,t){return r2(null,e,t)}function Ro(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=kt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Ro(e,Pe(t)):Ro(e,Pe({r:t,c:r||0}))}function fP(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function gm(){return{SheetNames:[],Sheets:{}}}function vm(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(F_(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function hP(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=fP(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function mP(e,t){return e.z=t,e}function n2(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function xP(e,t,r){return n2(e,"#"+t,r)}function pP(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function gP(e,t,r,n){for(var a=typeof t!="string"?t:Ve(t),s=typeof t=="string"?t:Ie(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var c=Ro(e,i,o);c.t="n",c.F=s,delete c.v,i==a.s.r&&o==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Qe={encode_col:mt,encode_row:jt,encode_cell:Pe,encode_range:Ie,decode_col:Wh,decode_row:Hh,split_cell:I4,decode_cell:kt,decode_range:Cr,format_cell:Jn,sheet_add_aoa:by,sheet_add_json:r2,sheet_add_dom:H_,aoa_to_sheet:cl,json_to_sheet:dP,table_to_sheet:W_,table_to_book:T8,sheet_to_csv:pm,sheet_to_txt:t2,sheet_to_json:A0,sheet_to_html:$_,sheet_to_formulae:uP,sheet_to_row_object_array:A0,sheet_get_cell:Ro,book_new:gm,book_append_sheet:vm,book_set_sheet_visibility:hP,cell_set_number_format:mP,cell_set_hyperlink:n2,cell_set_internal_link:xP,cell_add_comment:pP,sheet_set_array_formula:gP,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},cu;function vP(e){cu=e}function yP(e,t){var r=cu(),n=t??{};if(e==null||e["!ref"]==null)return r.push(null),r;var a=Ve(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],g=n.skipHidden&&e["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(h[p]||{}).hidden||(f[p]=mt(p));var x=a.s.r,m=!1,v=0;return r._read=function(){if(!m)return m=!0,r.push("\uFEFF");for(;x<=a.e.r;)if(++x,!(g[x-1]||{}).hidden&&(d=e2(e,a,x-1,f,i,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),d||n.blankrows!==!1)))return r.push((v++?o:"")+d);return r.push(null)},r}function _P(e,t){var r=cu(),n=t||{},a=n.header!=null?n.header:B_,s=n.footer!=null?n.footer:U_;r.push(a);var i=Cr(e["!ref"]);n.dense=Array.isArray(e),r.push(z_(e,i,n));var o=i.s.r,c=!1;return r._read=function(){if(o>i.e.r)return c||(c=!0,r.push("</table>"+s)),r.push(null);for(;o<=i.e.r;){r.push(M_(e,i,o,n)),++o;break}},r}function wP(e,t){var r=cu({objectMode:!0});if(e==null||e["!ref"]==null)return r.push(null),r;var n={t:"n",v:0},a=0,s=1,i=[],o=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},f=d.range!=null?d.range:e["!ref"];switch(d.header===1?a=1:d.header==="A"?a=2:Array.isArray(d.header)&&(a=3),typeof f){case"string":u=Ve(f);break;case"number":u=Ve(e["!ref"]),u.s.r=f;break;default:u=f}a>0&&(s=0);var h=jt(u.s.r),g=[],p=0,x=Array.isArray(e),m=u.s.r,v=0,_={};x&&!e[m]&&(e[m]=[]);var y=d.skipHidden&&e["!cols"]||[],b=d.skipHidden&&e["!rows"]||[];for(v=u.s.c;v<=u.e.c;++v)if(!(y[v]||{}).hidden)switch(g[v]=mt(v),n=x?e[m][v]:e[g[v]+h],a){case 1:i[v]=v-u.s.c;break;case 2:i[v]=g[v];break;case 3:i[v]=d.header[v-u.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),c=o=Jn(n,null,d),p=_[o]||0,!p)_[o]=1;else{do c=o+"_"+p++;while(_[c]);_[o]=p,_[c]=1}i[v]=c}return m=u.s.r+s,r._read=function(){for(;m<=u.e.r;)if(!(b[m-1]||{}).hidden){var E=Z_(e,u,m,g,a,i,x,d);if(++m,E.isempty===!1||(a===1?d.blankrows!==!1:d.blankrows)){r.push(E.row);return}}return r.push(null)},r}var bP={to_json:wP,to_html:_P,to_csv:yP,set_readable:vP};const kP=bo.version,kf=Object.freeze(Object.defineProperty({__proto__:null,CFB:Ce,SSF:ry,parse_xlscfb:cm,parse_zip:q_,read:$s,readFile:eg,readFileSync:eg,set_cptable:TN,set_fs:r4,stream:bP,utils:Qe,version:kP,write:ou,writeFile:Hs,writeFileAsync:cP,writeFileSync:Hs,writeFileXLSX:oP,writeXLSX:mm},Symbol.toStringTag,{value:"Module"}));function SP(){var ea;const{profile:e,clientId:t}=Pr(),[r,n]=z.useState({totalPolicies:0,totalClaims:0,totalPremium:0,earnedPremium:0,totalClaimAmount:0}),[a,s]=z.useState([]),[i,o]=z.useState([]),[c,u]=z.useState(!0),[d,f]=z.useState("overview"),[h,g]=z.useState([]),[p,x]=z.useState([]),[m,v]=z.useState("plate"),[_,y]=z.useState("loss_ratio"),[b,E]=z.useState(null),[T,k]=z.useState(!1),[A,M]=z.useState(""),[B,G]=z.useState(""),[U,ne]=z.useState(""),[de,oe]=z.useState(""),[Y,se]=z.useState(""),[Z,H]=z.useState("desc"),[ae,K]=z.useState(""),[P,V]=z.useState(""),[D,R]=z.useState(""),[te,F]=z.useState(!1),[q,X]=z.useState(null),[L,J]=z.useState(""),[j,ke]=z.useState([]),[ue,ve]=z.useState(!1),[Te,he]=z.useState(!1),[Ue,Ke]=z.useState(""),[nt,pt]=z.useState(""),[Ft,Ge]=z.useState(""),[gt,ir]=z.useState(""),[it,zr]=z.useState("none"),[xe,ye]=z.useState(!1),[je,lt]=z.useState({show_policy_reminders:!0,show_premium_distribution:!0,show_policy_types:!0,show_claims_trend:!0,show_insurance_companies:!0});console.log("ClientDashboard - clientId:",t,"profile:",e),z.useEffect(()=>{t&&(console.log("Fetching data for clientId:",t),at(),vt())},[t]),z.useEffect(()=>{t&&d==="analysis"&&lr(),t&&d==="documents"&&br()},[t,d]);const vt=async()=>{try{const{data:w}=await ee.from("clients").select("agent_id").eq("id",t).maybeSingle();if(!(w!=null&&w.agent_id))return;const{data:N}=await ee.from("dashboard_visibility_settings").select("*").eq("agent_id",w.agent_id).maybeSingle();N&&lt({show_policy_reminders:N.show_policy_reminders,show_premium_distribution:N.show_premium_distribution,show_policy_types:N.show_policy_types,show_claims_trend:N.show_claims_trend,show_insurance_companies:N.show_insurance_companies})}catch(w){console.error("Error fetching visibility settings:",w)}},at=async()=>{try{u(!0);const[{data:w,count:N},{data:S,count:C}]=await Promise.all([ee.from("policies").select("*, insurance_companies(name)",{count:"exact"}).eq("client_id",t).is("archived_at",null).eq("is_deleted",!1).gte("end_date",new Date(Date.now()-365*24*60*60*1e3).toISOString().split("T")[0]).order("start_date",{ascending:!1}),ee.from("claims").select("*, insurance_companies(name)",{count:"exact"}).eq("client_id",t).order("claim_date",{ascending:!1})]),O=(w==null?void 0:w.reduce((W,Q)=>W+Number(Q.premium_amount),0))||0,I=(S==null?void 0:S.reduce((W,Q)=>W+Number(Q.payment_amount),0))||0,re=new Date,ie=(w==null?void 0:w.reduce((W,Q)=>{const le=new Date(Q.start_date),me=new Date(Q.end_date),_e=Math.max(1,Math.ceil((me.getTime()-le.getTime())/(1e3*60*60*24))),pe=Math.min(_e,Math.max(0,Math.ceil((re.getTime()-le.getTime())/(1e3*60*60*24))))/_e;return W+Number(Q.premium_amount)*pe},0))||0;n({totalPolicies:N||0,totalClaims:C||0,totalPremium:O,earnedPremium:ie,totalClaimAmount:I}),s(w||[]),o(S||[])}catch(w){console.error("Error fetching data:",w)}finally{u(!1)}},lr=async()=>{try{const[{data:w},{data:N}]=await Promise.all([ee.from("policies").select("plate_number, premium_amount, start_date, end_date, policy_type").eq("client_id",t).not("plate_number","is",null),ee.from("claims").select("license_plate, payment_amount, claim_date, policy_type").eq("client_id",t).not("license_plate","is",null)]),S={},C=new Date;w==null||w.forEach(ie=>{var Se;const W=(Se=ie.plate_number)==null?void 0:Se.replace(/\s+/g,"").toUpperCase();if(!W)return;S[W]||(S[W]={name:ie.plate_number,normalized_plate:W,total_premium:0,earned_premium:0,total_claims:0,loss_ratio:0,policy_count:0,claim_count:0});const Q=new Date(ie.start_date),me=(new Date(ie.end_date).getTime()-Q.getTime())/(1e3*60*60*24),_e=Math.min((C.getTime()-Q.getTime())/(1e3*60*60*24),me),Ne=me>0?Math.max(0,Math.min(_e/me,1)):0,pe=Number(ie.premium_amount)*Ne;S[W].total_premium+=Number(ie.premium_amount)||0,S[W].earned_premium+=pe,S[W].policy_count+=1}),N==null||N.forEach(ie=>{var Q;const W=(Q=ie.license_plate)==null?void 0:Q.replace(/\s+/g,"").toUpperCase();W&&(S[W]||(S[W]={name:W,total_premium:0,earned_premium:0,total_claims:0,loss_ratio:0,policy_count:0,claim_count:0}),S[W].total_claims+=Number(ie.payment_amount)||0,S[W].claim_count+=1)});const O=Object.values(S).map(ie=>({...ie,loss_ratio:ie.earned_premium>0?ie.total_claims/ie.earned_premium*100:0}));g(O);const I={};w==null||w.forEach(ie=>{const W=ie.policy_type||"Bilinmeyen";I[W]||(I[W]={name:W,total_premium:0,earned_premium:0,total_claims:0,loss_ratio:0,policy_count:0,claim_count:0});const Q=new Date(ie.start_date),me=(new Date(ie.end_date).getTime()-Q.getTime())/(1e3*60*60*24),_e=Math.min((C.getTime()-Q.getTime())/(1e3*60*60*24),me),Ne=me>0?Math.max(0,Math.min(_e/me,1)):0,pe=Number(ie.premium_amount)*Ne;I[W].total_premium+=Number(ie.premium_amount)||0,I[W].earned_premium+=pe,I[W].policy_count+=1}),N==null||N.forEach(ie=>{const W=ie.policy_type||"Bilinmeyen";I[W]||(I[W]={name:W,total_premium:0,earned_premium:0,total_claims:0,loss_ratio:0,policy_count:0,claim_count:0}),I[W].total_claims+=Number(ie.payment_amount)||0,I[W].claim_count+=1});const re=Object.values(I).map(ie=>({...ie,loss_ratio:ie.earned_premium>0?ie.total_claims/ie.earned_premium*100:0}));x(re)}catch(w){console.error("Error fetching analysis data:",w)}},br=async()=>{try{const{data:w,error:N}=await ee.from("client_documents").select("*").eq("client_id",t).order("created_at",{ascending:!1});if(N)throw N;ke(w||[])}catch(w){console.error("Error fetching documents:",w)}},Ln=async w=>{var S,C,O,I;const N=(S=w.target.files)==null?void 0:S[0];if(N)try{he(!0);const{data:re}=await ee.auth.getUser(),ie=N.name.split(".").pop(),W=`${t}/${Date.now()}.${ie}`,{error:Q}=await ee.storage.from("client-documents").upload(W,N);if(Q)throw Q;const le=((C=document.getElementById("document_type"))==null?void 0:C.value)||"diger",me=((O=document.getElementById("document_description"))==null?void 0:O.value)||"",{error:_e}=await ee.from("client_documents").insert({client_id:t,agent_id:e==null?void 0:e.id,uploaded_by:(I=re.user)==null?void 0:I.id,document_type:le,document_name:N.name,file_path:W,file_size:N.size,mime_type:N.type,description:me||null});if(_e)throw _e;alert(" Dosya baaryla yklendi!"),ve(!1),br()}catch(re){console.error("Error uploading file:",re),alert(" Dosya yklenirken hata olutu: "+re.message)}finally{he(!1)}},nn=()=>{let w=[...a];if(A){const N=A.toLowerCase();w=w.filter(S=>{var C,O,I;return S.policy_number.toLowerCase().includes(N)||((C=S.plate_number)==null?void 0:C.toLowerCase().includes(N))||((I=(O=S.insurance_companies)==null?void 0:O.name)==null?void 0:I.toLowerCase().includes(N))})}return de&&(w=w.filter(N=>N.policy_type===de)),Y&&(w=w.filter(N=>{var S;return((S=N.insurance_companies)==null?void 0:S.name)===Y})),B&&(w=w.filter(N=>new Date(N.start_date)>=new Date(B))),U&&(w=w.filter(N=>new Date(N.end_date)<=new Date(U))),w.sort((N,S)=>{const C=Number(N.premium_amount),O=Number(S.premium_amount);return Z==="desc"?O-C:C-O}),w},cs=Array.from(new Set(a.map(w=>w.policy_type))),ei=Array.from(new Set(a.map(w=>{var N;return(N=w.insurance_companies)==null?void 0:N.name}).filter(Boolean))),kn=nn(),ti=()=>{H(Z==="desc"?"asc":"desc")},Me=()=>{M(""),G(""),ne(""),oe(""),se(""),H("desc")},Be=A||B||U||de||Y,kr=()=>{let w=[...i];if(ae){const N=ae.toLowerCase();w=w.filter(S=>S.claim_number&&S.claim_number.toLowerCase().includes(N)||S.license_plate&&S.license_plate.toLowerCase().includes(N))}if(Ue&&(w=w.filter(N=>N.claim_type===Ue)),nt&&(w=w.filter(N=>N.status===nt)),Ft&&(w=w.filter(N=>N.policy_type===Ft)),gt&&(w=w.filter(N=>{var S;return((S=N.insurance_companies)==null?void 0:S.name)===gt})),P&&(w=w.filter(N=>new Date(N.claim_date)>=new Date(P))),D&&(w=w.filter(N=>new Date(N.claim_date)<=new Date(D))),it==="plate"){const N=w.reduce((S,C)=>(C.license_plate&&(S[C.license_plate]=(S[C.license_plate]||0)+1),S),{});w.sort((S,C)=>{const O=S.license_plate&&N[S.license_plate]||0;return(C.license_plate&&N[C.license_plate]||0)-O})}else if(it==="claim_type"){const N=w.reduce((S,C)=>(C.claim_type&&(S[C.claim_type]=(S[C.claim_type]||0)+1),S),{});w.sort((S,C)=>{const O=S.claim_type&&N[S.claim_type]||0;return(C.claim_type&&N[C.claim_type]||0)-O})}return w},ri=Array.from(new Set(i.map(w=>w.claim_type).filter(Boolean))),ni=Array.from(new Set(i.map(w=>w.status))),ai=Array.from(new Set(i.map(w=>w.policy_type))),wa=Array.from(new Set(i.map(w=>{var N;return(N=w.insurance_companies)==null?void 0:N.name}).filter(Boolean))),Mn=kr(),dl=()=>{K(""),V(""),R(""),Ke(""),pt(""),Ge(""),ir(""),zr("none")},fl=ae||P||D||Ue||nt||Ft||gt||it!=="none",an=()=>{const N=[...m==="plate"?h:p];return _==="claim_count"?N.sort((S,C)=>C.claim_count-S.claim_count):_==="total_claims"?N.sort((S,C)=>C.total_claims-S.total_claims):N.sort((S,C)=>C.loss_ratio-S.loss_ratio),N},us=w=>{const S={open:{label:"Ak",color:"bg-blue-100 text-blue-800"},closed:{label:"dendi",color:"bg-green-100 text-green-800"},rejected:{label:"Red Oldu",color:"bg-red-100 text-red-800"}}[w]||{label:w,color:"bg-gray-100 text-gray-800"};return l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${S.color}`,children:S.label})};if(c)return l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const Pt=()=>{const w=Qe.book_new(),N=a.map(W=>{var Q;return{"Polie No":W.policy_number,"Polie Tr":W.policy_type,"Sigorta irketi":((Q=W.insurance_companies)==null?void 0:Q.name)||"-",Sigortal:W.insured_name||"-",Plaka:W.plate_number||"-",Balang:new Date(W.start_date).toLocaleDateString("tr-TR"),Biti:new Date(W.end_date).toLocaleDateString("tr-TR"),Prim:Number(W.premium_amount).toLocaleString("tr-TR",{style:"currency",currency:"TRY"}),Durum:W.status==="active"?"Aktif":W.status==="expired"?"Sresi Dolmu":"ptal"}}),S=i.map(W=>({"Hasar No":W.claim_number,"Hasar Tarihi":new Date(W.claim_date).toLocaleDateString("tr-TR"),Plaka:W.plate_number||"-","Polie Tr":W.policy_type||"-",Aklama:W.description,"deme Tutar":Number(W.payment_amount).toLocaleString("tr-TR",{style:"currency",currency:"TRY"}),Durum:W.status||"Beklemede"})),C=[{zet:"Toplam Polie Says",Deer:a.length},{zet:"Aktif Polieler",Deer:a.filter(W=>W.status==="active").length},{zet:"Toplam Hasar Says",Deer:i.length},{zet:"Toplam Prim",Deer:a.reduce((W,Q)=>W+Number(Q.premium_amount),0).toLocaleString("tr-TR",{style:"currency",currency:"TRY"})},{zet:"Toplam Hasar demesi",Deer:i.reduce((W,Q)=>W+Number(Q.payment_amount),0).toLocaleString("tr-TR",{style:"currency",currency:"TRY"})}],O=Qe.json_to_sheet(C),I=Qe.json_to_sheet(N),re=Qe.json_to_sheet(S);Qe.book_append_sheet(w,O,"zet"),Qe.book_append_sheet(w,I,"Polielerim"),Qe.book_append_sheet(w,re,"Hasarlarm");const ie=`Sigorta_Raporum_${new Date().toLocaleDateString("tr-TR").replace(/\./g,"-")}.xlsx`;Hs(w,ie)};return l.jsxs("div",{children:[l.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Mteri Paneli"}),l.jsxs("p",{className:"text-gray-600 mt-2",children:["Ho geldiniz, ",e==null?void 0:e.full_name]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:Pt,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[l.jsx(Qr,{className:"w-5 h-5"}),"Rapor ndir"]}),l.jsxs("button",{onClick:()=>ye(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[l.jsx(Ja,{className:"w-5 h-5"}),"Destek Talebi"]})]})]}),l.jsxs("div",{className:"flex gap-2 mb-6 border-b border-gray-200",children:[l.jsx("button",{onClick:()=>f("overview"),className:`px-4 py-2 font-medium transition ${d==="overview"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Genel Bak"}),l.jsx("button",{onClick:()=>f("policies"),className:`px-4 py-2 font-medium transition ${d==="policies"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Polielerim"}),l.jsx("button",{onClick:()=>f("claims"),className:`px-4 py-2 font-medium transition ${d==="claims"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Hasarlarm"}),l.jsx("button",{onClick:()=>f("analysis"),className:`px-4 py-2 font-medium transition ${d==="analysis"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Hasar Analizi"}),l.jsx("button",{onClick:()=>f("documents"),className:`px-4 py-2 font-medium transition ${d==="documents"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Dosyalarm"}),l.jsx("button",{onClick:()=>f("contact"),className:`px-4 py-2 font-medium transition ${d==="contact"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"letiim"})]}),d==="overview"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("div",{className:"flex items-center justify-between mb-4",children:l.jsx("div",{className:"bg-blue-500 rounded-lg p-3",children:l.jsx(gn,{className:"w-6 h-6 text-white"})})}),l.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-1",children:"Toplam Polie"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.totalPolicies})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("div",{className:"flex items-center justify-between mb-4",children:l.jsx("div",{className:"bg-red-500 rounded-lg p-3",children:l.jsx(Rt,{className:"w-6 h-6 text-white"})})}),l.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-1",children:"Toplam Hasar"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.totalClaims})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("div",{className:"flex items-center justify-between mb-4",children:l.jsx("div",{className:"bg-green-500 rounded-lg p-3",children:l.jsx(Ka,{className:"w-6 h-6 text-white"})})}),l.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-1",children:"Toplam Prim"}),l.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["",r.totalPremium.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("div",{className:"flex items-center justify-between mb-4",children:l.jsx("div",{className:"bg-orange-500 rounded-lg p-3",children:l.jsx(Ka,{className:"w-6 h-6 text-white"})})}),l.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-1",children:"Toplam Hasar Tutar"}),l.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["",r.totalClaimAmount.toLocaleString("tr-TR",{minimumFractionDigits:2})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("div",{className:"flex items-center justify-between mb-4",children:l.jsx("div",{className:`${r.earnedPremium>0?r.totalClaimAmount/r.earnedPremium*100<50?"bg-teal-500":r.totalClaimAmount/r.earnedPremium*100<75?"bg-yellow-500":"bg-red-500":"bg-gray-400"} rounded-lg p-3`,children:l.jsx($v,{className:"w-6 h-6 text-white"})})}),l.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-1",children:"Hasar/Prim Frekans"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.earnedPremium>0?`%${(r.totalClaimAmount/r.earnedPremium*100).toFixed(1)}`:"-%"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:r.earnedPremium>0?r.totalClaimAmount/r.earnedPremium*100<50?"ok iyi":r.totalClaimAmount/r.earnedPremium*100<75?"yi":"Yksek":""})]})]}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:l.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Son Polieler"}),l.jsxs("div",{className:"space-y-3",children:[a.slice(0,5).map(w=>{var N;return l.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:w.policy_number}),l.jsx("p",{className:"text-sm text-gray-600",children:((N=w.insurance_companies)==null?void 0:N.name)||"Bilinmiyor"})]}),l.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["",Number(w.premium_amount).toLocaleString("tr-TR")]})]},w.id)}),a.length===0&&l.jsx("p",{className:"text-gray-500 text-center py-4",children:"Henz polie bulunmuyor"})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Son Hasarlar"}),l.jsxs("div",{className:"space-y-3",children:[i.slice(0,5).map(w=>{var N;return l.jsxs("div",{className:"flex justify-between items-center py-2 border-b",children:[l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:w.claim_number}),l.jsx("p",{className:"text-sm text-gray-600",children:((N=w.insurance_companies)==null?void 0:N.name)||"Bilinmiyor"})]}),l.jsx("div",{className:"text-right",children:us(w.status)})]},w.id)}),i.length===0&&l.jsx("p",{className:"text-gray-500 text-center py-4",children:"Henz hasar bulunmuyor"})]})]})]}),l.jsx(_N,{}),je.show_policy_reminders&&l.jsx(wN,{})]})}),l.jsx(kN,{policies:a,claims:i,visibilitySettings:je})]}),d==="policies"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx(Qi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),l.jsx("input",{type:"text",placeholder:"Polie No, Plaka Ara...",value:A,onChange:w=>M(w.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsx("div",{children:l.jsx("input",{type:"date",placeholder:"Balang Tarihi",value:B,onChange:w=>G(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{children:l.jsx("input",{type:"date",placeholder:"Biti Tarihi",value:U,onChange:w=>ne(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{children:l.jsxs("select",{value:de,onChange:w=>oe(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Tm Polie Trleri"}),cs.map(w=>l.jsx("option",{value:w,children:w},w))]})}),l.jsx("div",{children:l.jsxs("select",{value:Y,onChange:w=>se(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Tm irketler"}),ei.map(w=>l.jsx("option",{value:w,children:w},w))]})})]}),l.jsxs("div",{className:"flex justify-between items-center mt-4",children:[l.jsx("div",{className:"flex items-center gap-2",children:l.jsxs("button",{onClick:ti,className:"flex items-center gap-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:[l.jsx(ZS,{className:"w-4 h-4"}),"Prim: ",Z==="desc"?"Yksekten De":"Dkten Yksee"]})}),Be&&l.jsx("button",{onClick:Me,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-900 underline",children:"Filtreleri Temizle"})]}),l.jsxs("div",{className:"mt-4 text-sm text-gray-600",children:[kn.length," polie gsteriliyor"]})]}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:l.jsxs("div",{className:"overflow-x-auto",children:[l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Polie No"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Sigorta irketi"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Polie Tr"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Detay"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Balang"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Biti"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Prim"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"PDF"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"lemler"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:kn.map(w=>{var N;return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:w.policy_number}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:((N=w.insurance_companies)==null?void 0:N.name)||"Bilinmiyor"}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:w.policy_type}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:(w.policy_type==="trafik"||w.policy_type==="kasko")&&w.plate_number?w.plate_number:w.policy_type==="isyeri"||w.policy_type==="konut"||w.policy_type==="dask"?[w.address,w.location].filter(Boolean).join(" ")||"-":w.policy_type==="saglik"&&w.insured_name?w.insured_name:"-"}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:new Date(w.start_date).toLocaleDateString("tr-TR")}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:new Date(w.end_date).toLocaleDateString("tr-TR")}),l.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:["",Number(w.premium_amount).toLocaleString("tr-TR")]}),l.jsx("td",{className:"px-6 py-4 text-sm",children:w.pdf_data&&l.jsx("button",{onClick:()=>E(w.pdf_data),className:"text-blue-600 hover:text-blue-800",children:l.jsx(Pa,{className:"w-4 h-4"})})}),l.jsx("td",{className:"px-6 py-4 text-sm",children:l.jsxs("button",{onClick:()=>{X(w),F(!0)},className:"flex items-center gap-1 px-3 py-1 bg-green-600 text-white rounded-lg hover:bg-green-700 transition text-xs",children:[l.jsx(Ji,{className:"w-3 h-3"}),"Yenile"]})})]},w.id)})})]}),kn.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(gn,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Henz polie bulunmuyor"})]})]})})]}),d==="claims"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx(Qi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),l.jsx("input",{type:"text",placeholder:"Hasar No, Plaka Ara...",value:ae,onChange:w=>K(w.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsx("div",{children:l.jsx("input",{type:"date",placeholder:"Balang Tarihi",value:P,onChange:w=>V(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{children:l.jsx("input",{type:"date",placeholder:"Biti Tarihi",value:D,onChange:w=>R(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{children:l.jsxs("select",{value:Ue,onChange:w=>Ke(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Tm Hasar Nedenleri"}),ri.map(w=>l.jsx("option",{value:w,children:w},w))]})}),l.jsx("div",{children:l.jsxs("select",{value:nt,onChange:w=>pt(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Tm Durumlar"}),ni.map(w=>l.jsx("option",{value:w,children:w==="open"?"Ak":w==="closed"?"dendi":w==="rejected"?"Red":w},w))]})}),l.jsx("div",{children:l.jsxs("select",{value:Ft,onChange:w=>Ge(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Tm Polie Trleri"}),ai.map(w=>l.jsx("option",{value:w,children:w},w))]})}),l.jsx("div",{children:l.jsxs("select",{value:gt,onChange:w=>ir(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Tm irketler"}),wa.map(w=>l.jsx("option",{value:w,children:w},w))]})}),l.jsx("div",{children:l.jsxs("select",{value:it,onChange:w=>zr(w.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"none",children:"Sralama Sein"}),l.jsx("option",{value:"plate",children:"En Fazla Hasar Yapan Ara"}),l.jsx("option",{value:"claim_type",children:"En Fazla Hasar Nedeni"})]})})]}),l.jsxs("div",{className:"flex justify-between items-center mt-4",children:[l.jsxs("div",{className:"text-sm text-gray-600",children:[Mn.length," hasar gsteriliyor"]}),fl&&l.jsx("button",{onClick:dl,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-900 underline",children:"Filtreleri Temizle"})]})]}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:l.jsxs("div",{className:"overflow-x-auto",children:[l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hasar No"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Sigorta irketi"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Polie Tr"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hasar Nedeni"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Plaka"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Olay Tarihi"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hasar Tutar"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Durum"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:Mn.map(w=>{var N;return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:w.claim_number}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:((N=w.insurance_companies)==null?void 0:N.name)||"Bilinmiyor"}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:w.policy_type}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:w.claim_type||"-"}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:w.license_plate||"-"}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:new Date(w.claim_date).toLocaleDateString("tr-TR")}),l.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:["",Number(w.payment_amount).toLocaleString("tr-TR")]}),l.jsx("td",{className:"px-6 py-4 text-sm",children:us(w.status)})]},w.id)})})]}),Mn.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Rt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Henz hasar bulunmuyor"})]})]})})]}),d==="analysis"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Hasar Skl Analizi"}),l.jsx("p",{className:"text-sm text-gray-600",children:"En ok hasar yapan plakalar ve detayl bilgiler"})]}),l.jsxs("button",{onClick:()=>k(!0),className:"flex items-center gap-2 px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition",children:[l.jsx(Ci,{className:"w-5 h-5"}),"En ok Hasar Yapan Plakalar"]})]})}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Hasar/Prim Frekans Analizi"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>v("plate"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${m==="plate"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Plakaya Gre"}),l.jsx("button",{onClick:()=>v("policy_type"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${m==="policy_type"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Polie Trne Gre"})]})]}),l.jsxs("div",{className:"mt-4 mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sralama"}),l.jsxs("select",{value:_,onChange:w=>y(w.target.value),className:"w-64 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"loss_ratio",children:"Hasar/Prim Oranna Gre (Yksekten De)"}),l.jsx("option",{value:"claim_count",children:"Alan Dosya Saysna Gre (oktan Aza)"}),l.jsx("option",{value:"total_claims",children:"Toplam Hasara Gre (Yksekten De)"})]})]}),l.jsxs("div",{className:"overflow-x-auto",children:[l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-gray-200",children:[l.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900",children:m==="plate"?"Plaka":"Polie Tr"}),l.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-900",children:"Polie Says"}),l.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-900",children:"Kazanlm Prim"}),l.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-900",children:"Alan Dosya Says"}),l.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-900",children:"Toplam Hasar"}),l.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-900",children:"Hasar/Prim Frekans"})]})}),l.jsx("tbody",{children:an().map(w=>l.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[l.jsx("td",{className:"py-4 px-4 font-medium text-gray-900",children:w.name}),l.jsx("td",{className:"py-4 px-4 text-right text-gray-700",children:w.policy_count}),l.jsxs("td",{className:"py-4 px-4 text-right font-medium text-green-600",children:["",w.earned_premium.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),l.jsx("td",{className:"py-4 px-4 text-right text-gray-700",children:w.claim_count}),l.jsxs("td",{className:"py-4 px-4 text-right font-medium text-red-600",children:["",w.total_claims.toLocaleString("tr-TR",{minimumFractionDigits:2})]}),l.jsx("td",{className:"py-4 px-4 text-right",children:l.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold ${w.loss_ratio<50?"bg-green-100 text-green-700":w.loss_ratio<75?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:["%",w.loss_ratio.toFixed(2)]})})]},w.name))})]}),an().length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Ci,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Analiz iin yeterli veri bulunmuyor"})]})]})]})]}),d==="documents"&&l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Dosyalarm"}),l.jsxs("button",{onClick:()=>ve(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[l.jsx(Yn,{className:"w-4 h-4"}),"Dosya Ykle"]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[j.map(w=>l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200 hover:border-blue-300 transition",children:[l.jsx("div",{className:"flex items-start justify-between mb-3",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ja,{className:"w-8 h-8 text-blue-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900 text-sm",children:w.document_name}),l.jsxs("p",{className:"text-xs text-gray-500",children:[(w.file_size/1024).toFixed(1)," KB"]})]})]})}),l.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:["Tr: ",l.jsx("span",{className:"font-medium",children:w.document_type})]}),w.description&&l.jsx("p",{className:"text-xs text-gray-600 mb-2",children:w.description}),l.jsx("p",{className:"text-xs text-gray-400",children:new Date(w.created_at).toLocaleDateString("tr-TR")}),l.jsx("div",{className:"mt-3 flex gap-2",children:l.jsx("button",{onClick:async()=>{const{data:N}=await ee.storage.from("client-documents").createSignedUrl(w.file_path,3600);N&&window.open(N.signedUrl,"_blank")},className:"flex-1 text-xs px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Grntle"})})]},w.id)),j.length===0&&l.jsxs("div",{className:"col-span-full text-center py-12",children:[l.jsx(ja,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"Henz dosya yklenmemi"}),l.jsxs("button",{onClick:()=>ve(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[l.jsx(Yn,{className:"w-4 h-4"}),"lk Dosyay Ykle"]})]})]})]})}),d==="contact"&&l.jsx("div",{className:"max-w-4xl mx-auto",children:l.jsx(yN,{clientId:t})}),b&&l.jsx(gN,{pdfUrl:b,onClose:()=>E(null)}),l.jsx(vN,{isOpen:T,onClose:()=>k(!1)}),l.jsx(bN,{isOpen:xe,onClose:()=>ye(!1)}),te&&q&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:l.jsxs("div",{className:"p-6",children:[l.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Polie Yenileme Talebi"}),l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:[l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Polie No"}),l.jsx("p",{className:"font-semibold text-gray-900",children:q.policy_number}),l.jsx("p",{className:"text-sm text-gray-600 mt-2 mb-1",children:"Polie Tr"}),l.jsx("p",{className:"font-semibold text-gray-900",children:q.policy_type}),l.jsx("p",{className:"text-sm text-gray-600 mt-2 mb-1",children:"Sigorta irketi"}),l.jsx("p",{className:"font-semibold text-gray-900",children:((ea=q.insurance_companies)==null?void 0:ea.name)||"-"}),l.jsx("p",{className:"text-sm text-gray-600 mt-2 mb-1",children:"Biti Tarihi"}),l.jsx("p",{className:"font-semibold text-gray-900",children:new Date(q.end_date).toLocaleDateString("tr-TR")})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notlarnz (Opsiyonel)"}),l.jsx("textarea",{value:L,onChange:w=>J(w.target.value),placeholder:"Yenileme ile ilgili zel talepleriniz varsa buraya yazabilirsiniz...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:4})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:()=>{F(!1),J(""),X(null)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"ptal"}),l.jsx("button",{onClick:async()=>{var w;try{const{data:N}=await ee.auth.getUser(),{data:S}=await ee.from("clients").select("id").eq("user_id",(w=N.user)==null?void 0:w.id).single();if(!S){alert("Mteri bilgisi bulunamad");return}const{error:C}=await ee.from("policy_renewal_requests").insert({policy_id:q.id,client_id:S.id,agent_id:e==null?void 0:e.id,request_notes:L||null});if(C)throw C;alert(" Yenileme talebiniz baaryla gnderildi. En ksa srede size dn yaplacaktr."),F(!1),J(""),X(null)}catch(N){console.error("Error creating renewal request:",N),alert(" Talep gnderilirken hata olutu: "+N.message)}},className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:"Yenileme Talebi Gnder"})]})]})})}),ue&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Dosya Ykle"}),l.jsx("button",{onClick:()=>ve(!1),className:"text-gray-400 hover:text-gray-600",children:l.jsx(Kt,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dosya Tr"}),l.jsxs("select",{id:"document_type",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"ruhsat",children:"Ruhsat"}),l.jsx("option",{value:"ehliyet",children:"Ehliyet"}),l.jsx("option",{value:"hasar_fotografi",children:"Hasar Fotoraf"}),l.jsx("option",{value:"fatura",children:"Fatura"}),l.jsx("option",{value:"sozlesme",children:"Szleme"}),l.jsx("option",{value:"diger",children:"Dier"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Aklama (Opsiyonel)"}),l.jsx("textarea",{id:"document_description",placeholder:"Bu dosya hakknda ksa bir aklama...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dosya Se"}),l.jsx("input",{type:"file",onChange:Ln,disabled:Te,accept:"image/*,.pdf,.doc,.docx",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Maksimum dosya boyutu: 10MB"})]}),Te&&l.jsxs("div",{className:"flex items-center justify-center py-4",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),l.jsx("span",{className:"ml-3 text-sm text-gray-600",children:"Ykleniyor..."})]})]})]})})})]})}function NP({onClose:e,onSuccess:t}){const[r,n]=z.useState(!1),[a,s]=z.useState([]),[i,o]=z.useState([]),[c,u]=z.useState({policy_number:"",policy_type:"kasko",client_id:"",insurance_company_id:"",start_date:"",end_date:"",premium_amount:"",license_plate:"",vehicle_value:"",chassis_value:"",accessories_value:"",other_values:"",no_claims_discount:"",address:"",building_value:"",fixtures_value:"",electronics_value:"",inventory_value:"",workplace_other_values:"",vehicle_brand_model:"",trafik_coverage_amount:"",plate_number:"",location:""}),[d,f]=z.useState(null);z.useEffect(()=>{h(),g()},[]);const h=async()=>{const{data:m}=await ee.auth.getUser();if(!m.user)return;const{data:v,error:_}=await ee.from("clients").select("*").eq("agent_id",m.user.id).order("name");_?console.error("Error fetching clients:",_):s(v||[])},g=async()=>{const{data:m}=await ee.from("insurance_companies").select("*").order("name");o(m||[])},p=m=>{var _;const v=(_=m.target.files)==null?void 0:_[0];v&&f(v)},x=async m=>{if(m.preventDefault(),!c.client_id||!c.insurance_company_id){alert("Ltfen mteri ve sigorta irketi sein");return}n(!0);try{let v="";if(d){const E=new FileReader;v=await new Promise((T,k)=>{E.onload=()=>T(E.result),E.onerror=k,E.readAsDataURL(d)})}const{data:_}=await ee.auth.getUser();if(!_.user)throw new Error("Kullanc bulunamad");const y={policy_number:c.policy_number,policy_type:c.policy_type,client_id:c.client_id,insurance_company_id:c.insurance_company_id,start_date:c.start_date,end_date:c.end_date,premium_amount:parseFloat(c.premium_amount)||0,pdf_data:v,pdf_filename:(d==null?void 0:d.name)||"",agent_id:_.user.id,plate_number:c.plate_number?c.plate_number.toUpperCase():null,location:c.location?c.location.toLowerCase():null};c.policy_type==="kasko"?(y.license_plate=c.license_plate,y.vehicle_value=parseFloat(c.vehicle_value)||0,y.chassis_value=parseFloat(c.chassis_value)||0,y.accessories_value=parseFloat(c.accessories_value)||0,y.other_values=parseFloat(c.other_values)||0,y.no_claims_discount=parseInt(c.no_claims_discount)||0):c.policy_type==="trafik"?(y.license_plate=c.license_plate,y.vehicle_brand_model=c.vehicle_brand_model,y.trafik_coverage_amount=parseFloat(c.trafik_coverage_amount)||0):(y.address=c.address,y.building_value=parseFloat(c.building_value)||0,y.fixtures_value=parseFloat(c.fixtures_value)||0,y.electronics_value=parseFloat(c.electronics_value)||0,y.inventory_value=parseFloat(c.inventory_value)||0,y.workplace_other_values=parseFloat(c.workplace_other_values)||0);const{error:b}=await ee.from("policies").insert([y]);if(b)throw b;t()}catch(v){console.error("Error uploading policy:",v),alert("Polie yklenirken hata olutu: "+v.message)}finally{n(!1)}};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-y-auto m-4",children:[l.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Yeni Polie Ekle"}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(Kt,{className:"w-6 h-6"})})]}),l.jsxs("form",{onSubmit:x,className:"p-6 space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mteri *"}),l.jsxs("select",{required:!0,value:c.client_id,onChange:m=>u({...c,client_id:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"Mteri Sein"}),a.map(m=>l.jsx("option",{value:m.id,children:m.name},m.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sigorta irketi *"}),l.jsxs("select",{required:!0,value:c.insurance_company_id,onChange:m=>u({...c,insurance_company_id:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"irket Sein"}),i.map(m=>l.jsx("option",{value:m.id,children:m.name},m.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Polie Numaras *"}),l.jsx("input",{type:"text",required:!0,value:c.policy_number,onChange:m=>u({...c,policy_number:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Polie Tipi *"}),l.jsxs("select",{required:!0,value:c.policy_type,onChange:m=>u({...c,policy_type:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"kasko",children:"Kasko"}),l.jsx("option",{value:"trafik",children:"Trafik"}),l.jsx("option",{value:"workplace",children:"yeri"}),l.jsx("option",{value:"residence",children:"Konut"}),l.jsx("option",{value:"health",children:"Salk"}),l.jsx("option",{value:"dask",children:"Dask"}),l.jsx("option",{value:"group_health",children:"Grup Salk"}),l.jsx("option",{value:"group_accident",children:"Grup Ferdi Kaza"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Balang Tarihi *"}),l.jsx("input",{type:"date",required:!0,value:c.start_date,onChange:m=>u({...c,start_date:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Biti Tarihi *"}),l.jsx("input",{type:"date",required:!0,value:c.end_date,onChange:m=>u({...c,end_date:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prim Tutar () *"}),l.jsx("input",{type:"number",step:"0.01",required:!0,value:c.premium_amount,onChange:m=>u({...c,premium_amount:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"PDF Dosyas"}),l.jsx("input",{type:"file",accept:".pdf",onChange:p,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"PDF yalnzca saklanacaktr, bilgileri manuel olarak giriniz"})]})]}),c.policy_type==="kasko"&&l.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Kasko Bilgileri"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plaka"}),l.jsx("input",{type:"text",value:c.license_plate,onChange:m=>u({...c,license_plate:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ara Bedeli ()"}),l.jsx("input",{type:"number",step:"0.01",value:c.vehicle_value,onChange:m=>u({...c,vehicle_value:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Kasa Bedeli ()"}),l.jsx("input",{type:"number",step:"0.01",value:c.chassis_value,onChange:m=>u({...c,chassis_value:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Aksesuar Bedeli ()"}),l.jsx("input",{type:"number",step:"0.01",value:c.accessories_value,onChange:m=>u({...c,accessories_value:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dier Bedeller ()"}),l.jsx("input",{type:"number",step:"0.01",value:c.other_values,onChange:m=>u({...c,other_values:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hasarszlk Kademesi"}),l.jsx("input",{type:"number",value:c.no_claims_discount,onChange:m=>u({...c,no_claims_discount:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]}),c.policy_type==="trafik"&&l.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"Trafik Bilgileri"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plaka (PDF Eletirme in) *"}),l.jsx("input",{type:"text",required:!0,placeholder:"16AN425",value:c.plate_number,onChange:m=>u({...c,plate_number:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Marka Model"}),l.jsx("input",{type:"text",value:c.vehicle_brand_model,onChange:m=>u({...c,vehicle_brand_model:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Teminat Tutar ()"}),l.jsx("input",{type:"number",step:"0.01",value:c.trafik_coverage_amount,onChange:m=>u({...c,trafik_coverage_amount:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]}),c.policy_type==="workplace"&&l.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-4",children:"yeri Bilgileri"}),l.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lokasyon (PDF Eletirme in) *"}),l.jsx("input",{type:"text",required:!0,placeholder:"bursa",value:c.location,onChange:m=>u({...c,location:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adres"}),l.jsx("textarea",{value:c.address,onChange:m=>u({...c,address:m.target.value}),rows:2,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bina Bedeli ()"}),l.jsx("input",{type:"number",step:"0.01",value:c.building_value,onChange:m=>u({...c,building_value:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Demirba Bedeli ()"}),l.jsx("input",{type:"number",step:"0.01",value:c.fixtures_value,onChange:m=>u({...c,fixtures_value:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Elektronik Cihaz Bedeli ()"}),l.jsx("input",{type:"number",step:"0.01",value:c.electronics_value,onChange:m=>u({...c,electronics_value:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Emtea Bedeli ()"}),l.jsx("input",{type:"number",step:"0.01",value:c.inventory_value,onChange:m=>u({...c,inventory_value:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dier Bedeller ()"}),l.jsx("input",{type:"number",step:"0.01",value:c.workplace_other_values,onChange:m=>u({...c,workplace_other_values:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]})]}),l.jsxs("div",{className:"flex items-center justify-end gap-4 pt-4 border-t border-gray-200",children:[l.jsx("button",{type:"button",onClick:e,className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"ptal"}),l.jsx("button",{type:"submit",disabled:r,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:r?l.jsxs(l.Fragment,{children:[l.jsx(Nh,{className:"w-5 h-5 animate-spin"}),"Ykleniyor..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Yn,{className:"w-5 h-5"}),"Kaydet"]})})]})]})]})})}function a2({onClose:e,onSuccess:t}){const[r,n]=z.useState(!1),[a,s]=z.useState({name:"",tc_number:"",tax_number:"",phone:"",email:"",address:""}),i=async o=>{if(o.preventDefault(),!a.name||!a.tc_number&&!a.tax_number){alert("Ltfen isim ve TC Kimlik No veya Vergi No doldurun");return}n(!0);try{const{data:c}=await ee.auth.getUser();if(!c.user)throw new Error("Kullanc oturumu bulunamad");if(a.tc_number){const{data:d}=await ee.from("clients").select("id").eq("tc_number",a.tc_number).eq("agent_id",c.user.id).maybeSingle();if(d){alert("Bu TC Kimlik No ile kaytl mteri zaten var!"),n(!1);return}}if(a.tax_number){const{data:d}=await ee.from("clients").select("id").eq("tax_number",a.tax_number).eq("agent_id",c.user.id).maybeSingle();if(d){alert("Bu Vergi No ile kaytl mteri zaten var!"),n(!1);return}}const{error:u}=await ee.from("clients").insert([{name:a.name,tc_number:a.tc_number||null,tax_number:a.tax_number||null,phone:a.phone||null,email:a.email||null,address:a.address||null,agent_id:c.user.id}]);if(u)throw u;alert("Mteri baaryla eklendi!"),t()}catch(c){console.error("Error adding client:",c),c.code==="23505"?alert("Bu vergi numaras zaten kaytl!"):alert("Mteri eklenirken hata olutu: "+c.message)}finally{n(!1)}};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md m-4",children:[l.jsxs("div",{className:"border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Yeni Mteri Ekle"}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition",children:l.jsx(Kt,{className:"w-6 h-6"})})]}),l.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mteri Ad / irket Ad *"}),l.jsx("input",{type:"text",required:!0,value:a.name,onChange:o=>s({...a,name:o.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Ege Ulam Ltd. ti."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"TC Kimlik No"}),l.jsx("input",{type:"text",value:a.tc_number,onChange:o=>s({...a,tc_number:o.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"12345678901",maxLength:11})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vergi No"}),l.jsx("input",{type:"text",value:a.tax_number,onChange:o=>s({...a,tax_number:o.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"1234567890",maxLength:10}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"TC Kimlik No veya Vergi No gerekli"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telefon"}),l.jsx("input",{type:"tel",value:a.phone,onChange:o=>s({...a,phone:o.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"0532 123 45 67"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"E-posta"}),l.jsx("input",{type:"email",value:a.email,onChange:o=>s({...a,email:o.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"ornek@sirket.com"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Adres"}),l.jsx("textarea",{value:a.address,onChange:o=>s({...a,address:o.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"zmir, Trkiye",rows:2})]}),l.jsxs("div",{className:"flex items-center justify-end gap-4 pt-4 border-t border-gray-200",children:[l.jsx("button",{type:"button",onClick:e,className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"ptal"}),l.jsx("button",{type:"submit",disabled:r,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:r?l.jsxs(l.Fragment,{children:[l.jsx(Nh,{className:"w-5 h-5 animate-spin"}),"Kaydediliyor..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Eh,{className:"w-5 h-5"}),"Kaydet"]})})]})]})]})})}function EP({onClose:e,onSuccess:t,clientId:r}){const[n,a]=z.useState(!1),[s,i]=z.useState(null),o=()=>{let d;r?d=[{"Sigorta irketi":"Anadolu Sigorta","Polie No":"POL123456","Polie Tipi":"kasko","Sigortal Ad":"Ahmet Ylmaz",Plaka:"34ABC123","Riziko Adresi 1":"","Riziko Adresi 2":"","Balang Tarihi":"01.01.2024","Biti Tarihi":"01.01.2025","Prim Tutar":"5000"},{"Sigorta irketi":"Trkiye Sigorta","Polie No":"POL789012","Polie Tipi":"trafik","Sigortal Ad":"Ahmet Ylmaz",Plaka:"06XYZ456","Riziko Adresi 1":"","Riziko Adresi 2":"","Balang Tarihi":"15.02.2024","Biti Tarihi":"15.02.2025","Prim Tutar":"2000"}]:d=[{"Mteri Ad":"Ahmet Ylmaz","TC Kimlik No":"12345678901","Vergi No":"",Telefon:"05321234567",Email:"ahmet@example.com","Sigorta irketi":"Anadolu Sigorta","Polie No":"POL123456","Polie Tipi":"kasko","Sigortal Ad":"Ahmet Ylmaz",Plaka:"34ABC123","Riziko Adresi 1":"","Riziko Adresi 2":"","Balang Tarihi":"01.01.2024","Biti Tarihi":"01.01.2025","Prim Tutar":"5000"},{"Mteri Ad":"Mehmet Kaya","TC Kimlik No":"98765432109","Vergi No":"",Telefon:"05339876543",Email:"mehmet@example.com","Sigorta irketi":"Trkiye Sigorta","Polie No":"POL789012","Polie Tipi":"trafik","Sigortal Ad":"Mehmet Kaya",Plaka:"06XYZ456","Riziko Adresi 1":"","Riziko Adresi 2":"","Balang Tarihi":"15.02.2024","Biti Tarihi":"15.02.2025","Prim Tutar":"2000"},{"Mteri Ad":"ABC irketi","TC Kimlik No":"","Vergi No":"1234567890",Telefon:"05351112233",Email:"info@abc.com","Sigorta irketi":"Allianz Sigorta","Polie No":"POL345678","Polie Tipi":"konut","Sigortal Ad":"ABC irketi",Plaka:"","Riziko Adresi 1":"Atatrk Caddesi No:123","Riziko Adresi 2":"ankaya/Ankara","Balang Tarihi":"20.03.2024","Biti Tarihi":"20.03.2025","Prim Tutar":"3000"}];const f=Qe.json_to_sheet(d),h=Qe.book_new();Qe.book_append_sheet(h,f,"Polieler"),Hs(h,"police_sablonu.xlsx")},c=d=>{if(!d)return null;if(typeof d=="number"){const p=new Date(1899,11,30),x=new Date(p.getTime()+d*864e5),m=x.getFullYear(),v=String(x.getMonth()+1).padStart(2,"0"),_=String(x.getDate()).padStart(2,"0");return`${m}-${v}-${_}`}const h=String(d).trim(),g=[/(\d{1,2})[\.\/\-](\d{1,2})[\.\/\-](\d{4})/,/(\d{4})[\.\/\-](\d{1,2})[\.\/\-](\d{1,2})/];for(const p of g){const x=h.match(p);if(x){let m,v,_;return x[3].length===4?(m=x[1].padStart(2,"0"),v=x[2].padStart(2,"0"),_=x[3]):(_=x[1],v=x[2].padStart(2,"0"),m=x[3].padStart(2,"0")),`${_}-${v}-${m}`}}return null},u=async d=>{var b,E,T,k,A,M,B,G,U,ne,de,oe,Y,se,Z,H;const f=(b=d.target.files)==null?void 0:b[0];if(!f)return;a(!0);const h=[],g=[];let p=0,x=0,m=0;const v={};let _=0,y=0;try{const ae=await f.arrayBuffer(),K=$s(ae),P=K.Sheets[K.SheetNames[0]],V=Qe.sheet_to_json(P),D=V.filter(X=>Object.values(X).some(J=>J!=null&&J.toString().trim()!==""));console.log(`Toplam satr: ${V.length}, Dolu satr: ${D.length}`);const{data:{user:R}}=await ee.auth.getUser();if(!R)throw new Error("Kullanc oturumu bulunamad");const{data:te}=await ee.from("insurance_companies").select("id, name"),F=X=>X.toLowerCase().replace(//g,"g").replace(//g,"g").replace(//g,"u").replace(//g,"u").replace(//g,"s").replace(//g,"s").replace(//g,"i").replace(/I/g,"i").replace(//g,"i").replace(/i/g,"i").replace(//g,"o").replace(//g,"o").replace(//g,"c").replace(//g,"c").replace(/\./g,"").replace(/\s+/g," ").trim(),q=new Map((te==null?void 0:te.map(X=>[F(X.name),X.id]))||[]);console.log("Excel stunlar:",D.length>0?Object.keys(D[0]):"Satr yok"),D.length>0&&console.log("lk satr rnei:",JSON.stringify(D[0],null,2));for(let X=0;X<D.length;X++){const L=D[X],J=X+2;try{const j=Object.keys(L),ke=j.find(Me=>Me.toLowerCase().includes("sigorta")||Me.toLowerCase().includes("irket")),ue=ke?(E=L[ke])==null?void 0:E.toString().trim():"";if(!ue){if(!j.some(Be=>L[Be]&&L[Be].toString().trim())){skipCount++;continue}h.push(`Satr ${J}: Sigorta irketi stunu bo veya bulunamad`),x++;continue}const ve=ue.toLowerCase();if(ve.includes("zeyl")||ve.includes("iptal")||ve.includes("iade")||ve.includes("yenileme")){const Me=j.find(kr=>kr.toLowerCase().includes("prim")||kr.toLowerCase().includes("tutar")||kr.toLowerCase().includes("brt")||kr.toLowerCase().includes("brut")),Be=Me&&parseFloat((T=L[Me])==null?void 0:T.toString().replace(/[^\d.,]/g,"").replace(",","."))||0;y+=Be,g.push(`Satr ${J}: lem satr atland - ${ue} (Prim: ${Be.toFixed(2)} TL)`),skipCount++;continue}const Te=F(ue);let he=q.get(Te);if(!he){for(const[Me,Be]of q.entries())if(Me.includes(Te)||Te.includes(Me.split(" ")[0])){he=Be;break}}if(!he){h.push(`Satr ${J}: Sigorta irketi bulunamad: "${ue}"`),x++;continue}const Ue=j.find(Me=>Me.toLowerCase().includes("balang")),Ke=j.find(Me=>Me.toLowerCase().includes("biti")),nt=Ue?c(L[Ue]):null,pt=Ke?c(L[Ke]):null;if(!nt||!pt){h.push(`Satr ${J}: Tarih format hatal (GG.AA.YYYY)`),x++;continue}const Ft=j.find(Me=>{const Be=Me.toLowerCase();return(Be.includes("polie")||Be.includes("police"))&&(Be.includes("tip")||Be.includes("tr"))});let Ge=Ft?F(((k=L[Ft])==null?void 0:k.toString())||""):"";X<5&&console.log(`Satr ${J} - Polie tipi RAW: "${L[Ft||""]}" -> Normalized: "${Ge}"`);const gt={trafik:"trafik",traffic:"trafik",dask:"dask",konut:"residence",saglik:"health",salk:"health","saglik sigortasi":"health","bireysel saglik":"health","bireysel salk":"health","bireysel saglik sigortasi":"health",bireyselsaglik:"health",bireyselsalk:"health",isyeri:"workplace",iyeri:"workplace","is yeri":"workplace","i yeri":"workplace",grup_saglik:"group_health",grup_salk:"group_health","grup saglik":"group_health","grup salk":"group_health",grupsaglik:"group_health",grupsalk:"group_health",grup_ferdi_kaza:"group_accident","grup ferdi kaza":"group_accident",grupferdikaza:"group_accident","ferdi kaza":"group_accident",ferdikaza:"group_accident"};gt[Ge]&&(Ge=gt[Ge]);const ir=["kasko","trafik","dask","workplace","residence","health","group_health","group_accident"];if(!Ge){h.push(`Satr ${J}: Polie tipi stunu bo veya bulunamad`),x++;continue}if(!ir.includes(Ge)){h.push(`Satr ${J}: Geersiz polie tipi: "${Ge}". Kabul edilen: kasko, trafik, konut, iyeri, salk, bireysel salk, dask, grup_salk, grup_ferdi_kaza`),x++;continue}const it=j.find(Me=>{const Be=Me.toLowerCase();return Be.includes("polie")&&(Be.includes("no")||Be.includes("numaras")||Be.includes("numarasi"))}),zr=j.find(Me=>Me.toLowerCase().includes("prim")||Me.toLowerCase().includes("tutar")||Me.toLowerCase().includes("brt")||Me.toLowerCase().includes("brut")),xe=j.find(Me=>{const Be=Me.toLowerCase();return Be.includes("riziko")&&Be.includes("adres")&&Be.includes("1")}),ye=j.find(Me=>{const Be=Me.toLowerCase();return Be.includes("riziko")&&Be.includes("adres")&&Be.includes("2")}),je=xe?(A=L[xe])==null?void 0:A.toString().trim():"",lt=ye?(M=L[ye])==null?void 0:M.toString().trim():"",vt=[je,lt].filter(Boolean).join(" ")||null,at=j.find(Me=>Me.toLowerCase().includes("plaka")),lr=at&&((B=L[at])==null?void 0:B.toString().trim().toUpperCase())||null,br=it?(G=L[it])==null?void 0:G.toString().trim():"";if(!br){h.push(`Satr ${J}: Polie numaras bo`),x++;continue}let Ln=r;if(!r){const Me=j.find(Pt=>Pt.toLowerCase().includes("mteri")&&Pt.toLowerCase().includes("ad")),Be=j.find(Pt=>Pt.toLowerCase().includes("tc")||Pt.toLowerCase().includes("kimlik")),kr=j.find(Pt=>Pt.toLowerCase().includes("vergi")),ri=j.find(Pt=>Pt.toLowerCase().includes("telefon")||Pt.toLowerCase().includes("tel")),ni=j.find(Pt=>Pt.toLowerCase().includes("email")||Pt.toLowerCase().includes("e-mail")||Pt.toLowerCase().includes("mail")),ai=Me?(U=L[Me])==null?void 0:U.toString().trim():"",wa=Be?(ne=L[Be])==null?void 0:ne.toString().trim():"",Mn=kr?(de=L[kr])==null?void 0:de.toString().trim():"",dl=ri?(oe=L[ri])==null?void 0:oe.toString().trim():"",fl=ni?(Y=L[ni])==null?void 0:Y.toString().trim():"";if(!ai){h.push(`Satr ${J}: Mteri ad bulunamad`),x++;continue}if(!wa&&!Mn){h.push(`Satr ${J}: TC Kimlik No veya Vergi No gerekli`),x++;continue}let an=ee.from("clients").select("id").eq("agent_id",R.id);wa?an=an.eq("tc_number",wa):Mn&&(an=an.eq("tax_number",Mn));const{data:us}=await an.maybeSingle();if(us)Ln=us.id;else{const{data:Pt,error:ea}=await ee.from("clients").insert({name:ai,tc_number:wa||null,tax_number:Mn||null,phone:dl||null,email:fl||null,agent_id:R.id}).select("id").single();if(ea||!Pt){h.push(`Satr ${J}: Mteri oluturulamad - ${ea==null?void 0:ea.message}`),x++;continue}Ln=Pt.id}}const{data:nn}=await ee.from("policies").select("id, status, end_date").eq("policy_number",br).eq("agent_id",R.id).eq("is_deleted",!1).maybeSingle();if(nn){if(nn.status==="active"&&nn.end_date===pt){g.push(`Satr ${J}: Mkerrer polie atland - ${br}`),m++;continue}new Date(pt)>new Date(nn.end_date)&&(await ee.from("policies").update({status:"archived",archived_at:new Date().toISOString()}).eq("id",nn.id),g.push(`Satr ${J}: Eski polie arivlendi, yeni polie ekleniyor - ${br}`))}const cs=j.find(Me=>{const Be=Me.toLowerCase();return Be.includes("sigortal")&&Be.includes("ad")}),ei=cs?(se=L[cs])==null?void 0:se.toString().trim():null,kn={client_id:Ln,insured_name:ei,insurance_company_id:he,policy_number:br,policy_type:Ge,start_date:nt,end_date:pt,premium_amount:zr&&parseFloat((Z=L[zr])==null?void 0:Z.toString().replace(/[^\d.,]/g,"").replace(",","."))||0,plate_number:lr,address:vt,agent_id:R.id,status:"active",policy_year:new Date(nt).getFullYear(),renewed_policy_id:(nn==null?void 0:nn.id)||null};if(Ge==="kasko"||Ge==="trafik"){const Me=j.find(Be=>{const kr=Be.toLowerCase();return kr.includes("marka")&&kr.includes("model")||kr.includes("ara")});kn.license_plate=lr,kn.vehicle_brand_model=Me&&((H=L[Me])==null?void 0:H.toString().trim())||null}const{error:ti}=await ee.from("policies").insert(kn);ti?(h.push(`Satr ${J}: Polie eklenemedi - ${ti.message}`),x++):(p++,_+=kn.premium_amount,v[Ge]=(v[Ge]||0)+1)}catch(j){h.push(`Satr ${J}: ${j.message}`),x++}}console.log("=== LEM TAMAMLANDI ==="),console.log("Baarl:",p),console.log("Baarsz:",x),console.log("Atland:",m),console.log("Polie tipi dalm:",v),console.log("=== LK 20 HATA ==="),h.slice(0,20).forEach((X,L)=>{console.log(`${L+1}. ${X}`)}),i({success:p,failed:x,skipped:m,errors:h.slice(0,20),warnings:g.slice(0,20),totalPremium:_,skippedPremium:y}),p>0&&t()}catch(ae){alert("Excel dosyas okunamad: "+ae.message)}finally{a(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Toplu Polie Ykleme"}),l.jsx("button",{onClick:e,className:"text-gray-500 hover:text-gray-700 transition-colors",children:l.jsx(Kt,{className:"w-6 h-6"})})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx(Rt,{className:"w-5 h-5 text-blue-600 mt-0.5"}),l.jsxs("div",{className:"text-sm text-blue-800",children:[l.jsx("p",{className:"font-medium mb-2",children:"Excel dosyanz u stunlar iermelidir:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[!r&&l.jsxs(l.Fragment,{children:[l.jsx("li",{children:"Mteri Ad (zorunlu - client seilmemise)"}),l.jsx("li",{children:"TC Kimlik No veya Vergi No (zorunlu - client seilmemise)"}),l.jsx("li",{children:"Telefon, Email (opsiyonel)"})]}),l.jsx("li",{children:"Sigorta irketi (zorunlu)"}),l.jsx("li",{children:"Polie No (zorunlu)"}),l.jsx("li",{children:"Polie Tipi (kasko/trafik/konut/iyeri/salk/dask/grup_salk/grup_ferdi_kaza)"}),l.jsx("li",{children:"Sigortal Ad (opsiyonel)"}),l.jsx("li",{children:"Plaka (ara polieleri iin)"}),l.jsx("li",{children:"Riziko Adresi 1, Riziko Adresi 2 (konut/iyeri iin)"}),l.jsx("li",{children:"Balang Tarihi, Biti Tarihi (GG.AA.YYYY)"}),l.jsx("li",{children:"Prim Tutar"})]})]})]})}),l.jsxs("button",{onClick:o,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[l.jsx(Qr,{className:"w-5 h-5"}),"rnek ablon ndir"]}),l.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8",children:l.jsxs("label",{className:"flex flex-col items-center cursor-pointer",children:[l.jsx(Yn,{className:"w-12 h-12 text-gray-400 mb-3"}),l.jsx("span",{className:"text-sm font-medium text-gray-700 mb-1",children:"Excel Dosyas Se"}),l.jsx("span",{className:"text-xs text-gray-500",children:".xlsx veya .xls dosyas"}),l.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:u,disabled:n,className:"hidden"})]})}),n&&l.jsxs("div",{className:"text-center py-4",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),l.jsx("p",{className:"text-sm text-gray-600",children:"leniyor..."})]}),s&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[l.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx(qr,{className:"w-5 h-5 text-green-600"}),l.jsx("span",{className:"font-medium text-green-800",children:"Baarl"})]}),l.jsx("p",{className:"text-2xl font-bold text-green-600",children:s.success}),s.totalPremium!==void 0&&l.jsxs("p",{className:"text-xs text-green-700 mt-1",children:[s.totalPremium.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," TL"]})]}),s.skipped>0&&l.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx(Rt,{className:"w-5 h-5 text-yellow-600"}),l.jsx("span",{className:"font-medium text-yellow-800",children:"Atland"})]}),l.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:s.skipped}),s.skippedPremium!==void 0&&s.skippedPremium>0&&l.jsxs("p",{className:"text-xs text-yellow-700 mt-1",children:["-",s.skippedPremium.toLocaleString("tr-TR",{minimumFractionDigits:2,maximumFractionDigits:2})," TL"]})]}),l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx(Rt,{className:"w-5 h-5 text-red-600"}),l.jsx("span",{className:"font-medium text-red-800",children:"Baarsz"})]}),l.jsx("p",{className:"text-2xl font-bold text-red-600",children:s.failed})]})]}),s.warnings.length>0&&l.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[l.jsx("p",{className:"font-medium text-yellow-800 mb-2",children:"Uyarlar:"}),l.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[s.warnings.map((d,f)=>l.jsx("li",{children:d},f)),s.warnings.length===20&&l.jsx("li",{className:"italic",children:"...ve daha fazlas"})]})]}),s.errors.length>0&&l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[l.jsx("p",{className:"font-medium text-red-800 mb-2",children:"Hatalar:"}),l.jsxs("ul",{className:"text-sm text-red-700 space-y-1",children:[s.errors.map((d,f)=>l.jsx("li",{children:d},f)),s.errors.length===20&&l.jsx("li",{className:"italic",children:"...ve daha fazlas"})]})]})]})]})]})})}function TP({onClose:e,onSuccess:t}){const[r,n]=z.useState(!1),[a,s]=z.useState(null),i=async o=>{const c=o.target.files;if(!c||c.length===0)return;n(!0);const u=[];let d=0,f=0;try{const{data:{user:h}}=await ee.auth.getUser();if(!h)throw new Error("Kullanc oturumu bulunamad");for(let g=0;g<c.length;g++){const p=c[g],x=p.name;if(!x.toLowerCase().endsWith(".pdf")){u.push(`${x}: PDF dosyas deil`),f++;continue}const m=x.replace(".pdf","").split("_");if(m.length<3){u.push(`${x}: Format hatal (plaka_bititarihi_tip.pdf)`),f++;continue}const v=m[0].trim().toUpperCase(),_=m[1].trim(),y=m[2].trim().toLowerCase().replace(".pdf","");let b=null,E=null;v.match(/^\d{2}[A-Z]+\d+$/i)?b=v:E=v.toLowerCase();let T=ee.from("policies").select("id, policy_number, plate_number, location").eq("agent_id",h.id).eq("policy_type",y).eq("end_date",_).eq("is_deleted",!1).eq("status","active");b?T=T.ilike("plate_number",b):E&&(T=T.ilike("location",E));const{data:k,error:A}=await T;if(A){u.push(`${x}: Polie sorgulanamad - ${A.message}`),f++;continue}let M=null;if(k&&k.length>0&&(M=k[0]),!M){u.push(`${x}: Eleen polie bulunamad`),f++;continue}const B=new FileReader,G=await new Promise((ne,de)=>{B.onload=()=>ne(B.result),B.onerror=de,B.readAsDataURL(p)}),{error:U}=await ee.from("policies").update({pdf_data:G,pdf_filename:x}).eq("id",M.id);if(U){u.push(`${x}: Veritaban gncelleme hatas - ${U.message}`),f++;continue}d++}s({success:d,failed:f,errors:u}),d>0&&t()}catch(h){s({success:0,failed:c.length,errors:[h.message]})}finally{n(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900",children:"Polie PDF Ykle"}),l.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:l.jsx(Kt,{className:"w-6 h-6"})})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:a?l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[l.jsx(qr,{className:"w-5 h-5"}),l.jsxs("span",{className:"font-medium",children:[a.success," baarl"]})]}),a.failed>0&&l.jsxs("div",{className:"flex items-center space-x-2 text-red-600",children:[l.jsx(Rt,{className:"w-5 h-5"}),l.jsxs("span",{className:"font-medium",children:[a.failed," baarsz"]})]})]}),a.errors.length>0&&l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[l.jsx("h4",{className:"font-semibold text-red-900 mb-2",children:"Hatalar:"}),l.jsx("ul",{className:"space-y-1 text-sm text-red-800 max-h-60 overflow-y-auto",children:a.errors.map((o,c)=>l.jsxs("li",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:"text-red-600 mt-0.5",children:""}),l.jsx("span",{children:o})]},c))})]}),l.jsx("button",{onClick:()=>{s(null),e()},className:"w-full py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Kapat"})]}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[l.jsx("h3",{className:"font-semibold text-blue-900 mb-3",children:" Toplu PDF Ykleme"}),l.jsxs("div",{className:"bg-white rounded p-3 mb-3",children:[l.jsx("p",{className:"text-blue-900 font-medium mb-1",children:" Tek seferde tm PDF'leri seebilirsiniz!"}),l.jsx("p",{className:"text-blue-700 text-sm",children:"Dosya seerken Ctrl (Windows) veya Cmd (Mac) tuuyla oklu seim yapn"})]}),l.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Dosya Adlandrma Format:"}),l.jsxs("p",{className:"text-blue-800 text-sm mb-3",children:[l.jsx("strong",{children:"plaka_bititarihi_tip.pdf"})," veya ",l.jsx("strong",{children:"yer_bititarihi_tip.pdf"})]}),l.jsxs("div",{className:"space-y-2 text-sm text-blue-800",children:[l.jsx("p",{children:l.jsx("strong",{children:"rnekler:"})}),l.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[l.jsx("li",{children:l.jsx("code",{className:"bg-blue-100 px-2 py-1 rounded",children:"34ABC123_2025-01-01_trafik.pdf"})}),l.jsx("li",{children:l.jsx("code",{className:"bg-blue-100 px-2 py-1 rounded",children:"06XYZ789_2025-06-15_kasko.pdf"})}),l.jsx("li",{children:l.jsx("code",{className:"bg-blue-100 px-2 py-1 rounded",children:"istanbulanadolusubesi_2025-03-20_konut.pdf"})})]}),l.jsxs("p",{className:"mt-3",children:[l.jsx("strong",{children:"Polie Tipleri:"})," trafik, kasko, dask, saglik, konut, isyeri"]})]})]}),l.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-blue-500 transition-colors",children:[l.jsx("input",{type:"file",id:"pdf-upload",multiple:!0,accept:".pdf",onChange:i,disabled:r,className:"hidden"}),l.jsxs("label",{htmlFor:"pdf-upload",className:"cursor-pointer flex flex-col items-center",children:[l.jsx(Yn,{className:"w-12 h-12 text-blue-500 mb-4"}),l.jsx("p",{className:"text-xl font-bold text-gray-900 mb-2",children:" Tm PDF'leri Tek Seferde Sein"}),l.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["Dosya seerken ",l.jsx("kbd",{className:"px-2 py-1 bg-gray-200 rounded text-xs",children:"Ctrl"})," + Tklama ile oklu seim"]}),l.jsx("p",{className:"text-xs text-gray-500",children:"veya srkleyip brakn"})]})]}),r&&l.jsxs("div",{className:"flex items-center justify-center space-x-3",children:[l.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),l.jsx("span",{className:"text-gray-600",children:"Dosyalar ykleniyor..."})]})]})})]})})}function jP({onClose:e,onSuccess:t}){const[r,n]=z.useState(!1),[a,s]=z.useState(""),[i,o]=z.useState({updated:0,failed:0,notFound:0}),c=()=>{const d=[{"Polie No":"POL123456","Sigorta irketi":"Anadolu Sigorta"},{"Polie No":"POL789012","Sigorta irketi":"Trkiye Sigorta"}],f=Qe.json_to_sheet(d),h=Qe.book_new();Qe.book_append_sheet(h,f,"Polie Gncelleme"),Hs(h,"police_guncelleme_sablonu.xlsx")},u=async d=>{var h;const f=(h=d.target.files)==null?void 0:h[0];if(f)try{n(!0),s(""),o({updated:0,failed:0,notFound:0});const g=await f.arrayBuffer(),p=$s(g),x=p.Sheets[p.SheetNames[0]],m=Qe.sheet_to_json(x);if(m.length===0)throw new Error("Excel dosyas bo");let v=0,_=0,y=0;const b=[];for(const E of m)try{if(!E["Polie No"]||!E["Sigorta irketi"]){b.push(`Eksik bilgi: ${E["Polie No"]||"Polie No yok"}`),_++;continue}const{data:T}=await ee.from("policies").select("id").eq("policy_number",E["Polie No"]).maybeSingle();if(!T){b.push(`Polie bulunamad: ${E["Polie No"]}`),y++;continue}const{data:k}=await ee.from("insurance_companies").select("id").ilike("name",E["Sigorta irketi"]).maybeSingle();if(!k){b.push(`Sigorta irketi bulunamad: ${E["Sigorta irketi"]}`),_++;continue}const{error:A}=await ee.from("policies").update({insurance_company_id:k.id}).eq("id",T.id);if(A)throw A;v++}catch(T){const k=T instanceof Error?T.message:JSON.stringify(T);b.push(`${E["Polie No"]}: ${k}`),_++}o({updated:v,failed:_,notFound:y}),b.length>0&&b.length<=10&&console.log("Hatalar:",b),v>0&&setTimeout(()=>{t()},2e3)}catch(g){s(g.message||"Ykleme srasnda hata olutu")}finally{n(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Polie Sigorta irketi Gncelleme"}),l.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition",children:l.jsx(Kt,{className:"w-6 h-6"})})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex gap-3",children:[l.jsx(Rt,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"text-sm text-blue-800",children:[l.jsx("p",{className:"font-semibold mb-2",children:"Nasl alr?"}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Polie No ile eleen polielerin sigorta irketi gncellenir"}),l.jsx("li",{children:"Sigorta irketi ad veritabanndaki ile elemelidir"}),l.jsx("li",{children:"Geerli irketler: Anadolu Sigorta, Trkiye Sigorta, Quick Sigorta, HDI Sigorta, Neova Sigorta"})]})]})]})}),l.jsx("div",{children:l.jsxs("button",{onClick:c,className:"w-full flex items-center justify-center gap-2 bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700 transition",children:[l.jsx(Qr,{className:"w-5 h-5"}),"Excel ablonunu ndir"]})}),l.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[l.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:u,disabled:r,className:"hidden",id:"file-upload"}),l.jsxs("label",{htmlFor:"file-upload",className:`cursor-pointer flex flex-col items-center gap-3 ${r?"opacity-50 cursor-not-allowed":""}`,children:[l.jsx(Yn,{className:"w-12 h-12 text-gray-400"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-lg font-semibold text-gray-700",children:r?"Gncelleniyor...":"Excel Dosyasn Se"}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"veya srkleyip brakn"})]})]})]}),a&&l.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex gap-3",children:[l.jsx(Rt,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),l.jsx("p",{className:"text-sm text-red-800",children:a})]})}),(i.updated>0||i.failed>0||i.notFound>0)&&l.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Gncellenen:"}),l.jsx("span",{className:"text-sm font-bold text-green-600",children:i.updated})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Bulunamayan:"}),l.jsx("span",{className:"text-sm font-bold text-orange-600",children:i.notFound})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Baarsz:"}),l.jsx("span",{className:"text-sm font-bold text-red-600",children:i.failed})]})]}),i.updated>0&&l.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex gap-3",children:[l.jsx(qr,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),l.jsx("p",{className:"text-sm text-green-800",children:"Gncelleme baarl! Sayfa otomatik yenilenecek..."})]})})]})]})})}function CP({isOpen:e,onClose:t,onSuccess:r}){const[n,a]=z.useState([]),[s,i]=z.useState(!1),[o,c]=z.useState([]),[u,d]=z.useState(!1),f=_=>{if(_.target.files){const y=Array.from(_.target.files).filter(b=>b.type==="application/pdf");a(y),c([]),d(!1)}},h=_=>{const y=_.replace(".pdf",""),b=y.match(/(\d{9,})/);if(b)return b[1];const E=y.split(/[-_\s]/);for(const T of E)if(/^\d{9,}$/.test(T))return T;return y},g=async()=>{if(n.length===0){alert("Ltfen en az bir PDF dosyas sein");return}i(!0);const _=[];try{const{data:y}=await ee.auth.getUser();if(!y.user)throw new Error("Kullanc bulunamad");for(const E of n){const T=h(E.name);try{const{data:k,error:A}=await ee.from("policies").select("id, policy_number, is_deleted").eq("policy_number",T).eq("is_deleted",!1).maybeSingle();if(A)throw A;if(!k){_.push({filename:E.name,policyNumber:T,status:"not_found",message:"Polie bulunamad"});continue}const M=new FileReader,B=await new Promise((U,ne)=>{M.onload=()=>U(M.result),M.onerror=ne,M.readAsDataURL(E)}),{error:G}=await ee.from("policies").update({pdf_data:B,pdf_filename:E.name}).eq("id",k.id);if(G)throw G;_.push({filename:E.name,policyNumber:T,status:"success",message:`Polie ${k.policy_number} ile eletirildi`})}catch(k){_.push({filename:E.name,policyNumber:T,status:"error",message:k.message})}}c(_),d(!0),_.filter(E=>E.status==="success").length>0&&setTimeout(()=>r(),2e3)}catch(y){alert("Ykleme hatas: "+y.message)}finally{i(!1)}},p=()=>{a([]),c([]),d(!1),t()};if(!e)return null;const x=o.filter(_=>_.status==="success").length,m=o.filter(_=>_.status==="not_found").length,v=o.filter(_=>_.status==="error").length;return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Toplu PDF Ykleme"}),l.jsx("button",{onClick:p,className:"text-gray-500 hover:text-gray-700",children:l.jsx(Kt,{className:"w-6 h-6"})})]}),l.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-140px)]",children:u?l.jsxs("div",{children:[l.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx(qr,{className:"w-5 h-5 text-green-600"}),l.jsx("span",{className:"text-sm font-medium text-green-900",children:"Baarl"})]}),l.jsx("p",{className:"text-2xl font-bold text-green-600",children:x})]}),l.jsxs("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx(Rt,{className:"w-5 h-5 text-yellow-600"}),l.jsx("span",{className:"text-sm font-medium text-yellow-900",children:"Bulunamad"})]}),l.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:m})]}),l.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx(g0,{className:"w-5 h-5 text-red-600"}),l.jsx("span",{className:"text-sm font-medium text-red-900",children:"Hata"})]}),l.jsx("p",{className:"text-2xl font-bold text-red-600",children:v})]})]}),l.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:o.map((_,y)=>l.jsx("div",{className:`p-4 rounded-lg border-2 ${_.status==="success"?"bg-green-50 border-green-200":_.status==="not_found"?"bg-yellow-50 border-yellow-200":"bg-red-50 border-red-200"}`,children:l.jsxs("div",{className:"flex items-start gap-3",children:[_.status==="success"?l.jsx(qr,{className:"w-5 h-5 text-green-600 mt-0.5"}):_.status==="not_found"?l.jsx(Rt,{className:"w-5 h-5 text-yellow-600 mt-0.5"}):l.jsx(g0,{className:"w-5 h-5 text-red-600 mt-0.5"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-medium text-gray-900",children:_.filename}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Polie No: ",_.policyNumber]}),l.jsx("p",{className:`text-sm ${_.status==="success"?"text-green-700":_.status==="not_found"?"text-yellow-700":"text-red-700"}`,children:_.message})]})]})},y))})]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[l.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Dosya simlendirme:"}),l.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[l.jsxs("li",{children:[" ",l.jsx("code",{className:"bg-blue-100 px-2 py-0.5 rounded",children:"123456789.pdf"})," - Sadece polie numaras"]}),l.jsxs("li",{children:[" ",l.jsx("code",{className:"bg-blue-100 px-2 py-0.5 rounded",children:"123456789-kasko.pdf"})," - Polie no + aklama"]}),l.jsxs("li",{children:[" ",l.jsx("code",{className:"bg-blue-100 px-2 py-0.5 rounded",children:"AXA_123456789.pdf"})," - irket + polie no"]}),l.jsx("li",{className:"mt-2 font-medium",children:" Dosya adnda en az 9 haneli polie numaras olmal"})]})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"PDF Dosyalar Sein"}),l.jsx("input",{type:"file",accept:"application/pdf",multiple:!0,onChange:f,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),n.length>0&&l.jsxs("div",{className:"mb-6",children:[l.jsxs("h3",{className:"font-semibold text-gray-900 mb-3",children:["Seilen Dosyalar (",n.length," adet)"]}),l.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:n.map((_,y)=>{const b=h(_.name);return l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:_.name}),l.jsxs("p",{className:"text-xs text-gray-500",children:["Tespit edilen polie no: ",l.jsx("span",{className:"font-semibold text-blue-600",children:b})]})]}),l.jsxs("span",{className:"text-xs text-gray-500",children:[(_.size/1024).toFixed(1)," KB"]})]},y)})})]})]})}),l.jsx("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-200 bg-gray-50",children:u?l.jsx("button",{onClick:p,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Kapat"}):l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:p,className:"px-4 py-2 text-gray-700 hover:text-gray-900",children:"ptal"}),l.jsx("button",{onClick:g,disabled:s||n.length===0,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:s?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Ykleniyor..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Yn,{className:"w-5 h-5"}),n.length," Dosyay Ykle"]})})]})})]})})}function AP(){const{profile:e,isAdmin:t}=Pr(),[r,n]=z.useState([]),[a,s]=z.useState([]),[i,o]=z.useState(!0),[c,u]=z.useState(""),[d,f]=z.useState("all"),[h,g]=z.useState(!1),[p,x]=z.useState(!1),[m,v]=z.useState(!1),[_,y]=z.useState(!1),[b,E]=z.useState(!1),[T,k]=z.useState(!1),[A,M]=z.useState(""),[B,G]=z.useState([]),[U,ne]=z.useState("all"),[de,oe]=z.useState([]),[Y,se]=z.useState("all");z.useEffect(()=>{ae(),Z(),H()},[e]),z.useEffect(()=>{D()},[r,c,d,A,U,Y]);const Z=async()=>{try{const{data:F}=await ee.auth.getUser();if(!F.user)return;const{data:q,error:X}=await ee.from("clients").select("id, name, tax_number").eq("agent_id",F.user.id).order("name");if(X)throw X;G(q||[])}catch(F){console.error("Error fetching clients:",F)}},H=async()=>{try{const{data:F,error:q}=await ee.from("insurance_companies").select("id, name").order("name");if(q)throw q;oe(F||[])}catch(F){console.error("Error fetching insurance companies:",F)}},ae=async()=>{try{o(!0);let F=ee.from("policies").select("*, insurance_company:insurance_companies(*), client:clients(id, name, tax_number)").eq("is_deleted",!1).in("status",["active","expired"]);!t&&e&&(F=F.eq("client_id",e.id));const{data:q,error:X}=await F.order("created_at",{ascending:!1});if(X)throw X;n(q||[])}catch(F){console.error("Error fetching policies:",F)}finally{o(!1)}},K=async()=>{const{data:F}=await ee.auth.getUser();if(F.user)if(U!=="all"){const q=B.find(L=>L.id===U),X=a.length;if(!confirm(` UYARI: "${q==null?void 0:q.name}" mterisinin ${X} adet poliesini kalc olarak silmek istediinizden emin misiniz?

(Mteri kayd SLNMEYECEK, sadece polieler silinecek)`)||!confirm(` SON ONAY: ${q==null?void 0:q.name} iin ${X} polie kalc olarak VERTABANINDAN silinecek.

Bu ilem GER ALINAMAZ! Devam edilsin mi?`))return;try{const{error:L}=await ee.from("policies").delete().eq("client_id",U).eq("agent_id",F.user.id);if(L)throw L;alert(` ${q==null?void 0:q.name} mterisinin ${X} poliesi silindi (Mteri kayd korundu)`),ae()}catch(L){console.error("Silme hatas:",L),alert(" Silme ilemi baarsz: "+L.message)}}else{const q=r.length,X=B.length;if(!confirm(` TEHLKEL LEM!

${X} mteriye ait TOPLAM ${q} POLE kalc olarak silinecek.

(Mteri kaytlar SLNMEYECEK)

Bu ilem GER ALINAMAZ! Emin misiniz?`)||!confirm(` SON UYARI!

Tm polieler (${q} adet) kalc olarak VERTABANINDAN silinecek.

Devam edilsin mi?`)||!confirm(` LTFEN ONAYLAYIN:

"${q} polie kalc olarak silinecek"

Bu mesaj okuyup anladnz m?`))return;try{const{error:L}=await ee.from("policies").delete().eq("agent_id",F.user.id);if(L)throw L;alert(` Toplam ${q} polie silindi. Mteri kaytlar korundu.`),ae()}catch(L){console.error("Silme hatas:",L),alert(" Silme ilemi baarsz: "+L.message)}}},P=async(F,q)=>{if(confirm(`${q} numaral polieyi kalc olarak silmek istediinizden emin misiniz?

Bu ilem geri alnamaz!`))try{const{error:X}=await ee.from("policies").delete().eq("id",F);if(X)throw X;alert(" Polie baaryla silindi"),ae()}catch(X){alert(" Polie silinemedi: "+X.message)}},V=async()=>{const{default:F}=await Ya(async()=>{const{default:j}=await Promise.resolve().then(()=>kf);return{default:j}},void 0),q=a.map(j=>{var ke,ue,ve;return{"Polie No":j.policy_number,Mteri:((ke=j.clients)==null?void 0:ke.full_name)||"-","TC/VKN":((ue=j.clients)==null?void 0:ue.tc_number)||"-","Polie Tr":j.policy_type,"Sigorta irketi":((ve=j.insurance_companies)==null?void 0:ve.name)||"-",Sigortal:j.insured_name||"-",Plaka:j.plate_number||"-",Balang:new Date(j.start_date).toLocaleDateString("tr-TR"),Biti:new Date(j.end_date).toLocaleDateString("tr-TR"),Prim:Number(j.premium_amount).toLocaleString("tr-TR",{style:"currency",currency:"TRY"}),Durum:j.status==="active"?"Aktif":j.status==="expired"?"Sresi Dolmu":"ptal"}}),X=F.utils.json_to_sheet(q),L=F.utils.book_new();F.utils.book_append_sheet(L,X,"Polieler");const J=`Polieler_${new Date().toLocaleDateString("tr-TR").replace(/\./g,"-")}.xlsx`;F.writeFile(L,J)},D=()=>{let F=[...r];U!=="all"&&(F=F.filter(q=>q.client_id===U)),Y!=="all"&&(F=F.filter(q=>q.insurance_company_id===Y)),d!=="all"&&(F=F.filter(q=>q.policy_type===d)),A&&(F=F.filter(q=>{var X;return(X=q.plate_number)==null?void 0:X.toLowerCase().includes(A.toLowerCase())})),c&&(F=F.filter(q=>{var X,L,J;return q.policy_number.toLowerCase().includes(c.toLowerCase())||((X=q.license_plate)==null?void 0:X.toLowerCase().includes(c.toLowerCase()))||((L=q.address)==null?void 0:L.toLowerCase().includes(c.toLowerCase()))||((J=q.location)==null?void 0:J.toLowerCase().includes(c.toLowerCase()))})),s(F)},R=F=>new Date(F).toLocaleDateString("tr-TR"),te=async()=>{const F=await Ya(()=>Promise.resolve().then(()=>kf),void 0),q=a.map(J=>{var j;return{"Polie No":J.policy_number,"Sigorta irketi":((j=J.insurance_company)==null?void 0:j.name)||"Belirtilmemi","Polie Tipi":J.policy_type==="kasko"?"Kasko":J.policy_type==="trafik"?"Trafik":J.policy_type==="workplace"?"yeri":J.policy_type==="residence"?"Konut":J.policy_type==="health"?"Salk":J.policy_type==="dask"?"Dask":J.policy_type==="group_health"?"Grup Salk":J.policy_type==="group_accident"?"Grup Ferdi Kaza":"Dier","Plaka/Yer":J.plate_number||J.location||"",Balang:R(J.start_date),Biti:R(J.end_date),Prim:J.premium_amount}}),X=F.utils.json_to_sheet(q),L=F.utils.book_new();F.utils.book_append_sheet(L,X,"Polieler"),F.writeFile(L,"police_raporu.xlsx")};return i?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Polieler"}),l.jsxs("p",{className:"text-gray-600 mt-2",children:["Tm polie kaytlarnz (",a.length," adet)"]})]}),l.jsxs("button",{onClick:V,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[l.jsx(Qr,{className:"w-5 h-5"}),"Excel ndir"]})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-2",children:[l.jsxs("button",{onClick:()=>{if(!t){alert("Sadece yneticiler mteri ekleyebilir");return}x(!0)},className:"flex items-center justify-center gap-2 bg-green-600 text-white px-3 py-2.5 rounded-lg hover:bg-green-700 transition text-sm font-medium",children:[l.jsx(Eh,{className:"w-4 h-4"}),"Mteri"]}),l.jsxs("button",{onClick:()=>{if(!t){alert("Sadece yneticiler polie ekleyebilir");return}g(!0)},className:"flex items-center justify-center gap-2 bg-blue-600 text-white px-3 py-2.5 rounded-lg hover:bg-blue-700 transition text-sm font-medium",children:[l.jsx(Yn,{className:"w-4 h-4"}),"Polie"]}),l.jsxs("button",{onClick:()=>{if(!t){alert("Sadece yneticiler toplu ykleme yapabilir");return}v(!0)},className:"flex items-center justify-center gap-2 bg-orange-600 text-white px-3 py-2.5 rounded-lg hover:bg-orange-700 transition text-sm font-medium",children:[l.jsx(p0,{className:"w-4 h-4"}),"Excel"]}),l.jsxs("button",{onClick:()=>{if(!t){alert("Sadece yneticiler PDF ykleyebilir");return}y(!0)},className:"flex items-center justify-center gap-2 bg-red-600 text-white px-3 py-2.5 rounded-lg hover:bg-red-700 transition text-sm font-medium",children:[l.jsx(rN,{className:"w-4 h-4"}),"PDF"]}),l.jsxs("button",{onClick:()=>{if(!t){alert("Sadece yneticiler toplu PDF ykleyebilir");return}k(!0)},className:"flex items-center justify-center gap-2 bg-pink-600 text-white px-3 py-2.5 rounded-lg hover:bg-pink-700 transition text-sm font-medium",children:[l.jsx(p0,{className:"w-4 h-4"}),"Toplu PDF"]}),l.jsxs("button",{onClick:()=>{if(!t){alert("Sadece yneticiler gncelleme yapabilir");return}E(!0)},className:"flex items-center justify-center gap-2 bg-cyan-600 text-white px-3 py-2.5 rounded-lg hover:bg-cyan-700 transition text-sm font-medium",children:[l.jsx(Ji,{className:"w-4 h-4"}),"Gncelle"]}),l.jsxs("button",{onClick:te,className:"flex items-center justify-center gap-2 bg-teal-600 text-white px-3 py-2.5 rounded-lg hover:bg-teal-700 transition text-sm font-medium",children:[l.jsx(Qr,{className:"w-4 h-4"}),"Rapor"]}),l.jsxs("button",{onClick:()=>{if(!t){alert("Sadece yneticiler toplu silme yapabilir");return}K()},className:"flex items-center justify-center gap-2 bg-red-700 text-white px-3 py-2.5 rounded-lg hover:bg-red-800 transition text-sm font-medium border-2 border-red-900",children:[l.jsx(Ds,{className:"w-4 h-4"}),"Tmn Sil"]})]})]}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx(Qi,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",value:c,onChange:F=>u(F.target.value),placeholder:"Polie no, plaka, adres ara...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{className:"relative",children:[l.jsx(Ci,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",value:A,onChange:F=>M(F.target.value),placeholder:"Plaka ile filtrele (rn: 34ABC)",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Sh,{className:"w-5 h-5 text-gray-400"}),l.jsxs("select",{value:d,onChange:F=>f(F.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"all",children:"Tm Polieler"}),l.jsx("option",{value:"kasko",children:"Kasko"}),l.jsx("option",{value:"trafik",children:"Trafik"}),l.jsx("option",{value:"workplace",children:"yeri"}),l.jsx("option",{value:"residence",children:"Konut"}),l.jsx("option",{value:"health",children:"Salk"}),l.jsx("option",{value:"dask",children:"Dask"}),l.jsx("option",{value:"group_health",children:"Grup Salk"}),l.jsx("option",{value:"group_accident",children:"Grup Ferdi Kaza"})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(yc,{className:"w-5 h-5 text-gray-400"}),l.jsxs("select",{value:U,onChange:F=>ne(F.target.value),className:`flex-1 px-4 py-2 border-2 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${U==="all"?"border-gray-300 bg-white":"border-blue-500 bg-blue-50 font-semibold"}`,children:[l.jsx("option",{value:"all",children:"Tm Mteriler"}),B.map(F=>l.jsxs("option",{value:F.id,children:[F.name," (",F.tax_number,")"]},F.id))]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(yc,{className:"w-5 h-5 text-gray-400"}),l.jsxs("select",{value:Y,onChange:F=>se(F.target.value),className:`flex-1 px-4 py-2 border-2 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent ${Y==="all"?"border-gray-300 bg-white":"border-green-500 bg-green-50 font-semibold"}`,children:[l.jsx("option",{value:"all",children:"Tm irketler"}),de.map(F=>l.jsx("option",{value:F.id,children:F.name},F.id))]})]})]})}),l.jsxs("div",{className:"space-y-4",children:[a.map(F=>{var q;return l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`rounded-lg p-3 ${F.policy_type==="kasko"?"bg-blue-100":F.policy_type==="trafik"?"bg-orange-100":F.policy_type==="workplace"?"bg-green-100":F.policy_type==="residence"?"bg-cyan-100":F.policy_type==="health"?"bg-red-100":F.policy_type==="dask"?"bg-yellow-100":F.policy_type==="group_health"?"bg-pink-100":F.policy_type==="group_accident"?"bg-purple-100":"bg-gray-100"}`,children:F.policy_type==="kasko"?l.jsx(Ci,{className:"w-6 h-6 text-blue-600"}):F.policy_type==="trafik"?l.jsx(Ci,{className:"w-6 h-6 text-orange-600"}):F.policy_type==="workplace"?l.jsx(yc,{className:"w-6 h-6 text-green-600"}):F.policy_type==="residence"?l.jsx(aN,{className:"w-6 h-6 text-cyan-600"}):F.policy_type==="health"?l.jsx(Vx,{className:"w-6 h-6 text-red-600"}):F.policy_type==="dask"?l.jsx(wo,{className:"w-6 h-6 text-yellow-600"}):F.policy_type==="group_health"?l.jsx(Os,{className:"w-6 h-6 text-pink-600"}):F.policy_type==="group_accident"?l.jsx(wo,{className:"w-6 h-6 text-purple-600"}):l.jsx(gn,{className:"w-6 h-6 text-gray-600"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:F.policy_number}),l.jsx("p",{className:"text-sm text-gray-600",children:((q=F.insurance_company)==null?void 0:q.name)||"Bilinmeyen irket"}),F.plate_number&&l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Plaka: ",l.jsx("span",{className:"font-medium",children:F.plate_number})]}),F.location&&l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Yer: ",l.jsx("span",{className:"font-medium",children:F.location})]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[F.pdf_data&&l.jsxs("a",{href:F.pdf_data,download:F.pdf_filename||`policy_${F.policy_number}.pdf`,className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition text-sm",children:[l.jsx(gn,{className:"w-4 h-4"}),"PDF"]}),t&&l.jsx(l.Fragment,{children:l.jsx("button",{onClick:()=>P(F.id,F.policy_number),className:"flex items-center gap-2 px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition text-sm",title:"Sil",children:l.jsx(Ds,{className:"w-4 h-4"})})}),l.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${F.policy_type==="kasko"?"bg-blue-100 text-blue-700":F.policy_type==="trafik"?"bg-orange-100 text-orange-700":F.policy_type==="workplace"?"bg-green-100 text-green-700":F.policy_type==="residence"?"bg-cyan-100 text-cyan-700":F.policy_type==="health"?"bg-red-100 text-red-700":F.policy_type==="dask"?"bg-yellow-100 text-yellow-700":F.policy_type==="group_health"?"bg-pink-100 text-pink-700":F.policy_type==="group_accident"?"bg-purple-100 text-purple-700":"bg-gray-100 text-gray-700"}`,children:F.policy_type==="kasko"?"Kasko":F.policy_type==="trafik"?"Trafik":F.policy_type==="workplace"?"yeri":F.policy_type==="residence"?"Konut":F.policy_type==="health"?"Salk":F.policy_type==="dask"?"Dask":F.policy_type==="group_health"?"Grup Salk":F.policy_type==="group_accident"?"Grup Ferdi Kaza":"Dier"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[(F.policy_type==="kasko"||F.policy_type==="trafik")&&l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Plaka"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ci,{className:"w-4 h-4 text-gray-400"}),l.jsx("p",{className:"text-sm font-medium",children:F.plate_number||F.license_plate||"-"})]})]}),(F.policy_type==="workplace"||F.policy_type==="residence"||F.policy_type==="dask")&&l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Adres"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(yc,{className:"w-4 h-4 text-gray-400"}),l.jsx("p",{className:"text-sm font-medium truncate",children:F.address||F.location||"-"})]})]}),F.policy_type==="health"&&l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Sigortal Ad"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Vx,{className:"w-4 h-4 text-gray-400"}),l.jsx("p",{className:"text-sm font-medium",children:F.insured_name||"-"})]})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Balang"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Kr,{className:"w-4 h-4 text-gray-400"}),l.jsx("p",{className:"text-sm font-medium",children:R(F.start_date)})]})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Biti"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Kr,{className:"w-4 h-4 text-gray-400"}),l.jsx("p",{className:"text-sm font-medium",children:R(F.end_date)})]})]})]})]},F.id)}),a.length===0&&l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[l.jsx(gn,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Henz polie kayd bulunmuyor"})]})]}),h&&l.jsx(NP,{onClose:()=>g(!1),onSuccess:()=>{g(!1),ae()}}),_&&l.jsx(TP,{onClose:()=>y(!1),onSuccess:()=>{y(!1),ae()}}),p&&l.jsx(a2,{onClose:()=>x(!1),onSuccess:()=>{x(!1),Z()}}),m&&l.jsx(EP,{clientId:U!=="all"?U:void 0,onClose:()=>v(!1),onSuccess:()=>{v(!1),ae()}}),b&&l.jsx(jP,{onClose:()=>E(!1),onSuccess:()=>{E(!1),ae()}}),T&&l.jsx(CP,{isOpen:T,onClose:()=>k(!1),onSuccess:()=>{ae()}})]})}function FP({onClose:e,onSuccess:t}){const[r,n]=z.useState(!1),[a,s]=z.useState([]),[i,o]=z.useState("manual"),[c,u]=z.useState(null),[d,f]=z.useState({claim_number:"",policy_id:"",claim_date:"",claim_type:"",license_plate:"",payment_amount:"",description:""});z.useEffect(()=>{h()},[]);const h=async()=>{const{data:x}=await ee.from("policies").select("id, policy_number, license_plate, policy_type, client_id").order("policy_number");s(x||[])},g=async()=>{if(!c){alert("Ltfen bir Excel dosyas sein");return}n(!0);try{const x=new FileReader;x.onload=async m=>{var v;try{const y=((v=m.target)==null?void 0:v.result).split(`
`).filter(k=>k.trim());if(y.length<2)throw new Error("Excel dosyas bo veya geersiz");const b=y[0].split(/[,;\t]/).map(k=>k.trim().toLowerCase()),E=[];for(let k=1;k<y.length;k++){const A=y[k].split(/[,;\t]/).map(Y=>Y.trim()),M=A[b.indexOf("policeNo")]||A[b.indexOf("police_no")]||A[0],B=A[b.indexOf("hasartarihi")]||A[b.indexOf("hasar_tarihi")]||A[1],G=A[b.indexOf("hasartipi")]||A[b.indexOf("hasar_tipi")]||A[2],U=A[b.indexOf("plaka")]||A[3]||"",ne=A[b.indexOf("odenentutar")]||A[b.indexOf("odenen_tutar")]||A[4]||"0",de=A[b.indexOf("aciklama")]||A[5]||"",oe=a.find(Y=>Y.policy_number===M);oe&&E.push({policy_id:oe.id,client_id:oe.client_id,claim_date:B,claim_type:G,license_plate:U||oe.license_plate,payment_amount:parseFloat(ne.replace(/[^\d.-]/g,""))||0,description:de})}if(E.length===0)throw new Error("Geerli hasar kayd bulunamad. Polie numaralarn kontrol edin.");const{error:T}=await ee.from("claims").insert(E);if(T)throw T;alert(`${E.length} hasar kayd baaryla eklendi!`),t()}catch(_){console.error("Excel parse error:",_),alert("Excel dosyas ilenirken hata olutu: "+_.message),n(!1)}},x.readAsText(c)}catch(x){console.error("Error uploading excel:",x),alert("Dosya yklenirken hata olutu: "+x.message),n(!1)}},p=async x=>{if(x.preventDefault(),i==="excel"){await g();return}if(!d.policy_id){alert("Ltfen bir polie sein");return}n(!0);try{const m=a.find(y=>y.id===d.policy_id),v={claim_number:d.claim_number||null,policy_id:d.policy_id,claim_date:d.claim_date,claim_type:d.claim_type,license_plate:d.license_plate||null,payment_amount:parseFloat(d.payment_amount)||0,description:d.description||null,client_id:m==null?void 0:m.client_id},{error:_}=await ee.from("claims").insert([v]);if(_)throw _;t()}catch(m){console.error("Error adding claim:",m),alert("Hasar eklenirken hata olutu: "+m.message)}finally{n(!1)}};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto m-4",children:[l.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Yeni Hasar Ekle"}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(Kt,{className:"w-6 h-6"})})]}),l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{type:"button",onClick:()=>o("manual"),className:`flex-1 py-2 px-4 rounded-lg font-medium transition flex items-center justify-center gap-2 ${i==="manual"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[l.jsx(Yi,{className:"w-5 h-5"}),"Manuel Giri"]}),l.jsxs("button",{type:"button",onClick:()=>o("excel"),className:`flex-1 py-2 px-4 rounded-lg font-medium transition flex items-center justify-center gap-2 ${i==="excel"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[l.jsx(p0,{className:"w-5 h-5"}),"Excel ile Ykle"]})]})}),l.jsxs("form",{onSubmit:p,className:"p-6 space-y-6",children:[i==="excel"?l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[l.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Excel Dosya Format"}),l.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"CSV veya Excel dosyanz aadaki stunlar iermelidir:"}),l.jsx("div",{className:"bg-white rounded border border-gray-200 p-3 font-mono text-xs overflow-x-auto",children:l.jsx("div",{className:"whitespace-nowrap",children:"policeNo, hasarTarihi, hasarTipi, plaka, odenenTutar, aciklama"})}),l.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Not: Stun balklar kk/byk harf duyarl deildir. Dosya CSV formatnda olmaldr."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Excel/CSV Dosyas *"}),l.jsx("input",{type:"file",accept:".csv,.xlsx,.xls",onChange:x=>{var m;return u(((m=x.target.files)==null?void 0:m[0])||null)},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0}),c&&l.jsxs("p",{className:"mt-2 text-sm text-green-600",children:["Seilen dosya: ",c.name]})]})]}):l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Polie *"}),l.jsxs("select",{required:!0,value:d.policy_id,onChange:x=>{const m=a.find(v=>v.id===x.target.value);f({...d,policy_id:x.target.value,license_plate:(m==null?void 0:m.license_plate)||""})},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"Polie Sein"}),a.map(x=>l.jsxs("option",{value:x.id,children:[x.policy_number," ",x.license_plate?`- ${x.license_plate}`:""]},x.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hasar Numaras"}),l.jsx("input",{type:"text",value:d.claim_number,onChange:x=>f({...d,claim_number:x.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Opsiyonel"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hasar Tarihi *"}),l.jsx("input",{type:"date",required:!0,value:d.claim_date,onChange:x=>f({...d,claim_date:x.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hasar ekli *"}),l.jsx("input",{type:"text",required:!0,value:d.claim_type,onChange:x=>f({...d,claim_type:x.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"rn: arpma, Yangn, Hrszlk"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Plaka"}),l.jsx("input",{type:"text",value:d.license_plate,onChange:x=>f({...d,license_plate:x.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"deme Tutar () *"}),l.jsx("input",{type:"number",step:"0.01",required:!0,value:d.payment_amount,onChange:x=>f({...d,payment_amount:x.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Aklama"}),l.jsx("textarea",{value:d.description,onChange:x=>f({...d,description:x.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Hasar hakknda ek bilgiler..."})]})]}),l.jsxs("div",{className:"flex items-center justify-end gap-4 pt-4 border-t border-gray-200",children:[l.jsx("button",{type:"button",onClick:e,className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"ptal"}),l.jsx("button",{type:"submit",disabled:r,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:r?l.jsxs(l.Fragment,{children:[l.jsx(Nh,{className:"w-5 h-5 animate-spin"}),i==="excel"?"Ykleniyor...":"Kaydediliyor..."]}):l.jsx(l.Fragment,{children:i==="excel"?l.jsxs(l.Fragment,{children:[l.jsx(Yn,{className:"w-5 h-5"}),"Ykle"]}):l.jsxs(l.Fragment,{children:[l.jsx(Yi,{className:"w-5 h-5"}),"Kaydet"]})})})]})]})]})})}function PP({onClose:e,onSuccess:t}){const{user:r}=Pr(),[n,a]=z.useState(!1),[s,i]=z.useState(""),[o,c]=z.useState({added:0,updated:0,failed:0}),[u,d]=z.useState([]),[f,h]=z.useState("");z.useEffect(()=>{g()},[]);const g=async()=>{const{data:v}=await ee.from("clients").select("id, name, tax_number").order("name");v&&d(v)},p=()=>{const v=[{"Dosya No":"HS-2024-001","Polie No":"POL123456",Plaka:"34ABC123","Sigorta irketi":"Anadolu Sigorta","Polie Tr":"Kasko","Hasar Tarihi":"15.01.2024","deme Tutar":5e3,"Hasar Nedeni":"arpma hasar"},{"Dosya No":"HS-2024-002","Polie No":"POL789012",Plaka:"34XYZ789","Sigorta irketi":"Quick Sigorta","Polie Tr":"Trafik","Hasar Tarihi":"20.01.2024","deme Tutar":3500,"Hasar Nedeni":"Park halinde arpma"},{"Dosya No":"HS-2024-003","Polie No":"POL345678",Plaka:"","Sigorta irketi":"Allianz","Polie Tr":"yeri","Hasar Tarihi":"25.01.2024","deme Tutar":15e3,"Hasar Nedeni":"Yangn"}],_=Qe.json_to_sheet(v),y=Qe.book_new();Qe.book_append_sheet(y,_,"Hasarlar"),Hs(y,"hasar_sablonu.xlsx")},x=v=>{if(!v)return new Date().toISOString().split("T")[0];if(typeof v=="number"){const T=new Date(1899,11,30);return new Date(T.getTime()+v*864e5).toISOString().split("T")[0]}const _=String(v).trim(),y=_.match(/^(\d{1,2})[\.\/-](\d{1,2})[\.\/-](\d{4})$/);if(y){const T=parseInt(y[1]),k=parseInt(y[2]);return`${parseInt(y[3])}-${String(k).padStart(2,"0")}-${String(T).padStart(2,"0")}`}const b=_.match(/^(\d{4})[\.\/-](\d{1,2})[\.\/-](\d{1,2})$/);if(b){const T=parseInt(b[1]),k=parseInt(b[2]),A=parseInt(b[3]);return`${T}-${String(k).padStart(2,"0")}-${String(A).padStart(2,"0")}`}const E=new Date(_);return isNaN(E.getTime())?new Date().toISOString().split("T")[0]:E.toISOString().split("T")[0]},m=async v=>{var y;const _=(y=v.target.files)==null?void 0:y[0];if(_)try{a(!0),i(""),c({added:0,updated:0,failed:0});const b=await _.arrayBuffer(),E=$s(b),T=E.Sheets[E.SheetNames[0]],k=Qe.sheet_to_json(T);if(k.length===0)throw new Error("Excel dosyas bo");console.log("Excel stun adlar:",Object.keys(k[0])),console.log("lk satr verisi:",k[0]);const{data:A}=await ee.auth.getUser();if(!A.user)throw new Error("Kullanc bulunamad");console.log("Seilen mteri ID:",f);let M=ee.from("policies").select("id, policy_number, license_plate, policy_type, client_id, agent_id, insurance_company_id");f&&(M=M.eq("client_id",f));const{data:B}=await M;console.log("Bulunan polie says:",(B==null?void 0:B.length)||0);const{data:G}=await ee.from("insurance_companies").select("id, name"),{data:U}=await ee.from("claims").select("id, claim_number, policy_id, claim_date");if(!B||!G||!U)throw new Error("Veriler yklenemedi");const ne=new Map(G.map(D=>[D.name.toLowerCase().trim(),D.id])),de=D=>{const R=D.toLowerCase().trim();console.log("Aranan irket:",`"${D}"`," normalize:",`"${R}"`);const te=ne.get(R);if(te)return console.log(" Tam eleme bulundu"),te;const F=R+" sigorta",q=ne.get(F);if(q)return console.log(' "sigorta" ekleyerek eleme bulundu'),q;for(const[X,L]of ne)if(X.includes(R)||R.includes(X))return console.log(" Ksmi eleme bulundu:",X),L;console.log(" Hi eleme bulunamad. Mevcut irketler:",Array.from(ne.keys()).join(", "))},oe=new Map;B.forEach(D=>{if(D.policy_number&&D.insurance_company_id){const R=`${D.policy_number.toLowerCase()}-${D.insurance_company_id}-${(D.policy_type||"").toLowerCase()}`;oe.set(R,D)}});const Y=new Map;B.forEach(D=>{if(D.license_plate){const R=String(D.license_plate).replace(/\s+/g,"").toUpperCase();Y.has(R)||Y.set(R,[]),Y.get(R).push(D)}});const se=new Map(U.map(D=>{var R;return[(R=D.claim_number)==null?void 0:R.toLowerCase(),D]}));let Z=0,H=0,ae=0;const K=[],P=[],V=[];for(const D of k)try{let R=null,te=null;if(D["Sigorta irketi"]){const ve=String(D["Sigorta irketi"]);te=de(ve),te||console.warn(`Sigorta irketi bulunamad: "${ve}" (Dosya: ${D["Dosya No"]})`)}const F=D["Polie Tr"]?String(D["Polie Tr"]).toLowerCase().trim():"",q=x(D["Hasar Tarihi"]);if(D["Polie No"]){const ve=String(D["Polie No"]).toLowerCase();let Te=B.filter(he=>{var Ue;return((Ue=he.policy_number)==null?void 0:Ue.toLowerCase())===ve});Te.length>0&&te&&(Te=Te.filter(he=>he.insurance_company_id===te)),Te.length>0&&(R=Te[0])}const X=D["deme Tutar"];let L=0;if(typeof X=="number")L=X;else if(typeof X=="string"){const ve=X.replace(/[^\d,.-]/g,"").replace(/\./g,"").replace(",",".");L=parseFloat(ve)||0}const J=L>0?"closed":"open",j=f||(R==null?void 0:R.client_id)||null;if(console.log("lenen satr:",{dosyaNo:D["Dosya No"],selectedClientId:f,policyClientId:R==null?void 0:R.client_id,finalClientId:j}),!j){const ve=D["Dosya No"]||D["Polie No"]||"Bilinmeyen";K.push(`Mteri bulunamad: ${ve} - Ltfen mteri sein veya geerli bir polie eletirin`),ae++;continue}const ke={claim_number:D["Dosya No"]||`HS-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,policy_id:(R==null?void 0:R.id)||null,client_id:j,agent_id:(r==null?void 0:r.id)||null,insurance_company_id:te||null,claim_date:q,payment_amount:isNaN(L)?0:L,license_plate:D.Plaka||null,policy_type:F||null,description:R?null:`Eski polie - Polie No: ${D["Polie No"]||"Yok"}`,claim_type:D["Hasar Nedeni"]||"Belirtilmemi",status:J};let ue=null;D["Dosya No"]&&(ue=se.get(String(D["Dosya No"]).toLowerCase())),ue?(V.push({...ke,id:ue.id}),H++):(P.push(ke),Z++)}catch(R){const te=D["Dosya No"]||D["Polie No"]||"Bilinmeyen",F=R instanceof Error?R.message:JSON.stringify(R);K.push(`${te}: ${F}`),ae++}if(P.length>0){const{error:D}=await ee.from("claims").insert(P);if(D)throw console.error("Toplu ekleme hatas:",D),D}for(const D of V){const{id:R,...te}=D,{error:F}=await ee.from("claims").update(te).eq("id",R);F&&console.error("Gncelleme hatas:",F)}c({added:Z,updated:H,failed:ae}),K.length>0&&(console.log("Detayl hatalar:",K.slice(0,10)),ae===k.length&&i(`Tm kaytlar baarsz. lk hatalar: ${K.slice(0,3).join(", ")}`)),(Z>0||H>0)&&setTimeout(()=>{t()},2e3)}catch(b){i(b.message||"Ykleme srasnda hata olutu")}finally{a(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Toplu Hasar Ykleme"}),l.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition",children:l.jsx(Kt,{className:"w-6 h-6"})})]}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex gap-3",children:[l.jsx(Rt,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"text-sm text-blue-800",children:[l.jsx("p",{className:"font-semibold mb-2",children:"Nasl alr?"}),l.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[l.jsx("li",{children:"Mteri seerek sadece o mterinin polieleriyle eletirebilirsiniz"}),l.jsx("li",{children:"Polie Tr (Kasko/Trafik) belirtilmesi nemlidir"}),l.jsx("li",{children:"Eletirme: Mteri + Polie No + Sigorta irketi + Polie Tr"}),l.jsx("li",{children:"Dosya No ayn olan kaytlar gncellenir"}),l.jsx("li",{children:"Tarih format: 15.01.2024 veya 15/01/2024"})]})]})]})}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mteri Se (Opsiyonel)"}),l.jsxs("select",{value:f,onChange:v=>h(v.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Tm Mteriler"}),u.map(v=>l.jsxs("option",{value:v.id,children:[v.name," ",v.tax_number?`(${v.tax_number})`:""]},v.id))]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Mteri seerseniz, sadece o mterinin polieleriyle eletirilir"})]}),l.jsxs("button",{onClick:p,className:"w-full flex items-center justify-center gap-2 bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700 transition",children:[l.jsx(Qr,{className:"w-5 h-5"}),"Excel ablonunu ndir"]})]}),l.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[l.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:m,disabled:n,className:"hidden",id:"file-upload"}),l.jsxs("label",{htmlFor:"file-upload",className:`cursor-pointer flex flex-col items-center gap-3 ${n?"opacity-50 cursor-not-allowed":""}`,children:[l.jsx(Yn,{className:"w-12 h-12 text-gray-400"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-lg font-semibold text-gray-700",children:n?"Ykleniyor...":"Excel Dosyasn Se"}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"veya srkleyip brakn"})]})]})]}),s&&l.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex gap-3",children:[l.jsx(Rt,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),l.jsx("p",{className:"text-sm text-red-800",children:s})]})}),(o.added>0||o.updated>0||o.failed>0)&&l.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Eklenen:"}),l.jsx("span",{className:"text-sm font-bold text-green-600",children:o.added})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Gncellenen:"}),l.jsx("span",{className:"text-sm font-bold text-blue-600",children:o.updated})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Baarsz:"}),l.jsx("span",{className:"text-sm font-bold text-red-600",children:o.failed})]})]}),(o.added>0||o.updated>0)&&l.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex gap-3",children:[l.jsx(qr,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),l.jsx("p",{className:"text-sm text-green-800",children:"Ykleme baarl! Sayfa otomatik yenilenecek..."})]})})]})]})})}function DP(){var X;const{profile:e,isAdmin:t}=Pr(),[r,n]=z.useState([]),[a,s]=z.useState([]),[i,o]=z.useState(!0),[c,u]=z.useState(""),[d,f]=z.useState("date"),[h,g]=z.useState(""),[p,x]=z.useState(""),[m,v]=z.useState(!1),[_,y]=z.useState(!1),[b,E]=z.useState([]),[T,k]=z.useState([]),[A,M]=z.useState([]),[B,G]=z.useState([]),[U,ne]=z.useState(""),[de,oe]=z.useState(!1),[Y,se]=z.useState(1);z.useEffect(()=>{Z(),D()},[e]),z.useEffect(()=>{ae(),K()},[r,c,d,h,p]);const Z=async()=>{try{o(!0);let L=ee.from("claims").select("*, policy:policies(policy_number, license_plate, insurance_company:insurance_companies(*)), insurance_company:insurance_companies(*)");!t&&e&&(L=L.eq("client_id",e.id));const{data:J,error:j}=await L.order("created_at",{ascending:!1});if(j)throw j;n(J||[]);const ke=[...new Set(J==null?void 0:J.map(ve=>{var Te,he,Ue;return ve.policy_id?(he=(Te=ve.policy)==null?void 0:Te.insurance_company)==null?void 0:he.name:(Ue=ve.insurance_company)==null?void 0:Ue.name}).filter(Boolean))];k(ke.sort());const ue=[...new Set(J==null?void 0:J.map(ve=>ve.claim_type).filter(Boolean))];M(ue.sort())}catch(L){console.error("Error fetching claims:",L)}finally{o(!1)}},H=(L,J)=>{let j={label:"Ak",color:"bg-blue-100 text-blue-800"};return L==="rejected"?j={label:"Red Oldu",color:"bg-red-100 text-red-800"}:(L==="closed"||J>0)&&(j={label:"dendi",color:"bg-green-100 text-green-800"}),l.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-semibold ${j.color}`,children:j.label})},ae=()=>{let L=[...r];c&&(L=L.filter(J=>{var j,ke,ue,ve;return((j=J.claim_number)==null?void 0:j.toLowerCase().includes(c.toLowerCase()))||((ke=J.license_plate)==null?void 0:ke.toLowerCase().includes(c.toLowerCase()))||((ve=(ue=J.policy)==null?void 0:ue.policy_number)==null?void 0:ve.toLowerCase().includes(c.toLowerCase()))})),h&&(L=L.filter(J=>{var ke,ue,ve;return(J.policy_id?(ue=(ke=J.policy)==null?void 0:ke.insurance_company)==null?void 0:ue.name:(ve=J.insurance_company)==null?void 0:ve.name)===h})),p&&(L=L.filter(J=>J.claim_type===p)),L.sort((J,j)=>{var ke,ue;if(d==="date")return new Date(j.claim_date).getTime()-new Date(J.claim_date).getTime();if(d==="amount")return j.payment_amount-J.payment_amount;{const ve=J.license_plate||((ke=J.policy)==null?void 0:ke.license_plate)||"",Te=j.license_plate||((ue=j.policy)==null?void 0:ue.license_plate)||"",he=r.filter(Ke=>{var nt;return(Ke.license_plate||((nt=Ke.policy)==null?void 0:nt.license_plate))===ve}).length;return r.filter(Ke=>{var nt;return(Ke.license_plate||((nt=Ke.policy)==null?void 0:nt.license_plate))===Te}).length-he}}),s(L)},K=()=>{const L={};r.forEach(j=>{var ue;const ke=j.license_plate||((ue=j.policy)==null?void 0:ue.license_plate)||"Bilinmeyen";L[ke]||(L[ke]={count:0,total:0}),L[ke].count++,L[ke].total+=Number(j.payment_amount)});const J=Object.entries(L).map(([j,ke])=>({plate:j,count:ke.count,total:ke.total}));J.sort((j,ke)=>ke.total-j.total),E(J.slice(0,5))},P=L=>`${L.toLocaleString("tr-TR",{minimumFractionDigits:2})}`,V=L=>new Date(L).toLocaleDateString("tr-TR"),D=async()=>{try{const{data:L}=await ee.auth.getUser();if(!L.user)return;const{data:J,error:j}=await ee.from("clients").select("id, name").eq("agent_id",L.user.id).order("name");if(j)throw j;G(J||[])}catch(L){console.error("Error fetching clients:",L)}},R=async()=>{const{default:L}=await Ya(async()=>{const{default:ve}=await Promise.resolve().then(()=>kf);return{default:ve}},void 0),J=a.map(ve=>{var Te,he;return{"Hasar No":ve.claim_number,Mteri:((Te=ve.clients)==null?void 0:Te.full_name)||"-",Plaka:ve.plate_number||"-","Polie Tr":ve.policy_type||"-","Sigorta irketi":((he=ve.insurance_companies)==null?void 0:he.name)||"-","Hasar Tarihi":new Date(ve.claim_date).toLocaleDateString("tr-TR"),Aklama:ve.description,"deme Tutar":Number(ve.payment_amount).toLocaleString("tr-TR",{style:"currency",currency:"TRY"}),Durum:ve.status||"Beklemede"}}),j=L.utils.json_to_sheet(J),ke=L.utils.book_new();L.utils.book_append_sheet(ke,j,"Hasarlar");const ue=`Hasarlar_${new Date().toLocaleDateString("tr-TR").replace(/\./g,"-")}.xlsx`;L.writeFile(ke,ue)},te=async L=>{if(confirm(`Bu hasar kalc olarak silmek istediinize emin misiniz?

Bu ilem geri alnamaz!`))try{const{error:J}=await ee.from("claims").delete().eq("id",L);if(J)throw J;alert(" Hasar baaryla silindi"),await Z()}catch(J){console.error("Hasar silinirken hata:",J),alert(" Hasar silinirken hata olutu: "+J.message)}},F=()=>{if(!U){alert("Ltfen bir mteri sein");return}se(1),oe(!0)},q=async()=>{if(Y===1){se(2);return}try{const{data:L}=await ee.auth.getUser();if(!L.user)return;const{data:J}=await ee.from("claims").select("id").eq("client_id",U).eq("agent_id",L.user.id);if(!J||J.length===0){alert("Bu mteriye ait hasar bulunamad"),oe(!1),se(1);return}const{error:j}=await ee.from("claims").delete().eq("client_id",U).eq("agent_id",L.user.id);if(j)throw j;alert(` ${J.length} adet hasar baaryla silindi`),oe(!1),se(1),ne(""),await Z()}catch(L){console.error("Hasarlar silinirken hata:",L),alert(" Hasarlar silinirken hata olutu: "+L.message)}};return i?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Hasarlar"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Hasar kaytlar ve analizi"})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:R,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition",children:[l.jsx(Qr,{className:"w-5 h-5"}),"Excel ndir"]}),l.jsxs("button",{onClick:()=>{if(!t){alert("Sadece yneticiler toplu ykleme yapabilir");return}y(!0)},className:"flex items-center gap-2 bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition",children:[l.jsx(p0,{className:"w-5 h-5"}),"Excel Ykle"]}),l.jsxs("button",{onClick:()=>{if(!t){alert("Sadece yneticiler hasar ekleyebilir");return}v(!0)},className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition",children:[l.jsx(Yi,{className:"w-5 h-5"}),"Yeni Hasar"]})]})]}),l.jsx("div",{className:"mb-6 bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(Os,{className:"w-5 h-5 text-gray-600"}),l.jsxs("select",{value:U,onChange:L=>ne(L.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"Mteri sein..."}),B.map(L=>l.jsx("option",{value:L.id,children:L.name},L.id))]}),l.jsxs("button",{onClick:F,disabled:!U,className:"flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(Ds,{className:"w-5 h-5"}),"Seili Mterinin Tm Hasarlarn Sil"]})]})}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[l.jsxs("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"space-y-4 mb-6",children:[l.jsxs("div",{className:"relative",children:[l.jsx(Qi,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",value:c,onChange:L=>u(L.target.value),placeholder:"Hasar no, plaka veya polie ara...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[l.jsxs("select",{value:h,onChange:L=>g(L.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Tm Sigorta irketleri"}),T.map(L=>l.jsx("option",{value:L,children:L},L))]}),l.jsxs("select",{value:p,onChange:L=>x(L.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Tm Hasar ekilleri"}),A.map(L=>l.jsx("option",{value:L,children:L},L))]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Sh,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}),l.jsxs("select",{value:d,onChange:L=>f(L.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"date",children:"Tarihe Gre"}),l.jsx("option",{value:"amount",children:"En Byk Tutar"}),l.jsx("option",{value:"count",children:"En ok Hasar Adedi"})]})]})]}),(h||p)&&l.jsxs("div",{className:"flex gap-2",children:[h&&l.jsxs("button",{onClick:()=>g(""),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm hover:bg-blue-200 transition",children:[h," "]}),p&&l.jsxs("button",{onClick:()=>x(""),className:"px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm hover:bg-blue-200 transition",children:[p," "]})]})]}),l.jsxs("div",{className:"space-y-3",children:[a.map(L=>{var J,j,ke,ue,ve,Te;return l.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:border-blue-300 hover:shadow-sm transition",children:[l.jsxs("div",{className:"flex items-start justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-red-100 rounded-lg p-2",children:l.jsx(Rt,{className:"w-5 h-5 text-red-600"})}),l.jsxs("div",{children:[l.jsxs("h4",{className:"font-semibold text-gray-900",children:[l.jsx("span",{className:"text-xs text-gray-500 font-normal mr-1",children:"Hasar:"}),L.claim_number||"Hasar No Yok"]}),l.jsxs("p",{className:"text-sm text-gray-600",children:[l.jsx("span",{className:"text-xs text-gray-400 mr-1",children:"Polie:"}),((J=L.policy)==null?void 0:J.policy_number)||"Polie Yok"]})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"text-right",children:[L.payment_amount>0&&l.jsx("div",{className:"text-lg font-bold text-red-600 mb-1",children:P(L.payment_amount)}),H(L.status||"open",L.payment_amount)]}),l.jsx("button",{onClick:()=>te(L.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition",title:"Hasar Sil",children:l.jsx(Ds,{className:"w-4 h-4"})})]})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"Tarih:"}),l.jsx("p",{className:"font-medium",children:V(L.claim_date)})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"Hasar ekli:"}),l.jsx("p",{className:"font-medium",children:L.claim_type})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"Sigorta irketi:"}),l.jsx("p",{className:"font-medium",children:L.policy_id?((ke=(j=L.policy)==null?void 0:j.insurance_company)==null?void 0:ke.name)||"Bilinmiyor":((ue=L.insurance_company)==null?void 0:ue.name)||"Bilinmiyor"})]}),(L.license_plate||((ve=L.policy)==null?void 0:ve.license_plate))&&l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"Plaka:"}),l.jsx("p",{className:"font-medium",children:L.policy_id&&((Te=L.policy)==null?void 0:Te.license_plate)||L.license_plate})]}),L.description&&l.jsxs("div",{className:"col-span-2 md:col-span-4",children:[l.jsx("span",{className:"text-gray-500",children:"Aklama:"}),l.jsx("p",{className:"font-medium text-sm",children:L.description})]})]})]},L.id)}),a.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Rt,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Henz hasar kayd bulunmuyor"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"En ok Hasar Yapan Aralar"}),l.jsxs("div",{className:"space-y-3",children:[b.map((L,J)=>l.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"flex items-center justify-center w-6 h-6 bg-blue-600 text-white text-xs font-bold rounded-full",children:J+1}),l.jsx("span",{className:"font-semibold text-gray-900",children:L.plate})]}),J===0?l.jsx(Ka,{className:"w-5 h-5 text-red-500"}):l.jsx(Wv,{className:"w-5 h-5 text-gray-400"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500",children:"Hasar Says"}),l.jsx("p",{className:"font-bold text-gray-900",children:L.count})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500",children:"Toplam Tutar"}),l.jsx("p",{className:"font-bold text-red-600",children:P(L.total)})]})]})]},L.plate)),b.length===0&&l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500 text-sm",children:"Henz veri yok"})})]})]})]}),m&&l.jsx(FP,{onClose:()=>v(!1),onSuccess:()=>{v(!1),Z()}}),_&&l.jsx(PP,{onClose:()=>y(!1),onSuccess:()=>{y(!1),Z()}}),de&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx("div",{className:"bg-red-100 rounded-full p-3",children:l.jsx(Rt,{className:"w-6 h-6 text-red-600"})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900",children:Y===1?"Onay 1/2":"Onay 2/2 - Son Uyar"})]}),l.jsx("div",{className:"mb-6",children:Y===1?l.jsxs("div",{className:"space-y-3",children:[l.jsxs("p",{className:"text-gray-700",children:[l.jsx("span",{className:"font-semibold",children:(X=B.find(L=>L.id===U))==null?void 0:X.name})," mterisinin tm hasarlarn silmek zeresiniz."]}),l.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:l.jsx("p",{className:"text-sm text-yellow-800",children:"Bu ilem geri alnamaz. Devam etmek istediinize emin misiniz?"})})]}):l.jsxs("div",{className:"space-y-3",children:[l.jsx("p",{className:"text-gray-700 font-semibold",children:"SON UYARI: Bu ilem geri alnamaz!"}),l.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:l.jsx("p",{className:"text-sm text-red-800",children:"Tm hasarlar kalc olarak silinecektir. Bu ilemi geri almanz mmkn olmayacak."})}),l.jsx("p",{className:"text-gray-700",children:"Silmek iin onaylayn:"})]})}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:()=>{oe(!1),se(1)},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition",children:"ptal"}),l.jsx("button",{onClick:q,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition",children:Y===1?"Devam Et":"Evet, Sil"})]})]})})]})}function OP({client:e,onClose:t,onSuccess:r}){const[n,a]=z.useState(e.email||""),[s,i]=z.useState(""),[o,c]=z.useState(""),[u,d]=z.useState(!1),[f,h]=z.useState(""),g=async p=>{if(p.preventDefault(),h(""),!n){h("Email adresi gereklidir");return}if(s.length<6){h("ifre en az 6 karakter olmaldr");return}if(s!==o){h("ifreler elemiyor");return}d(!0);try{const{data:x,error:m}=await ee.auth.signUp({email:n,password:s});if(m)throw m;if(x.user){const{error:v}=await ee.from("profiles").insert([{id:x.user.id,email:n,full_name:e.name,role:"client",is_verified:!0}]);if(v)throw v;const{error:_}=await ee.from("clients").update({user_id:x.user.id,password_set:!0,email:n}).eq("id",e.id);if(_)throw _;alert(`Mteri hesab baaryla oluturuldu!

Email: ${n}
ifre: ${s}

Bu bilgileri mterinizle paylan.`),r()}}catch(x){console.error("Error creating account:",x),h(x.message||"Hesap oluturulurken hata olutu")}finally{d(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:l.jsx(Uv,{className:"w-6 h-6 text-blue-600"})}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Mteri Hesab Olutur"})]}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:l.jsx(Kt,{className:"w-6 h-6"})})]}),l.jsxs("form",{onSubmit:g,className:"p-6 space-y-4",children:[l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:l.jsxs("p",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:e.name})," iin bir giri hesab oluturun. Mteri bu bilgilerle sisteme giri yaparak kendi polie ve hasarlarn grntleyebilecek."]})}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Adresi"}),l.jsx("input",{type:"email",value:n,onChange:p=>a(p.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ornek@email.com"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ifre"}),l.jsx("input",{type:"password",value:s,onChange:p=>i(p.target.value),required:!0,minLength:6,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"En az 6 karakter"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ifre Tekrar"}),l.jsx("input",{type:"password",value:o,onChange:p=>c(p.target.value),required:!0,minLength:6,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"ifrenizi tekrar girin"})]}),f&&l.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:f}),l.jsxs("div",{className:"flex gap-3 pt-4",children:[l.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"ptal"}),l.jsx("button",{type:"submit",disabled:u,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:u?"Oluturuluyor...":"Hesap Olutur"})]})]})]})})}function RP(){const[e,t]=z.useState([]),[r,n]=z.useState([]),[a,s]=z.useState(!0),[i,o]=z.useState(""),[c,u]=z.useState(!1),[d,f]=z.useState(!1),[h,g]=z.useState(null);z.useEffect(()=>{p()},[]),z.useEffect(()=>{if(i.trim()==="")n(e);else{const m=i.toLowerCase(),v=e.filter(_=>{var y,b,E,T;return _.name.toLowerCase().includes(m)||((y=_.tc_number)==null?void 0:y.includes(m))||((b=_.tax_number)==null?void 0:b.includes(m))||((E=_.phone)==null?void 0:E.includes(m))||((T=_.email)==null?void 0:T.toLowerCase().includes(m))});n(v)}},[i,e]);const p=async()=>{try{const{data:m}=await ee.auth.getUser();if(!m.user)return;const{data:v,error:_}=await ee.from("clients").select("*").eq("agent_id",m.user.id).order("created_at",{ascending:!1});if(_)throw _;const y=await Promise.all((v||[]).map(async b=>{const{count:E}=await ee.from("policies").select("*",{count:"exact",head:!0}).eq("client_id",b.id).eq("is_deleted",!1),{count:T}=await ee.from("claims").select("*",{count:"exact",head:!0}).eq("client_id",b.id);return{...b,policy_count:E||0,claim_count:T||0}}));t(y),n(y)}catch(m){console.error("Error loading clients:",m)}finally{s(!1)}},x=async m=>{if(m.policy_count>0||m.claim_count>0){alert(`Bu mterinin ${m.policy_count} poliesi ve ${m.claim_count} hasar var. nce bunlar silmeniz gerekiyor.`);return}if(confirm(`${m.name} mterisini silmek istediinize emin misiniz?`))try{const{error:v}=await ee.from("clients").delete().eq("id",m.id);if(v)throw v;alert("Mteri baaryla silindi!"),p()}catch(v){console.error("Error deleting client:",v),alert("Mteri silinirken hata olutu: "+v.message)}};return a?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Mteriler"}),l.jsxs("p",{className:"text-gray-600 mt-1",children:["Toplam ",e.length," mteri"]})]}),l.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(Eh,{className:"w-5 h-5"}),"Yeni Mteri"]})]}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:l.jsxs("div",{className:"relative",children:[l.jsx(Qi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),l.jsx("input",{type:"text",placeholder:"Mteri ad, TC No, Vergi No, telefon veya email ile ara...",value:i,onChange:m=>o(m.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),r.length===0?l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[l.jsx(Os,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:i?"Mteri bulunamad":"Henz mteri eklenmemi"}),l.jsx("p",{className:"text-gray-600",children:i?"Arama kriterlerinize uygun mteri bulunamad.":"Yeni mteri eklemek iin yukardaki butona tklayn."})]}):l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mteri Ad"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"TC / Vergi No"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"letiim"}),l.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Polie"}),l.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hasar"}),l.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Hesap Durumu"}),l.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"lemler"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(m=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(Os,{className:"h-5 w-5 text-blue-600"})}),l.jsxs("div",{className:"ml-4",children:[l.jsx("div",{className:"text-sm font-medium text-gray-900",children:m.name}),m.address&&l.jsx("div",{className:"text-xs text-gray-500",children:m.address})]})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"text-sm text-gray-900",children:[m.tc_number&&l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"text-xs text-gray-500",children:"TC:"}),l.jsx("span",{children:m.tc_number})]}),m.tax_number&&l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"text-xs text-gray-500",children:"VN:"}),l.jsx("span",{children:m.tax_number})]})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{className:"text-sm text-gray-900",children:[m.phone&&l.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[l.jsx(Hv,{className:"w-3 h-3 text-gray-400"}),l.jsx("span",{children:m.phone})]}),m.email&&l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(zv,{className:"w-3 h-3 text-gray-400"}),l.jsx("span",{className:"text-xs",children:m.email})]})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[l.jsx(gn,{className:"w-3 h-3 mr-1"}),m.policy_count]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:l.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[l.jsx(gn,{className:"w-3 h-3 mr-1"}),m.claim_count]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:m.password_set?l.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Aktif"}):l.jsxs("button",{onClick:()=>{g(m),f(!0)},className:"inline-flex items-center px-3 py-1 text-xs font-medium text-blue-700 bg-blue-100 rounded-full hover:bg-blue-200 transition-colors",children:[l.jsx(Uv,{className:"w-3 h-3 mr-1"}),"Hesap Olutur"]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:l.jsx("button",{onClick:()=>x(m),className:"text-red-600 hover:text-red-900 transition-colors",title:"Sil",children:l.jsx(Ds,{className:"w-5 h-5"})})})]},m.id))})]})})}),c&&l.jsx(a2,{onClose:()=>u(!1),onSuccess:()=>{u(!1),p()}}),d&&h&&l.jsx(OP,{client:h,onClose:()=>{f(!1),g(null)},onSuccess:()=>{f(!1),g(null),p()}})]})}function IP(){const{profile:e,isAdmin:t}=Pr(),[r,n]=z.useState(!0),[a,s]=z.useState(""),[i,o]=z.useState(""),[c,u]=z.useState([]),[d,f]=z.useState([]),[h,g]=z.useState([]),[p,x]=z.useState(""),[m,v]=z.useState(""),[_,y]=z.useState(""),[b,E]=z.useState("company"),[T,k]=z.useState([]),[A,M]=z.useState([]),[B,G]=z.useState([]),[U,ne]=z.useState([]),[de,oe]=z.useState("loss_ratio"),[Y,se]=z.useState("loss_ratio");z.useEffect(()=>{const F=new Date,q=new Date(F.getFullYear()-1,F.getMonth(),F.getDate());s(q.toISOString().split("T")[0]),o(F.toISOString().split("T")[0]),Z()},[]);const Z=async()=>{try{const[{data:F},{data:q}]=await Promise.all([ee.from("clients").select("id, name").order("name"),ee.from("insurance_companies").select("id, name").order("name")]);f(F||[]),g(q||[])}catch(F){console.error("Error fetching filters:",F)}};z.useEffect(()=>{a&&i&&H()},[a,i,e,p,m,_]);const H=async()=>{try{n(!0);let F=ee.from("policies").select("insurance_company_id, client_id, premium_amount, policy_type, insurance_company:insurance_companies(name)").gte("start_date",a).lte("start_date",i),q=ee.from("claims").select("payment_amount, client_id, insurance_company_id, policy_type, insurance_company:insurance_companies(name)").gte("claim_date",a).lte("claim_date",i);!t&&e&&(F=F.eq("agent_id",e.id),q=q.eq("policy.agent_id",e.id)),p&&(F=F.eq("client_id",p),q=q.eq("client_id",p)),m&&(F=F.eq("insurance_company_id",Number(m)),q=q.eq("insurance_company_id",Number(m))),_&&(F=F.eq("policy_type",_),q=q.eq("policy_type",_));const[{data:X,error:L},{data:J,error:j}]=await Promise.all([F,q]);console.log("Analiz - Polie says:",X==null?void 0:X.length,"Hata:",L),console.log("Analiz - Hasar says:",J==null?void 0:J.length,"Hata:",j);const ke=new Set;X==null||X.forEach(xe=>xe.client_id&&ke.add(xe.client_id)),J==null||J.forEach(xe=>xe.client_id&&ke.add(xe.client_id));const ue=new Map;if(ke.size>0){const{data:xe}=await ee.from("clients").select("id, name").in("id",Array.from(ke));xe==null||xe.forEach(ye=>{ue.set(ye.id,ye.name)})}const ve={};X==null||X.forEach(xe=>{var je;const ye=((je=xe.insurance_company)==null?void 0:je.name)||"Bilinmeyen";ve[ye]||(ve[ye]={company_name:ye,total_premium:0,total_claims:0,loss_ratio:0,policy_count:0,claim_count:0}),ve[ye].total_premium+=Number(xe.premium_amount)||0,ve[ye].policy_count+=1}),J==null||J.forEach(xe=>{var je;const ye=((je=xe.insurance_company)==null?void 0:je.name)||"Bilinmeyen";ve[ye]||(ve[ye]={company_name:ye,total_premium:0,total_claims:0,loss_ratio:0,policy_count:0,claim_count:0}),ve[ye].total_claims+=Number(xe.payment_amount)||0,ve[ye].claim_count+=1});const Te=Object.values(ve).map(xe=>({...xe,loss_ratio:xe.total_premium>0?xe.total_claims/xe.total_premium*100:0}));Te.sort((xe,ye)=>ye.total_premium-xe.total_premium),u(Te);const he={};X==null||X.forEach(xe=>{const ye=ue.get(xe.client_id)||"Bilinmeyen";he[ye]||(he[ye]={company_name:ye,total_premium:0,total_claims:0,loss_ratio:0,policy_count:0,claim_count:0}),he[ye].total_premium+=Number(xe.premium_amount)||0,he[ye].policy_count+=1}),J==null||J.forEach(xe=>{const ye=ue.get(xe.client_id)||"Bilinmeyen";he[ye]||(he[ye]={company_name:ye,total_premium:0,total_claims:0,loss_ratio:0,policy_count:0,claim_count:0}),he[ye].total_claims+=Number(xe.payment_amount)||0,he[ye].claim_count+=1});const Ue=Object.values(he).map(xe=>({...xe,loss_ratio:xe.total_premium>0?xe.total_claims/xe.total_premium*100:0}));Ue.sort((xe,ye)=>ye.total_claims-xe.total_claims),k(Ue);const Ke={};X==null||X.forEach(xe=>{const ye=xe.policy_type||"Bilinmeyen";Ke[ye]||(Ke[ye]={company_name:ye,total_premium:0,total_claims:0,loss_ratio:0,policy_count:0,claim_count:0}),Ke[ye].total_premium+=Number(xe.premium_amount)||0,Ke[ye].policy_count+=1}),J==null||J.forEach(xe=>{const ye=xe.policy_type||"Bilinmeyen";Ke[ye]||(Ke[ye]={company_name:ye,total_premium:0,total_claims:0,loss_ratio:0,policy_count:0,claim_count:0}),Ke[ye].total_claims+=Number(xe.payment_amount)||0,Ke[ye].claim_count+=1});const nt=Object.values(Ke).map(xe=>({...xe,loss_ratio:xe.total_premium>0?xe.total_claims/xe.total_premium*100:0}));nt.sort((xe,ye)=>ye.total_claims-xe.total_claims),M(nt);const{data:pt}=await ee.from("policies").select("plate_number, premium_amount, start_date, end_date, policy_type").gte("start_date",a).lte("start_date",i).not("plate_number","is",null),{data:Ft}=await ee.from("claims").select("license_plate, payment_amount, claim_date, policy_type").gte("claim_date",a).lte("claim_date",i).not("license_plate","is",null),Ge={},gt=new Date;pt==null||pt.forEach(xe=>{var Ln;const ye=(Ln=xe.plate_number)==null?void 0:Ln.replace(/\s+/g,"").toUpperCase();if(!ye)return;Ge[ye]||(Ge[ye]={company_name:xe.plate_number,normalized_plate:ye,total_premium:0,earned_premium:0,total_claims:0,loss_ratio:0,policy_count:0,claim_count:0});const je=new Date(xe.start_date),vt=(new Date(xe.end_date).getTime()-je.getTime())/(1e3*60*60*24),at=Math.min((gt.getTime()-je.getTime())/(1e3*60*60*24),vt),lr=vt>0?Math.max(0,Math.min(at/vt,1)):0,br=Number(xe.premium_amount)*lr;Ge[ye].total_premium+=Number(xe.premium_amount)||0,Ge[ye].earned_premium+=br,Ge[ye].policy_count+=1}),Ft==null||Ft.forEach(xe=>{var je;const ye=(je=xe.license_plate)==null?void 0:je.replace(/\s+/g,"").toUpperCase();ye&&(Ge[ye]||(Ge[ye]={company_name:ye,total_premium:0,earned_premium:0,total_claims:0,loss_ratio:0,policy_count:0,claim_count:0}),Ge[ye].total_claims+=Number(xe.payment_amount)||0,Ge[ye].claim_count+=1)});let ir=Object.values(Ge).map(xe=>({...xe,loss_ratio:xe.earned_premium>0?xe.total_claims/xe.earned_premium*100:0}));G(ir);const it={};pt==null||pt.forEach(xe=>{const ye=xe.policy_type||"Bilinmeyen";it[ye]||(it[ye]={company_name:ye,total_premium:0,earned_premium:0,total_claims:0,loss_ratio:0,policy_count:0,claim_count:0});const je=new Date(xe.start_date),vt=(new Date(xe.end_date).getTime()-je.getTime())/(1e3*60*60*24),at=Math.min((gt.getTime()-je.getTime())/(1e3*60*60*24),vt),lr=vt>0?Math.max(0,Math.min(at/vt,1)):0,br=Number(xe.premium_amount)*lr;it[ye].total_premium+=Number(xe.premium_amount)||0,it[ye].earned_premium+=br,it[ye].policy_count+=1}),Ft==null||Ft.forEach(xe=>{const ye=xe.policy_type||"Bilinmeyen";it[ye]||(it[ye]={company_name:ye,total_premium:0,earned_premium:0,total_claims:0,loss_ratio:0,policy_count:0,claim_count:0}),it[ye].total_claims+=Number(xe.payment_amount)||0,it[ye].claim_count+=1});let zr=Object.values(it).map(xe=>({...xe,loss_ratio:xe.earned_premium>0?xe.total_claims/xe.earned_premium*100:0}));ne(zr)}catch(F){console.error("Error fetching analytics:",F)}finally{n(!1)}},ae=F=>`${F.toLocaleString("tr-TR",{minimumFractionDigits:2})}`,K=F=>`%${F.toFixed(2)}`,P=()=>{const F=Qe.book_new(),q=c.map(ue=>({"Sigorta irketi":ue.company_name,"Toplam Prim":ae(ue.total_premium),"Toplam Hasar demesi":ae(ue.total_claims),"Hasar/Prim Oran":K(ue.loss_ratio),"Polie Says":ue.policy_count,"Hasar Says":ue.claim_count})),X=T.map(ue=>({Mteri:ue.client_name,"Toplam Prim":ae(ue.total_premium),"Toplam Hasar demesi":ae(ue.total_claims),"Hasar/Prim Oran":K(ue.loss_ratio),"Polie Says":ue.policy_count,"Hasar Says":ue.claim_count})),L=A.map(ue=>({Bran:ue.branch_name,"Toplam Prim":ae(ue.total_premium),"Toplam Hasar demesi":ae(ue.total_claims),"Hasar/Prim Oran":K(ue.loss_ratio),"Polie Says":ue.policy_count,"Hasar Says":ue.claim_count})),J=B.map(ue=>({Plaka:ue.plate_number,"Toplam Hasar demesi":ae(ue.total_claims),"Hasar/Prim Oran":K(ue.loss_ratio),"Hasar Says":ue.claim_count})),j=U.map(ue=>({"Polie Tr":ue.policy_type,"Toplam Hasar demesi":ae(ue.total_claims),"Hasar/Prim Oran":K(ue.loss_ratio),"Hasar Says":ue.claim_count}));if(q.length>0){const ue=Qe.json_to_sheet(q);Qe.book_append_sheet(F,ue,"irket Analizi")}if(X.length>0){const ue=Qe.json_to_sheet(X);Qe.book_append_sheet(F,ue,"Mteri Analizi")}if(L.length>0){const ue=Qe.json_to_sheet(L);Qe.book_append_sheet(F,ue,"Bran Analizi")}if(J.length>0){const ue=Qe.json_to_sheet(J);Qe.book_append_sheet(F,ue,"Plaka Analizi")}if(j.length>0){const ue=Qe.json_to_sheet(j);Qe.book_append_sheet(F,ue,"Polie Tr Analizi")}const ke=`Analiz_Raporu_${a}_${i}.xlsx`;Hs(F,ke)},V=()=>{let F=b==="company"?c:b==="client"?T:b==="branch"?A:b==="plate"?B:U;if(b==="plate"||b==="policy_type"){const q=b==="plate"?de:Y,X=[...F];return q==="claim_count"?X.sort((L,J)=>J.claim_count-L.claim_count):q==="total_claims"?X.sort((L,J)=>J.total_claims-L.total_claims):X.sort((L,J)=>J.loss_ratio-L.loss_ratio),X}return F},R=c.reduce((F,q)=>({totalPremium:F.totalPremium+q.total_premium,totalClaims:F.totalClaims+q.total_claims,totalPolicies:F.totalPolicies+q.policy_count,totalClaimCount:F.totalClaimCount+q.claim_count}),{totalPremium:0,totalClaims:0,totalPolicies:0,totalClaimCount:0}),te=R.totalPremium>0?R.totalClaims/R.totalPremium*100:0;return l.jsxs("div",{children:[l.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Analiz & Raporlar"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Sigorta irketlerine gre hasar-prim analizi"})]}),l.jsxs("button",{onClick:P,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50",children:[l.jsx(Qr,{className:"w-5 h-5"}),"Excel ndir"]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[l.jsx(Kr,{className:"w-5 h-5 text-gray-600"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filtreler"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Balang Tarihi"}),l.jsx("input",{type:"date",value:a,onChange:F=>s(F.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Biti Tarihi"}),l.jsx("input",{type:"date",value:i,onChange:F=>o(F.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mteri"}),l.jsxs("select",{value:p,onChange:F=>x(F.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Tm"}),d.map(F=>l.jsx("option",{value:F.id,children:F.name},F.id))]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sigorta irketi"}),l.jsxs("select",{value:m,onChange:F=>v(F.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Tm"}),h.map(F=>l.jsx("option",{value:F.id,children:F.name},F.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bran"}),l.jsxs("select",{value:_,onChange:F=>y(F.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Tm"}),l.jsx("option",{value:"Kasko",children:"Kasko"}),l.jsx("option",{value:"Trafik",children:"Trafik"}),l.jsx("option",{value:"DASK",children:"DASK"}),l.jsx("option",{value:"Konut",children:"Konut"}),l.jsx("option",{value:"yeri",children:"yeri"}),l.jsx("option",{value:"Salk",children:"Salk"}),l.jsx("option",{value:"Hayat",children:"Hayat"}),l.jsx("option",{value:"Ferdi Kaza",children:"Ferdi Kaza"}),l.jsx("option",{value:"Seyahat",children:"Seyahat"}),l.jsx("option",{value:"IMM",children:"IMM"}),l.jsx("option",{value:"Nakliyat",children:"Nakliyat"}),l.jsx("option",{value:"Yangn",children:"Yangn"}),l.jsx("option",{value:"Mhendislik",children:"Mhendislik"}),l.jsx("option",{value:"Sorumluluk",children:"Sorumluluk"})]})]})]})]}),r?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[l.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-sm p-6 text-white",children:[l.jsx("h4",{className:"text-sm font-medium mb-2 opacity-90",children:"Toplam retim"}),l.jsx("p",{className:"text-2xl font-bold",children:ae(R.totalPremium)}),l.jsxs("p",{className:"text-xs opacity-75 mt-1",children:[R.totalPolicies," polie"]})]}),l.jsxs("div",{className:"bg-gradient-to-br from-red-500 to-red-600 rounded-xl shadow-sm p-6 text-white",children:[l.jsx("h4",{className:"text-sm font-medium mb-2 opacity-90",children:"Toplam Hasar"}),l.jsx("p",{className:"text-2xl font-bold",children:ae(R.totalClaims)}),l.jsxs("p",{className:"text-xs opacity-75 mt-1",children:[R.totalClaimCount," hasar"]})]}),l.jsxs("div",{className:"bg-gradient-to-br from-green-500 to-green-600 rounded-xl shadow-sm p-6 text-white",children:[l.jsx("h4",{className:"text-sm font-medium mb-2 opacity-90",children:"Hasar/Prim Oran"}),l.jsx("p",{className:"text-2xl font-bold",children:K(te)}),l.jsx("div",{className:"flex items-center gap-1 mt-1 text-xs",children:te<70?l.jsxs(l.Fragment,{children:[l.jsx(Wv,{className:"w-4 h-4"}),l.jsx("span",{children:"Dk risk"})]}):l.jsxs(l.Fragment,{children:[l.jsx(Ka,{className:"w-4 h-4"}),l.jsx("span",{children:"Yksek risk"})]})})]}),l.jsxs("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-sm p-6 text-white",children:[l.jsx("h4",{className:"text-sm font-medium mb-2 opacity-90",children:"retim Frekans"}),l.jsxs("p",{className:"text-2xl font-bold",children:[R.totalPolicies>0?(R.totalPremium/R.totalPolicies).toLocaleString("tr-TR",{minimumFractionDigits:0,maximumFractionDigits:0}):"0"," "]}),l.jsx("p",{className:"text-xs opacity-75 mt-1",children:"Ortalama prim"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl shadow-sm p-6 text-white",children:[l.jsx("h4",{className:"text-sm font-medium mb-2 opacity-90",children:"Hasar Frekans"}),l.jsxs("p",{className:"text-2xl font-bold",children:[R.totalPolicies>0?(R.totalClaimCount/R.totalPolicies*100).toFixed(1):"0","%"]}),l.jsxs("p",{className:"text-xs opacity-75 mt-1",children:[R.totalClaimCount,"/",R.totalPolicies," polie"]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Kl,{className:"w-5 h-5 text-gray-600"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Detayl Analiz"})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>E("company"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${b==="company"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Sigorta irketine Gre"}),t&&l.jsx("button",{onClick:()=>E("client"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${b==="client"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Mteriye Gre"}),l.jsx("button",{onClick:()=>E("branch"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${b==="branch"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Brana Gre"}),l.jsx("button",{onClick:()=>E("plate"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${b==="plate"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Plakaya Gre"}),l.jsx("button",{onClick:()=>E("policy_type"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${b==="policy_type"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Polie Trne Gre"})]})]}),(b==="plate"||b==="policy_type")&&l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sralama"}),l.jsxs("select",{value:b==="plate"?de:Y,onChange:F=>{const q=F.target.value;b==="plate"?oe(q):se(q)},className:"w-64 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"loss_ratio",children:"Hasar/Prim Oranna Gre (Yksekten De)"}),l.jsx("option",{value:"claim_count",children:"Alan Dosya Saysna Gre (oktan Aza)"}),l.jsx("option",{value:"total_claims",children:"Toplam Hasara Gre (Yksekten De)"})]})]}),l.jsxs("div",{className:"overflow-x-auto",children:[l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"border-b border-gray-200",children:[l.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-900",children:b==="company"?"Sigorta irketi":b==="client"?"Mteri":b==="branch"?"Bran":b==="plate"?"Plaka":"Polie Tr"}),l.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-900",children:"Polie Says"}),l.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-900",children:b==="plate"||b==="policy_type"?"Kazanlm Prim":"Toplam Prim"}),l.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-900",children:"Alan Dosya Says"}),l.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-900",children:"Toplam Hasar"}),l.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-900",children:"Hasar/Prim Oran"})]})}),l.jsx("tbody",{children:V().map(F=>l.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[l.jsx("td",{className:"py-4 px-4 font-medium text-gray-900",children:F.company_name}),l.jsx("td",{className:"py-4 px-4 text-right text-gray-700",children:F.policy_count}),l.jsx("td",{className:"py-4 px-4 text-right font-medium text-green-600",children:ae(b==="plate"||b==="policy_type"?F.earned_premium:F.total_premium)}),l.jsx("td",{className:"py-4 px-4 text-right text-gray-700",children:F.claim_count}),l.jsx("td",{className:"py-4 px-4 text-right font-medium text-red-600",children:ae(F.total_claims)}),l.jsx("td",{className:"py-4 px-4 text-right",children:l.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold ${F.loss_ratio<50?"bg-green-100 text-green-700":F.loss_ratio<70?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:K(F.loss_ratio)})})]},F.company_name))})]}),V().length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Kl,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Seili tarih aralnda veri bulunmuyor"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Hasar/Prim Oran Grafii"}),l.jsxs("div",{className:"space-y-4",children:[V().map(F=>{const q=V(),X=b==="plate"||b==="policy_type"?F.earned_premium:F.total_premium,L=Math.max(...q.map(ke=>b==="plate"||b==="policy_type"?ke.earned_premium:ke.total_premium)),J=L>0?X/L*100:0,j=X>0?F.total_claims/X*100:0;return l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-sm font-medium text-gray-900",children:F.company_name}),l.jsx("span",{className:"text-sm text-gray-600",children:K(F.loss_ratio)})]}),l.jsxs("div",{className:"relative h-8 bg-gray-100 rounded-lg overflow-hidden",children:[l.jsx("div",{className:"absolute h-full bg-blue-500 rounded-lg transition-all duration-500",style:{width:`${J}%`},children:l.jsx("span",{className:"absolute right-2 top-1/2 -translate-y-1/2 text-xs font-medium text-white",children:ae(X)})}),l.jsx("div",{className:"absolute h-full bg-red-500 rounded-lg transition-all duration-500",style:{width:`${Math.min(j,J)}%`}})]}),l.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-600",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),l.jsx("span",{children:"Prim"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("div",{className:"w-3 h-3 bg-red-500 rounded"}),l.jsx("span",{children:"Hasar"})]})]})]},F.company_name)}),V().length===0&&l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500 text-sm",children:"Grntlenecek veri yok"})})]})]})]})]})}function LP(){const{isAdmin:e,profile:t}=Pr(),[r,n]=z.useState(!0),[a,s]=z.useState(!1),[i,o]=z.useState(null),[c,u]=z.useState(""),[d,f]=z.useState("#1e40af"),[h,g]=z.useState(null),[p,x]=z.useState([]),[m,v]=z.useState(""),[_,y]=z.useState([]),[b,E]=z.useState(""),[T,k]=z.useState({email:"",password:"",full_name:"",company_name:""}),[A,M]=z.useState({show_policy_reminders:!0,show_premium_distribution:!0,show_policy_types:!0,show_claims_trend:!0,show_insurance_companies:!0}),[B,G]=z.useState(!1);z.useEffect(()=>{e&&(U(),ne(),de(),oe(),t!=null&&t.verification_code&&E(t.verification_code))},[e,t]);const U=async()=>{try{const{data:K}=await ee.from("settings").select("*").maybeSingle();K&&(o(K),u(K.company_name),f(K.primary_color))}catch(K){console.error("Error fetching settings:",K)}finally{n(!1)}},ne=async()=>{const{data:K}=await ee.from("insurance_companies").select("*").order("name");x(K||[])},de=async()=>{const{data:K}=await ee.from("profiles").select("*").eq("role","client").order("full_name");y(K||[])},oe=async()=>{try{const{data:{user:K}}=await ee.auth.getUser();if(!K)return;const{data:P}=await ee.from("dashboard_visibility_settings").select("*").eq("agent_id",K.id).maybeSingle();P&&M({show_policy_reminders:P.show_policy_reminders,show_premium_distribution:P.show_premium_distribution,show_policy_types:P.show_policy_types,show_claims_trend:P.show_claims_trend,show_insurance_companies:P.show_insurance_companies})}catch(K){console.error("Error fetching visibility settings:",K)}},Y=async()=>{G(!0);try{const{data:{user:K}}=await ee.auth.getUser();if(!K)throw new Error("User not found");const{data:P}=await ee.from("dashboard_visibility_settings").select("id").eq("agent_id",K.id).maybeSingle();P?await ee.from("dashboard_visibility_settings").update({...A,updated_at:new Date().toISOString()}).eq("agent_id",K.id):await ee.from("dashboard_visibility_settings").insert([{agent_id:K.id,...A}]),alert("Grnrlk ayarlar baaryla kaydedildi")}catch(K){console.error("Error saving visibility settings:",K),alert("Ayarlar kaydedilirken hata olutu: "+K.message)}finally{G(!1)}},se=async()=>{s(!0);try{let K=(i==null?void 0:i.logo_url)||"";if(h){const V=h.name.split(".").pop(),D=`logo_${Date.now()}.${V}`,{error:R}=await ee.storage.from("settings").upload(D,h,{upsert:!0});if(R)throw R;const{data:{publicUrl:te}}=ee.storage.from("settings").getPublicUrl(D);K=te}const P={company_name:c,primary_color:d,logo_url:K,updated_at:new Date().toISOString()};i?await ee.from("settings").update(P).eq("id",i.id):await ee.from("settings").insert([P]),alert("Ayarlar baaryla kaydedildi"),U()}catch(K){console.error("Error saving settings:",K),alert("Ayarlar kaydedilirken hata olutu: "+K.message)}finally{s(!1)}},Z=async()=>{if(!m.trim()){alert("Ltfen irket adn girin");return}try{const{error:K}=await ee.from("insurance_companies").insert([{name:m}]);if(K)throw K;v(""),ne(),alert("irket baaryla eklendi")}catch(K){console.error("Error adding company:",K),alert("irket eklenirken hata olutu: "+K.message)}},H=async K=>{if(confirm("Bu irketi silmek istediinizden emin misiniz?"))try{const{error:P}=await ee.from("insurance_companies").delete().eq("id",K);if(P)throw P;ne(),alert("irket baaryla silindi")}catch(P){console.error("Error deleting company:",P),alert("irket silinirken hata olutu: "+P.message)}},ae=async()=>{if(!T.email||!T.password||!T.full_name){alert("Ltfen tm zorunlu alanlar doldurun");return}try{const{data:K,error:P}=await ee.auth.signUp({email:T.email,password:T.password});if(P)throw P;if(K.user){const{data:V}=await ee.from("profiles").select("verification_code").eq("id",K.user.id).maybeSingle(),D=(V==null?void 0:V.verification_code)||(i==null?void 0:i.company_name)||"DEFAULT",{data:R}=await ee.rpc("generate_verification_code"),te=R,{error:F}=await ee.from("profiles").insert([{id:K.user.id,email:T.email,full_name:T.full_name,company_name:T.company_name,role:"client",verification_code:te,is_verified:!0}]);if(F)throw F;k({email:"",password:"",full_name:"",company_name:""}),de(),alert(`Mteri baaryla eklendi!

Dorulama Kodu: ${te}

Bu kodu mterinizle paylan.`)}}catch(K){console.error("Error adding client:",K),alert("Mteri eklenirken hata olutu: "+K.message)}};return e?r?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsxs("div",{children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Ayarlar"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Sistem ayarlarn ynetin"})]}),l.jsxs("div",{className:"space-y-6",children:[b&&l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl shadow-sm p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Dorulama Kodunuz"}),l.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Mterilerinizin sisteme giri yapabilmesi iin bu kodu paylan"}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("code",{className:"flex-1 bg-white px-4 py-3 rounded-lg text-2xl font-bold text-blue-600 tracking-wider border-2 border-blue-300",children:b}),l.jsx("button",{onClick:()=>{navigator.clipboard.writeText(b),alert("Dorulama kodu kopyaland!")},className:"px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition whitespace-nowrap",children:"Kopyala"})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Marka Ayarlar"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"irket Ad"}),l.jsx("input",{type:"text",value:c,onChange:K=>u(K.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ana Renk"}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("input",{type:"color",value:d,onChange:K=>f(K.target.value),className:"h-10 w-20 rounded cursor-pointer"}),l.jsx("input",{type:"text",value:d,onChange:K=>f(K.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Logo"}),l.jsxs("div",{className:"flex items-center gap-4",children:[(i==null?void 0:i.logo_url)&&l.jsx("img",{src:i.logo_url,alt:"Logo",className:"h-16 w-16 object-contain border border-gray-200 rounded"}),l.jsx("input",{type:"file",accept:"image/*",onChange:K=>{var P;return g(((P=K.target.files)==null?void 0:P[0])||null)},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),l.jsxs("button",{onClick:se,disabled:a,className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[l.jsx(uf,{className:"w-5 h-5"}),a?"Kaydediliyor...":"Kaydet"]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Sigorta irketleri"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:m,onChange:K=>v(K.target.value),placeholder:"Yeni irket ad",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),l.jsxs("button",{onClick:Z,className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition",children:[l.jsx(Yi,{className:"w-5 h-5"}),"Ekle"]})]}),l.jsx("div",{className:"space-y-2",children:p.map(K=>l.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[l.jsx("span",{className:"font-medium",children:K.name}),l.jsx("button",{onClick:()=>H(K.id),className:"text-red-600 hover:text-red-700",children:l.jsx(Kt,{className:"w-5 h-5"})})]},K.id))})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Mteri Dashboard Grnrlk Ayarlar"}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Mteri dashboard'unda hangi widget'larn grneceini belirleyin"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[A.show_policy_reminders?l.jsx(Pa,{className:"w-5 h-5 text-green-600"}):l.jsx(Nl,{className:"w-5 h-5 text-gray-400"}),l.jsx("span",{className:"font-medium text-gray-900",children:"Polie Hatrlatclar"})]}),l.jsx("input",{type:"checkbox",checked:A.show_policy_reminders,onChange:K=>M({...A,show_policy_reminders:K.target.checked}),className:"w-5 h-5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("label",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[A.show_premium_distribution?l.jsx(Pa,{className:"w-5 h-5 text-green-600"}):l.jsx(Nl,{className:"w-5 h-5 text-gray-400"}),l.jsx("span",{className:"font-medium text-gray-900",children:"Aylk Prim Dalm"})]}),l.jsx("input",{type:"checkbox",checked:A.show_premium_distribution,onChange:K=>M({...A,show_premium_distribution:K.target.checked}),className:"w-5 h-5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("label",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[A.show_policy_types?l.jsx(Pa,{className:"w-5 h-5 text-green-600"}):l.jsx(Nl,{className:"w-5 h-5 text-gray-400"}),l.jsx("span",{className:"font-medium text-gray-900",children:"Polie Trleri"})]}),l.jsx("input",{type:"checkbox",checked:A.show_policy_types,onChange:K=>M({...A,show_policy_types:K.target.checked}),className:"w-5 h-5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("label",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[A.show_claims_trend?l.jsx(Pa,{className:"w-5 h-5 text-green-600"}):l.jsx(Nl,{className:"w-5 h-5 text-gray-400"}),l.jsx("span",{className:"font-medium text-gray-900",children:"Hasar Trend Analizi"})]}),l.jsx("input",{type:"checkbox",checked:A.show_claims_trend,onChange:K=>M({...A,show_claims_trend:K.target.checked}),className:"w-5 h-5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("label",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[A.show_insurance_companies?l.jsx(Pa,{className:"w-5 h-5 text-green-600"}):l.jsx(Nl,{className:"w-5 h-5 text-gray-400"}),l.jsx("span",{className:"font-medium text-gray-900",children:"Sigorta irketleri"})]}),l.jsx("input",{type:"checkbox",checked:A.show_insurance_companies,onChange:K=>M({...A,show_insurance_companies:K.target.checked}),className:"w-5 h-5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"})]})]}),l.jsxs("button",{onClick:Y,disabled:B,className:"mt-4 flex items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[l.jsx(uf,{className:"w-5 h-5"}),B?"Kaydediliyor...":"Grnrlk Ayarlarn Kaydet"]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Mteri Ynetimi"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsx("input",{type:"email",value:T.email,onChange:K=>k({...T,email:K.target.value}),placeholder:"E-posta *",className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),l.jsx("input",{type:"password",value:T.password,onChange:K=>k({...T,password:K.target.value}),placeholder:"ifre *",className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),l.jsx("input",{type:"text",value:T.full_name,onChange:K=>k({...T,full_name:K.target.value}),placeholder:"Ad Soyad *",className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),l.jsx("input",{type:"text",value:T.company_name,onChange:K=>k({...T,company_name:K.target.value}),placeholder:"irket Ad",className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("button",{onClick:ae,className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition",children:[l.jsx(Yi,{className:"w-5 h-5"}),"Mteri Ekle"]}),l.jsxs("div",{className:"mt-6",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Mevcut Mteriler"}),l.jsx("div",{className:"space-y-2",children:_.map(K=>l.jsx("div",{className:"p-4 border border-gray-200 rounded-lg bg-gray-50",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-medium text-gray-900",children:K.full_name}),l.jsx("p",{className:"text-sm text-gray-600",children:K.email}),K.company_name&&l.jsx("p",{className:"text-sm text-gray-600",children:K.company_name})]}),K.verification_code&&l.jsxs("div",{className:"ml-4",children:[l.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Dorulama Kodu"}),l.jsx("code",{className:"bg-white px-3 py-1 rounded border border-blue-300 text-blue-600 font-bold text-sm",children:K.verification_code})]})]})},K.id))})]})]})]})]})]}):l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center",children:l.jsx("p",{className:"text-gray-600",children:"Bu sayfaya eriim yetkiniz yok"})})}function MP(){const[e,t]=z.useState([]),[r,n]=z.useState(!0),[a,s]=z.useState(!1),[i,o]=z.useState(null),[c,u]=z.useState({title:"",content:"",priority:"medium",is_active:!0,expires_at:""});z.useEffect(()=>{d()},[]);const d=async()=>{try{const{data:m,error:v}=await ee.from("announcements").select("*").order("created_at",{ascending:!1});if(v)throw v;t(m||[])}catch(m){console.error("Error fetching announcements:",m)}finally{n(!1)}},f=async m=>{var v;m.preventDefault(),n(!0);try{const{data:_}=await ee.auth.getUser(),y={...c,agent_id:(v=_.user)==null?void 0:v.id,expires_at:c.expires_at||null};if(i){const{error:b}=await ee.from("announcements").update(y).eq("id",i);if(b)throw b}else{const{error:b}=await ee.from("announcements").insert(y);if(b)throw b}await d(),s(!1),p()}catch(_){console.error("Error saving announcement:",_),alert("Duyuru kaydedilirken bir hata olutu.")}finally{n(!1)}},h=m=>{o(m.id),u({title:m.title,content:m.content,priority:m.priority,is_active:m.is_active,expires_at:m.expires_at||""}),s(!0)},g=async m=>{if(confirm("Bu duyuruyu silmek istediinizden emin misiniz?"))try{const{error:v}=await ee.from("announcements").delete().eq("id",m);if(v)throw v;await d()}catch(v){console.error("Error deleting announcement:",v),alert("Duyuru silinirken bir hata olutu.")}},p=()=>{u({title:"",content:"",priority:"medium",is_active:!0,expires_at:""}),o(null)},x=m=>{const v={high:"bg-red-100 text-red-700",medium:"bg-yellow-100 text-yellow-700",low:"bg-blue-100 text-blue-700"},_={high:"Yksek",medium:"Orta",low:"Dk"};return l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${v[m]}`,children:_[m]})};return l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Duyuru Ynetimi"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Mterilerinize duyurular oluturun ve ynetin"})]}),l.jsxs("button",{onClick:()=>{p(),s(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition",children:[l.jsx(Yi,{className:"w-5 h-5"}),"Yeni Duyuru"]})]}),r&&!a?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:l.jsxs("div",{className:"overflow-x-auto",children:[l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Balk"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"ncelik"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Durum"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Son Geerlilik"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Oluturma"}),l.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"lemler"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:e.map(m=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:m.title}),l.jsx("p",{className:"text-sm text-gray-600 line-clamp-1",children:m.content})]})}),l.jsx("td",{className:"px-6 py-4",children:x(m.priority)}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${m.is_active?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:m.is_active?"Aktif":"Pasif"})}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:m.expires_at?new Date(m.expires_at).toLocaleDateString("tr-TR"):"Sresiz"}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:new Date(m.created_at).toLocaleDateString("tr-TR")}),l.jsx("td",{className:"px-6 py-4 text-right",children:l.jsxs("div",{className:"flex items-center justify-end gap-2",children:[l.jsx("button",{onClick:()=>h(m),className:"text-blue-600 hover:text-blue-800",children:l.jsx(eN,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>g(m.id),className:"text-red-600 hover:text-red-800",children:l.jsx(Ds,{className:"w-4 h-4"})})]})})]},m.id))})]}),e.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(ua,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Henz duyuru bulunmuyor"})]})]})}),a&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900",children:i?"Duyuru Dzenle":"Yeni Duyuru"}),l.jsx("button",{onClick:()=>{s(!1),p()},className:"text-gray-500 hover:text-gray-700 transition",children:l.jsx(Kt,{className:"w-6 h-6"})})]}),l.jsxs("form",{onSubmit:f,className:"p-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Balk"}),l.jsx("input",{type:"text",value:c.title,onChange:m=>u({...c,title:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"erik"}),l.jsx("textarea",{value:c.content,onChange:m=>u({...c,content:m.target.value}),rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",required:!0})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ncelik"}),l.jsxs("select",{value:c.priority,onChange:m=>u({...c,priority:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"low",children:"Dk"}),l.jsx("option",{value:"medium",children:"Orta"}),l.jsx("option",{value:"high",children:"Yksek"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Son Geerlilik Tarihi"}),l.jsx("input",{type:"date",value:c.expires_at,onChange:m=>u({...c,expires_at:m.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"is_active",checked:c.is_active,onChange:m=>u({...c,is_active:m.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm text-gray-700",children:"Duyuru aktif"})]})]}),l.jsxs("div",{className:"flex gap-3 justify-end mt-6",children:[l.jsx("button",{type:"button",onClick:()=>{s(!1),p()},className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"ptal"}),l.jsx("button",{type:"submit",disabled:r,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:r?"Kaydediliyor...":i?"Gncelle":"Kaydet"})]})]})]})})]})}function BP(){const[e,t]=z.useState(!0),[r,n]=z.useState(!1),[a,s]=z.useState(!1),[i,o]=z.useState({agency_name:"",contact_person:"",phone:"",email:"",address:"",website:"",working_hours:""});z.useEffect(()=>{c()},[]);const c=async()=>{var d;try{const{data:f}=await ee.auth.getUser(),{data:h,error:g}=await ee.from("agency_info").select("*").eq("agent_id",(d=f.user)==null?void 0:d.id).maybeSingle();h&&(s(!0),o({agency_name:h.agency_name,contact_person:h.contact_person,phone:h.phone,email:h.email,address:h.address,website:h.website||"",working_hours:h.working_hours||""}))}catch(f){console.error("Error fetching agency info:",f)}finally{t(!1)}},u=async d=>{var f,h;d.preventDefault(),n(!0);try{const{data:g}=await ee.auth.getUser(),p={...i,agent_id:(f=g.user)==null?void 0:f.id,updated_at:new Date().toISOString()};if(a){const{error:x}=await ee.from("agency_info").update(p).eq("agent_id",(h=g.user)==null?void 0:h.id);if(x)throw x}else{const{error:x}=await ee.from("agency_info").insert(p);if(x)throw x;s(!0)}alert("Acente bilgileri baaryla kaydedildi!")}catch(g){console.error("Error saving agency info:",g),alert("Bilgiler kaydedilirken bir hata olutu.")}finally{n(!1)}};return e?l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"mb-8",children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Acente Bilgileri"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Mterilerinizin grecei acente iletiim bilgilerinizi dzenleyin"})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 max-w-3xl",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-6 border-b border-gray-200",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:l.jsx(kh,{className:"w-6 h-6 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"letiim Bilgileri"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Bu bilgiler mteri panelinde grntlenecektir"})]})]}),l.jsxs("form",{onSubmit:u,className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Acente Ad ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",value:i.agency_name,onChange:d=>o({...i,agency_name:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"rn: ABC Sigorta Acentesi",required:!0})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Yetkili Kii ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",value:i.contact_person,onChange:d=>o({...i,contact_person:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"rn: Ahmet Ylmaz",required:!0})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Telefon ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"tel",value:i.phone,onChange:d=>o({...i,phone:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"rn: 0212 123 45 67",required:!0})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["E-posta ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"email",value:i.email,onChange:d=>o({...i,email:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"rn: info@acente.com",required:!0})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Adres ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("textarea",{value:i.address,onChange:d=>o({...i,address:d.target.value}),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:"Tam adresinizi girin",required:!0})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Website"}),l.jsx("input",{type:"url",value:i.website,onChange:d=>o({...i,website:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"rn: https://www.acente.com"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"alma Saatleri"}),l.jsx("input",{type:"text",value:i.working_hours,onChange:d=>o({...i,working_hours:d.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"rn: Pzt-Cuma 09:00-18:00"})]})]}),l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("p",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Not:"}),' Bu bilgiler mteri panelinde "Acente letiim Bilgileri" kartnda grntlenir. Gncel ve doru bilgiler girdiinizden emin olun.']})}),l.jsx("div",{className:"flex justify-end pt-4",children:l.jsxs("button",{type:"submit",disabled:r,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:[l.jsx(uf,{className:"w-5 h-5"}),r?"Kaydediliyor...":a?"Gncelle":"Kaydet"]})})]})]})]})}function UP(){const[e,t]=z.useState([]),[r,n]=z.useState(!0),[a,s]=z.useState(null),[i,o]=z.useState("");z.useEffect(()=>{c();const m=ee.channel("customer_messages_changes").on("postgres_changes",{event:"*",schema:"public",table:"customer_messages"},()=>{c()}).subscribe();return()=>{m.unsubscribe()}},[]);const c=async()=>{var m;try{const{data:v}=await ee.auth.getUser(),{data:_,error:y}=await ee.from("customer_messages").select(`
          *,
          clients (
            full_name,
            email,
            phone
          )
        `).eq("agent_id",(m=v.user)==null?void 0:m.id).order("created_at",{ascending:!1});if(y)throw y;t(_||[])}catch(v){console.error("Error fetching messages:",v)}finally{n(!1)}},u=async m=>{if(s(m),m.status==="new")try{const{error:v}=await ee.from("customer_messages").update({status:"read",updated_at:new Date().toISOString()}).eq("id",m.id);if(v)throw v;await c()}catch(v){console.error("Error updating message status:",v)}},d=async(m,v)=>{try{const{error:_}=await ee.from("customer_messages").update({status:v,updated_at:new Date().toISOString()}).eq("id",m);if(_)throw _;await c(),(a==null?void 0:a.id)===m&&s({...a,status:v})}catch(_){console.error("Error updating message status:",_)}},f=m=>{const v={high:"bg-red-100 text-red-700",medium:"bg-yellow-100 text-yellow-700",low:"bg-blue-100 text-blue-700"},_={high:"Acil",medium:"Normal",low:"Dk"};return l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${v[m]}`,children:_[m]})},h=m=>{const v={new:"bg-blue-100 text-blue-700",read:"bg-purple-100 text-purple-700",replied:"bg-green-100 text-green-700",closed:"bg-gray-100 text-gray-700"},_={new:"Yeni",read:"Okundu",replied:"Yantland",closed:"Kapatld"};return l.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${v[m]}`,children:_[m]})},g=m=>{switch(m){case"new":return l.jsx(x0,{className:"w-4 h-4 text-blue-600"});case"read":return l.jsx(Pa,{className:"w-4 h-4 text-purple-600"});case"replied":return l.jsx(qr,{className:"w-4 h-4 text-green-600"});case"closed":return l.jsx(g0,{className:"w-4 h-4 text-gray-600"});default:return null}},p=i?e.filter(m=>m.status===i):e,x=e.filter(m=>m.status==="new").length;return r?l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:"Mteri Mesajlar"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Mterilerinizden gelen destek taleplerini grntleyin ve ynetin"})]}),x>0&&l.jsxs("div",{className:"bg-red-100 text-red-700 px-4 py-2 rounded-lg font-semibold",children:[x," Yeni Mesaj"]})]}),l.jsx("div",{className:"mb-4",children:l.jsxs("select",{value:i,onChange:m=>o(m.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsxs("option",{value:"",children:["Tm Mesajlar (",e.length,")"]}),l.jsxs("option",{value:"new",children:["Yeni (",e.filter(m=>m.status==="new").length,")"]}),l.jsxs("option",{value:"read",children:["Okundu (",e.filter(m=>m.status==="read").length,")"]}),l.jsxs("option",{value:"replied",children:["Yantland (",e.filter(m=>m.status==="replied").length,")"]}),l.jsxs("option",{value:"closed",children:["Kapatld (",e.filter(m=>m.status==="closed").length,")"]})]})}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"lg:col-span-1 bg-white rounded-xl shadow-sm border border-gray-200",children:[l.jsx("div",{className:"p-4 border-b border-gray-200",children:l.jsx("h3",{className:"font-semibold text-gray-900",children:"Mesajlar"})}),l.jsxs("div",{className:"divide-y divide-gray-200 max-h-[600px] overflow-y-auto",children:[p.map(m=>l.jsxs("button",{onClick:()=>u(m),className:`w-full text-left p-4 hover:bg-gray-50 transition ${(a==null?void 0:a.id)===m.id?"bg-blue-50":""} ${m.status==="new"?"bg-blue-50/50":""}`,children:[l.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[g(m.status),l.jsx("h4",{className:"font-semibold text-sm text-gray-900 line-clamp-1",children:m.subject})]}),f(m.priority)]}),l.jsx("p",{className:"text-sm text-gray-600 mb-2",children:m.clients.full_name}),l.jsx("p",{className:"text-xs text-gray-500 line-clamp-2 mb-2",children:m.message}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"text-xs text-gray-500",children:new Date(m.created_at).toLocaleDateString("tr-TR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})}),h(m.status)]})]},m.id)),p.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Ja,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Mesaj bulunmuyor"})]})]})]}),l.jsx("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-sm border border-gray-200",children:a?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"p-6 border-b border-gray-200",children:[l.jsxs("div",{className:"flex items-start justify-between gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:a.subject}),l.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[l.jsx("span",{className:"font-medium",children:a.clients.full_name}),l.jsx("span",{children:""}),l.jsx("span",{children:a.clients.email}),l.jsx("span",{children:""}),l.jsx("span",{children:a.clients.phone})]})]}),l.jsxs("div",{className:"flex flex-col gap-2 items-end",children:[f(a.priority),h(a.status)]})]}),l.jsx("p",{className:"text-sm text-gray-500",children:new Date(a.created_at).toLocaleDateString("tr-TR",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})})]}),l.jsxs("div",{className:"p-6",children:[l.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:l.jsx("p",{className:"text-gray-800 whitespace-pre-line",children:a.message})}),l.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[l.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Durum Gncelle"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>d(a.id,"read"),disabled:a.status==="read",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition disabled:opacity-50",children:"Okundu aretle"}),l.jsx("button",{onClick:()=>d(a.id,"replied"),disabled:a.status==="replied",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50",children:"Yantland aretle"}),l.jsx("button",{onClick:()=>d(a.id,"closed"),disabled:a.status==="closed",className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition disabled:opacity-50",children:"Kapat"})]}),l.jsxs("p",{className:"text-sm text-gray-600 mt-3",children:[l.jsx("strong",{children:"Not:"})," Mteriyle iletiim kurmak iin yukardaki telefon veya e-posta bilgilerini kullanabilirsiniz."]})]})]})]}):l.jsx("div",{className:"flex items-center justify-center h-full p-12",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Ja,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Grntlemek iin bir mesaj sein"})]})})})]})]})}function zP(){var b;const{profile:e}=Pr(),[t,r]=z.useState([]),[n,a]=z.useState(!0),[s,i]=z.useState("all"),[o,c]=z.useState(null),[u,d]=z.useState(!1),[f,h]=z.useState(""),[g,p]=z.useState(!1);z.useEffect(()=>{x()},[]);const x=async()=>{try{a(!0);const{data:E,error:T}=await ee.from("policy_renewal_requests").select(`
          *,
          policies (
            policy_number,
            policy_type,
            end_date,
            insurance_companies (name)
          ),
          clients (
            full_name,
            email,
            phone
          )
        `).order("created_at",{ascending:!1});if(T)throw T;r(E||[])}catch(E){console.error("Error fetching renewals:",E)}finally{a(!1)}},m=async(E,T)=>{try{p(!0);const{error:k}=await ee.from("policy_renewal_requests").update({status:T,admin_notes:f||null,processed_by:e==null?void 0:e.id,processed_at:new Date().toISOString()}).eq("id",E);if(k)throw k;alert(" Talep durumu gncellendi!"),d(!1),c(null),h(""),x()}catch(k){console.error("Error updating renewal:",k),alert(" Hata: "+k.message)}finally{p(!1)}},v=E=>{switch(E){case"pending":return l.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-xs font-medium",children:[l.jsx(x0,{className:"w-3 h-3"}),"Beklemede"]});case"approved":return l.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:[l.jsx(qr,{className:"w-3 h-3"}),"Onayland"]});case"rejected":return l.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-red-100 text-red-800 rounded-full text-xs font-medium",children:[l.jsx(g0,{className:"w-3 h-3"}),"Reddedildi"]});case"completed":return l.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium",children:[l.jsx(qr,{className:"w-3 h-3"}),"Tamamland"]});default:return null}},_=t.filter(E=>s==="all"?!0:E.status===s),y={total:t.length,pending:t.filter(E=>E.status==="pending").length,approved:t.filter(E=>E.status==="approved").length,completed:t.filter(E=>E.status==="completed").length};return l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Polie Yenileme Talepleri"}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Mterilerden gelen yenileme taleplerini ynetin"})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Toplam Talep"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:y.total})]}),l.jsx(Ji,{className:"w-10 h-10 text-blue-600"})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Bekleyen"}),l.jsx("p",{className:"text-2xl font-bold text-yellow-600 mt-1",children:y.pending})]}),l.jsx(x0,{className:"w-10 h-10 text-yellow-600"})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Onaylanan"}),l.jsx("p",{className:"text-2xl font-bold text-blue-600 mt-1",children:y.approved})]}),l.jsx(qr,{className:"w-10 h-10 text-blue-600"})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tamamlanan"}),l.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:y.completed})]}),l.jsx(qr,{className:"w-10 h-10 text-green-600"})]})})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[l.jsx("div",{className:"p-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("button",{onClick:()=>i("all"),className:`px-4 py-2 rounded-lg font-medium transition ${s==="all"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Tm (",y.total,")"]}),l.jsxs("button",{onClick:()=>i("pending"),className:`px-4 py-2 rounded-lg font-medium transition ${s==="pending"?"bg-yellow-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Bekleyen (",y.pending,")"]}),l.jsxs("button",{onClick:()=>i("approved"),className:`px-4 py-2 rounded-lg font-medium transition ${s==="approved"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Onaylanan (",y.approved,")"]}),l.jsxs("button",{onClick:()=>i("completed"),className:`px-4 py-2 rounded-lg font-medium transition ${s==="completed"?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["Tamamlanan (",y.completed,")"]})]})}),l.jsx("div",{className:"overflow-x-auto",children:n?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):_.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Ji,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Henz yenileme talebi bulunmuyor"})]}):l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Mteri"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Polie"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Polie Tr"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Biti Tarihi"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Talep Tarihi"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Durum"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"lem"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:_.map(E=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:E.clients.full_name}),l.jsx("p",{className:"text-xs text-gray-500",children:E.clients.email})]})}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:E.policies.policy_number}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:E.policies.policy_type}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:new Date(E.policies.end_date).toLocaleDateString("tr-TR")}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(E.created_at).toLocaleDateString("tr-TR")}),l.jsx("td",{className:"px-6 py-4",children:v(E.status)}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("button",{onClick:()=>{c(E),h(E.admin_notes||""),d(!0)},className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Detay"})})]},E.id))})]})})]}),u&&o&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsx("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Yenileme Talebi Detay"}),l.jsx("button",{onClick:()=>{d(!1),c(null),h("")},className:"text-gray-400 hover:text-gray-600",children:""})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(fN,{className:"w-4 h-4 text-blue-600"}),l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Mteri"})]}),l.jsx("p",{className:"font-semibold text-gray-900",children:o.clients.full_name}),l.jsx("p",{className:"text-sm text-gray-600",children:o.clients.email}),o.clients.phone&&l.jsx("p",{className:"text-sm text-gray-600",children:o.clients.phone})]}),l.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(gn,{className:"w-4 h-4 text-green-600"}),l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Polie Bilgileri"})]}),l.jsx("p",{className:"font-semibold text-gray-900",children:o.policies.policy_number}),l.jsx("p",{className:"text-sm text-gray-600",children:o.policies.policy_type}),l.jsx("p",{className:"text-sm text-gray-600",children:((b=o.policies.insurance_companies)==null?void 0:b.name)||"-"})]})]}),l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(Kr,{className:"w-4 h-4 text-gray-600"}),l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tarih Bilgileri"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500",children:"Polie Biti Tarihi"}),l.jsx("p",{className:"font-medium text-gray-900",children:new Date(o.policies.end_date).toLocaleDateString("tr-TR")})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-gray-500",children:"Talep Tarihi"}),l.jsx("p",{className:"font-medium text-gray-900",children:new Date(o.created_at).toLocaleDateString("tr-TR")})]})]})]}),o.request_notes&&l.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx(Ja,{className:"w-4 h-4 text-yellow-600"}),l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Mteri Notlar"})]}),l.jsx("p",{className:"text-sm text-gray-900",children:o.request_notes})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Notlar"}),l.jsx("textarea",{value:f,onChange:E=>h(E.target.value),placeholder:"Talep hakknda notlarnz...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:3,disabled:g})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Mevcut Durum:"}),v(o.status)]}),o.status==="pending"&&l.jsxs("div",{className:"flex gap-3",children:[l.jsx("button",{onClick:()=>m(o.id,"approved"),disabled:g,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:"Onayla"}),l.jsx("button",{onClick:()=>m(o.id,"rejected"),disabled:g,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition disabled:opacity-50",children:"Reddet"})]}),o.status==="approved"&&l.jsx("button",{onClick:()=>m(o.id,"completed"),disabled:g,className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition disabled:opacity-50",children:"Yenilemeyi Tamamla"})]})]})})})]})}function $P(){const[e,t]=z.useState([]),[r,n]=z.useState(!0),[a,s]=z.useState(""),[i,o]=z.useState("all");z.useState(null),z.useState(!1),z.useEffect(()=>{c()},[]);const c=async()=>{try{n(!0);const{data:p,error:x}=await ee.from("client_documents").select(`
          *,
          clients (
            full_name,
            email
          )
        `).order("created_at",{ascending:!1});if(x)throw x;t(p||[])}catch(p){console.error("Error fetching documents:",p)}finally{n(!1)}},u=async(p,x)=>{if(confirm("Bu dosyay silmek istediinizden emin misiniz?"))try{const{error:m}=await ee.storage.from("client-documents").remove([x]);if(m)throw m;const{error:v}=await ee.from("client_documents").delete().eq("id",p);if(v)throw v;alert(" Dosya baaryla silindi!"),c()}catch(m){console.error("Error deleting document:",m),alert(" Dosya silinirken hata olutu: "+m.message)}},d=async(p,x)=>{try{const{data:m,error:v}=await ee.storage.from("client-documents").download(p);if(v)throw v;const _=URL.createObjectURL(m),y=document.createElement("a");y.href=_,y.download=x,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(_)}catch(m){console.error("Error downloading document:",m),alert(" Dosya indirilirken hata olutu: "+m.message)}},f=p=>({ruhsat:"Ruhsat",ehliyet:"Ehliyet",hasar_fotografi:"Hasar Fotoraf",fatura:"Fatura",sozlesme:"Szleme",diger:"Dier"})[p]||p,h=e.filter(p=>{const x=p.document_name.toLowerCase().includes(a.toLowerCase())||p.clients.full_name.toLowerCase().includes(a.toLowerCase())||p.clients.email.toLowerCase().includes(a.toLowerCase()),m=i==="all"||p.document_type===i;return x&&m}),g={total:e.length,ruhsat:e.filter(p=>p.document_type==="ruhsat").length,ehliyet:e.filter(p=>p.document_type==="ehliyet").length,hasar:e.filter(p=>p.document_type==="hasar_fotografi").length};return l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dosya Ynetimi"}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Mteri dosyalarn grntleyin ve ynetin"})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Toplam Dosya"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:g.total})]}),l.jsx(ja,{className:"w-10 h-10 text-blue-600"})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Ruhsat"}),l.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:g.ruhsat})]}),l.jsx(ja,{className:"w-10 h-10 text-green-600"})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Ehliyet"}),l.jsx("p",{className:"text-2xl font-bold text-purple-600 mt-1",children:g.ehliyet})]}),l.jsx(ja,{className:"w-10 h-10 text-purple-600"})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Hasar Fotoraf"}),l.jsx("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:g.hasar})]}),l.jsx(ja,{className:"w-10 h-10 text-orange-600"})]})})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[l.jsx("div",{className:"p-4 border-b border-gray-200",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"relative",children:[l.jsx(Qi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),l.jsx("input",{type:"text",placeholder:"Dosya ad, mteri ara...",value:a,onChange:p=>s(p.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{className:"relative",children:[l.jsx(Sh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),l.jsxs("select",{value:i,onChange:p=>o(p.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent appearance-none",children:[l.jsx("option",{value:"all",children:"Tm Dosya Trleri"}),l.jsx("option",{value:"ruhsat",children:"Ruhsat"}),l.jsx("option",{value:"ehliyet",children:"Ehliyet"}),l.jsx("option",{value:"hasar_fotografi",children:"Hasar Fotoraf"}),l.jsx("option",{value:"fatura",children:"Fatura"}),l.jsx("option",{value:"sozlesme",children:"Szleme"}),l.jsx("option",{value:"diger",children:"Dier"})]})]})]})}),l.jsx("div",{className:"overflow-x-auto",children:r?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):h.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx(ja,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Dosya bulunamad"})]}):l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Dosya Ad"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Mteri"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tr"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Boyut"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Tarih"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"lemler"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:h.map(p=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ja,{className:"w-4 h-4 text-blue-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:p.document_name}),p.description&&l.jsx("p",{className:"text-xs text-gray-500",children:p.description})]})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:p.clients.full_name}),l.jsx("p",{className:"text-xs text-gray-500",children:p.clients.email})]})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:f(p.document_type)})}),l.jsxs("td",{className:"px-6 py-4 text-sm text-gray-900",children:[(p.file_size/1024).toFixed(1)," KB"]}),l.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(p.created_at).toLocaleDateString("tr-TR")}),l.jsx("td",{className:"px-6 py-4",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("button",{onClick:async()=>{const{data:x}=await ee.storage.from("client-documents").createSignedUrl(p.file_path,3600);x&&window.open(x.signedUrl,"_blank")},className:"text-blue-600 hover:text-blue-800",title:"Grntle",children:l.jsx(Pa,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>d(p.file_path,p.document_name),className:"text-green-600 hover:text-green-800",title:"ndir",children:l.jsx(Qr,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>u(p.id,p.file_path),className:"text-red-600 hover:text-red-800",title:"Sil",children:l.jsx(Ds,{className:"w-4 h-4"})})]})})]},p.id))})]})})]})]})}function HP(){const e=async()=>{try{const r=await(await fetch("/STN-SIGORTA-FINAL.tar.gz")).blob(),n=window.URL.createObjectURL(r),a=document.createElement("a");a.href=n,a.download="STN-SIGORTA-FINAL.tar.gz",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(n),document.body.removeChild(a)}catch(t){console.error("Download failed:",t),alert("ndirme baarsz! Ltfen tekrar deneyin.")}};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-600 via-purple-600 to-purple-800 flex items-center justify-center p-6",children:l.jsx("div",{className:"bg-white rounded-3xl shadow-2xl p-12 max-w-2xl w-full",children:l.jsxs("div",{className:"text-center",children:[l.jsx(tN,{className:"w-20 h-20 text-purple-600 mx-auto mb-6"}),l.jsx("h1",{className:"text-4xl font-bold text-gray-800 mb-3",children:"STN Sigorta Backup"}),l.jsx("p",{className:"text-gray-600 mb-8 text-lg",children:"Backup dosyanz hazr!"}),l.jsxs("button",{onClick:e,className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-10 py-4 rounded-full text-xl font-bold hover:shadow-2xl hover:scale-105 transition-all duration-300 flex items-center gap-3 mx-auto",children:[l.jsx(Qr,{className:"w-6 h-6"}),"Backup' ndir (341KB)"]}),l.jsx("div",{className:"mt-8 p-6 bg-blue-50 rounded-xl border-l-4 border-blue-600",children:l.jsxs("div",{className:"text-left space-y-2 text-sm text-gray-700",children:[l.jsxs("p",{children:[l.jsx("strong",{children:"Dosya:"})," STN-SIGORTA-FINAL.tar.gz"]}),l.jsxs("p",{children:[l.jsx("strong",{children:"Boyut:"})," 341 KB"]}),l.jsxs("p",{className:"flex items-center gap-2 text-green-600 font-semibold",children:[l.jsx(qr,{className:"w-4 h-4"}),"Tek dosya - Parasz"]})]})}),l.jsxs("div",{className:"mt-8 p-6 bg-gray-50 rounded-xl text-left",children:[l.jsxs("h3",{className:"text-lg font-bold text-purple-600 mb-4 flex items-center gap-2",children:[l.jsx(qr,{className:"w-5 h-5"}),"Sonraki Admlar"]}),l.jsxs("ol",{className:"space-y-3 text-gray-700",children:[l.jsxs("li",{className:"flex gap-3",children:[l.jsx("span",{className:"font-bold text-purple-600",children:"1."}),l.jsx("span",{children:"Dosyay indir (butona tkla)"})]}),l.jsxs("li",{className:"flex gap-3",children:[l.jsx("span",{className:"font-bold text-purple-600",children:"2."}),l.jsxs("span",{children:[l.jsx("strong",{children:"cPanel File Manager"}),"'a git"]})]}),l.jsxs("li",{className:"flex gap-3",children:[l.jsx("span",{className:"font-bold text-purple-600",children:"3."}),l.jsxs("span",{children:[l.jsx("strong",{children:"public_html"})," klasrne dosyay ykle"]})]}),l.jsxs("li",{className:"flex gap-3",children:[l.jsx("span",{className:"font-bold text-purple-600",children:"4."}),l.jsxs("span",{children:["Dosyaya ",l.jsx("strong",{children:"sa tkla  Extract"})]})]}),l.jsxs("li",{className:"flex gap-3",children:[l.jsx("span",{className:"font-bold text-purple-600",children:"5."}),l.jsx("span",{children:l.jsx("strong",{children:"Tamam!"})})]})]})]})]})})})}function WP(){const{user:e,loading:t,isClient:r}=Pr(),[n,a]=z.useState("dashboard");if(z.useEffect(()=>{const i=o=>{a(o.detail)};return window.addEventListener("navigate",i),()=>window.removeEventListener("navigate",i)},[]),console.log("App state - user exists:",!!e,"loading:",t,"isClient:",r),t)return l.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!e)return l.jsx(hN,{});const s=()=>{if(r)return l.jsx(SP,{});switch(n){case"dashboard":return l.jsx(Kx,{});case"policies":return l.jsx(AP,{});case"claims":return l.jsx(DP,{});case"clients":return l.jsx(RP,{});case"analytics":return l.jsx(IP,{});case"settings":return l.jsx(LP,{});case"announcements":return l.jsx(MP,{});case"agency-info":return l.jsx(BP,{});case"messages":return l.jsx(UP,{});case"renewals":return l.jsx(zP,{});case"documents":return l.jsx($P,{});case"backup":return l.jsx(HP,{});default:return l.jsx(Kx,{})}};return l.jsx(xN,{currentPage:n,onNavigate:a,children:s()})}function VP(){return l.jsx(XS,{children:l.jsx(WP,{})})}mv(document.getElementById("root")).render(l.jsx(z.StrictMode,{children:l.jsx(VP,{})}));
